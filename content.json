{"meta":{"title":"æœ‰å¹¸çš„ä¸ªäººå°ç«™","subtitle":"code is poetry","description":"è¿™æ˜¯ä½œè€…ä¸ºäº”åå¹´åçš„è‡ªå·±ç•™ä¸‹çš„ï¼Œæ„Ÿæ©ç”Ÿæ´»ã€‚","author":"xiaoqinghua æœ‰å¹¸","url":"http://xiaoqinghua.site"},"pages":[],"posts":[{"title":"Java8 æ—¶é—´æˆ³å’ŒLocalDateTimeäº’è½¬","slug":"Java8-æ—¶é—´æˆ³å’ŒLocalDateTimeäº’è½¬","date":"2018-09-06T08:22:48.000Z","updated":"2018-09-06T08:32:16.986Z","comments":true,"path":"Java8-æ—¶é—´æˆ³å’ŒLocalDateTimeäº’è½¬.html","link":"","permalink":"http://xiaoqinghua.site/Java8-æ—¶é—´æˆ³å’ŒLocalDateTimeäº’è½¬.html","excerpt":"","text":"Unixæ—¶é—´æˆ³(Unix timestamp)ï¼Œæˆ–ç§°Unixæ—¶é—´(Unix time)ã€POSIXæ—¶é—´(POSIX time)ï¼Œæ˜¯ä¸€ç§æ—¶é—´è¡¨ç¤ºæ–¹å¼ï¼Œå®šä¹‰ä¸ºä»æ ¼æ—å¨æ²»æ—¶é—´1970å¹´01æœˆ01æ—¥00æ—¶00åˆ†00ç§’èµ·è‡³ç°åœ¨çš„æ€»ç§’æ•°ã€‚ javaå®ç°è·å¾—æ—¶é—´æˆ³(long)ï¼š 1LocalDateTime.now().toInstant(ZoneOffset.of(\"+8\")).toEpochMilli(); æ—¶é—´æˆ³(long)è½¬æ¢æˆLocalDateTime: 12Long timestamp = LocalDateTime.now().toInstant(ZoneOffset.of(\"+8\")).toEpochMilli();LocalDateTime time2 =LocalDateTime.ofEpochSecond(timestamp/1000,0,ZoneOffset.ofHours(8)); æµ‹è¯•ï¼š 12345678910111213/** * @author xiaoqinghua * @since 2018-09-05 14:30 */public class Test &#123; public static void main(String[] args) &#123; long nowTimestamp = LocalDateTime.now().toInstant(ZoneOffset.of(\"+8\")).toEpochMilli(); System.out.println(nowTimestamp); System.out.println(\"=================\"); LocalDateTime nowLocalDateTime = LocalDateTime.ofEpochSecond(nowTimestamp / 1000, 0, ZoneOffset.ofHours(8)); System.out.println(nowLocalDateTime); &#125;&#125; ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/iterm2å°æŠ€å·§.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"JAVA 8","slug":"Code/JAVA-8","permalink":"http://xiaoqinghua.site/categories/Code/JAVA-8/"}],"tags":[{"name":"JAVA 8","slug":"JAVA-8","permalink":"http://xiaoqinghua.site/tags/JAVA-8/"}]},{"title":"æ˜“ç‡ƒæ˜“çˆ†ç‚¸(ç¨‹åºå‘˜ç‰ˆ)","slug":"æ˜“ç‡ƒæ˜“çˆ†ç‚¸(ç¨‹åºå‘˜ç‰ˆ)","date":"2018-08-24T16:12:09.000Z","updated":"2018-08-25T06:56:04.154Z","comments":true,"path":"æ˜“ç‡ƒæ˜“çˆ†ç‚¸(ç¨‹åºå‘˜ç‰ˆ).html","link":"","permalink":"http://xiaoqinghua.site/æ˜“ç‡ƒæ˜“çˆ†ç‚¸(ç¨‹åºå‘˜ç‰ˆ).html","excerpt":"","text":"å¼ æ‚¬æ˜¯å¤§æµ·ï¼Œé›·å…‰å¤æ˜¯æ˜Ÿç©ºã€‚é™ˆç»®è´æ˜¯å¤ªé˜³ï¼Œæ›¹æ–¹æ˜¯é£ã€‚é™ˆç²’æ˜¯ç«å’Œå…‰ã€‚ ä¸€ç›´å¾ˆå–œæ¬¢é™ˆç²’è¿™é¦–æ­Œï¼Œä¸ä»…åŸç‰ˆæ­Œè¯å†™å¾—æ„å‘³æ·±é•¿ï¼ŒèŠ‚å¥æ—‹å¾‹æ›´æ˜¯æ·±å…¥äººå¿ƒï¼› æ”¹ç¼–ä¸€é¦–ç¨‹åºå‘˜ç‰ˆçš„ï¼Œæ’¸ä»£ç çš„æ—¶å€™ï¼Œå¬è¿™é¦–çœŸçš„å¾ˆæ¥åŠ²ï¼ ç”±äºç‰ˆæƒä¿æŠ¤ï¼Œä¸èƒ½å¤–é“¾åŸç‰ˆçš„æ˜“ç‡ƒæ˜“çˆ†ç‚¸-é™ˆç²’ï¼Œæ”¾ä¸€é¦–ä¸ªäººè§‰å¾—é£æ ¼è¿˜ä¸é”™çš„plusç‰ˆæœ¬å§ï¼› æƒ³å¬åŸç‰ˆçš„ï¼šåŸç‰ˆ-æ˜“ç‡ƒæ˜“çˆ†ç‚¸(é™ˆç²’) ä»¥ä¸‹æ˜¯ç¨‹åºå‘˜ç‰ˆçš„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839æ˜“ç‡ƒæ˜“çˆ†ç‚¸(ç¨‹åºå‘˜ç‰ˆ)ä½œæ›²: é™ˆç²’ä½œè¯: å°æ¸…åç›¼æˆ‘é‡æ„è¿˜ç›¼æˆ‘ä¼˜é›…ä¸æ¶ˆç˜¦æƒ³æˆ‘å¥å£®è¿˜æƒ³æˆ‘å®‰å…¨ä¸è·Œå®•è¦æˆ‘ä¸€è‡´è¿˜è¦æˆ‘æœåŠ¡åˆ†å¸ƒå¼æˆæˆ‘è®¾è®¡æ¨¡å¼è¿˜æˆæˆ‘å¼‚å¸¸æ—¥å¿—èµæˆ‘æ¢¦å¢ƒè¿˜èµæˆ‘å¾ˆå¿«å°±æ¸…é†’ä¸æˆ‘æ²‰ç¡è¿˜ä¸æˆ‘è°ƒåº¦æŠ¢æ ˆå †çˆ±æˆ‘è§£é”è¿˜çˆ±æˆ‘æˆåŠŸä¸æŠ¥é”™çœ‹æˆ‘åè¿›å…ˆå‡ºè¿˜çœ‹æˆ‘å­‘å­“å­¤ç‹¬æ„¿æˆ‘å¹³æ»‘è¿˜æ„¿æˆ‘æ•ˆç‡é«˜åˆç‚¸çœ‹æˆ‘é›†æˆè¿˜çœ‹æˆ‘å¹¶å‘ä¸å†ç­‰è¦æˆ‘å¼‚æ­¥è¿˜è¦æˆ‘å•è°ƒåˆå†·é…·ç¥æˆ‘ä»æ­¤å¹¸ç¦è¿˜ç¥æˆ‘bugå…¨æ— ä¸ºæˆ‘è§£é”è¿˜ä¸ºæˆ‘è°¢ç»åå°„å›¾æˆ‘å°è£…è¿˜å›¾æˆ‘æ³›å‹æŠ½è±¡ä¸æˆ‘æ³¨è§£è¿˜ä¸ä»£ç†å´æ‹¦æˆªå¤¸æˆ‘è´Ÿè½½å‡è¡¡è¿˜å¤¸æˆ‘ä¸€è§†åŒä» èµæˆ‘æ¢¦å¢ƒè¿˜èµæˆ‘å¾ˆå¿«å°±æ¸…é†’ä¸æˆ‘å“ˆå¸Œè¿˜ä¸æˆ‘æ’’ç›åˆåŠ å¯†çˆ±æˆ‘è‡ªå¢è¿˜çˆ±æˆ‘é€’å½’åˆä¸æ·±çœ‹æˆ‘å¢åˆ æ”¹æŸ¥è¿˜çœ‹æˆ‘æµ·è§’å¤©æ¶¯ä¸ºæˆ‘è½®è¯¢è¿˜ä¸ºæˆ‘è§£è€¦é›†ç¾¤å›¾æˆ‘ç¼“å­˜è¿˜å›¾æˆ‘å‡ºåº“ä¿­çœä¸æˆ‘é‡è½½è¿˜ä¸æˆ‘äº’æ–¥å¤šæ€å¤¸æˆ‘é¢å‘å¯¹è±¡è¿˜å¤¸æˆ‘è£…æ¨¡ä½œæ · è¯·æˆ‘ç¼–ç è¿˜è¯·æˆ‘bugå…¨ç¼‰æ‹¿ä¼¼æˆ‘å¾ªç¯è¿˜ä¼¼æˆ‘çœŸå‡éš¾åˆ¤æ–­ç”±æˆ‘æ¡¥æ¥è¿˜ç”±æˆ‘éå†ä¸åœæ­‡æ€¨æˆ‘å…¨å±€æ’¤é”€è¿˜æ€¨æˆ‘å›ºæ‰§å›è°ƒ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/æ˜“ç‡ƒæ˜“çˆ†ç‚¸(ç¨‹åºå‘˜ç‰ˆ).htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼ 123456789101112131415161718192021222324252627282930313233343536373839åŸç‰ˆæ­Œè¯ä½œæ›²: é™ˆç²’ä½œè¯: å°šæ¢¦è¿ª/éªˆç„¶ç›¼æˆ‘ç–¯é­”è¿˜ç›¼æˆ‘å­‘å­“ä¸ç‹¬æ´»æƒ³æˆ‘å†·è‰³è¿˜æƒ³æˆ‘è½»ä½»åˆä¸‹è´±è¦æˆ‘é˜³å…‰è¿˜è¦æˆ‘é£æƒ…ä¸æ‘‡æ™ƒæˆæˆ‘å“­ç¬‘æ— ä¸»è¿˜æˆæˆ‘å¿ƒå¦‚æ¯æœ¨èµæˆ‘æ¢¦å¢ƒè¿˜èµæˆ‘å¾ˆå¿«å°±æ¸…é†’ä¸æˆ‘æ²‰ç¡è¿˜ä¸æˆ‘è¹‰è·æ— æ…ˆæ‚²çˆ±æˆ‘çº¯ç²¹è¿˜çˆ±æˆ‘èµ¤è£¸ä¸é¡é¢“çœ‹æˆ‘è‡ªå¼¹è‡ªå”±è¿˜çœ‹æˆ‘ç—›å¿ƒæ–­è‚ æ„¿æˆ‘å¦‚çƒŸè¿˜æ„¿æˆ‘æ›¼ä¸½åˆæ‡’å€¦çœ‹æˆ‘ç—´ç‹‚è¿˜çœ‹æˆ‘é£è¶£åˆç«¯åº„è¦æˆ‘ç¾è‰³è¿˜è¦æˆ‘æ€äººä¸çœ¨çœ¼ç¥æˆ‘ä»æ­¤å¹¸ç¦è¿˜ç¥æˆ‘æ¯èä¸æ¸¡ä¸ºæˆ‘æ’©äººè¿˜ä¸ºæˆ‘åŒçœ¸å¤±ç¥å›¾æˆ‘æƒ…çœŸè¿˜å›¾æˆ‘çœ¼æ³¢é”€é­‚ä¸æˆ‘ç§å¥”è¿˜ä¸æˆ‘åšä¸è´°è‡£å¤¸æˆ‘å«è‹å¾…æ”¾è¿˜å¤¸æˆ‘æ¬²ç›–å¼¥å½° èµæˆ‘æ¢¦å¢ƒè¿˜èµæˆ‘å¾ˆå¿«å°±æ¸…é†’ä¸æˆ‘æ²‰ç¡è¿˜ä¸æˆ‘è¹‰è·æ— æ…ˆæ‚²çˆ±æˆ‘çº¯ç²¹è¿˜çˆ±æˆ‘èµ¤è£¸ä¸é¡é¢“çœ‹æˆ‘è‡ªå¼¹è‡ªå”±è¿˜çœ‹æˆ‘ç—›å¿ƒæ–­è‚ ä¸ºæˆ‘æ’©äººè¿˜ä¸ºæˆ‘åŒçœ¸å¤±ç¥å›¾æˆ‘æƒ…çœŸè¿˜å›¾æˆ‘çœ¼æ³¢é”€é­‚ä¸æˆ‘ç§å¥”è¿˜ä¸æˆ‘åšä¸è´°è‡£å¤¸æˆ‘å«è‹å¾…æ”¾è¿˜å¤¸æˆ‘æ¬²ç›–å¼¥å½° è¯·æˆ‘è¿·äººè¿˜è¯·æˆ‘è‰³æƒ…é€æ¸—ä¼¼æˆ‘ç››æ”¾è¿˜ä¼¼æˆ‘ç¼ºæ°§ä¹–å¼ ç”±æˆ‘ç¾ä¸½è¿˜ç”±æˆ‘è´ªæ‹ç€è¿·æ€¨æˆ‘ç™¾å²æ— å¿§è¿˜æ€¨æˆ‘å¾’æœ‰æ³ªæµ","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"http://xiaoqinghua.site/tags/Life/"}]},{"title":"Computer Principles","slug":"è®¡ç®—æœºä¸–ç•Œçš„æ½œè§„åˆ™","date":"2018-08-24T15:21:38.000Z","updated":"2018-08-25T07:18:41.723Z","comments":true,"path":"è®¡ç®—æœºä¸–ç•Œçš„æ½œè§„åˆ™.html","link":"","permalink":"http://xiaoqinghua.site/è®¡ç®—æœºä¸–ç•Œçš„æ½œè§„åˆ™.html","excerpt":"","text":"åºåˆåˆ°äº†å¤œæ·±äººé™çš„æ—¶å€™ï¼Œæ€ç»´æ¸æ¸é¡¿äº†ä¸‹æ¥ï¼Œæƒ³æƒ³è‡ªå·±æ¯å¤©éƒ½åœ¨å†™ä»£ç ï¼Œdebugï¼Œé¢å¯¹ç€è¿™å†°å†·çš„ç¨‹åºï¼Œä¸€è¡Œä¸€è¡Œçš„è¾“å‡ºï¼Œå´ä¸çŸ¥é“å…¶èƒŒåçœŸæ­£çš„è¿è¡Œè§„å¾‹ï¼ŒæŒæ¡ç€çš„è¿™é—¨åƒé¥­çš„è¯­è¨€ï¼Œä¹Ÿåªæ˜¯çŸ¥å…¶ç„¶ï¼Œå°±ç®—çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œä¹Ÿæ„Ÿè§‰è‹èŒ«æ— åŠ›ï¼Œå› ä¸ºè¿™æ˜¯ä¸¤ä¸ªä¸–ç•Œï¼›ç‰©ç†ä¸–ç•Œä¸è®¡ç®—æœºä¸–ç•Œï¼Œä¸–ç•Œä¸‡ç‰©ç”±åŸå­æ„æˆï¼ŒåŸå­ç”±åŸå­æ ¸å’Œç”µå­æ„æˆï¼Œç”µå­ç»•ç€åŸå­æ ¸è¿åŠ¨ï¼Œäº§ç”Ÿä¸–é—´ä¸‡ç‰©ï¼Œä¸åŒçš„è¿è¡Œè§„å¾‹äº§ç”Ÿä¸åŒçš„ç‰©è´¨ï¼ˆèƒ½é‡ï¼‰ï¼›å¯åœ¨æˆ‘ç†è§£çš„è®¡ç®—æœºä¸–ç•Œå³ä½¿ä¸æŠŠè¿™ä¸ªä¸–ç•ŒæŠ½è±¡æˆæœ€å°çš„CPUæŒ‡ä»¤é›†è¿è¡Œçš„æœ€ç»†å°çš„ç»„ä»¶ä¸Šï¼Œè¿˜æ˜¯æœ‰ä¸è¿™ç°å®ç‰©ç†ä¸–ç•Œä¸åŒçš„æ³•åˆ™ï¼Œè¿™æ˜¯ä¸€å¥—ä¸“é—¨ä¸ºè®¡ç®—æœºä¸–ç•Œå®šä¸‹çš„è§„åˆ™ï¼Œä½ è¿è¡Œè®¡ç®—æœºï¼Œå†™ä¸€æ®µç¨‹åºäº¦æˆ–æ˜¯åšä¸€æ¬¡è¿ç®—ï¼Œä½ éƒ½è¢«è¿™å¼ºå¤§çš„è®¡ç®—æœºä¸–ç•Œçš„åŸºç¡€æ³•åˆ™æ‰€éœ‡æ…‘ï¼› ä¸ç¡®å®šæ˜¯æœ‰è¿¹å¯å¾ªçš„ï¼šå±€éƒ¨æ€§åŸç†åœ¨è¿™ä¸ªä¸–ç•Œé‡Œï¼Œä¸€æ®µæ—¶é—´å†…ï¼Œä¸€ä¸ªç¨‹åºçš„æ‰§è¡Œä»…é™äºè¿™ä¸ªç¨‹åºçš„æŸä¸ªéƒ¨åˆ†ï¼Œè¯šç„¶ï¼Œç¨‹åºè®¿é—®çš„å­˜å‚¨ç©ºé—´ä¹Ÿå±€é™äºæŸä¸€ä¸ªå†…å­˜åŒºåŸŸï¼› æ—¶é—´å±€éƒ¨æ€§ï¼šä¸€æ—¦ä¸€ä¸ªç¨‹åºçš„æŸä¸ªæŒ‡ä»¤ä¸€æ—¦æ‰§è¡Œï¼Œåˆ™åœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´é‡Œï¼Œè¿™ä¸ªæŒ‡ä»¤å°†å†æ¬¡è¢«æ‰§è¡Œï¼› ç©ºé—´å±€éƒ¨æ€§ï¼šä¸€æ—¦ä¸€ä¸ªç¨‹åºè®¿é—®äº†æŸä¸ªå­˜å‚¨å•å…ƒï¼Œåˆ™åœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´é‡Œï¼Œå…¶é™„è¿‘çš„å­˜å‚¨å•å…ƒä¹Ÿå°†è¢«è®¿é—®ï¼› This is the god princples. è¿™ä¸ªåŸç†çš„å½±å“æ˜¯å·¨å¤§çš„ï¼Œä½ æˆ‘å¤©å¤©å†™çš„ Javaï¼Œè¿è¡Œåœ¨ Java è™šæ‹Ÿæœºä¸­ï¼ŒåŸæœ¬æ˜¯è§£é‡Šæ‰§è¡Œ.classæ–‡ä»¶ï¼Œä½†æ˜¯è¿™æ ·æ€§èƒ½çœŸçš„ä¸é«˜ï¼Œä½†æ˜¯åŠ æŒå±€éƒ¨æ€§åŸç†çš„å…‰ç¯ğŸ˜‡ï¼Œå°±å¯ä»¥æ‰¾åˆ°é‚£äº›å¸¸ç”¨çš„ï¼Œçƒ­ç‚¹çš„ä»£ç ï¼Œç„¶å JVM ä¼šæŠŠä»–ä»¬ç¼–è¯‘æˆæœ¬åœ°åŸç”Ÿä»£ç native codeï¼Œè¿™æ ·æ‰§è¡Œæ•ˆç‡å°±å’Œæ‰§è¡ŒC/C++å·®ä¸å¤šäº†ï¼› åšå°”ç‰¹åœ¨å‰é¢ç­‰ä½ ï¼šç¼“å­˜åœ¨è®¡ç®—æœºçš„ä¸–ç•Œé‡Œï¼ŒCPU çš„é€Ÿåº¦è¿œè¿œå¤§äºå†…å­˜å’Œç¡¬ç›˜ï¼ŒCPU &gt; 100å€å†…å­˜ &gt; 1000ä¸‡å€ç¡¬ç›˜ã€‚ å‡è®¾åšå°”ç‰¹å’Œä½ åœ¨è·‘æ¥åŠ›èµ›ï¼Œå¦‚æœè¿™ä¸ªåšå°”ç‰¹æ¯æ¬¡äº¤æ¥æ£’çš„æ—¶å€™éƒ½è¦ç­‰ä½ ï¼Œå°±åƒåœ¨è®¡ç®—æœºä¸–ç•Œï¼Œå¦‚æœè¿è¡Œä¸€å¥—ç¨‹åºï¼ŒCPU ä¸€ç›´éƒ½è¦ç­‰ç€ç¡¬ç›˜å’Œå†…å­˜çš„è¯ï¼Œé‚£è®¡ç®—æœºå°±å¤ªæ…¢äº†ã€‚ æ‰€ä»¥ï¼Œè¿ç”¨å±€éƒ¨æ€§åŸç†ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠç»å¸¸éœ€è¦ç”¨çš„æ•°æ®ä»ç¡¬ç›˜å–åˆ°å†…å­˜ï¼ŒCPUä¼šæŠŠç»å¸¸ç”¨çš„æ•°æ®ä»å†…å­˜å–åˆ°è‡ªå·±çš„ç¼“å­˜ä¸­ã€‚ é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå„æ–¹çš„é€Ÿåº¦ä¸åŒ¹é…é—®é¢˜ï¼Œå¾—åˆ°äº†å‡ å¤§çš„ç¼“è§£ï¼› åœ¨ web å¼€å‘ä¸­ï¼Œç¼“å­˜æ›´æ˜¾å¾—éå¸¸å¸¸è§ï¼Œç”±äºæ•°æ®åº“ï¼ˆç¡¬ç›˜ï¼‰å¤ªæ…¢ï¼Œå¤§éƒ¨åˆ† web ç³»ç»Ÿéƒ½ä¼šæŠŠæœ€å¸¸ç”¨çš„ä¸šåŠ¡æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ç¼“å­˜èµ·æ¥ æŠ›å¼ƒç»†èŠ‚ï¼š æŠ½è±¡æŠ½è±¡æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­æœ€ä¸ºé‡è¦çš„æ¦‚å¿µä¹‹ä¸€ã€‚ å½“æˆ‘ä»¬é‡åˆ°å¤æ‚é—®é¢˜çš„æ—¶å€™ï¼Œ æŠ½è±¡æ˜¯éå¸¸é‡è¦çš„æ­¦å™¨ã€‚ ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ä¸€ä¹¦ä¸­æåˆ°ï¼šâ€œæŒ‡ä»¤é›†æ˜¯å¯¹CPUçš„æŠ½è±¡ï¼Œ æ–‡ä»¶æ˜¯å¯¹è¾“å…¥/è¾“å‡ºè®¾å¤‡çš„æŠ½è±¡ï¼Œ è™šæ‹Ÿå­˜å‚¨å™¨æ˜¯å¯¹ç¨‹åºå­˜å‚¨çš„æŠ½è±¡ï¼Œ è¿›ç¨‹æ˜¯å¯¹ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„æŠ½è±¡ï¼Œ è€Œè™šæ‹Ÿæœºæ˜¯å¯¹æ•´ä¸ªè®¡ç®—æœºï¼ˆåŒ…æ‹¬æ“ä½œç³»ç»Ÿã€å¤„ç†å™¨å’Œç¨‹åºï¼‰çš„æŠ½è±¡ã€‚â€â€” æ„Ÿè§‰å®Œå…¨å¯ä»¥èƒŒä¸‹æ¥ï¼Œç»å…¸ä¸­çš„ç»å…¸ CPUé›†æˆç”µè·¯ç¡¬ä»¶æ— æ¯”å¤æ‚ï¼Œ ä½†æ˜¯æˆ‘ä»¬å†™ç¨‹åºè‚¯å®šä¸ç”¨æ¥è§¦è¿™äº›ç¡¬ä»¶ç»†èŠ‚ï¼Œ é‚£æ ·å°±ç´¯æ­»äº†ï¼Œ æˆ‘ä»¬åªè¦éµå¾ªCPUçš„æŒ‡ä»¤é›†ï¼Œ ç¨‹åºå°±å¯ä»¥æ­£ç¡®çš„è¿è¡Œï¼Œ è€Œä¸ç”¨å…³å¿ƒæŒ‡ä»¤åœ¨ç¡¬ä»¶å±‚æ¬¡åˆ°åº•æ˜¯æ€ä¹ˆè¿è¡Œçš„ã€‚ ç¡¬ç›˜ä¹Ÿæ˜¯è¿™æ ·ï¼Œ æœ‰ç£é“ï¼ŒæŸ±é¢ï¼Œæ‰‡åŒºï¼Œ æˆ‘ä»¬å†™åº”ç”¨å±‚ç¨‹åºä¹Ÿä¸ç”¨å’Œè¿™äº›çƒ¦äººçš„ç»†èŠ‚æ‰“äº¤é“ï¼Œ åœ¨æ“ä½œç³»ç»Ÿå’Œè®¾å¤‡é©±åŠ¨çš„é…åˆä¸‹ï¼Œ æˆ‘ä»¬åªéœ€è¦é¢å¯¹ä¸€ä¸ªä¸ªâ€œæ–‡ä»¶â€ï¼Œæ‰“å¼€ï¼Œè¯»å–ï¼Œå…³é—­å°±è¡Œäº†ã€‚ æ“ä½œç³»ç»Ÿä¼šæŠŠé€»è¾‘çš„æ–‡ä»¶ç¿»è¯‘æˆç‰©ç†ç£ç›˜ä¸Šçš„å­—èŠ‚ã€‚ å†æ¯”å¦‚ä¸ºäº†å®ç°æ•°æ®çš„å…±äº«ï¼Œæ•°æ®çš„ä¸€è‡´æ€§å’Œå®‰å…¨æ€§ï¼Œéœ€è¦å¤§é‡çš„ï¼Œå¤æ‚çš„ç¨‹åºä»£ç æ¥å®ç°ï¼Œ æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½å®ç°ä¸€ä»½è‚¯å®šä¸æ˜¯ç°å®çš„ã€‚ æ‰€ä»¥è®¡ç®—æœºç§‘å­¦æŠ½è±¡å‡ºäº†ä¸€ä¸ªå«æ•°æ®åº“çš„ä¸œè¥¿ï¼Œ ä½ åªéœ€è¦å®‰è£…æ•°æ®åº“è½¯ä»¶ï¼Œ ä½¿ç”¨SQLå’Œäº‹åŠ¡å°±èƒ½å®ç°å¤šç”¨æˆ·å¯¹æ•°æ®çš„å®‰å…¨è®¿é—®äº†ã€‚ æˆ‘åªæƒ³å’Œé‚»å±…æ‰“äº¤é“ï¼šåˆ†å±‚åŸç†è¯´ç¨‹åºå‘˜æ¯”è¾ƒå®…ï¼Œè®¡ç®—æœºçš„ä¸–ç•Œä¹Ÿä¸€æ ·ï¼Œéƒ½æ¯”è¾ƒæ‡’ï¼ˆå…¶å®æ˜¯ä¸ºäº†æ•ˆç‡ï¼‰ï¼Œä¸æ„¿æ„è·¨è¶Šæ›´å¤šçš„åŒºåŸŸå»åšä¸€ä»¶äº‹ï¼› åˆ†å±‚å…¶å®ä¹Ÿæ˜¯æŠ½è±¡çš„ä¸€ç§ï¼Œå®ƒé€šè¿‡å±‚æ¬¡æŠŠå¤æ‚çš„ï¼Œå¯èƒ½å˜åŒ–çš„ä¸œè¥¿éš”ç¦»å¼€æ¥ï¼Œ æŸä¸€å±‚åªèƒ½è®¿é—®å®ƒçš„ç›´æ¥ä¸Šå±‚å’Œä¸‹å±‚ï¼Œ ä¸èƒ½è·¨å±‚è®¿é—®ã€‚ ä¾‹å¦‚ç½‘ç»œåè®®åˆ†å±‚ï¼š OSI çš„ç»å…¸7å±‚ç½‘ç»œæ¨¡å‹ åº”ç”¨å±‚ è¡¨ç¤ºå±‚ ä¼šè¯å±‚ ä¼ è¾“å±‚ ç½‘ç»œå±‚ æ•°æ®é“¾è·¯å±‚ ç‰©ç†å±‚ TCP/IP 5å±‚æ¨¡å‹ åº”ç”¨å±‚ ä¼ è¾“å±‚ ç½‘ç»œå±‚ æ•°æ®é“¾è·¯å±‚ ç‰©ç†å±‚ å†æ¯”å¦‚ Web å¼€å‘ä¸­çš„åˆ†å±‚ï¼š è¡¨ç¤ºå±‚ ä¸šåŠ¡é€»è¾‘å±‚ æ•°æ®è®¿é—®å±‚ DB åˆ†å±‚çš„å¥½å¤„å°±æ˜¯éš”ç¦»å˜åŒ–ï¼Œ åœ¨æ¥å£ä¸å˜çš„æƒ…å†µä¸‹ï¼Œ æŸä¸€å±‚çš„å˜åŒ–åªä¼šå±€é™äºæœ¬å±‚æ¬¡å†…ã€‚å³ä½¿æ˜¯æ¥å£å˜åŒ–ï¼Œ ä¹Ÿä»…ä»…ä¼šå½±å“è°ƒç”¨æ–¹ã€‚ éƒ½æ˜¯æ€¥æ€§å­ï¼šå¼‚æ­¥è°ƒç”¨å½“ä½ çš„ç¨‹åºéœ€è¦ç­‰å¾…ä¸€ä¸ªé•¿æ—¶é—´çš„æ“ä½œè€Œè¢«é˜»å¡ä½æ—¶è€Œæ— æ‰€äº‹äº‹çš„æ—¶å€™ï¼Œ å¼‚æ­¥è°ƒç”¨å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ å¼‚æ­¥è°ƒç”¨ç®€å•å°±æ˜¯è¯´ï¼š æˆ‘ç­‰ä¸åŠä½ äº†ï¼Œ å…ˆå»åšåˆ«çš„äº‹æƒ…ï¼Œ ä½ åšå®Œäº†å‘Šè¯‰æˆ‘ä¸€å£°ã€‚ å›åˆ°æœ€æ—©çš„é‚£ä¸ªCPUçš„ä¾‹å­ï¼Œ CPUé€Ÿåº¦å¤ªå¿«ï¼Œ å½“å®ƒæƒ³è¯»å–ç¡¬ç›˜æ–‡ä»¶çš„æ—¶å€™ï¼Œæ˜¯ä¸ä¼šç­‰å¾…æ…¢1000å¤šä¸‡å€çš„ç¡¬ç›˜çš„ï¼Œ å®ƒä¼šå¯åŠ¨ä¸€ä¸ªDMA , ä¸ç”¨é€šè¿‡CPUï¼Œ ç›´æ¥æŠŠæ•°æ®ä»ç¡¬ç›˜è¯»åˆ°å†…å­˜ï¼Œ è¯»å®Œä»¥åé€šè¿‡ä¸­æ–­çš„æ–¹å¼æ¥é€šçŸ¥CPUã€‚ Node.js å’Œ WebæœåŠ¡å™¨Nginx ä¹Ÿæ˜¯è¿™æ ·ï¼Œ ä¸€ä¸ªçº¿ç¨‹æˆ–è‹¥å¹²ä¸ªçº¿ç¨‹å¤„ç†æ‰€æœ‰çš„è¯·æ±‚ï¼Œ é‡åˆ°è€—æ—¶çš„æ“ä½œï¼Œ ç»ä¸ç­‰å¾…ï¼Œ é©¬ä¸Šå»å¹²åˆ«çš„äº‹æƒ…ï¼Œç­‰åˆ°è€—æ—¶æ“ä½œå®Œæˆåï¼Œå†æ¥é€šçŸ¥è¿™äº›å¹²æ´»çš„çº¿ç¨‹ã€‚ è¿˜æœ‰è‘—åçš„AJAX , å½“æµè§ˆå™¨ä¸­çš„javascriptå‘å‡ºä¸€ä¸ªHttp è¯·æ±‚çš„æ—¶å€™, ä¹Ÿä¸ä¼šç­‰å¾…ä»æœåŠ¡å™¨ç«¯è¿”å›æ•°æ®ï¼Œ åªæ˜¯è®¾ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œ æœåŠ¡å™¨å“åº”æ•°æ®å›æ¥çš„æ—¶å€™è°ƒç”¨ä¸€ä¸‹å°±è¡Œäº†ã€‚ åˆ†è€Œæ²»ä¹‹åˆ†è€Œæ²»ä¹‹çš„åŸºæœ¬æ€æƒ³æ˜¯å°†ä¸€ä¸ªè§„æ¨¡æ¯”è¾ƒå¤§çš„é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªè§„æ¨¡è¾ƒå°çš„å­é—®é¢˜ï¼Œè¿™äº›å­é—®é¢˜ç›¸äº’ç‹¬ç«‹ä¸”ä¸åŸé—®é¢˜æ€§è´¨ç›¸åŒã€‚æ±‚å‡ºå­é—®é¢˜çš„è§£ï¼Œæœ€åç»„åˆèµ·æ¥å°±å¯å¾—åˆ°åŸé—®é¢˜çš„è§£ã€‚ ç”±äºå­é—®é¢˜å’ŒåŸé—®é¢˜æ€§è´¨ç›¸åŒï¼Œ æ‰€ä»¥å¾ˆå¤šæ—¶å€™å¯ä»¥ç”¨é€’å½’ã€‚ å½’å¹¶æ’åºå°±æ˜¯ä¸€ä¸ªç»å…¸çš„ä¾‹å­ï¼Œ æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹¦ä¸Šåˆ°å¤„éƒ½æ˜¯ï¼Œ è¿™é‡Œå°±ä¸åœ¨èµ˜è¿°äº†ã€‚ å¦‚æœæŠŠåˆ†è€Œæ²»ä¹‹æ³›åŒ–ä¸€ä¸‹ï¼Œ åˆ°è½¯ä»¶è®¾è®¡é¢†åŸŸï¼Œ å°±å¯ä»¥è®¤ä¸ºæ˜¯æŠŠä¸€ä¸ªå¤§é—®é¢˜é€æ­¥åˆ†è§£çš„è¿‡ç¨‹","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Computer Principles","slug":"Code/Computer-Principles","permalink":"http://xiaoqinghua.site/categories/Code/Computer-Principles/"}],"tags":[{"name":"Computer Principles","slug":"Computer-Principles","permalink":"http://xiaoqinghua.site/tags/Computer-Principles/"}]},{"title":"æˆéƒ½","slug":"æˆéƒ½","date":"2018-07-21T08:38:55.000Z","updated":"2018-09-08T07:00:13.888Z","comments":true,"path":"æˆéƒ½.html","link":"","permalink":"http://xiaoqinghua.site/æˆéƒ½.html","excerpt":"","text":"æˆéƒ½ï¼Œå†ç­‰æˆ‘ä¸€ä¸‹ï¼Œæˆ‘å¾ˆå¿«å°±èƒ½æœ‰å±äºè‡ªå·±çš„æˆ¿å­äº†ï¼åŠ æ²¹ï¼ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ æˆ éƒ½ 123456789\"city\":&#123; \"name\":\"chengdu\", \"abbreviation01\":\"cdc\", \"abbreviation02\":\"splendid officer city\", \"abbreviation03\":\"hibiscus city\", \"slogan_en\":\"living and enjoy in your home forever\", \"slogan_ch\":\"ä¸€åº§æ¥äº†å°±ä¸æƒ³ç¦»å¼€çš„åŸå¸‚\" \"xiaoqinghua\":\"I love you , I love my city\"&#125; ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/æˆéƒ½.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[],"tags":[{"name":"City","slug":"City","permalink":"http://xiaoqinghua.site/tags/City/"}]},{"title":"Follow ç®—æ³•è¿‡ç¨‹éªŒç®—","slug":"followç®—æ³•è¿‡ç¨‹éªŒç®—","date":"2018-07-10T07:08:15.000Z","updated":"2018-08-25T06:48:47.520Z","comments":true,"path":"followç®—æ³•è¿‡ç¨‹éªŒç®—.html","link":"","permalink":"http://xiaoqinghua.site/followç®—æ³•è¿‡ç¨‹éªŒç®—.html","excerpt":"","text":"ä¸¾ä¸ªæ —å­ğŸŒ° 1follow(cs1,cs2) --&gt; follow(\"Z:z&gt;4|2=m=b-1+2+3$abcde\", \"Z:z&gt;1|2=m=b=1+2-1$fg\") 12345678910111213141516æŠŠcs1,cs2å±•å¼€cs1:op1.1:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;op1.2:&#123; opcode: &apos;=&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;op1.3:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;op1.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;op1.5:&#123; opcode: &apos;+&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;charBank=&apos;abcde&apos;cs2:op2.1:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;op2.2:&#123; opcode: &apos;=&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;op2.3:&#123; opcode: &apos;=&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;op2.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;op2.5:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;charBank=&apos;fg&apos; åœ¨followå‡½æ•°ä¸­æœ‰ä¸€ä¸ªapplyZipçš„å‡½æ•°,å…¶å®è¿™æ˜¯ä¸€ä¸ªè¿­ä»£å™¨,zipæœ‰æ‹‰é“¾çš„æ„æ€,åœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­ä¸æ–­çš„ä¸¤ä¸¤è¿ç®—,å°±åƒæ‹‰é“¾ä¸€æ ·ä¸€é¢—é¢—ç¼åˆèµ·æ¥: 1234567891011121314151617181920exports.applyZip = function (in1, idx1, in2, idx2, func) &#123; var iter1 = exports.opIterator(in1, idx1); var iter2 = exports.opIterator(in2, idx2); var assem = exports.smartOpAssembler(); var op1 = exports.newOp(); var op2 = exports.newOp(); var opOut = exports.newOp(); while (op1.opcode || iter1.hasNext() || op2.opcode || iter2.hasNext()) &#123; if ((!op1.opcode) &amp;&amp; iter1.hasNext()) iter1.next(op1); if ((!op2.opcode) &amp;&amp; iter2.hasNext()) iter2.next(op2); func(op1, op2, opOut); if (opOut.opcode) &#123; //print(opOut.toSource()); assem.append(opOut); opOut.opcode = ''; &#125; &#125; assem.endDocument(); return assem.toString();&#125;; 1234567891011å¼€å§‹è¿­ä»£(å¾ªç¯)å‰,éœ€è¦åšä¸€äº›å‡†å¤‡å·¥ä½œ:1ã€æ–°å»ºä¸¤ä¸ªç©ºçš„op1,op2å¯¹è±¡ï¼Œç”¨äºæ¥æ”¶å±•å¼€çš„cs1,cs2ä¸­æ‰€æœ‰çš„opå¯¹è±¡çš„å€¼Op op1 = new Op();op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;Op op2 = new Op();op2:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€æ–°å»ºä¸€ä¸ªopOutå¯¹è±¡,ç”¨äºæ¥æ”¶æ¯ä¸€æ¬¡è¿­ä»£å®Œåæˆ‘ä»¬å¾—åˆ°çš„è¿ç®—ç»“æœopOp opOut = new Op();opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125; 1234567891011121314ç¬¬1æ¬¡è¿­ä»£:1ã€åˆå§‹:æŒ‰ç…§é¡ºåºä¼šä½¿ç”¨cs1ä¸­çš„op1.1å’Œcs2ä¸­çš„op2.1å’Œä¸€ä¸ªåˆšåˆšnewå‡ºæ¥çš„æ–°çš„opå¯¹è±¡op1.1:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;op2.1:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€followç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;ops : &quot;|2=m&quot;è¯´æ˜:both keep,followä¹‹åop1,op2éƒ½æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬1æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :12345678910111213141516171819// both keepsopOut.opcode = '=';opOut.attribs = exports.followAttributes(op1.attribs, op2.attribs, pool);if (op1.chars &lt;= op2.chars) &#123; opOut.chars = op1.chars; opOut.lines = op1.lines; op2.chars -= op1.chars; op2.lines -= op1.lines; op1.opcode = ''; if (!op2.chars) &#123; op2.opcode = ''; &#125;&#125; else &#123; opOut.chars = op2.chars; opOut.lines = op2.lines; op1.chars -= op2.chars; op1.lines -= op2.lines; op2.opcode = '';&#125; 123456789101112ç¬¬2æ¬¡è¿­ä»£:1ã€åˆå§‹:op1.2:&#123; opcode: &apos;=&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;op2.2:&#123; opcode: &apos;=&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€followç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;=&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;ops : &quot;|2=m=b&quot;è¯´æ˜:both keep,followä¹‹åop1,op2éƒ½æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬2æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :12345678910111213141516171819// both keepsopOut.opcode = '=';opOut.attribs = exports.followAttributes(op1.attribs, op2.attribs, pool);if (op1.chars &lt;= op2.chars) &#123; opOut.chars = op1.chars; opOut.lines = op1.lines; op2.chars -= op1.chars; op2.lines -= op1.lines; op1.opcode = ''; if (!op2.chars) &#123; op2.opcode = ''; &#125;&#125; else &#123; opOut.chars = op2.chars; opOut.lines = op2.lines; op1.chars -= op2.chars; op1.lines -= op2.lines; op2.opcode = '';&#125; 123456789101112ç¬¬3æ¬¡è¿­ä»£:1ã€åˆå§‹:op1.3:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;op2.3:&#123; opcode: &apos;=&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€followç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;ops : &quot;|2=m=b&quot;è¯´æ˜:op1-,op2=,followä¹‹åop1,op2éƒ½æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬3æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç : 12345678910111213141516if (!op2.opcode) &#123; op1.opcode = '';&#125; else &#123; if (op1.chars &lt;= op2.chars) &#123; op2.chars -= op1.chars; op2.lines -= op1.lines; op1.opcode = ''; if (!op2.chars) &#123; op2.opcode = ''; &#125; &#125; else &#123; op1.chars -= op2.chars; op1.lines -= op2.lines; op2.opcode = ''; &#125;&#125; 123456789101112ç¬¬4æ¬¡è¿­ä»£:1ã€åˆå§‹:op1.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;op2.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€followç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;=&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;ops : &quot;|2=m=b=2&quot;è¯´æ˜:both+,followä¹‹åop1æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬4æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :123456789101112131415161718192021222324252627282930313233343536373839404142var whichToDo;if (op2.opcode != '+') &#123; whichToDo = 1;&#125; else if (op1.opcode != '+') &#123; whichToDo = 2;&#125; else &#123; // both + var firstChar1 = chars1.peek(1); var firstChar2 = chars2.peek(1); var insertFirst1 = hasInsertFirst(op1.attribs); var insertFirst2 = hasInsertFirst(op2.attribs); if (insertFirst1 &amp;&amp; !insertFirst2) &#123; whichToDo = 1; &#125; else if (insertFirst2 &amp;&amp; !insertFirst1) &#123; whichToDo = 2; &#125; // insert string that doesn't start with a newline first so as not to break up lines else if (firstChar1 == '\\n' &amp;&amp; firstChar2 != '\\n') &#123; whichToDo = 2; &#125; else if (firstChar1 != '\\n' &amp;&amp; firstChar2 == '\\n') &#123; whichToDo = 1; &#125; // break symmetry: else if (reverseInsertOrder) &#123; whichToDo = 2; &#125; else &#123; whichToDo = 1; &#125;&#125;if (whichToDo == 1) &#123; chars1.skip(op1.chars); opOut.opcode = '='; opOut.lines = op1.lines; opOut.chars = op1.chars; opOut.attribs = ''; op1.opcode = '';&#125; else &#123; // whichToDo == 2 chars2.skip(op2.chars); exports.copyOp(op2, opOut); op2.opcode = '';&#125; 123456789101112ç¬¬5æ¬¡è¿­ä»£:1ã€åˆå§‹:op1.5:&#123; opcode: &apos;+&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;op2.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;(ç¬¬4æ¬¡å¾ªç¯followç®—æ³•åçš„op2)opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€followç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;ops : &quot;|2=m=b=2=3&quot;è¯´æ˜:both+,followä¹‹åop1æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next(),ä½†æ­¤æ—¶å·²æ²¡æœ‰next(),æ•…è¿˜æ˜¯ä½¿ç”¨op1åŸæœ‰å€¼ å¯¹åº”ç¬¬5æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :123456789101112131415161718192021222324252627282930313233343536373839404142var whichToDo;if (op2.opcode != '+') &#123; whichToDo = 1;&#125; else if (op1.opcode != '+') &#123; whichToDo = 2;&#125; else &#123; // both + var firstChar1 = chars1.peek(1); var firstChar2 = chars2.peek(1); var insertFirst1 = hasInsertFirst(op1.attribs); var insertFirst2 = hasInsertFirst(op2.attribs); if (insertFirst1 &amp;&amp; !insertFirst2) &#123; whichToDo = 1; &#125; else if (insertFirst2 &amp;&amp; !insertFirst1) &#123; whichToDo = 2; &#125; // insert string that doesn't start with a newline first so as not to break up lines else if (firstChar1 == '\\n' &amp;&amp; firstChar2 != '\\n') &#123; whichToDo = 2; &#125; else if (firstChar1 != '\\n' &amp;&amp; firstChar2 == '\\n') &#123; whichToDo = 1; &#125; // break symmetry: else if (reverseInsertOrder) &#123; whichToDo = 2; &#125; else &#123; whichToDo = 1; &#125;&#125;if (whichToDo == 1) &#123; chars1.skip(op1.chars); opOut.opcode = '='; opOut.lines = op1.lines; opOut.chars = op1.chars; opOut.attribs = ''; op1.opcode = '';&#125; else &#123; // whichToDo == 2 chars2.skip(op2.chars); exports.copyOp(op2, opOut); op2.opcode = '';&#125; 123456789101112ç¬¬6æ¬¡è¿­ä»£:1ã€åˆå§‹:op1:&#123; opcode: &apos;&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;(ç¬¬5æ¬¡å¾ªç¯followç®—æ³•åçš„op1)op2.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;(ç¬¬4æ¬¡å¾ªç¯followç®—æ³•åçš„op2)opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€followç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;ops : &quot;|2=m=b=2=3+2&quot;è¯´æ˜:op2+,followä¹‹åop1ï¼Œop2æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next(),ä½†æ­¤æ—¶å·²æ²¡æœ‰next(),æ•…è¿˜æ˜¯ä½¿ç”¨op1ï¼Œop2åŸæœ‰å€¼ å¯¹åº”ç¬¬6æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :123456789101112131415161718192021222324252627282930313233343536373839404142var whichToDo;if (op2.opcode != '+') &#123; whichToDo = 1;&#125; else if (op1.opcode != '+') &#123; whichToDo = 2;&#125; else &#123; // both + var firstChar1 = chars1.peek(1); var firstChar2 = chars2.peek(1); var insertFirst1 = hasInsertFirst(op1.attribs); var insertFirst2 = hasInsertFirst(op2.attribs); if (insertFirst1 &amp;&amp; !insertFirst2) &#123; whichToDo = 1; &#125; else if (insertFirst2 &amp;&amp; !insertFirst1) &#123; whichToDo = 2; &#125; // insert string that doesn't start with a newline first so as not to break up lines else if (firstChar1 == '\\n' &amp;&amp; firstChar2 != '\\n') &#123; whichToDo = 2; &#125; else if (firstChar1 != '\\n' &amp;&amp; firstChar2 == '\\n') &#123; whichToDo = 1; &#125; // break symmetry: else if (reverseInsertOrder) &#123; whichToDo = 2; &#125; else &#123; whichToDo = 1; &#125;&#125;if (whichToDo == 1) &#123; chars1.skip(op1.chars); opOut.opcode = '='; opOut.lines = op1.lines; opOut.chars = op1.chars; opOut.attribs = ''; op1.opcode = '';&#125; else &#123; // whichToDo == 2 chars2.skip(op2.chars); exports.copyOp(op2, opOut); op2.opcode = '';&#125; 123456789101112ç¬¬7æ¬¡è¿­ä»£:1ã€åˆå§‹:op1:&#123; opcode: &apos;&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;(ç¬¬6æ¬¡å¾ªç¯followç®—æ³•åçš„op1)op2.5:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€followç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;ops : &quot;|2=m=b=2=3+2-1&quot;è¯´æ˜:åˆ¤æ–­ï¼Œop1,op2éƒ½æ²¡æœ‰opcode,ä¹Ÿæ²¡æœ‰next()äº†,åœæ­¢ å¯¹åº”ç¬¬7æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :12345678910111213141516171819exports.copyOp(op2, opOut);if (!op1.opcode) &#123; op2.opcode = '';&#125; else if (op2.chars &lt;= op1.chars) &#123; // delete part or all of a keep op1.chars -= op2.chars; op1.lines -= op2.lines; op2.opcode = ''; if (!op1.chars) &#123; op1.opcode = ''; &#125;&#125; else &#123; // delete all of a keep, and keep going opOut.lines = op1.lines; opOut.chars = op1.chars; op2.lines -= op1.lines; op2.chars -= op1.chars; op1.opcode = '';&#125; ç®—æ³•ç»“æœ12345678910111213141516171819202122232425261 Changeset = require(\"./src/static/js/Changeset\");2 var csA = \"Z:z&gt;4|2=m=b-1+2+3$abcde\";3 var csB = \"Z:z&gt;1|2=m=b=1+2-1$fg\";45 var doc = \"Hello World\\n\\n Hello World Hello Wor\";67 var appliedA = Changeset.applyToText(csA,doc);8 var appliedB = Changeset.applyToText(csB,doc);910 console.log('apply csA:', appliedA, ',apply csB: ', appliedB);1112 var csA1 = Changeset.follow(csB,csA,true,null);13 var csB1 = Changeset.follow(csA,csB,false,null);1415 console.log('csA1:', csA1, 'csB1: ', csB1);1617 // X * csA * csB1 = Y18 // X * csB * csA1 = Y1920 var leftY = Changeset.applyToText(csB1, appliedA);21 var rightY = Changeset.applyToText(csA1, appliedB);2223 console.log('final left:', leftY, ',final right: ', rightY);24 if (leftY === rightY) &#123;25 console.log('bingo');26 &#125; 12345678910111213141516171819202122apply csA: Hello World Hello World Hello Wabcderapply csB: Hello World Hello World Hello WofgcsA1: Z:10&gt;4|2=m=b-1+5$abcdecsB1: Z:13&gt;1|2=m=g-1+2$fgfinal left: Hello World Hello World Hello Wabcdefgfinal right: Hello World Hello World Hello Wabcdefgbingo 123456789&gt; var cs1 = \"Z:z&gt;4|2=m=b-1+2+3$abcde\";&gt; var cs2 = \"Z:z&gt;1|2=m=b=1+2-1$fg\";&gt; Changeset.follow(cs1,cs2,false,null);'Z:13&gt;1|2=m=g-1+2$fg'æœ€ç»ˆçš„CS:'Z:13&gt;1|2=m=g-1+2$fg' ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/followç®—æ³•è¿‡ç¨‹éªŒç®—.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"OT","slug":"Code/OT","permalink":"http://xiaoqinghua.site/categories/Code/OT/"}],"tags":[{"name":"OT","slug":"OT","permalink":"http://xiaoqinghua.site/tags/OT/"}]},{"title":"Follow ç®—æ³•å›¾è§£","slug":"followç®—æ³•å›¾è§£","date":"2018-07-09T07:09:28.000Z","updated":"2018-08-25T06:48:26.023Z","comments":true,"path":"followç®—æ³•å›¾è§£.html","link":"","permalink":"http://xiaoqinghua.site/followç®—æ³•å›¾è§£.html","excerpt":"","text":"01 02 03 04 05 06 07 08 09 10 11 ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/followç®—æ³•å›¾è§£.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"OT","slug":"Code/OT","permalink":"http://xiaoqinghua.site/categories/Code/OT/"}],"tags":[{"name":"OT","slug":"OT","permalink":"http://xiaoqinghua.site/tags/OT/"}]},{"title":"FollowAttributes ç®—æ³•è§£æ","slug":"followAttributesç®—æ³•è§£æ","date":"2018-06-19T07:09:01.000Z","updated":"2018-08-25T06:48:11.575Z","comments":true,"path":"followAttributesç®—æ³•è§£æ.html","link":"","permalink":"http://xiaoqinghua.site/followAttributesç®—æ³•è§£æ.html","excerpt":"","text":"ä½•æ—¶ç”¨ followAttributesåœ¨followç®—æ³•ä¸­ï¼Œopä¸¤ä¸¤è¿›è¡Œè¿ç®—ï¼ŒåŒ…å«15ç§æƒ…å†µï¼Œä½•æ—¶è¿›è¡Œå±æ€§çš„åˆå¹¶å³followAttributesï¼Œåœ¨ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä»…åœ¨op1ï¼Œop2çš„opcodeåŒæ—¶ä¸ºâ€˜=â€™æ—¶è¿›è¡Œ\bfollowAttributesã€‚ ä¸ºä½•ç”¨ followAttributes followAttributeså‡½æ•°æ³¨é‡Š\b 123456// The merge of two sets of attribute changes to the same text// takes the lexically-earlier value if there are two values// for the same key. Otherwise, all key/value changes from// both attribute sets are taken. This operation is the \"follow\",// so a set of changes is produced that can be applied to att1// to produce the merged set. 1234ä»¥ä¸Šæ³¨é‡Šå¤§æ¦‚æ„æ€ï¼šä¸¤ä¸ªå±æ€§æ”¹å˜é›†çš„åˆå¹¶ä½œç”¨äºåŒä¸€æ®µæ–‡ï¼Œå¦‚æœåŒä¸€ä¸ªkeyæœ‰ä¸¤ä¸ªä¸åŒçš„å€¼åˆ™é‡‡å–å­—å…¸æ’åºåœ¨å‰çš„å€¼ã€‚å¦åˆ™ï¼Œæ‰€æœ‰çš„é”®å€¼éƒ½å°†æ”¹å˜å› ä¸ºä¸¤ä¸ªå±æ€§é›†éƒ½è¢«é‡‡å–ã€‚æ­¤æ“ä½œä¸ºâ€˜followâ€™ï¼Œå› æ­¤äº§ç”Ÿäº†ä¸€ç»„å¯ä»¥åº”ç”¨äºâ€˜att1â€™å±æ€§çš„å˜æ›´ï¼Œå»ç”Ÿæˆåˆå¹¶é›†ã€‚ \bé€šè¿‡followç®—æ³•æˆ‘ä»¬äº†è§£åˆ°ï¼Œä»…åœ¨op1ï¼Œop2çš„opcodeåŒæ—¶ä¸ºâ€˜=â€™æ—¶ï¼Œ\bæ­¤æ—¶çš„op1ï¼Œop2ä¸¤ä¸¤è¿ç®—æ‰æ˜¯æ“ä½œçš„åŒä¸€æ®µæ–‡æœ¬å­—ç¬¦(\bå¦‚\bop1ä¸º+ï¼Œop2ä¸º-)æ“ä½œçš„ä¸æ˜¯åŒä¸€å¤„æ–‡æœ¬ã€‚ followAttributes è¿‡ç¨‹ å‡†å¤‡AttributePool 1234567var p = new AttributePool();p.putAttrib(['x', '']);p.putAttrib(['x', 'abc']);p.putAttrib(['x', 'def']);p.putAttrib(['y', '']);p.putAttrib(['y', 'abc']);p.putAttrib(['y', 'def']); æ„é€ è¿ç®— 12assertEqualStrings('*3', Changeset.followAttributes('*0*4', '*2*3', p));assertEqualStrings('*0', Changeset.followAttributes('*2*3', '*0*4', p)); AttributePoolä¸­\bä¾æ¬¡å­˜å…¥äº†6ä¸ªå±æ€§: 1234567891011121314151617181920212223242526&#123; \"0\": [ \"x\", \"\" ], \"1\": [ \"x\", \"abc\" ], \"2\": [ \"x\", \"def\" ], \"3\": [ \"y\", \"\" ], \"4\": [ \"y\", \"abc\" ], \"5\": [ \"y\", \"def\" ]&#125; op1ä½¿ç”¨çš„å±æ€§ä¸º\b&quot;0&quot;: [&quot;x&quot;,&quot;&quot;]ã€&quot;4&quot;: [&quot;y&quot;,&quot;abc&quot;]ï¼Œop2ä½¿ç”¨çš„å±æ€§ä¸º\b&quot;2&quot;: [&quot;x&quot;,&quot;def&quot;]ã€&quot;3&quot;: [&quot;y&quot;,&quot;&quot;] ä»£ç è¯¦è§£ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768public static String followAttributes(String att1, String att2, AttributePool pool) &#123; // åœ¨ä¸Šè¿°çš„ç¤ºä¾‹ä¸­ att1ï¼Œatt2 å‡ä¸ä¸ºç©ºï¼Œæ•…å¯å¿½ç•¥ä¸‹é¢ä¸¤è¡Œä»£ç  // ä½†æ˜¯åœ¨ att2 ä¸ºç©ºï¼Œpool ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼ŒfollowAttributes è¿”å›ç©ºï¼Œä¸ºä½•ï¼Ÿ // å› ä¸ºåœ¨ä¸Šå±‚å‡½æ•° follow ä¸­å³ follow(op1,op2)ï¼Œop1 æ˜¯å·²ç»åº”ç”¨çš„æ“ä½œï¼Œ\bå½“ op2 ä½¿ç”¨çš„å±æ€§ä¸ºç©ºæ—¶ï¼Œ // æˆ‘ä»¬æœ€ç»ˆæ‰€éœ€è¦çš„æ“ä½œ opOut ç›¸å½“äºä¿æŒ op1 çš„æ“ä½œ /* å¯¹åº”ä¸Šå±‚å‡½æ•°followä¸­è¿™æ®µä»£ç ï¼ŒåŒæ ·çš„ attribs è¿”å›ç©ºå­—ç¬¦ä¸² if (whichToDo == 1) &#123; opOut.opcode = Op.OPCODE_KEEP; opOut.lines = op1.lines; opOut.chars = op1.chars; opOut.attribs = EMPTY_STRING; &#125; */ if (isEmpty(att2) || pool == null) &#123; return EMPTY_STRING; &#125; // åŒç†å¯è¯ /* å¯¹åº”å±‚å‡½æ•°followä¸­è¿™æ®µä»£ç ï¼ŒåŒæ ·çš„ attribs ä½¿ç”¨çš„æ˜¯ op2 çš„ 'attribs' &#125; else if (!op1.hasOpcode()) &#123; Op.copyOp(op2, opOut); op2.clearOpcode(); &#125; */ if (isEmpty(att1)) &#123; return att2; &#125; // æ–°å»ºä¸€ä¸ªç©ºçš„é›†åˆå³æˆ‘ä»¬æƒ³è¦çš„æœ€åç»“æœå±æ€§é›† // ä¸‹é¢åšçš„æ“ä½œå°±æ˜¯æŠŠ att2 çš„å±æ€§åŠ åˆ° atts ä¸­ï¼Œå…¶å® atts å°±æ˜¯ att2 List&lt;Attribute&gt; atts = Lists.newArrayList(); // åœ¨ä¸Šè¿°å®ä¾‹ä¸­ï¼Œç»è¿‡ä¸æ–­çš„æ­£åˆ™åŒ¹é…è¿­ä»£ï¼Œatts=[ [\"x\",\"def\"],[\"y\",\"\"] ] Matcher matcher = PATTERN_ATTRIBUTE.matcher(att2); while (matcher.find()) &#123; atts.add(pool.getAttrib(parseNum(matcher.group(1)))); &#125; // è¿™é‡Œä½¿ç”¨åµŒå¥—å¾ªç¯ï¼Œç›¸å½“äºä¸¤ä¸¤å¯¹æ¯” att1 å’Œ att2 ç›¸åŒ key å¯¹åº”çš„å±æ€§å€¼çš„å­—å…¸æ’åº\bå€¼çš„å¤§å° // åªæ˜¯æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„éƒ½æ˜¯att2çš„å€¼ï¼Œåœ¨ä¸€æ¬¡æ¬¡æ¯”è¾ƒä¸­åˆ é™¤æˆ–ä¸åˆ é™¤ att2 ä¸­çš„å€¼ matcher = PATTERN_ATTRIBUTE.matcher(att1); while (matcher.find()) &#123; Attribute pair1 = pool.getAttrib(parseNum(matcher.group(1))); for (int i = 0; i &lt; atts.size(); i++) &#123; Attribute pair2 = atts.get(i); if (pair1.getKey().equals(pair2.getKey())) &#123; // winner of merge is pair1, delete this attribute // ç¬¬ä¸€æ¬¡æ¯”è¾ƒ '' &lt; 'def',åˆ™åˆ é™¤ atts ä¸­çš„ '[\"x\",\"def\"]' ,atts=[ [\"y\",\"\"] ] // ç¬¬äºŒæ¬¡æ¯”è¾ƒ 'abc' &gt; '',æ²¡æœ‰æ“ä½œ ,æœ€ç»ˆ atts=[ [\"y\",\"\"] ] // TODO æ­¤å¤„ä¸ºä½•æ ¹æ®å€¼çš„å­—å…¸æ’åºæ¯”è¾ƒï¼Ÿ if (pair1.getValue().compareTo(pair2.getValue()) &lt;= 0) &#123; // ç§»é™¤ atts.remove(i); &#125; &#125; &#125; &#125; // we've only removed attributes, so they're already sorted StringAssembler buf = new StringAssembler(); for (int i = 0; i &lt; atts.size(); i++) &#123; buf.append(\"*\"); // atts=[ [\"y\",\"\"] ] ä¸­ [\"y\",\"\"]åœ¨ pool ä¸­ index=3 buf.append(numToString(pool.putAttrib(atts.get(i)))); &#125; return buf.toString();&#125;; ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/followAttributesç®—æ³•è§£æ.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"OT","slug":"Code/OT","permalink":"http://xiaoqinghua.site/categories/Code/OT/"}],"tags":[{"name":"OT","slug":"OT","permalink":"http://xiaoqinghua.site/tags/OT/"}]},{"title":"etherpad æŠ€æœ¯åˆ†æ","slug":"etherpadæŠ€æœ¯åˆ†æ","date":"2018-06-19T07:07:54.000Z","updated":"2018-08-25T06:47:49.706Z","comments":true,"path":"etherpadæŠ€æœ¯åˆ†æ.html","link":"","permalink":"http://xiaoqinghua.site/etherpadæŠ€æœ¯åˆ†æ.html","excerpt":"","text":"Etherpad \bæŠ€æœ¯åˆ†æé¢†åŸŸæ¨¡å‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849class Pad &#123; head atext apool&#125;class PadRevision &#123; author revision changeset timestamp&#125;class Changeset &#123; oldLength newLength ops charBank&#125;class Op &#123; opcode lines chars attribs&#125;class AText &#123; text attribs&#125;class AttributePool &#123; nextNum numToAttrib attribToNum&#125;class Attribute &#123; key value&#125;Pad o---&gt; PadRevisionPad o---&gt; ATextPad o---&gt; AttributePoolPadRevision o--&gt; ChangesetChangeset o--&gt; OpAttributePool o..&gt; Attribute Padpad åœ¨ etherpad ä¸­å¯¹åº”ä¸€ç¯‡æ–‡æ¡£ï¼Œæ˜¯å¤šäººåä½œçš„åŸºæœ¬å•ä½ã€‚ å¯¹ pad çš„æ¯ä¸€æ¬¡ç¼–è¾‘æ“ä½œï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ª revision, ç±»ä¼¼äºç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ(å°¤å…¶ç±»ä¼¼äº svn)ä¸­çš„ä¸€æ¬¡æäº¤ï¼Œrevision ä»é›¶å¼€å§‹å¾€ä¸Šé€’å¢ï¼Œhead æŒ‡å‘å½“å‰æœ€æ–°çš„ revisionã€‚å¯¹æ‰€æœ‰çš„ revision ä¾æ¬¡è®¡ç®—ï¼Œå¯ä»¥å¾—å‡º pad çš„æ­£æ–‡ï¼Œä½†æ˜¯å¯¹äºæœ‰å¤§é‡ç¼–è¾‘æ“ä½œçš„ pad, æ‰“å¼€ pad æ—¶å¤§é‡çš„è®¡ç®—åŠ¿å¿…å½±å“åŠ è½½é€Ÿåº¦ï¼Œæ‰€ä»¥ pad ä¸­åŒ…å« atext å­—æ®µè¡¨ç¤ºå½“å‰\bçš„å†…å®¹ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´ã€‚atext åŒ…å«ä¸¤éƒ¨åˆ†ï¼š text å’Œ attribs, text å°±æ˜¯è¯¥æ–‡æ¡£çš„æ­£æ–‡ï¼Œattribs æ˜¯æè¿°æ­£æ–‡çš„å†…å®¹éƒ½æœ‰å“ªäº›å±æ€§ã€‚ \bapool æ˜¯å±æ€§ â€œæ± â€ï¼Œ\bè®°å½•äº†å±æ€§ç¼–å·å¯¹åº”çš„å±æ€§ã€‚ ATextAtext ç¤ºä¾‹æ•°æ®ï¼š 1234&#123; \"text\": \"Welcome to Etherpad!\\n\\nThis pad text is synchronized as you type, so that everyone viewing this page sees the same text. This allows you to collaborate seamlessly on documents!\\n\\nGet involved with Etherpad at http://etherpad.org\\n\\nsdf\\n\\ns\\nsdf\\nsefssss\\n\\nsss\\nsdf\\nsss\\n\\nsefffsdfsssef\\nesssdfsd\\ns\\nsdfsdfsd\\n\\ncvb\\nsdfsdf\\n\\naaaaaaaaaaaaaaaaaç¬¬ä¸‰æ–¹æ–¯è’‚èŠ¬\\n\\nsdf\\n\\nsdsssdf\\n\\nabc\\n\\nabccccfbcfcvbcfgrddfgddddd\\n\\nsdfesfsges\\n\\nsdfdsses\\n\\nsseg\\n\\n\\nsdfesgessdf\\n\\n\\n\\nsdfessefgdfg\\n\", \"attribs\": \"|2+m+1o*4+7|2+2g*3+1d*0|5+9*1+3*0|1+1*0+7|1+1*1|1+1*0+3*1|2+5*0+3*1|2+2*0+5*2+8*1|2+a*2+1*1|3+b*2+3*1|3+9*1+n*2|3+6*0|5+f*0+3*2+b*0|1+d*2|1+1*0+a*2|2+2*2+5*0+3*2|2+2*0+4*2|1+1*0|2+2*0+7*2|4+8*2+7*0+5|1+1\"&#125; AttributePoolAttributePoolJson æ˜¯ AttributePool ä¿å­˜åˆ°æ•°æ®åº“ä¸­çš„å½¢å¼ï¼ŒåŠ è½½åˆ°å†…å­˜æ—¶ä¼šåšä¸€æ¬¡è½¬æ¢ã€‚ AttributePool å¤šäº†ä¸€ä¸ª Attribute -&gt; num çš„åå‘ç´¢å¼•ï¼Œç”¨äºå¿«é€Ÿçš„é€šè¿‡ Attribute æ‰¾åˆ°å¯¹åº”çš„ç¼–å·ã€‚ etherpad çš„è®¾è®¡ä¸­ï¼Œ AttributePool çš„å±äºæŸä¸ª pad çš„ â€œå‘½åç©ºé—´â€ çš„ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ª pad éƒ½ä¼šæœ‰è‡ªå·±çš„ AttributePoolã€‚ AttributePoolJson ç¤ºä¾‹æ•°æ®ï¼š 12345678910111213141516171819202122232425&#123; \"numToAttrib\": &#123; \"0\": [ \"author\", \"a.lbCJXik3gn5kFmZn\" ], \"1\": [ \"author\", \"a.QOApinD3T5GQ57t6\" ], \"2\": [ \"author\", \"a.EAPXEvFdNybN83aD\" ], \"3\": [ \"strikethrough\", \"true\" ], \"4\": [ \"bold\", \"true\" ] &#125;, \"nextNum\": 5&#125; PadRevisionæ¯ä¸ª revision éƒ½è®°å½•äº† author å’Œ timestamp, å› æ­¤å¯ä»¥å›åˆ°ä»»æ„çš„å†å²ç¼–è¾‘çŠ¶æ€ã€‚ revision çš„ä¸»è¦å†…å®¹æ˜¯ changeset. Changesetä¸€ä¸ª changeset ä»£è¡¨å¯¹æ–‡æ¡£çš„å˜æ›´ã€‚ changeset çš„ç»“æ„: å›¾ç‰‡æ¥æº: http://slix.rocks/%E5%9C%A8%E7%BA%BF%E6%96%87%E6%A1%A3%E4%B8%AD-easysync2-%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D/ Opetherpad å…±æœ‰å››ç§æ“ä½œï¼š 1234*N: åº”ç”¨æŸä¸ªå±æ€§=N: ä¿ç•™ N ä¸ªå­—ç¬¦+N: å¢åŠ  N ä¸ªå­—ç¬¦-N: åˆ é™¤ N ä¸ªå­—ç¬¦ åœ¨çº¿ demoã€‚ etherpad çš„ OT å®ç°å®æ—¶ååŒç¼–è¾‘çš„æ ¸å¿ƒç®—æ³•æ˜¯ OTï¼Œè€Œ Etherpad ä¸­ OT çš„å®ç°æ˜¯ä¸€ä¸ªåä¸º follow çš„å‡½æ•°ã€‚ è¯¦è§ follow ç®—æ³•ã€‚ client server åè®®é•¿è¿æ¥etherpad ä½¿ç”¨å¼€æº SocketIO åº“ï¼Œè¿™ä¸ªåº“åœ¨\bæµè§ˆå™¨æ”¯æŒ websocket æ—¶ï¼Œ\bä¼šä½¿ç”¨ websocket, åœ¨è€æ—§çš„æµè§ˆå™¨ä¸­ä¼š fallback åˆ° long polling ä¸Šã€‚ SocketIO ä¹Ÿæœ‰ä¸å°‘æ‰¹è¯„çš„å£°éŸ³ï¼Œä¾‹å¦‚: https://github.com/rethinkdb/horizon/issues/413 ã€‚ è€ƒè™‘åˆ°ç›®å‰ä¸»æµçš„æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒ websocket äº†ï¼Œå¯ä»¥è€ƒè™‘\bç”¨åŸç”Ÿ websocket, å¦‚æœå¿…é¡»æ”¯æŒè€æ—§æµè§ˆå™¨ï¼Œåˆ™å¯ä»¥è€ƒè™‘ sockjs(onlyoffice å¥½åƒç”¨çš„è¿™ä¸ª)ã€‚ æœåŠ¡ç«¯é€»è¾‘å¤šäººç¼–è¾‘æ˜¯ä¸€å®šä¼šå‡ºç°å†²çªçš„ï¼Œé€šè¿‡ä¸¤ä¸ªåŠæ³•è§£å†³å†²çª: \bæœåŠ¡ç«¯é€šè¿‡\bæ’é˜Ÿçš„æ–¹å¼ï¼ŒæŠŠ\bå¹¶å‘ä¿®æ”¹çš„çš„æ“ä½œ\bä¸²è¡ŒåŒ–ï¼› å¦‚æœæŸæ¬¡ä¿®æ”¹çš„ baseRev ä¸æ˜¯å½“å‰ pad çš„ head, åˆ™é€šè¿‡ OT ç®—æ³•\b\bå¯¹äºå·²ç» commit çš„ä¿®æ”¹ä¾æ¬¡è®¡ç®—ï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹ç±»ä¼¼äº git çš„ rebaseã€‚ 1234567891011121314151617181920212223242526272829autonumberskinparam ParticipantPadding 90title æœåŠ¡ç«¯å¤„ç†æµç¨‹\\n\\nClient -&gt; Server: baseRev + CSServer -&gt; Server: enqueue baseRev + CS|||loopServer -&gt; Server: follownote leftwhile (baseRev &lt; head) &#123; CS = follow(R(baseRev), CS); baseRev++;&#125;end noteend|||Server -&gt; Server: save revisionServer -&gt; Client: accept commit|||Server -&gt; &quot;Other clients&quot;: CS(head + 1) å®¢æˆ·ç«¯é€»è¾‘ å°†æ–°çš„è¾“å…¥åˆå¹¶åˆ°æœ¬åœ°å˜æ›´ ace2_inner.js 12var editor = new Ace2Inner()editor.init(); ace.js 1234567891011121314151617181ã€editor.init = function(containerId, initialCode, doneFunc)&#123;&#125;2ã€doActionsPendingInit()3ã€aceFunctionsPendingInit.getFormattedCode4ã€ace2_inner.jsfunction getFormattedCode()&#123; inCallStackIfNecessary(\"getFormattedCode\", incorporateUserChanges);&#125;5ã€function observeSuspiciousNodes()6ã€function incorporateUserChanges(isTimeUp)fastIncorp()inCallStackIfNecessary(\"handleKeyEvent\", function()&#123;&#125; å‘æœåŠ¡å™¨æäº¤å˜æ›´é›† 12345671ã€collab_client.js2ã€function getCollabClient(ace2editor, serverVars, initialUserInfo, options, _pad)&#123;&#125;3ã€editor.setUserChangeNotificationCallback(wrapRecordingErrors(\"handleUserChanges\", handleUserChanges));4ã€handleUserChanges() å›å¤ç¡®è®¤å·²æäº¤çš„å˜æ›´é›†(ack) ç›‘å¬å…¶ä»–å®¢æˆ·çš„å˜æ›´é›† è¿æ¥åˆ°æœåŠ¡å™¨å¹¶è¯·æ±‚åˆå§‹æ–‡æ¡£ pad.html 1&lt;script type=\"text/javascript\"&gt; pad.init(); &lt;/script&gt; pad.js 123456781ã€init: function()2ã€function handshake()3ã€socket.once('connect', function () &#123; sendClientReady(false); &#125;); 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475skinparam ParticipantPadding 90title å®¢æˆ·ç«¯å¤„ç†æµç¨‹\\n\\n||||||Server &lt;- Client: first connect &lt;&lt; unique ID &gt;&gt;note rightasync.waterfall()end notenote right of A #aquaæ”¶åˆ°æœåŠ¡å™¨ç¡®è®¤çš„å˜æ›´çŠ¶æ€end notenote right of X #aquaæŠŠå˜æ›´å‘åˆ°æœåŠ¡å™¨æ—¶çš„çŠ¶æ€end notenote right of Y #aquaç”¨æˆ·å·²è¾“å…¥çš„çŠ¶æ€end notenote right of E #aquaç”¨æˆ·æ­£åœ¨è¾“å…¥end note|||Client &lt;- Server: HEADTEXT|||note over Client , Aidentity mappingend note|||A &lt;-[#0000FF]- X: A=X*A|||X &lt;-[#0000FF]- Y:note rightY=Y*Eend note|||Y &lt;-[#ED3EEE] E: types|||Y -[#0000FF]-&gt; Server: submit &lt;&lt; cs+uid &gt;&gt;|||note over A , Yevery 500msend note|||A &lt;-- Server: acknowledgement |||&quot;Other clients&quot; &lt;-- Client : monitor other client|||&quot;Other clients&quot; --&gt; Server: other cs|||Client -&gt; Client: composenote leftmakeChangesetTracker()end note|||Server -&gt; Server: server logic||| åç»­äº§å“åŒ–å·¥ä½œ\b é•¿è¿æ¥å¤šæœºåˆ†å¸ƒ æ•°æ®åº“æ‰©å±• è´¦æˆ·ç³»ç»Ÿ è¿ç»´è‡ªåŠ¨åŒ–ç³»ç»Ÿ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/etherpadæŠ€æœ¯åˆ†æ.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"EtherPad","slug":"Code/EtherPad","permalink":"http://xiaoqinghua.site/categories/Code/EtherPad/"}],"tags":[{"name":"EtherPad","slug":"EtherPad","permalink":"http://xiaoqinghua.site/tags/EtherPad/"}]},{"title":"ComposeAttributes ç®—æ³•è§£æ","slug":"composeAttributesç®—æ³•è§£æ","date":"2018-06-18T07:10:02.000Z","updated":"2018-08-25T06:46:49.131Z","comments":true,"path":"composeAttributesç®—æ³•è§£æ.html","link":"","permalink":"http://xiaoqinghua.site/composeAttributesç®—æ³•è§£æ.html","excerpt":"","text":"ä½•æ—¶ç”¨ composeAttributesåœ¨composeç®—æ³•ä¸­ï¼Œopä¸¤ä¸¤è¿›è¡Œè¿ç®—ï¼Œä½•æ—¶è¿›è¡Œå±æ€§çš„åˆå¹¶å³composeAttributesï¼Œåœ¨ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä»…åœ¨op1ï¼Œop2çš„opcodeåŒæ—¶ä¸ºâ€˜=â€™æ—¶ï¼Œæˆ–è€…op2çš„opcodeä¸ºâ€˜=â€™ï¼Œop1çš„opcodeä¸ºâ€˜+â€™æ—¶è¿›è¡Œ\bcomposeAttributesã€‚ ä¸ºä½•ç”¨ composeAttributes composeAttributeså‡½æ•°æ³¨é‡Š\b 12345678910111213// att1 and att2 are strings like \"*3*f*1c\", asMutation is a boolean.// Sometimes attribute (key,value) pairs are treated as attribute presence// information, while other times they are treated as operations that// mutate a set of attributes, and this affects whether an empty value// is a deletion or a change.// Examples, of the form (att1Items, att2Items, resultIsMutation) -&gt; result// ([], [(bold, )], true) -&gt; [(bold, )]// ([], [(bold, )], false) -&gt; []// ([], [(bold, true)], true) -&gt; [(bold, true)]// ([], [(bold, true)], false) -&gt; [(bold, true)]// ([(bold, true)], [(bold, )], true) -&gt; [(bold, )]// ([(bold, true)], [(bold, )], false) -&gt; []// pool can be null if att2 has no attributes. 123ä»¥ä¸Šæ³¨é‡Šå¤§æ¦‚æ„æ€ï¼šatt1å’Œatt2æ˜¯ç±»ä¼¼äºâ€œ*3*f*1câ€çš„å­—ç¬¦ä¸²ï¼ŒresultIsMutationæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ã€‚æœ‰æ—¶å±æ€§(é”®ã€å€¼)å¯¹è¢«è§†ä¸ºå±æ€§å­˜åœ¨ä¿¡æ¯ï¼Œè€Œæœ‰æ—¶å®ƒä»¬è¢«è§†ä¸ºæ”¹å˜ä¸€ç»„å±æ€§çš„æ“ä½œï¼Œè¿™å°†å½±å“ç©ºå€¼æ˜¯åˆ é™¤è¿˜æ˜¯æ›´æ”¹ã€‚ \bé€šè¿‡composeç®—æ³•æˆ‘ä»¬äº†è§£åˆ°ï¼Œä»…åœ¨op1ï¼Œop2çš„opcodeåŒæ—¶ä¸ºâ€˜=â€™æ—¶ï¼Œ\bæ­¤æ—¶çš„op1ï¼Œop2ä¸¤ä¸¤è¿ç®—æ‰æ˜¯æ“ä½œçš„åŒä¸€æ®µæ–‡æœ¬å­—ç¬¦(\bå¦‚\bop1ä¸º+ï¼Œop2ä¸º-)æ“ä½œçš„ä¸æ˜¯åŒä¸€å¤„æ–‡æœ¬ã€‚ composeAttributes è¿‡ç¨‹ å‡†å¤‡AttributePool 1234567var p = new AttributePool();p.putAttrib(['x', '']);p.putAttrib(['x', 'abc']);p.putAttrib(['x', 'def']);p.putAttrib(['y', '']);p.putAttrib(['y', 'abc']);p.putAttrib(['y', 'def']); æ„é€ è¿ç®— 12assertEqualStrings('*0*3', Changeset.composeAttributes('*0*4', '*2*3', true, p));assertEqualStrings('*0*4', Changeset.composeAttributes('*2*3', '*0*4', true, p)); AttributePoolä¸­\bä¾æ¬¡å­˜å…¥äº†6ä¸ªå±æ€§: 1234567891011121314151617181920212223242526&#123; \"0\": [ \"x\", \"\" ], \"1\": [ \"x\", \"abc\" ], \"2\": [ \"x\", \"def\" ], \"3\": [ \"y\", \"\" ], \"4\": [ \"y\", \"abc\" ], \"5\": [ \"y\", \"def\" ]&#125; op1ä½¿ç”¨çš„å±æ€§ä¸º\b&quot;0&quot;: [&quot;x&quot;,&quot;&quot;]ã€&quot;4&quot;: [&quot;y&quot;,&quot;abc&quot;]ï¼Œop2ä½¿ç”¨çš„å±æ€§ä¸º\b&quot;2&quot;: [&quot;x&quot;,&quot;def&quot;]ã€&quot;3&quot;: [&quot;y&quot;,&quot;&quot;] ä»£ç è¯¦è§£ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667public static String composeAttributes(String att1, String att2, boolean resultIsMutation, AttributePool pool) &#123; // è¿™ä¸¤æ­¥å…¶å®å’Œ followAttributes ç›¸ä¼¼ï¼Œåœ¨å¤–å±‚å‡½æ•°ï¼Œéƒ½æœ‰å¯¹åº”æƒ…å†µçš„ä»£ç  if (isEmpty(att1) &amp;&amp; resultIsMutation) &#123; // In the case of a mutation (i.e. composing two exportss), // an att2 composed with an empy att1 is just att2. If att1 // is part of an attribution string, then att2 may remove // attributes that are already gone, so don't do this optimization. return att2; &#125; if (isEmpty(att2)) &#123; return att1; &#125; // æ–°å»ºä¸€ä¸ªç©ºçš„é›†åˆå³æˆ‘ä»¬æƒ³è¦çš„æœ€åç»“æœå±æ€§é›† // ä¸‹é¢åšçš„æ“ä½œå°±æ˜¯æŠŠ att1 çš„å±æ€§åŠ åˆ° atts ä¸­ï¼Œå…¶å® atts å°±æ˜¯ att1 List&lt;Attribute&gt; atts = new LinkedList&lt;&gt;(); // ç»è¿‡ä¸æ–­çš„æ­£åˆ™åŒ¹é…è¿­ä»£ atts==att1 Matcher matcher = PATTERN_ATTRIBUTE.matcher(att1); while (matcher.find()) &#123; String attId = matcher.group(1); atts.add(pool.getAttrib(parseNum(attId))); &#125; // è¿™é‡Œä½¿ç”¨åµŒå¥—å¾ªç¯ï¼Œç›¸å½“äºä¸¤ä¸¤å¯¹æ¯” att1 å’Œ att2 ç›¸åŒ key å¯¹åº”æ˜¯å¦æœ‰å€¼æˆ–è€…æ˜¯å¦çªå˜ // åªæ˜¯æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„éƒ½æ˜¯att2çš„å€¼ï¼Œåœ¨ä¸€æ¬¡æ¬¡æ¯”è¾ƒä¸­åˆ é™¤ att2 ä¸­çš„å€¼ï¼Œæˆ–è€… è®¾ç½®æˆä»¥å‰ att1 çš„å€¼ matcher = PATTERN_ATTRIBUTE.matcher(att2); while (matcher.find()) &#123; String attId = matcher.group(1); Attribute pair = pool.getAttrib(parseNum(attId)); boolean found = false; for (int i = 0; i &lt; atts.size(); i++) &#123; Attribute oldPair = atts.get(i); if (oldPair.getKey().equals(pair.getKey())) &#123; if (pair.hasValue() || resultIsMutation) &#123; // æ³¨æ„è¿™é‡Œæ˜¯ set, å³æ›¿æ¢æˆ att2 çš„å€¼ // é‡åˆ°ç›¸åŒçš„ key, å¦‚æœ att2 æœ‰å€¼æˆ–è€…æ˜¯çªå˜ï¼Œå°±æŠŠ att1 ä¸­çš„å€¼æ›¿æ¢æˆ att2 çš„å€¼ atts.set(i, oldPair.withValue(pair.getValue())); &#125; else &#123; // é‡åˆ°ç›¸åŒçš„ key, å¦‚æœ att2 æ²¡æœ‰å€¼ï¼Œåˆ™åˆ é™¤ att1 ä¸­çš„å€¼(å³ atts çš„å€¼) atts.remove(i); &#125; found = true; break; &#125; &#125; // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸åŒçš„ key åˆ™ç›´æ¥ç”¨ att2 if ((!found) &amp;&amp; (pair.hasValue() || resultIsMutation)) &#123; atts.add(pair); &#125; &#125; // atts è¿™é‡Œè¿›è¡Œäº†è‡ªç„¶æ’åºï¼Œæ‰€ä»¥åœ¨ followAttributes çš„æ—¶å€™æŒ‰ç…§è‡ªç„¶æ’åºå–å€¼ // åœ¨ js æºç ä¸­ï¼Œatts.sort(); // atts.sort();æ²¡æœ‰ compareFunction å‚æ•°ï¼Œæ‰€ä»¥æ’åºæ—¶ç›´æ¥å°†æ•°ç»„çš„å…ƒç´ è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ŒæŒ‰ç…§å­—ç¬¦ä¸²çš„ Unicode æ’åº atts.sort(Comparator.comparing(Attribute::toString)); StringAssembler buf = new StringAssembler(); for (int i = 0; i &lt; atts.size(); i++) &#123; buf.append(\"*\"); buf.append(numToString(pool.putAttrib(atts.get(i)))); &#125; //print(att1+\" / \"+att2+\" / \"+buf.toString()); return buf.toString();&#125; ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/composeAttributesç®—æ³•è§£æ.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"OT","slug":"Code/OT","permalink":"http://xiaoqinghua.site/categories/Code/OT/"}],"tags":[{"name":"OT","slug":"OT","permalink":"http://xiaoqinghua.site/tags/OT/"}]},{"title":"Compose ç®—æ³•è¿‡ç¨‹éªŒç®—","slug":"composeç®—æ³•è¿‡ç¨‹éªŒç®—","date":"2018-06-18T07:09:51.000Z","updated":"2018-08-25T06:47:07.463Z","comments":true,"path":"composeç®—æ³•è¿‡ç¨‹éªŒç®—.html","link":"","permalink":"http://xiaoqinghua.site/composeç®—æ³•è¿‡ç¨‹éªŒç®—.html","excerpt":"","text":"ä¸¾ä¸ªæ —å­ğŸŒ° 1compose(cs1,cs2) --&gt; compose(\"Z:z&gt;4|2=m=b-1+2+3$abcde\", \"Z:13&gt;1|2=m=g-1+2$fg\") 123456789101112131415æŠŠcs1,cs2å±•å¼€cs1:op1.1:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;op1.2:&#123; opcode: &apos;=&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;op1.3:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;op1.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;op1.5:&#123; opcode: &apos;+&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;charBank=&apos;abcde&apos;cs2:op2.1:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;op2.2:&#123; opcode: &apos;=&apos;, chars: 16, lines: 0, attribs: &apos;&apos; &#125;op2.3:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;op2.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;charBank=&apos;fg&apos; åŒfollowå‡½æ•°ä¸€æ ·ï¼Œåœ¨composeå‡½æ•°ä¸­ä¹Ÿæœ‰ä¸€ä¸ªapplyZipçš„å‡½æ•°,å…¶å®è¿™æ˜¯ä¸€ä¸ªè¿­ä»£å™¨,åŒæ—¶è¿˜æœ‰ä¸€ä¸ª_slicerZipperFuncçš„åˆ†ç‰‡è¿­ä»£å™¨ï¼Œæ˜¯ä¸“é—¨ä¸ºcomposeå‡†å¤‡çš„å‡½æ•°ã€‚zipæœ‰æ‹‰é“¾çš„æ„æ€,åœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­ä¸æ–­çš„ä¸¤ä¸¤è¿ç®—,å°±åƒæ‹‰é“¾ä¸€æ ·ä¸€é¢—é¢—ç¼åˆèµ·æ¥: applyZipå‡½æ•° 1234567891011121314151617181920exports.applyZip = function (in1, idx1, in2, idx2, func) &#123; var iter1 = exports.opIterator(in1, idx1); var iter2 = exports.opIterator(in2, idx2); var assem = exports.smartOpAssembler(); var op1 = exports.newOp(); var op2 = exports.newOp(); var opOut = exports.newOp(); while (op1.opcode || iter1.hasNext() || op2.opcode || iter2.hasNext()) &#123; if ((!op1.opcode) &amp;&amp; iter1.hasNext()) iter1.next(op1); if ((!op2.opcode) &amp;&amp; iter2.hasNext()) iter2.next(op2); func(op1, op2, opOut); if (opOut.opcode) &#123; //print(opOut.toSource()); assem.append(opOut); opOut.opcode = ''; &#125; &#125; assem.endDocument(); return assem.toString();&#125;; _slicerZipperFuncå‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119/** * Function used as parameter for applyZip to apply a Changeset to an attribute */ private static Op _slicerZipperFunc(Op attOp, Op csOp, AttributePool pool) &#123; // attOp is the op from the sequence that is being operated on, either an // attribution string or the earlier of two exportss being composed. // pool can be null if definitely not needed. //print(csOp.toSource()+\" \"+attOp.toSource()+\" \"+opOut.toSource()); // åœ¨ compose ä¸­ ï¼ŒattOp æ˜¯æ­£åœ¨è¢«æ“ä½œçš„å³ op1 Op opOut = new Op(); if (attOp.isMinus()) &#123; // å¦‚æœ op1 æ˜¯ - ï¼Œåˆ™æˆ‘ä»¬éœ€è¦çš„ opOut ä½¿ç”¨ op1 Op.copyOp(attOp, opOut); // æ¸…ç©º op1 æ“ä½œ attOp.clearOpcode(); &#125; else if (!attOp.hasOpcode()) &#123; // å¦‚æœ op1 æ²¡æœ‰æ“ä½œï¼Œåˆ™ä½¿ç”¨ op2 Op.copyOp(csOp, opOut); // æ¸…ç©º op2 æ“ä½œ csOp.clearOpcode(); &#125; else &#123; switch (csOp.opcode) &#123; case Op.OPCODE_MINUS: &#123; // å¦‚æœ op2 æ“ä½œçš„å­—ç¬¦å°äºç­‰äº op1 æ“ä½œçš„å­—ç¬¦ if (csOp.chars &lt;= attOp.chars) &#123; // delete or delete part if (attOp.isKeep()) &#123; // å¦‚æœ op2 æ˜¯ -,op1 æ˜¯ = // åˆå¹¶åçš„æ˜¯-ï¼Œå¯ä»¥ç†è§£ä¸ºï¼Œå…ˆ=å- opOut.opcode = Op.OPCODE_MINUS; // å–å°çš„éƒ¨åˆ† opOut.chars = csOp.chars; opOut.lines = csOp.lines; opOut.attribs = EMPTY_STRING; &#125; // å¦‚æœ op2 æ˜¯ -,op1 æ˜¯ + // å¾—åˆ°æ˜¯ç©ºçš„ opOut ï¼Œç›¸å½“äºä¸åšä»»ä½•æ“ä½œï¼Œç›´è‡³æ²¡æœ‰ä¸‹ä¸€æ¬¡è¿ç®— attOp.chars -= csOp.chars; attOp.lines -= csOp.lines; csOp.clearOpcode(); if (attOp.chars == 0) &#123; attOp.clearOpcode(); &#125; &#125; else &#123; // å¦‚æœ op2 æ“ä½œçš„å­—ç¬¦å¤§äº op1 æ“ä½œçš„å­—ç¬¦ // delete and keep going if (attOp.isKeep()) &#123; // å¦‚æœ op2 æ˜¯ -,op1 æ˜¯ = // åˆå¹¶åçš„æ˜¯-ï¼Œå¯ä»¥ç†è§£ä¸ºï¼Œå…ˆ=å- opOut.opcode = Op.OPCODE_MINUS; // å–å°çš„éƒ¨åˆ† opOut.chars = attOp.chars; opOut.lines = attOp.lines; opOut.attribs = EMPTY_STRING; &#125; // å–ç›¸å‡çš„éƒ¨åˆ† csOp.chars -= attOp.chars; csOp.lines -= attOp.lines; attOp.clearOpcode(); &#125; break; &#125; case Op.OPCODE_PLUS: &#123; // insert // å¦‚æœ op2 æ˜¯ +ï¼Œåˆ™åˆå¹¶åè¿˜æ˜¯ + Op.copyOp(csOp, opOut); csOp.clearOpcode(); break; &#125; case Op.OPCODE_KEEP: &#123; // å¦‚æœ op2 æ˜¯ = // å¦‚æœ op2 æ“ä½œçš„å­—ç¬¦å°äºç­‰äº op1 æ“ä½œçš„å­—ç¬¦ if (csOp.chars &lt;= attOp.chars) &#123; // keep or keep part ä¿æŒæˆ–è€…ä¿æŒä¸€éƒ¨åˆ†(ä¿æŒ op1 çš„æ“ä½œå’Œå…¨éƒ¨çš„æ“ä½œå­—ç¬¦ä¸²å’Œæ¢è¡Œ æˆ–è€… ä¿æŒ op1 çš„æ“ä½œå’Œä¸€éƒ¨åˆ†çš„æ“ä½œå­—ç¬¦ä¸²å’Œæ¢è¡Œ) // å¯ä»¥ç†è§£ä¸ºï¼šop1å¢åŠ æˆ–è€…ä¿æŒäº†nä¸ªå­—ç¬¦ï¼Œop2ä¿æŒäº†mä¸ªå­—ç¬¦(m&lt;=n) opOut.opcode = attOp.opcode; opOut.chars = csOp.chars; opOut.lines = csOp.lines; // åˆå¹¶å±æ€§ opOut.attribs = composeAttributes(attOp.attribs, csOp.attribs, attOp.isKeep(), pool); csOp.clearOpcode(); // å‰©ä½™éƒ¨åˆ† attOp.chars -= csOp.chars; attOp.lines -= csOp.lines; if (attOp.chars == 0) &#123; attOp.clearOpcode(); &#125; &#125; else &#123; // å¦‚æœ op2 æ“ä½œçš„å­—ç¬¦å¤§äº op1 æ“ä½œçš„å­—ç¬¦ // keep and keep going ä¿æŒå¹¶ä¸”ç»§ç»­ opOut.opcode = attOp.opcode; opOut.chars = attOp.chars; opOut.lines = attOp.lines; // åˆå¹¶å±æ€§ opOut.attribs = composeAttributes(attOp.attribs, csOp.attribs, attOp.isKeep(), pool); attOp.clearOpcode(); // å‰©ä½™éƒ¨åˆ† csOp.chars -= attOp.chars; csOp.lines -= attOp.lines; &#125; break; &#125; case EMPTY_STRING: &#123; // å¦‚æœ op2 æ˜¯ ç©ºæ“ä½œï¼Œåˆ™åˆå¹¶åè¿˜æ˜¯ op1 çš„æ“ä½œ Op.copyOp(attOp, opOut); attOp.clearOpcode(); break; &#125; &#125; &#125; return opOut; &#125; 1234567891011å¼€å§‹è¿­ä»£(å¾ªç¯)å‰,éœ€è¦åšä¸€äº›å‡†å¤‡å·¥ä½œ:1ã€æ–°å»ºä¸¤ä¸ªç©ºçš„op1,op2å¯¹è±¡ï¼Œç”¨äºæ¥æ”¶å±•å¼€çš„cs1,cs2ä¸­æ‰€æœ‰çš„opå¯¹è±¡çš„å€¼Op op1 = new Op();op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;Op op2 = new Op();op2:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€æ–°å»ºä¸€ä¸ªopOutå¯¹è±¡,ç”¨äºæ¥æ”¶æ¯ä¸€æ¬¡è¿­ä»£å®Œåæˆ‘ä»¬å¾—åˆ°çš„è¿ç®—ç»“æœopOp opOut = new Op();opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125; 1234567891011121314ç¬¬1æ¬¡è¿­ä»£:1ã€åˆå§‹:æŒ‰ç…§é¡ºåºä¼šä½¿ç”¨cs1ä¸­çš„op1.1å’Œcs2ä¸­çš„op2.1å’Œä¸€ä¸ªåˆšåˆšnewå‡ºæ¥çš„æ–°çš„opå¯¹è±¡op1.1:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;op2.1:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€composeç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;=&apos;, chars: 22, lines: 2, attribs: &apos;&apos; &#125;assem : &quot;|2=m&quot;è¯´æ˜:both keep,composeä¹‹åop1,op2éƒ½æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬1æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :1234567891011121314151617181920case Op.OPCODE_KEEP: &#123; // å¦‚æœ op2 æ˜¯ = // å¦‚æœ op2 æ“ä½œçš„å­—ç¬¦å°äºç­‰äº op1 æ“ä½œçš„å­—ç¬¦ if (csOp.chars &lt;= attOp.chars) &#123; // keep or keep part ä¿æŒæˆ–è€…ä¿æŒä¸€éƒ¨åˆ†(ä¿æŒ op1 çš„æ“ä½œå’Œå…¨éƒ¨çš„æ“ä½œå­—ç¬¦ä¸²å’Œæ¢è¡Œ æˆ–è€… ä¿æŒ op1 çš„æ“ä½œå’Œä¸€éƒ¨åˆ†çš„æ“ä½œå­—ç¬¦ä¸²å’Œæ¢è¡Œ) // å¯ä»¥ç†è§£ä¸ºï¼šop1å¢åŠ æˆ–è€…ä¿æŒäº†nä¸ªå­—ç¬¦ï¼Œop2ä¿æŒäº†mä¸ªå­—ç¬¦(m&lt;=n) opOut.opcode = attOp.opcode; opOut.chars = csOp.chars; opOut.lines = csOp.lines; // åˆå¹¶å±æ€§ opOut.attribs = composeAttributes(attOp.attribs, csOp.attribs, attOp.isKeep(), pool); csOp.clearOpcode(); // å‰©ä½™éƒ¨åˆ† attOp.chars -= csOp.chars; attOp.lines -= csOp.lines; if (attOp.chars == 0) &#123; attOp.clearOpcode(); &#125; &#125; 123456789101112ç¬¬2æ¬¡è¿­ä»£:1ã€åˆå§‹:op1.2:&#123; opcode: &apos;=&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;op2.2:&#123; opcode: &apos;=&apos;, chars: 16, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€composeç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;=&apos;, chars: 5, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;=&apos;, chars: 11, lines: 0, attribs: &apos;&apos; &#125;assem : &quot;|2=m=b&quot;è¯´æ˜:both keep,composeä¹‹åop2è¿˜æœ‰opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬2æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :12345678910111213else &#123; // å¦‚æœ op2 æ“ä½œçš„å­—ç¬¦å¤§äº op1 æ“ä½œçš„å­—ç¬¦ // keep and keep going ä¿æŒå¹¶ä¸”ç»§ç»­ opOut.opcode = attOp.opcode; opOut.chars = attOp.chars; opOut.lines = attOp.lines; // åˆå¹¶å±æ€§ opOut.attribs = composeAttributes(attOp.attribs, csOp.attribs, attOp.isKeep(), pool); attOp.clearOpcode(); // å‰©ä½™éƒ¨åˆ† csOp.chars -= attOp.chars; csOp.lines -= attOp.lines;&#125; 123456789101112ç¬¬3æ¬¡è¿­ä»£:1ã€åˆå§‹:op1.3:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;=&apos;, chars: 5, lines: 0, attribs: &apos;&apos; &#125;(ç¬¬2æ¬¡å¾ªç¯composeç®—æ³•åçš„op2)opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€composeç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;=&apos;, chars: 5, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;assem : &quot;|2=m=b&quot;ï¼ŒminusAssem : &quot;-1&quot;è¯´æ˜:op1-,op2=,composeä¹‹åop2è¿˜æœ‰opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬3æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç : 1234// å¦‚æœ op1 æ˜¯ - ï¼Œåˆ™æˆ‘ä»¬éœ€è¦çš„ opOut ä½¿ç”¨ op1Op.copyOp(attOp, opOut);// æ¸…ç©º op1 æ“ä½œattOp.clearOpcode(); 123456789101112ç¬¬4æ¬¡è¿­ä»£:1ã€åˆå§‹:op1.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;=&apos;, chars: 5, lines: 0, attribs: &apos;&apos; &#125;(ç¬¬3æ¬¡å¾ªç¯composeç®—æ³•åçš„op2)opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€composeç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;=&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;assem : &quot;|2=m=b&quot;, minusAssem : &quot;-1&quot;, plusAssem : &quot;+2&quot;è¯´æ˜:op1+,op2=,composeä¹‹åop1æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬4æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :12345678910111213&#125; else &#123; // å¦‚æœ op2 æ“ä½œçš„å­—ç¬¦å¤§äº op1 æ“ä½œçš„å­—ç¬¦ // keep and keep going ä¿æŒå¹¶ä¸”ç»§ç»­ opOut.opcode = attOp.opcode; opOut.chars = attOp.chars; opOut.lines = attOp.lines; // åˆå¹¶å±æ€§ opOut.attribs = composeAttributes(attOp.attribs, csOp.attribs, attOp.isKeep(), pool); attOp.clearOpcode(); // å‰©ä½™éƒ¨åˆ† csOp.chars -= attOp.chars; csOp.lines -= attOp.lines;&#125; 123456789101112ç¬¬5æ¬¡è¿­ä»£:1ã€åˆå§‹:op1.5:&#123; opcode: &apos;+&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;=&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;(ç¬¬4æ¬¡å¾ªç¯composeç®—æ³•åçš„op2)opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€composeç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;+&apos;, chars: 3, lines: 0, attribs: &apos;&apos; &#125;assem : &quot;|2=m=b&quot;, minusAssem : &quot;-1&quot;, plusAssem : &quot;+2+3&quot;è¯´æ˜:op1+,op2=,composeä¹‹åop1,op2éƒ½æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next(),ä½†æ­¤æ—¶op1å·²æ²¡æœ‰next(),æ•…op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125; å¯¹åº”ç¬¬5æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :12345678910111213141516if (csOp.chars &lt;= attOp.chars) &#123; // keep or keep part ä¿æŒæˆ–è€…ä¿æŒä¸€éƒ¨åˆ†(ä¿æŒ op1 çš„æ“ä½œå’Œå…¨éƒ¨çš„æ“ä½œå­—ç¬¦ä¸²å’Œæ¢è¡Œ æˆ–è€… ä¿æŒ op1 çš„æ“ä½œå’Œä¸€éƒ¨åˆ†çš„æ“ä½œå­—ç¬¦ä¸²å’Œæ¢è¡Œ) // å¯ä»¥ç†è§£ä¸ºï¼šop1å¢åŠ æˆ–è€…ä¿æŒäº†nä¸ªå­—ç¬¦ï¼Œop2ä¿æŒäº†mä¸ªå­—ç¬¦(m&lt;=n) opOut.opcode = attOp.opcode; opOut.chars = csOp.chars; opOut.lines = csOp.lines; // åˆå¹¶å±æ€§ opOut.attribs = composeAttributes(attOp.attribs, csOp.attribs, attOp.isKeep(), pool); csOp.clearOpcode(); // å‰©ä½™éƒ¨åˆ† attOp.chars -= csOp.chars; attOp.lines -= csOp.lines; if (attOp.chars == 0) &#123; attOp.clearOpcode(); &#125;&#125; 123456789101112ç¬¬6æ¬¡è¿­ä»£:1ã€åˆå§‹:op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;(next()æ²¡æœ‰ä¸‹ä¸€ä¸ªæ—¶ï¼Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„op)op2.3:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€composeç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;-&apos;, chars: 1, lines: 0, attribs: &apos;&apos; &#125;assem : &quot;|2=m=b&quot;, minusAssem : &quot;-1-1&quot;, plusAssem : &quot;+2+3&quot;è¯´æ˜:op2-,composeä¹‹åop1ï¼Œop2æ²¡opcode,æ‰€ä»¥é‡æ–°èµ‹å€¼next() å¯¹åº”ç¬¬6æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :1234// å¦‚æœ op1 æ²¡æœ‰æ“ä½œï¼Œåˆ™ä½¿ç”¨ op2Op.copyOp(csOp, opOut);// æ¸…ç©º op2 æ“ä½œcsOp.clearOpcode(); 123456789101112ç¬¬7æ¬¡è¿­ä»£:1ã€åˆå§‹:op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;(next()æ²¡æœ‰ä¸‹ä¸€ä¸ªæ—¶ï¼Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„op)op2.4:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;2ã€composeç®—æ³•å:op1:&#123; opcode: &apos;&apos;, chars: 0, lines: 0, attribs: &apos;&apos; &#125;op2:&#123; opcode: &apos;&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;opOut:&#123; opcode: &apos;+&apos;, chars: 2, lines: 0, attribs: &apos;&apos; &#125;assem : &quot;|2=m=b&quot;, minusAssem : &quot;-1-1&quot;, plusAssem : &quot;+2+3+2&quot;è¯´æ˜:op2+ï¼Œcomposeä¹‹åop1,op1,op2éƒ½æ²¡æœ‰opcode,ä¹Ÿæ²¡æœ‰next()äº†,åœæ­¢ å¯¹åº”ç¬¬7æ¬¡è¿­ä»£çš„å…·ä½“ä»£ç :1234// å¦‚æœ op1 æ²¡æœ‰æ“ä½œï¼Œåˆ™ä½¿ç”¨ op2Op.copyOp(csOp, opOut);// æ¸…ç©º op2 æ“ä½œcsOp.clearOpcode(); ç®—æ³•ç»“æœ12345678910111213141516171819202122231 Changeset = require(\"./src/static/js/Changeset\");2 var csA = \"Z:z&gt;4|2=m=b-1+2+3$abcde\";3 var csB = \"Z:13&gt;1|2=m=g-1+2$fg\";45 var doc1 = \"Hello World\\n\\n Hello World Hello Wor\";6 var doc2 = \"Hello World\\n\\n Hello World Hello Wabcder\";78 var appliedA = Changeset.applyToText(csA,doc1);9 console.log('apply csA:', appliedA);10 console.log('');11 console.log('appliedA==doc2:', appliedA==doc2);1213 console.log('');14 var appliedB = Changeset.applyToText(csB,doc2);1516 console.log('apply csB:', appliedB);17 console.log('');1819 var cs = Changeset.compose(csA,csB,false,null);20 var applied = Changeset.applyToText(cs,doc1);2122 console.log('final doc:', applied);23 1234567891011121314apply csA: Hello World Hello World Hello WabcderappliedA==doc2: trueapply csB: Hello World Hello World Hello Wabcdefgfinal doc: Hello World Hello World Hello Wabcdefg 123456789&gt; var cs1 = \"Z:z&gt;4|2=m=b-1+2+3$abcde\";&gt; var cs2 = \"Z:13&gt;1|2=m=g-1+2$fg\";&gt; Changeset.compose(cs1,cs2,false,null);'Z:z&gt;5|2=m=b-2+7$abcdefg'æœ€ç»ˆçš„CS:'Z:z&gt;5|2=m=b-2+7$abcdefg' ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/composeç®—æ³•è¿‡ç¨‹éªŒç®—.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"OT","slug":"Code/OT","permalink":"http://xiaoqinghua.site/categories/Code/OT/"}],"tags":[{"name":"OT","slug":"OT","permalink":"http://xiaoqinghua.site/tags/OT/"}]},{"title":"Hackpad æŠ€æœ¯åˆ†æ","slug":"hackpadæŠ€æœ¯åˆ†æ","date":"2018-05-20T05:58:53.000Z","updated":"2018-08-25T06:49:03.444Z","comments":true,"path":"hackpadæŠ€æœ¯åˆ†æ.html","link":"","permalink":"http://xiaoqinghua.site/hackpadæŠ€æœ¯åˆ†æ.html","excerpt":"","text":"hackpad æŠ€æœ¯åˆ†æå‰è¨€ 1ã€hackpad æ˜¯åŸºäº etherpad äºŒæ¬¡å¼€å‘ï¼Œå¢åŠ äº†å¾ˆå¤šäº§å“åŒ–çš„åŠŸèƒ½ï¼Œå¦‚\bè´¦æˆ·ç³»ç»Ÿï¼Œæ–‡æ¡£æƒé™ç­‰ã€‚\bè…¾è®¯æ–‡æ¡£ä¹Ÿæ˜¯åŸºäº hackpad å¼€å‘ï¼Œ\bè…¾è®¯æ–‡æ¡£çš„è¡¨æ ¼åˆ™æ˜¯åŸºäºå¼€æºé¡¹ç›® hansontable ä½œä¸ºå‰ç«¯è½½ä½“ï¼Œåœ¨åä½œç®—æ³•ä¸Šå¯¹ easysync è¿›è¡Œäº†ç•¥å¾®çš„ä¿®æ”¹ã€‚ 2ã€hackpad åŒæ ·æ˜¯åŸºäº client + serveræ¨¡å¼å¼€å‘ï¼Œé€šè®¯åè®®å¤§ä½“ç›¸åŒï¼Œåšäº†å°å¹…ä¿®æ”¹ï¼ŒOTç®—æ³•\béƒ½æ˜¯ä½¿ç”¨easysyncï¼Œ\bå®¢æˆ·ç«¯æœåŠ¡ç«¯æµç¨‹å¯ä»¥å‚è€ƒ etherpad æŠ€æœ¯åˆ†æã€‚ 3ã€hackpad é¡¹ç›®æ˜¯ç”± scala + java + js çš„ç»„åˆï¼Œhackpadä½¿ç”¨äº†Jettyåœ¨scalaä¸Šæ­å»ºçš„Websocket Server (åœ¨infrastructureç›®å½•ä¸‹çš„main.scalaä¸­å®Œæˆ) å®ç°é€šè®¯ï¼ŒåŒæ—¶ä¹Ÿä½¿ç”¨äº†etherpadä½¿ç”¨çš„å¼€æº SocketIO åº“ï¼Œæ¥å®ŒæˆåŸºäºåŒå‘é€šä¿¡çš„å®æ—¶ååŒã€‚ 4ã€ä»¥ä¸‹æŠ€æœ¯è°ƒç ”\bæ˜¯åœ¨etherpadçš„è°ƒç ”åŸºç¡€ä¸‹å¯¹hackpadè¡¨æ ¼ï¼Œå›¾ç‰‡ï¼Œåè®®ç­‰æ–¹é¢çš„æ¢³ç†ã€‚ 1ã€è¡Œ &amp; è¡¨æ ¼æ¢è¡Œæ“ä½œhackpadå…‰æ ‡æ¯ä¸€æ¬¡æ¢è¡Œï¼Œå®¢æˆ·ç«¯éƒ½ä¼šå‘é€ CLIENT_MESSAGE ï¼Œå…¶ä¸­è´Ÿè½½&quot;type&quot;:&quot;caret&quot;ï¼ŒchangeBy\bä»£è¡¨ä½œè€…ï¼Œå¦‚å›¾ï¼š ä¸Šè¿°åè®®ç›¸å½“äºå®šä½çš„ä½œç”¨ï¼Œç»“åˆå·¦ä¾§çš„ç”¨æˆ·å®æ—¶è¡Œå®šä½\båŠŸèƒ½å¦‚ä¸‹å›¾ï¼š ç»¼ä¸Šï¼šæ ‡é¢˜ &quot;caret&quot;:0, æ­£æ–‡çš„ç¬¬ä¸€è¡Œ &quot;caret&quot;:1 ,æ­£æ–‡çš„ç¬¬nè¡Œ &quot;caret&quot;:n ä¾‹: åœ¨æ ‡é¢˜è¡Œæ’å…¥ä¸€ä¸ª aï¼Œå®¢æˆ·ç«¯ä¼šåŒæ—¶å‘é€ä¸¤æ¡åè®®æ•°æ® 1ã€CLIENT_MESSAGE \bè´Ÿè½½ caret ä½ç½®ä¿¡æ¯ 1234567891011&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"CLIENT_MESSAGE\", \"payload\": &#123; \"type\": \"caret\", \"caret\": 0, \"changedBy\": \"p.1\" &#125; &#125;&#125; 2ã€USER_CHANGESï¼Œæ•°æ®ç»“æ„è¾ƒäº etherpad æ²¡æœ‰å˜åŒ– 1234567891011121314151617&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"USER_CHANGES\", \"baseRev\": 59, \"changeset\": \"Z:1&gt;1*0+1$a\", \"apool\": &#123; \"numToAttrib\": &#123; \"0\": [ \"author\", \"p.1\" ] &#125;, \"nextNum\": 1 &#125; &#125;&#125; æ’å…¥è¡¨æ ¼ åœ¨æ­£æ–‡ç¬¬ä¸€è¡Œæ’å…¥ä¸€ä¸ªè¡¨æ ¼(table)ï¼Œå®¢æˆ·ç«¯ä¼šåŒæ—¶å‘é€ä¸‰æ¡åè®®æ•°æ® 1ã€CLIENT_MESSAGE \bè´Ÿè½½ caret ä½ç½®ä¿¡æ¯ æ’å…¥ä¹‹å‰ï¼Œå…‰æ ‡ä½ç½® 1234567891011&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"CLIENT_MESSAGE\", \"payload\": &#123; \"type\": \"caret\", \"caret\": 1, \"changedBy\": \"p.1\" &#125; &#125;&#125; æ’å…¥ä¹‹åï¼Œå…‰æ ‡ä½ç½® 1234567891011&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"CLIENT_MESSAGE\", \"payload\": &#123; \"type\": \"caret\", \"caret\": 3, \"changedBy\": \"p.1\" &#125; &#125;&#125; 2ã€USER_CHANGES 123456789101112131415161718192021&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"USER_CHANGES\", \"baseRev\": 61, \"changeset\": \"Z:3&gt;3|1=2*0|1+1*0*1+1*0|1+1$\\n*\\n\", \"apool\": &#123; \"numToAttrib\": &#123; \"0\": [ \"author\", \"p.1\" ], \"1\": [ \"table\", \"123\" ] &#125;, \"nextNum\": 2 &#125; &#125;&#125; æ ¹æ®changesetè§„èŒƒè§£æä¸Šè¿°é€šä¿¡åè®®æ•°æ® 123pack the changeset `Z:3&gt;3|1=2*0|1+1*0*1+1*0|1+1$\\n*\\n`&#123; oldLen: 3,newLen: 6,ops: '|1=2*0|1+1*0*1+1*0|1+1',charBank: '\\n*\\n' &#125; operator:12345678910&#123; opcode: '=', chars: 2, lines: 1, attribs: '' &#125;æ’å…¥ä¸€ä¸ªç©ºè¡Œ \\n&#123; opcode: '+', chars: 1, lines: 1, attribs: '*0' &#125;æ’å…¥ä¸€ä¸ªè¡¨æ ¼ * (*ä»£è¡¨è¡¨æ ¼ï¼Œå›¾ç‰‡ï¼ŒåµŒå…¥çš„æ–‡ä»¶)(img/embed/table)&#123; opcode: '+', chars: 1, lines: 0, attribs: '*0*1' &#125;æ’å…¥ä¸€ä¸ªç©ºè¡Œ \\n&#123; opcode: '+', chars: 1, lines: 1, attribs: '*0' &#125; æ’å…¥è¡¨æ ¼ä»£ç ï¼š 123456789101112131415161718var rep = ace.getRep();// don't insert tables in title linevar selStart = [rep.selStart[0], rep.selStart[1]];var selEnd = [rep.selEnd[0], rep.selEnd[1]];if (selStart[0] == 0) &#123; selStart = [1, 0]; selEnd = [1, 0]; // make sure the table is on its own line, // (and not the title line) ace.replaceRange(selStart, selStart, '\\n\\n', []);&#125; else &#123; // make sure the table is on its own line, // (and not the title line) ace.replaceRange(selStart, selEnd, '\\n\\n', []); selStart = [selStart[0] + 1, 0];&#125;ace.replaceRange(selStart, selStart, '*', [['table', '123']]);padeditor.ace.focus(); 12345678910111213141516/** * Replace a range of text with new text. * @param &#123;Array.&lt;number&gt;&#125; start The line/column of the range start. * @param &#123;Array.&lt;number&gt;&#125; end The line/column of the range end. * @param &#123;string&#125; text The new text. * @param &#123;Array&#125; attribs The new attributes for this text. * @param &#123;boolean&#125; insertsAfterSelection The new text goes after the range. */self.replaceRange = function(start, end, text, attribs, insertsAfterSelection) &#123; self.inCallStackIfNecessary('replaceRange', function() &#123; self.fastIncorp(); self.performDocumentReplaceRange(start, end, text, attribs, insertsAfterSelection); &#125;);&#125; ç¼–è¾‘è¡¨æ ¼æ•°æ® åœ¨è¡¨æ ¼çš„ç¬¬ä¸€ä¸ªæ ¼å­åæ ‡(0:0)ä½ç½®æ’å…¥ä¸€ä¸ªå­—ç¬¦b 1234567891011121314151617&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"USER_CHANGES\", \"baseRev\": 67, \"changeset\": \"Z:7&gt;0|2=3*0=1$\", \"apool\": &#123; \"numToAttrib\": &#123; \"0\": [ \"0:0\", \"b\" ] &#125;, \"nextNum\": 1 &#125; &#125;&#125; åœ¨è¡¨æ ¼çš„ç¬¬ä¸€ä¸ªæ ¼å­åæ ‡(0:0)ä½ç½®è¿½åŠ ä¸€ä¸ªå­—ç¬¦c 1234567891011121314151617&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"USER_CHANGES\", \"baseRev\": 68, \"changeset\": \"Z:7&gt;0|2=3*0=1$\", \"apool\": &#123; \"numToAttrib\": &#123; \"0\": [ \"0:0\", \"bc\" ] &#125;, \"nextNum\": 1 &#125; &#125;&#125; åœ¨è¡¨æ ¼çš„ç¬¬ä¸€ä¸ªæ ¼å­åæ ‡(0:1)ä½ç½®æ’å…¥ä¸€ä¸ªå­—ç¬¦d 1234567891011121314151617&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"USER_CHANGES\", \"baseRev\": 69, \"changeset\": \"Z:7&gt;0|2=3*0=1$\", \"apool\": &#123; \"numToAttrib\": &#123; \"0\": [ \"0:1\", \"d\" ] &#125;, \"nextNum\": 1 &#125; &#125;&#125; åœ¨è¡¨æ ¼çš„ç¬¬ä¸€ä¸ªæ ¼å­åæ ‡(1:0)ä½ç½®æ’å…¥ä¸€ä¸ªå­—ç¬¦e 1234567891011121314151617&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"USER_CHANGES\", \"baseRev\": 70, \"changeset\": \"Z:7&gt;0|2=3*0=1$\", \"apool\": &#123; \"numToAttrib\": &#123; \"0\": [ \"1:0\", \"e\" ] &#125;, \"nextNum\": 1 &#125; &#125;&#125; ç»¼ä¸Šï¼š æ’å…¥ä¸€ä¸ªè¡¨æ ¼ï¼Œä¼šç›´æ¥åœ¨apool å¢åŠ ä¸€ä¸ª[&#39;table&#39;, &#39;123&#39;]å±æ€§ è¡¨æ ¼æœ‰ä½ç½®åæ ‡ | (0,0) | (0,1) | | â€” | â€” | | (1,0) | (1,1) | | (2,0) | (2,1) | æ›¿æ¢æ¯ä¸ªåæ ‡é‡Œçš„å€¼ï¼Œä¼šåœ¨apoolä¸­æ–°ç”Ÿæˆä¸€ä¸ª[&quot;1:0&quot;, &quot;abc&quot;] å¾€æ¯ä¸ªåæ ‡é‡Œè¿½åŠ å€¼ï¼Œä¼šåœ¨apoolä¸­æ›¿æ¢å·²ç”Ÿæˆçš„åæ ‡ä½ç½®ä¸€æ ·çš„æ–°å€¼[&quot;1:0&quot;, &quot;123&quot;] è¡¨æ ¼é‡Œçš„å­—ç¬¦æ˜¯ä¸èƒ½ä½¿ç”¨åŠ ç²—ï¼Œä¸‹åˆ’çº¿ï¼Œç­‰\bé™„åŠ å±æ€§çš„ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜æœ‰å¾…å¼€å‘ï¼ˆ\bå¦‚æœåŸºäºhackpadç°æœ‰çš„è¡¨æ ¼è®¾è®¡ï¼Œä½¿ç”¨apoolä¸­çš„å±æ€§ï¼Œå·²ç»å¾ˆéš¾å†è®¾è®¡å‡ºé™„åŠ å±æ€§çš„æ·»åŠ ï¼ŒçŒœæµ‹è…¾è®¯æ–‡æ¡£åº”è¯¥æ˜¯åšäº†å…¶ä»–çš„ä¼˜åŒ–ï¼‰ ä¸Šè¿°è¿™äº›\bå¢åŠ ï¼Œè¿½åŠ çš„æ–¹å¼ç¼–è¾‘è¡¨æ ¼æ•°æ®ï¼Œé€šè¿‡å¯¹å±æ€§apoolçš„æ“ä½œï¼Œ\b\bç„¶åæ ¹æ® Changeset.applyToText(cs,str)æ–¹æ³•ï¼Œä»è€Œä¸éœ€è¦\bæŠŠè¡¨æ ¼é‚£ä¸€ä¸ªrangeçš„ text(æ–‡æœ¬æ•°æ®)è¿›è¡ŒOTç®—æ³•å®ç°å°±å¯ä»¥å®ç°æ–‡æ¡£ä¸­è¡¨æ ¼æ•°æ®çš„ååŒç¼–è¾‘\bã€‚ 2ã€å›¾ç‰‡ç›´æ¥\b copy å›¾ç‰‡ url123456789101112131415161718192021&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"USER_CHANGES\", \"baseRev\": 8, \"changeset\": \"Z:s&gt;15|4=q*0*1+1*0|1+1*0+13$*\\nhttps://p.upyun.com/docs/cloud/demo.jpg\", \"apool\": &#123; \"numToAttrib\": &#123; \"0\": [ \"author\", \"p.1\" ], \"1\": [ \"img\", \"https://p.upyun.com/docs/cloud/demo.jpg\" ] &#125;, \"nextNum\": 2 &#125; &#125;&#125; ç›´æ¥ copy å›¾ç‰‡ url, æ˜¯ç›´æ¥åœ¨charbank:{*\\nurl}\b ,*è¡¨ç¤ºå›¾ç‰‡ï¼Œ\\nè¡¨ç¤ºæ¢ä¸€è¡Œï¼Œurlè¡¨ç¤ºå›¾ç‰‡é“¾æ¥,å’Œ etherpad ä¸åŒåœ¨äº*è¡¨ç¤ºå›¾ç‰‡ã€‚ å’Œæ’å…¥è¡¨æ ¼ä¸€æ ·ï¼Œéƒ½ä¼šåœ¨\bapoolé‡Œæ–°å¢å±æ€§&quot;1&quot;:[&quot;img&quot;,&quot;https://p.upyun.com/docs/cloud/demo.jpg&quot;] ä¸Šä¼ æœ¬åœ°å›¾ç‰‡ hackpad å›¾ç‰‡å­˜å‚¨ä½¿ç”¨ AWS çš„ S3 å­˜å‚¨æœåŠ¡ 12345678910111213141516171819202122232425&#123; \"type\": \"COLLABROOM\", \"data\": &#123; \"type\": \"USER_CHANGES\", \"baseRev\": 37, \"changeset\": \"Z:f&gt;1|4=e*0*1*2+1$*\", \"apool\": &#123; \"numToAttrib\": &#123; \"0\": [ \"attachmentPlaceholder\", \"attachment-1531119782428\" ], \"1\": [ \"author\", \"p.1\" ], \"2\": [ \"img\", \"/static/img/pixel.gif\" ] &#125;, \"nextNum\": 3 &#125; &#125;&#125; 1234567891011awsUser = __aws_key_id__awsPass = __aws_secret__s3Bucket = __aws_attachments_bucket__s3Region = us-east-1ç›¸å…³ä»£ç :editor.performDocumentReplaceRange(start, end, '*', [ ['img', '/static/img/pixel.gif'], ['attachmentPlaceholder', attachmentId]]); ä¸Šä¼ å›¾ç‰‡çš„æ–¹æ³•ï¼š æ„é€ FormDataæ•°æ®ï¼Œä½¿ç”¨ajaxä¸Šä¼ åˆ°S3\b 12345678910111213141516171819202122232425262728$.ajax(&#123; xhr: function() &#123; var xhr = new window.XMLHttpRequest(); xhr.upload.addEventListener(\"progress\", function(evt) &#123; if (evt.lengthComputable) &#123; var progress = evt.loaded / evt.total; editor.callWithAce(function (ace) &#123; setAttachmentUrlProgress(attachmentId, progress); &#125;); &#125; &#125;, false); return xhr; &#125;, url: s3host, data: form, processData: false, contentType: false, type: \"POST\", success: function() &#123; setTimeout(function() &#123; editor.callWithAce(function (ace) &#123; setAttachmentUrl(attachmentId, s3host + path, path); &#125;); observer.trigger('track', ['file-attach', null, null, &#123; success: true, padId: clientVars.padId, userId: clientVars.userId, type: file.type, path: path, size: file.size, uploadSize: shrunk.size &#125;]); &#125;, 500&#125;) 3ã€Aceç¼–è¾‘å™¨ &amp; Changesetå˜æ›´é›† &amp; AttribPoolå±æ€§æ± hackpad çš„é¡¹ç›®ç»“æ„ï¼š hackpad bin æ„å»ºé¡¹ç›®å’Œå¯åŠ¨é¡¹ç›®çš„å‘½ä»¤ contrib cron åŒ…å«ä¸€ä¸ªæ¸…ç†çš„å®šæ—¶ä»»åŠ¡ glue åŒ…å«ä¸€äº› python è„šæœ¬ runit åŒ…å«è®¾ç½®å®¹å™¨çš„ä¸€äº›è„šæœ¬ scripts è®¾ç½®æ•°æ®åº“å’ŒæœåŠ¡çš„ä¸€äº›è„šæœ¬ testing æµ‹è¯•\bç›®å½• etherpad bin åœ¨æœ¬åœ°å¯åŠ¨é¡¹ç›®çš„å‘½ä»¤ data æœ¬åœ°çš„æ•°æ®ï¼ŒåŒ…å«æ—¥å¿—å’Œ solr å…¨æ–‡æœç´¢æœåŠ¡å™¨ etc ä¸€äº›\bé…ç½®æ–‡ä»¶ solr solr å…¨æ–‡æœç´¢æœåŠ¡å™¨ src etherpad etherpad\b äº§å“åŠŸèƒ½ä»£ç  locals \bè¯­è¨€è®¾ç½® static etherpad é™æ€ä»£ç \båŒ…å« ace ç¼–è¾‘å™¨ easy_sync ç®—æ³•ç­‰\b themes \bä¸»é¢˜æ–‡ä»¶ .ejs æ¨¡æ¿ appjet-eth-dev.jar ç¼–è¯‘ infrastructure ç›®å½•ä¸‹çš„.scala æ–‡ä»¶ç”Ÿæˆçš„é¡¹ç›® infrastructure Scala \bç›®å½•ï¼Œç›®å‰ä¸æ˜¯å¤ªæ‡‚ lib åŒ…å«ä¸€ä¸ªæ•°æ®åº“è¿æ¥ä»¶ 1ã€ace ç¼–è¾‘å™¨ ç›¸å¯¹äº\betherpadï¼Œaceç¼–è¾‘å™¨\båŠŸèƒ½æ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ï¼Œæ•´ä¸ªaceç›®å½•ç»“æ„åˆ†ç¦»ï¼ŒåŒæ—¶å¢åŠ äº†ace_tableè¡¨æ ¼ï¼Œace_media\b\bï¼Œace_caretç­‰æŠ½è±¡æ¨¡å—ã€‚ 2ã€Changeset å˜æ›´é›† ç›¸å¯¹äº\betherpadï¼Œchangeset\båŠŸèƒ½æ²¡æœ‰å˜åŒ–ï¼Œå³ä¾¿æ˜¯åŠ äº†tableï¼Œimageè¿˜æ˜¯å’Œetherpadçš„ç›¸åŒã€‚ hackpadçš„changesetç»“æ„ä¸Šåšäº†åˆ†ç¦»ã€‚æŠ½ç¦»æˆeasysync1.jsï¼Œeasysync2.jsã€‚ easysync1.jsåŒ…å«changesetè‡ªèº«çš„ä¸€äº›æ–¹æ³•ï¼ŒåŒ…æ‹¬Changeset.decodeFromStringï¼ŒChangeset.numberArrayToStringç­‰ã€‚ easysync2.jsåŒ…å«changesetçš„OTåŠŸèƒ½ä¸Šçš„ä¸€äº›æ–¹æ³•ï¼ŒåŒ…æ‹¬Changeset.followï¼ŒChangeset.composeç­‰ã€‚ 3ã€AttribPool å±æ€§æ±  ç›¸å¯¹äº\betherpadï¼ŒAttribPool\båˆ™æ²¡æœ‰æ”¹å˜ã€‚ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/hackpadæŠ€æœ¯åˆ†æ.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"OT","slug":"Code/OT","permalink":"http://xiaoqinghua.site/categories/Code/OT/"}],"tags":[{"name":"OT","slug":"OT","permalink":"http://xiaoqinghua.site/tags/OT/"}]},{"title":"äº‘æ–‡æ¡£çš„éš¾ç‚¹","slug":"äº‘æ–‡æ¡£çš„éš¾ç‚¹","date":"2018-04-05T06:50:30.000Z","updated":"2018-08-05T06:57:09.278Z","comments":true,"path":"äº‘æ–‡æ¡£çš„éš¾ç‚¹.html","link":"","permalink":"http://xiaoqinghua.site/äº‘æ–‡æ¡£çš„éš¾ç‚¹.html","excerpt":"","text":"1. å¤šäººåä½œï¼Œå®æ—¶åŒæ­¥åœ¨äº‘æ–‡æ¡£ä¸ŠåŒæ—¶ç¼–å†™çš„å®¢æˆ·å¯èƒ½ä¼šéå¸¸å¤šï¼Œå¦‚æœä¸€ä¸ªæˆå‘˜æ›´æ–°äº†åˆ«çš„æˆå‘˜æ— æ³•åŠæ—¶çœ‹åˆ°ï¼Œæˆ–è€…å‡ ä¸ªæˆå‘˜æ— æ³•åŒæ—¶æ›´æ–°ï¼Œé‚£å°±ä¸å¯èƒ½å®ç°å›¢é˜Ÿåä½œï¼Œç”šè‡³ä¼šå‡ºç°ä¸šåŠ¡é”™è¯¯é£é™©ã€‚åœ¨çŸ³å¢¨æ–‡æ¡£ä¸Šï¼Œç”¨æˆ·è¾“å…¥çš„æ¯ä¸€ä¸ªæ–‡å­—éƒ½éœ€è¦åœ¨æ¯«ç§’çº§å°ºåº¦å†…å®æ—¶è®¡ç®—ï¼Œå¹¶ä¼ ç»™åŒä¸€ä¸ªæ–‡æ¡£çš„å…¶ä»–åä½œè€…ã€‚ä¸ºæ­¤ï¼ŒçŸ³å¢¨æ–‡æ¡£å¼•ç”¨äº† NATS æ•°æ®ç®¡é“ï¼Œå¯¹è¿›å…¥æœåŠ¡å™¨çš„æ‰€æœ‰æµé‡è¿›è¡Œå‰Šå³°å¡«è°·çš„å¤„ç†ã€‚åœ¨æ•°æ®é«˜å³°æœŸå¼•å…¥æœåŠ¡å™¨çš„æ•°æ®è¿›è¡Œå»¶æ—¶å¤„ç†ï¼Œç­‰å¾…ç©ºé—²æ—¶é—´å†è®¡ç®—ï¼Œä»è€Œä½¿æœåŠ¡å™¨å¯ä»¥å¹³ç¨³è¿è¡Œã€‚åŒæ—¶åŸºäºæ­¤ï¼Œè¿˜å®ç°äº†æ ¹æ®æ•°æ®æµé‡å¯¹åç«¯æœåŠ¡å™¨è‡ªåŠ¨æ‰©å®¹ï¼Œå½“æ•°æ®é‡çªç„¶å¢å¤§æ—¶ï¼Œè‡ªåŠ¨å¢åŠ æœåŠ¡å™¨ï¼Œæé«˜æ•´ä¸ªç³»ç»Ÿè´Ÿè½½èƒ½åŠ›ã€‚ 2.å¤šå®¢æˆ·ç«¯å®æ—¶åŒæ­¥ äº’è”ç½‘æ—¶ä»£ï¼Œå„ç§ç»ˆç«¯å±‚å‡ºä¸ç©·ï¼Œæ¯ä¸ªäººæ—¥å¸¸ä¸­è‡³å°‘ä¼šä½¿ç”¨ä¸¤ç§è®¾å¤‡ï¼Œæ‰‹æœºå’Œç”µè„‘ï¼Œå¦‚æœä¸€ä¸ªäººåŒæ—¶åœ¨æ‰‹æœºå’Œç”µè„‘ä¸Šç¼–è¾‘åŒä¸€ä»½ç¬”è®°ï¼Œå‡ºç°å†²çªæ—¶ï¼Œå¾ˆå¤šç¬”è®°ç±»åº”ç”¨ä¼šä¸ºæ¯ä¸€ä¸ªå†²çªåˆ›å»ºç‹¬ç«‹çš„å‰¯æœ¬ï¼Œéœ€è¦ç”¨æˆ·æ‰‹å·¥åˆå¹¶ï¼Œä½¿å¾—ç”¨æˆ·ä½¿ç”¨ç¬”è®°ä¾¿åˆ©æ€§å¤§å¤§ä¸‹é™ï¼› ä¸ºäº†æ”¯æŒå®æ—¶åä½œï¼ŒçŸ³å¢¨æ–‡æ¡£æŠ€æœ¯å›¢é˜Ÿå¯¹ç®—æ³•è¿›è¡Œäº†æ”¹è¿›ï¼Œè¿™ä¸ªç®—æ³•å¯ä»¥è§£å†³ä¸€æ®µæ–‡å­—ï¼Œå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶ä¿®æ”¹å¼•èµ·çš„å†²çªåˆå¹¶é—®é¢˜ã€‚å¦å¤–åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå·²ç»é€‚é…äº† 50 ç§ä¸åŒçš„æœºå™¨å’Œæµè§ˆå™¨ã€‚ 3.ç¦»çº¿ç¼–è¾‘ï¼Œé¿å…å†²çªç¦»çº¿ç¼–è¾‘ï¼Œç”¨æˆ·åŒæ­¥è¿‡æ¥çš„æ•°æ®å¾€å¾€æ˜¯ä»–å‡ ä¸ªå°æ—¶ç¼–å†™çš„æˆæœï¼Œæ­¤æ—¶ï¼Œè¿™ä¸ªç‰ˆæœ¬æˆ–å·²ç»ä¸æœåŠ¡å™¨çš„ç‰ˆæœ¬ç›¸å·®ç”šè¿œäº†ï¼ŒæŒ‰ç€æ­¤å‰æ–¹æ³•ï¼Œå¦‚ä½•è§£å†³æ–‡æ¡£å†²çªæ˜¯ä¸ªé—®é¢˜ã€‚ å¯¹æ­¤ï¼ŒçŸ³å¢¨æ–‡æ¡£å°½å¯èƒ½å¤šåœ°è®°å½•ç”¨æˆ·ç¼–è¾‘è¿‡ç¨‹ä¸­çš„æ¯ä¸€æ­¥æ“ä½œï¼Œç„¶ååˆ©ç”¨å„ç”¨æˆ·ç«¯çš„å†å²æ“ä½œä¿¡æ¯æŒ¨ä¸ªé‡æ”¾ï¼Œä»è€Œè¿˜åŸç”¨æˆ·ç¼–è¾‘çš„æœ¬æ„ã€‚æ¯”å¦‚ï¼Œå¯¹äºâ€œä»Šå¤©å¤©æ°”å¾ˆå¥½â€ï¼Œç¬¬ä¸€ä¸ªäººå¯èƒ½ä¼šåˆ é™¤ä¸­é—´çš„â€œå¤©æ°”â€ä¸¤å­—ï¼Œå˜æˆâ€œä»Šå¤©å¾ˆå¥½â€ï¼›è€Œå¦å¤–ä¸€ä¸ªäººå¯èƒ½ä¼šåŠ ä¸Šä¸€ä¸ªâ€œçœŸâ€å­—ï¼Œå˜æˆâ€œä»Šå¤©å¤©æ°”çœŸçš„å¾ˆå¥½â€ï¼ŒæŒ‰ç€çŸ³å¢¨æ–‡æ¡£çš„åŸºäºè¿˜åŸç”¨æˆ·æ„å›¾çš„ç®—æ³•ï¼Œæœ€ååˆå¹¶çš„ç»“æœåˆ™æ˜¯â€œä»Šå¤©çœŸçš„å¾ˆå¥½â€ï¼Œæ—¢æ»¡è¶³åˆ é™¤â€œå¤©æ°”â€ï¼Œåˆæ»¡è¶³å¢åŠ â€œçœŸâ€çš„åŒæ–¹æ„å›¾ã€‚å½“ç„¶ï¼Œè¿™ç§åˆå¹¶æ–¹æ³•ä¹Ÿå¹¶éç™¾åˆ†ç™¾å®Œç¾ï¼Œä½†æå­éª…è¡¨ç¤ºè¿™æ˜¯æœ€é€‚åˆç›®å‰ç¼–å†™ä½“éªŒçš„ã€‚","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Cloud-Office","slug":"Code/Cloud-Office","permalink":"http://xiaoqinghua.site/categories/Code/Cloud-Office/"}],"tags":[{"name":"Cloud-Office","slug":"Cloud-Office","permalink":"http://xiaoqinghua.site/tags/Cloud-Office/"}]},{"title":"VIMç»ƒä¹ æ‰‹å†Œ","slug":"VIMç»ƒä¹ æ‰‹å†Œ","date":"2018-02-25T06:42:48.000Z","updated":"2018-08-25T06:51:43.169Z","comments":true,"path":"VIMç»ƒä¹ æ‰‹å†Œ.html","link":"","permalink":"http://xiaoqinghua.site/VIMç»ƒä¹ æ‰‹å†Œ.html","excerpt":"","text":"==VIMå‘½ä»¤==1.ä¸€èˆ¬æ¨¡å¼å¯ç”¨çš„å…‰æ ‡ç§»åŠ¨ã€å¤åˆ¶ç²˜è´´ã€æœç´¢æ›¿æ¢ç­‰ ç§»åŠ¨å…‰æ ‡çš„æ–¹æ³• 1234567Ctrl+f å‘ä¸‹ç§»åŠ¨ä¸€é¡µCtrl+b å‘ä¸Šç§»åŠ¨ä¸€é¡µ0 ç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€å‰é¢çš„å­—ç¬¦å¤„$ ç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€åé¢çš„å­—ç¬¦å¤„G ç§»åŠ¨åˆ°æ–‡æœ¬çš„æœ€åä¸€è¡Œgg ç§»åŠ¨åˆ°æ–‡æœ¬çš„ç¬¬ä¸€è¡Œï¼Œç›¸å½“äº1Gn&lt;Enter&gt; nä¸ºæ•°å­—ã€‚å…‰æ ‡å‘ä¸‹ç§»åŠ¨nè¡Œ æœç´¢æ›¿æ¢ 12345/word å‘å…‰æ ‡ä¹‹ä¸‹æŸ¥è¯¢â€œwordâ€çš„å­—ç¬¦ä¸²n æŸ¥æ‰¾åˆ°â€œwordâ€ä¹‹å,å…‰æ ‡å®šä½åˆ°ä¸‹ä¸€ä¸ªâ€œwordâ€N ä¸nç›¸å,å®šä½åˆ°ä¸Šä¸€ä¸ª:n1,n2s/word1/word2/g åœ¨n1è¡Œä¸n2è¡Œä¹‹é—´æŸ¥è¯¢â€œword1â€,å¹¶æ›¿æ¢æˆâ€œword2â€:n1,$s/word1/word2/gc åœ¨n1è¡Œä¸æ–‡æœ¬æœ€åä¸€è¡Œä¹‹é—´æŸ¥è¯¢â€œword1â€,å¹¶æ›¿æ¢æˆâ€œword2â€,å¹¶æç¤ºç”¨æˆ· åˆ é™¤ã€å¤åˆ¶ã€ç²˜è´´ 1234567891011121314x(å°å†™) ç›¸å½“äº[del]é”®X(å¤§å†™) ç›¸å½“äº[backspace]é”®dd åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸€è¡Œndd åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„è¡Œä¸‹nè¡Œyy å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸€è¡Œnyy å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„è¡Œä¸‹nè¡Œp(å°å†™) å°†å¤åˆ¶çš„å†…å®¹ç²˜è´´åœ¨å…‰æ ‡ä¸‹ä¸€è¡ŒP(å¤§å†™) å°†å¤åˆ¶çš„å†…å®¹ç²˜è´´åœ¨å…‰æ ‡ä¸Šä¸€è¡ŒJ(å¤§å†™) å°†å½“å‰å…‰æ ‡è¡Œä¸ä¸‹ä¸€è¡Œï¼Œæ‹¼æˆä¸€è¡Œu æ¢å¤Crtl+r é‡åš. é‡å¤ä¸Šä¸€ä¸ªå‘½ä»¤æ³¨æ„: dd,yy éƒ½å¯ä»¥ä¸â€œ0â€,â€œ$â€,â€œGâ€é…åˆä½¿ç”¨ ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜12345678i åœ¨å½“å‰å…‰æ ‡å¤„å¼€å§‹è¾“å…¥I åœ¨å½“å‰è¡Œçš„ç¬¬ä¸€ä¸ªéç©ºæ ¼å¤„å¼€å§‹è¾“å…¥a åœ¨å½“å‰å…‰æ ‡çš„ä¸‹ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹è¾“å…¥A åœ¨å½“å‰è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹è¾“å…¥o åœ¨å½“å‰è¡Œçš„ä¸‹ä¸€è¡Œå¤„è¾“å…¥æ–°çš„ä¸€è¡ŒO åœ¨å½“å‰è¡Œçš„ä¸Šä¸€è¡Œå¤„è¾“å…¥æ–°çš„ä¸€è¡Œr å–ä»£æ¨¡å¼ï¼Œåªä¼šå–ä»£å…‰æ ‡æ‰€åœ¨å­—ç¬¦ä¸€æ¬¡R å–ä»£æ¨¡å¼ï¼Œä¼šä¸€ç›´å–ä»£å…‰æ ‡æ‰€åœ¨çš„æ–‡å­—ï¼Œç›´åˆ°æŒ‰ä¸‹ESCé”® ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°å‘½ä»¤è¡Œæ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜123:w ä¿å­˜ï¼Œé€€å‡º:q ä»…ä»…æ˜¯é€€å‡ºviç¼–è¾‘å™¨ï¼Œå¦‚æœæ²¡æœ‰ä¿®æ”¹ç›´æ¥é€€å‡ºï¼Œå¦‚æœæœ‰ä¿®æ”¹ä¼šæç¤ºï¼Œå¯ä»¥ä½¿ç”¨:q!ä¸å­˜å‚¨ä¿®æ”¹éƒ¨åˆ†ï¼Œå¼ºåˆ¶é€€å‡º:wq å­˜å‚¨åé€€å‡º ç‰›é€¼çš„æŠ€å·§ å•è¯ç§»åŠ¨ 1234567W w ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯å¼€å¤´E e ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯ç»“å°¾B b å€’é€€åˆ°ä¸Šä¸€ä¸ªå•è¯å¼€å¤´- Eä¼šå¿½ç•¥æ ‡ç‚¹ç¬¦å·ï¼Œå¦‚ï¼šIâ€˜mï¼Œeä¼šå½“æˆä¸¤ä¸ªå•è¯ï¼ŒEåˆ™ä¸ä¼š- 2wï¼Œè¡¨ç¤ºå¾€ä¸‹ç§»åŠ¨2ä¸ªå•è¯- ä¸€èˆ¬ç”¨å°å†™çš„å°±å¯ä»¥äº† æ•´è¡Œç§»åŠ¨ 12340 ç§»åŠ¨åˆ°è¡Œé¦–$ ç§»åŠ¨åˆ°è¡Œæœ«+ ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œå¼€å¤´- ç§»åŠ¨åˆ°ä¸Šä¸€è¡Œå¼€å¤´ æ»šå± 1234567Ctrl+f å¾€å‰æ»šåŠ¨ä¸€æ•´å±Ctrl+b å¾€åæ»šåŠ¨ä¸€æ•´å±Ctrl+d å¾€å‰æ»šåŠ¨åŠå±Ctrl+u å¾€åæ»šåŠ¨åŠå±Ctrl+e å¾€åæ»šåŠ¨ä¸€è¡Œ Ctrl+y å¾€å‰æ»šåŠ¨ä¸€è¡Œ ç”¨zè°ƒæ•´å…‰æ ‡ 123z&lt;Enter&gt; å°†å…‰æ ‡æ‰€åœ¨è¡Œç§»åŠ¨åˆ°å±å¹•é¡¶ç«¯z. å°†å…‰æ ‡æ‰€åœ¨è¡Œç§»åŠ¨åˆ°å±å¹•ä¸­é—´z- å°†å…‰æ ‡æ‰€åœ¨è¡Œç§»åŠ¨åˆ°å±å¹•ä½ç«¯ åœ¨å±å¹•ä¸­ç§»åŠ¨ 123456H ç§»åŠ¨åˆ°å±å¹•é¡¶ç«¯çš„è¡ŒM ç§»åŠ¨åˆ°å±å¹•ä¸­å¤®çš„è¡ŒL ç§»åŠ¨åˆ°å±å¹•åº•ç«¯çš„è¡ŒnH ç§»åŠ¨åˆ°å±å¹•é¡¶ç«¯å¾€ä¸‹çš„ç¬¬nè¡ŒnL ç§»åŠ¨åˆ°å±å¹•é¡¶ç«¯å¾€ä¸Šçš„ç¬¬nè¡Œ å•è¯åˆ é™¤ 12345dw åˆ é™¤åˆ°ä¸‹ä¸€ä¸ªå•è¯å¼€å¤´de åˆ é™¤åˆ°æœ¬å•è¯æœ«å°¾dE åˆ é™¤åˆ°æœ¬å•è¯æœ«å°¾åŒ…æ‹¬æ ‡ç‚¹åœ¨å†…db åˆ é™¤åˆ°å‰ä¸€ä¸ªå•è¯dB åˆ é™¤åˆ°å‰ä¸€ä¸ªå•è¯åŒ…æ‹¬æ ‡ç‚¹åœ¨å†… å•è¯ä¿®æ”¹ 12cw ä»å…‰æ ‡å¤„ä¿®æ”¹åˆ°å•è¯ç»“å°¾cb ä»å…‰æ ‡å¤„ä¿®æ”¹åˆ°å•è¯å¼€å¤´ è¡Œä¿®æ”¹ 123456c$ ä»å…‰æ ‡ä¿®æ”¹åˆ°æœ¬è¡Œæœ«å°¾C åŠŸèƒ½åŒä¸Šc0 ä»å…‰æ ‡ä¿®æ”¹åˆ°æœ¬è¡Œå¼€å¤´cc åˆ é™¤æ•´è¡Œä»å¤´ä¿®æ”¹S åŠŸèƒ½åŒä¸Šs åˆ é™¤å…‰æ ‡æ‰€åœ¨ä½ç½®çš„å­—ç¬¦ï¼Œç„¶åæ’å…¥ å•è¯å’Œå­—ç¬¦å¤åˆ¶ 123456ynl å‘å³å¤åˆ¶nä¸ªå­—ç¬¦ynh å‘å·¦å¤åˆ¶nä¸ªå­—ç¬¦ynw å‘å‰å¤åˆ¶nä¸ªå•è¯ynb å‘åå¤åˆ¶nä¸ªå•è¯eï¼ å…¨æ–‡æ¢å¤dt&quot; åˆ é™¤æ‰€æœ‰çš„å†…å®¹ï¼Œç›´åˆ°é‡åˆ°åŒå¼•å·â€”â€” &quot; æœ€å¼ºå…‰æ ‡ç§»åŠ¨ 12% : åŒ¹é…æ‹¬å·ç§»åŠ¨ï¼ŒåŒ…æ‹¬ (, &#123;, [. ï¼ˆé™ˆçš“æ³¨ï¼šä½ éœ€è¦æŠŠå…‰æ ‡å…ˆç§»åˆ°æ‹¬å·ä¸Šï¼‰;* å’Œ #: åŒ¹é…å…‰æ ‡å½“å‰æ‰€åœ¨çš„å•è¯ï¼Œç§»åŠ¨å…‰æ ‡åˆ°ä¸‹ä¸€ä¸ªï¼ˆæˆ–ä¸Šä¸€ä¸ªï¼‰åŒ¹é…å•è¯ï¼ˆ*æ˜¯ä¸‹ä¸€ä¸ªï¼Œ#æ˜¯ä¸Šä¸€ä¸ªï¼‰; ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/VIMç»ƒä¹ æ‰‹å†Œ.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Vim","slug":"Code/Vim","permalink":"http://xiaoqinghua.site/categories/Code/Vim/"}],"tags":[{"name":"Vim","slug":"Vim","permalink":"http://xiaoqinghua.site/tags/Vim/"}]},{"title":"Hibernateæ€»ç»“","slug":"Hibernateæ€»ç»“","date":"2017-12-10T05:22:36.000Z","updated":"2018-09-08T05:19:05.187Z","comments":true,"path":"Hibernateæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Hibernateæ€»ç»“.html","excerpt":"","text":"ä»€ä¹ˆæ˜¯Hibernateæ¡†æ¶Hibernateæ˜¯ä¸€ç§ORMæ¡†æ¶ï¼Œå…¨ç§°ä¸º Object Relative DateBase-Mappingï¼Œåœ¨Javaå¯¹è±¡ä¸å…³ç³»æ•°æ®åº“ä¹‹é—´å»ºç«‹æŸç§æ˜ å°„ï¼Œä»¥å®ç°ç›´æ¥å­˜å–Javaå¯¹è±¡ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Hibernateæ—¢ç„¶Hibernateæ˜¯å…³äºJavaå¯¹è±¡å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´çš„è”ç³»çš„è¯ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬MVCä¸­çš„æ•°æ®æŒä¹…å±‚-&gt;åœ¨ç¼–å†™ç¨‹åºä¸­çš„DAOå±‚â€¦ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹æˆ‘ä»¬åœ¨DAOå±‚å†™ç¨‹åºçš„å†ç¨‹å§ï¼š åœ¨DAOå±‚æ“ä½œXMLï¼Œå°†æ•°æ®å°è£…åˆ°XMLæ–‡ä»¶ä¸Šï¼Œè¯»å†™XMLæ–‡ä»¶æ•°æ®å®ç°CRUD åœ¨DAOå±‚ä½¿ç”¨åŸç”ŸJDBCè¿æ¥æ•°æ®åº“ï¼Œå®ç°CRUD å«Œå¼ƒJDBCçš„Connection\\Statement\\ResultSetç­‰å¯¹è±¡å¤ªç¹çï¼Œä½¿ç”¨å¯¹åŸç”ŸJDBCçš„å°è£…ç»„ä»¶â€“&gt;DbUtilsç»„ä»¶ æˆ‘ä»¬æ¥çœ‹çœ‹ä½¿ç”¨DbUtilsä¹‹åï¼Œç¨‹åºçš„ä»£ç æ˜¯æ€ä¹ˆæ ·çš„ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647public class CategoryDAOImpl implements zhongfucheng.dao.CategoryDao &#123; @Override public void addCategory(Category category) &#123; QueryRunner queryRunner = new QueryRunner(Utils2DB.getDataSource()); String sql = \"INSERT INTO category (id, name, description) VALUES(?,?,?)\"; try &#123; queryRunner.update(sql, new Object[]&#123;category.getId(), category.getName(), category.getDescription()&#125;); &#125; catch (SQLException e) &#123; throw new RuntimeException(e); &#125; &#125; @Override public Category findCategory(String id) &#123; QueryRunner queryRunner = new QueryRunner(Utils2DB.getDataSource()); String sql = \"SELECT * FROM category WHERE id=?\"; try &#123; Category category = (Category) queryRunner.query(sql, id, new BeanHandler(Category.class)); return category; &#125; catch (SQLException e) &#123; throw new RuntimeException(e); &#125; &#125; @Override public List&lt;Category&gt; getAllCategory() &#123; QueryRunner queryRunner = new QueryRunner(Utils2DB.getDataSource()); String sql = \"SELECT * FROM category\"; try &#123; List&lt;Category&gt; categories = (List&lt;Category&gt;) queryRunner.query(sql, new BeanListHandler(Category.class)); return categories; &#125; catch (SQLException e) &#123; throw new RuntimeException(e); &#125; &#125;&#125; å…¶å®ä½¿ç”¨DbUtilsæ—¶ï¼ŒDAOå±‚ä¸­çš„ä»£ç ç¼–å†™æ˜¯å¾ˆæœ‰è§„å¾‹çš„ã€‚ å½“æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œå°±å°†JavaBeanå¯¹è±¡æ‹†åˆ†ï¼Œæ‹¼è£…æˆSQLè¯­å¥ å½“æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ï¼Œç”¨SQLæŠŠæ•°æ®åº“è¡¨ä¸­çš„åˆ—ç»„åˆï¼Œæ‹¼è£…æˆJavaBeanå¯¹è±¡ ä¹Ÿå°±æ˜¯è¯´ï¼šJavaBeanå¯¹è±¡å’Œæ•°æ®è¡¨ä¸­çš„åˆ—å­˜åœ¨æ˜ å°„å…³ç³»!å¦‚æœç¨‹åºèƒ½å¤Ÿè‡ªåŠ¨ç”ŸæˆSQLè¯­å¥å°±å¥½äº†â€¦.é‚£ä¹ˆHibernateå°±å®ç°äº†è¿™ä¸ªåŠŸèƒ½ï¼ ç®€å•æ¥è¯´ï¼šæˆ‘ä»¬ä½¿ç”¨Hibernateæ¡†æ¶å°±ä¸ç”¨æˆ‘ä»¬å†™å¾ˆå¤šç¹ççš„SQLè¯­å¥ï¼Œä»è€Œç®€åŒ–æˆ‘ä»¬çš„å¼€å‘ï¼ ORMæ¦‚è¿°åœ¨ä»‹ç»Hibernateçš„æ—¶å€™ï¼Œè¯´äº†Hibernateæ˜¯ä¸€ç§ORMçš„æ¡†æ¶ã€‚é‚£ä»€ä¹ˆæ˜¯ORMå‘¢ï¼ŸORMæ˜¯ä¸€ç§æ€æƒ³ Oä»£è¡¨çš„æ˜¯Objcet Rä»£è¡¨çš„æ˜¯Relative Mä»£è¡¨çš„æ˜¯Mapping ORM-&gt;å¯¹è±¡å…³ç³»æ˜ å°„â€¦.ORMå…³æ³¨æ˜¯å¯¹è±¡ä¸`æ•°æ®åº“ä¸­çš„åˆ—çš„å…³ç³» Hibernateå¿«é€Ÿå…¥é—¨ç¼–å†™å¯¹è±¡å’Œå¯¹è±¡æ˜ å°„ç¼–å†™ä¸€ä¸ªUserå¯¹è±¡-&gt;User.java 123456789public class User &#123; private int id; private String username; private String password; private String cellphone; //å„ç§setterå’Œgetter&#125; ç¼–å†™å¯¹è±¡æ˜ å°„-&gt;User.hbm.xmlã€‚ä¸€èˆ¬å®ƒå’ŒJavaBeanå¯¹è±¡æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ æˆ‘ä»¬æ˜¯ä¸çŸ¥é“è¯¥XMLæ˜¯æ€ä¹ˆå†™çš„ï¼Œå¯ä»¥æœç´¢ä¸€ä¸‹Hibernateæ–‡ä»¶å¤¹ä¸­åç¼€ä¸º.hbm.xmlã€‚çœ‹çœ‹å®ƒä»¬æ˜¯æ€ä¹ˆå†™çš„ã€‚ç„¶åå¤åˆ¶ä¸€ä»½è¿‡æ¥: 1234567891011121314151617181920212223242526272829303132333435363738&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\" \"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd\"&gt;&lt;!-- This mapping demonstrates content-based discrimination for the table-per-hierarchy mapping strategy, using a formula discriminator.--&gt;&lt;hibernate-mapping package=\"org.hibernate.test.array\"&gt; &lt;class name=\"A\" lazy=\"true\" table=\"aaa\"&gt; &lt;id name=\"id\"&gt; &lt;generator class=\"native\"/&gt; &lt;/id&gt; &lt;array name=\"bs\" cascade=\"all\" fetch=\"join\"&gt; &lt;key column=\"a_id\"/&gt; &lt;list-index column=\"idx\"/&gt; &lt;one-to-many class=\"B\"/&gt; &lt;/array&gt; &lt;/class&gt; &lt;class name=\"B\" lazy=\"true\" table=\"bbb\"&gt; &lt;id name=\"id\"&gt; &lt;generator class=\"native\"/&gt; &lt;/id&gt; &lt;/class&gt;&lt;/hibernate-mapping&gt; åœ¨ä¸Šé¢çš„æ¨¡æ¿ä¸Šä¿®æ”¹ï½ä¸‹é¢ä¼šå…·ä½“è®²è§£è¿™ä¸ªé…ç½®æ–‡ä»¶! 12345678910111213141516171819&lt;!--åœ¨domainåŒ…ä¸‹--&gt;&lt;hibernate-mapping package=\"xiaoqinghua.domain\"&gt; &lt;!--ç±»åä¸ºUserï¼Œè¡¨åä¹Ÿä¸ºUser--&gt; &lt;class name=\"User\" table=\"user\"&gt; &lt;!--ä¸»é”®æ˜ å°„ï¼Œå±æ€§åä¸ºidï¼Œåˆ—åä¹Ÿä¸ºid--&gt; &lt;id name=\"id\" column=\"id\"&gt; &lt;!--æ ¹æ®åº•å±‚æ•°æ®åº“ä¸»é”®è‡ªåŠ¨å¢é•¿--&gt; &lt;generator class=\"native\"/&gt; &lt;/id&gt; &lt;!--éä¸»é”®æ˜ å°„ï¼Œå±æ€§å’Œåˆ—åä¸€ä¸€å¯¹åº”--&gt; &lt;property name=\"username\" column=\"username\"/&gt; &lt;property name=\"cellphone\" column=\"cellphone\"/&gt; &lt;property name=\"password\" column=\"password\"/&gt; &lt;/class&gt;&lt;/hibernate-mapping&gt; ä¸»é…ç½®æ–‡ä»¶hibernate.cfg.xml å¦‚æœä½¿ç”¨Intellij Ideaç”Ÿæˆçš„Hibernateå¯ä»¥æŒ‡å®šç”Ÿæˆå‡ºä¸»é…ç½®æ–‡ä»¶hibernate.cfg.xmlï¼Œå®ƒæ˜¯è¦æ”¾åœ¨srcç›®å½•ä¸‹çš„ å¦‚æœä¸æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Hibernateçš„hibernate-distribution-3.6.0.Final\\project\\etcè¿™ä¸ªç›®å½•ä¸‹å¯ä»¥æ‰¾åˆ° å®ƒé•¿å¾—è¿™ä¸ªæ ·å­ï¼š 1234567891011121314&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD//EN\" \"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd\"&gt;&lt;hibernate-configuration&gt; &lt;session-factory&gt; &lt;property name=\"connection.url.\"/&gt; &lt;property name=\"connection.driver_class\"/&gt; &lt;property name=\"connection.username\"/&gt; &lt;property name=\"connection.password\"/&gt; &lt;!-- DB schema will be updated if needed --&gt; &lt;!-- &lt;property name=\"hbm2ddl.auto\"&gt;update&lt;/property&gt; --&gt; &lt;/session-factory&gt;&lt;/hibernate-configuration&gt; é€šè¿‡ä¸Šé¢çš„æ¨¡æ¿è¿›è¡Œä¿®æ”¹ 12345678910111213141516171819202122232425262728&lt;hibernate-configuration&gt; &lt;!-- é€šå¸¸ï¼Œä¸€ä¸ªsession-factoryèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªæ•°æ®åº“ --&gt; &lt;session-factory&gt; &lt;!-- 1. æ•°æ®åº“è¿æ¥é…ç½® --&gt; &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt; &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql:///xiaoqinghua&lt;/property&gt; &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt; &lt;property name=\"hibernate.connection.password\"&gt;root&lt;/property&gt; &lt;!-- æ•°æ®åº“æ–¹æ³•é…ç½®ï¼Œ hibernateåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¼šæ ¹æ®ä¸åŒçš„æ–¹è¨€ç”Ÿæˆç¬¦åˆå½“å‰æ•°æ®åº“è¯­æ³•çš„sql --&gt; &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQL5Dialect&lt;/property&gt; &lt;!-- 2. å…¶ä»–ç›¸å…³é…ç½® --&gt; &lt;!-- 2.1 æ˜¾ç¤ºhibernateåœ¨è¿è¡Œæ—¶å€™æ‰§è¡Œçš„sqlè¯­å¥ --&gt; &lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt; &lt;!-- 2.2 æ ¼å¼åŒ–sql --&gt; &lt;property name=\"hibernate.format_sql\"&gt;true&lt;/property&gt; &lt;!-- 2.3 è‡ªåŠ¨å»ºè¡¨ --&gt; &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;create&lt;/property&gt; &lt;!--3. åŠ è½½æ‰€æœ‰æ˜ å°„--&gt; &lt;mapping resource=\"xiaoqinghua/domain/User.hbm.xml\"/&gt; &lt;/session-factory&gt;&lt;/hibernate-configuration&gt; æµ‹è¯•12345678910111213141516171819202122232425262728293031323334353637public class App &#123; public static void main(String[] args) &#123; //åˆ›å»ºå¯¹è±¡ User user = new User(); user.setPassword(\"123\"); user.setCellphone(\"122222\"); user.setUsername(\"nihao\"); //è·å–åŠ è½½é…ç½®ç®¡ç†ç±» Configuration configuration = new Configuration(); //ä¸ç»™å‚æ•°å°±é»˜è®¤åŠ è½½hibernate.cfg.xmlæ–‡ä»¶ï¼Œ configuration.configure(); //åˆ›å»ºSessionå·¥å‚å¯¹è±¡ SessionFactory factory = configuration.buildSessionFactory(); //å¾—åˆ°Sessionå¯¹è±¡ Session session = factory.openSession(); //ä½¿ç”¨Hibernateæ“ä½œæ•°æ®åº“ï¼Œéƒ½è¦å¼€å¯äº‹åŠ¡,å¾—åˆ°äº‹åŠ¡å¯¹è±¡ Transaction transaction = session.getTransaction(); //å¼€å¯äº‹åŠ¡ transaction.begin(); //æŠŠå¯¹è±¡æ·»åŠ åˆ°æ•°æ®åº“ä¸­ session.save(user); //æäº¤äº‹åŠ¡ transaction.commit(); //å…³é—­Session session.close(); &#125;&#125; å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šJavaBeançš„ä¸»é”®ç±»å‹åªèƒ½æ˜¯intç±»å‹ï¼Œå› ä¸ºåœ¨æ˜ å°„å…³ç³»ä¸­é…ç½®æ˜¯è‡ªåŠ¨å¢é•¿çš„ï¼ŒStringç±»å‹æ˜¯ä¸èƒ½è‡ªåŠ¨å¢é•¿çš„ã€‚å¦‚æœæ˜¯ä½ è®¾ç½®äº†Stringç±»å‹ï¼Œåˆä½¿ç”¨äº†è‡ªåŠ¨å¢é•¿ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥å‡ºä¸‹é¢çš„é”™è¯¯ï¼ 1Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'xiaoqinghua.user' does æ‰§è¡Œå®Œç¨‹åºåï¼ŒHibernateå°±ä¸ºæˆ‘ä»¬åˆ›å»ºå¯¹åº”çš„è¡¨ï¼Œå¹¶æŠŠæ•°æ®å­˜è¿›äº†æ•°æ®åº“äº† Configurationé…ç½®ç®¡ç†ç±»ï¼šä¸»è¦ç®¡ç†é…ç½®æ–‡ä»¶çš„ä¸€ä¸ªç±» å®ƒæ‹¥æœ‰ä¸€ä¸ªå­ç±»AnnotationConfigurationï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ³¨è§£æ¥ä»£æ›¿XMLé…ç½®æ–‡ä»¶æ¥é…ç½®ç›¸å¯¹åº”çš„ä¿¡æ¯ configureæ–¹æ³•configure()æ–¹æ³•ç”¨äºåŠ è½½é…ç½®æ–‡ä»¶ åŠ è½½ä¸»é…ç½®æ–‡ä»¶çš„æ–¹æ³• å¦‚æœæŒ‡å®šå‚æ•°ï¼Œé‚£ä¹ˆåŠ è½½å‚æ•°çš„è·¯å¾„é…ç½®æ–‡ä»¶ å¦‚æœä¸æŒ‡å®šå‚æ•°ï¼Œé»˜è®¤åŠ è½½src/ç›®å½•ä¸‹çš„hibernate.cfg.xml buildSessionFactoryæ–¹æ³•buildSessionFactory()ç”¨äºåˆ›å»ºSessionå·¥å‚ SessionFactorySessionFactoryâ€“&gt;Sessionçš„å·¥å‚ï¼Œä¹Ÿå¯ä»¥è¯´ä»£è¡¨äº†hibernate.cfg.xmlè¿™ä¸ªæ–‡ä»¶â€¦hibernate.cfg.xmlçš„å°±æœ‰&lt;session-factory&gt;è¿™ä¹ˆä¸€ä¸ªèŠ‚ç‚¹ openSessionæ–¹æ³• åˆ›å»ºä¸€ä¸ªSessionå¯¹è±¡ getCurrentSessionæ–¹æ³• åˆ›å»ºSessionå¯¹è±¡æˆ–å–å‡ºSessionå¯¹è±¡ SessionSessionæ˜¯Hibernateæœ€é‡è¦çš„å¯¹è±¡ï¼ŒSessionç»´æŠ¤äº†ä¸€ä¸ªè¿æ¥ï¼ˆConnectionï¼‰ï¼Œåªè¦ä½¿ç”¨Hibernateæ“ä½œæ•°æ®åº“ï¼Œéƒ½éœ€è¦ç”¨åˆ°Sessionå¯¹è±¡ é€šå¸¸æˆ‘ä»¬åœ¨DAOå±‚ä¸­éƒ½ä¼šæœ‰ä»¥ä¸‹çš„æ–¹æ³•ï¼ŒSessionä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†å¯¹åº”çš„æ–¹æ³•æ¥å®ç°ï¼ 1234567891011public interface IEmployeeDao &#123; void save(Employee emp); void update(Employee emp); Employee findById(Serializable id); List&lt;Employee&gt; getAll(); List&lt;Employee&gt; getAll(String employeeName); List&lt;Employee&gt; getAll(int index, int count); void delete(Serializable id);&#125; æ›´æ–°æ“ä½œæˆ‘ä»¬åœ¨å¿«é€Ÿå…¥é—¨ä¸­ä½¿ç”¨åˆ°äº†save(Objcet o)æ–¹æ³•ï¼Œè°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•å°±æŠŠå¯¹è±¡ä¿å­˜åœ¨æ•°æ®åº“ä¹‹ä¸­äº†ã€‚Sessionå¯¹è±¡è¿˜æä¾›ç€å…¶ä»–çš„æ–¹æ³•æ¥è¿›è¡Œå¯¹æ•°æ®åº“çš„æ›´æ–° session.save(obj); ä¿å­˜ä¸€ä¸ªå¯¹è±¡ session.update(obj); æ›´æ–°ä¸€ä¸ªå¯¹è±¡ session.saveOrUpdate(obj); ä¿å­˜æˆ–è€…æ›´æ–°çš„æ–¹æ³• æ²¡æœ‰è®¾ç½®ä¸»é”®ï¼Œæ‰§è¡Œä¿å­˜ï¼› æœ‰è®¾ç½®ä¸»é”®ï¼Œæ‰§è¡Œæ›´æ–°æ“ä½œ; å¦‚æœè®¾ç½®ä¸»é”®ä¸å­˜åœ¨æŠ¥é”™ï¼ æˆ‘ä»¬æ¥ä½¿ç”¨ä¸€ä¸‹update()æ–¹æ³•å§â€¦.æ—¢ç„¶æ˜¯æ›´æ–°æ“ä½œäº†ï¼Œé‚£ä¹ˆè‚¯å®šéœ€è¦è®¾ç½®ä¸»é”®çš„ï¼Œä¸è®¾ç½®ä¸»é”®ï¼Œæ•°æ®åº“æ€ä¹ˆçŸ¥é“ä½ è¦æ›´æ–°ä»€ä¹ˆã€‚å°†idä¸º1çš„è®°å½•ä¿®æ”¹æˆå¦‚ä¸‹ï¼š 1234user.setId(1);user.setPassword(\"fhjdlashf\");user.setCellphone(\"100865\");user.setUsername(\"xiaoqinghua\"); ä¸»é”®æŸ¥è¯¢é€šè¿‡ä¸»é”®æ¥æŸ¥è¯¢æ•°æ®åº“çš„è®°å½•ï¼Œä»è€Œè¿”å›ä¸€ä¸ªJavaBeanå¯¹è±¡ session.get(javaBean.class, int id); ä¼ å…¥å¯¹åº”çš„classå’Œidå°±å¯ä»¥æŸ¥è¯¢ session.load(javaBean.class, int id); æ”¯æŒæ‡’åŠ è½½ Useré‡å†™toString()æ¥çœ‹ä¸€ä¸‹æ•ˆæœï¼š 1234User user1 = (User) session.get(User.class, 1);System.out.println(user1);User&#123;id=1ï¼Œusername='xiaoqinghua'ï¼Œpassword='fhjdlashf'ï¼Œcellphone='100865'&#125; HQLæŸ¥è¯¢HQL:hibernate query language å³hibernateæä¾›çš„é¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ æŸ¥è¯¢çš„æ˜¯å¯¹è±¡ä»¥åŠå¯¹è±¡çš„å±æ€§å®ƒæŸ¥è¯¢çš„æ˜¯å¯¹è±¡ä»¥åŠå±æ€§ï¼Œå› æ­¤æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼ã€‚ SQLï¼šStruct query language ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ æŸ¥è¯¢çš„æ˜¯è¡¨ä»¥åŠåˆ—ä¸åŒºåˆ†å¤§å°å†™ HQLæ˜¯é¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œå¯ä»¥ç”¨æ¥æŸ¥è¯¢å…¨éƒ¨çš„æ•°æ®ï¼ 123Query query = session.createQuery(\"FROM User\");List list = query.list();System.out.println(list); ä¹Ÿå¯ä»¥ä¼ é€’å‚æ•°è¿›å»æŸ¥è¯¢ 1234567Query query = session.createQuery(\"FROM User WHERE id=?\");//è¿™é‡Œçš„ï¼Ÿå·æ˜¯ä»0å¼€å§‹çš„ï¼Œå¹¶ä¸åƒJDBCä»1å¼€å§‹çš„ï¼query.setParameter(0, user.getId());List list = query.list();System.out.println(list); QBCæŸ¥è¯¢QBCæŸ¥è¯¢: query by criteria å®Œå…¨é¢å‘å¯¹è±¡çš„æŸ¥è¯¢ ä»ä¸Šé¢çš„HQLæŸ¥è¯¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç°ï¼šHQLæŸ¥è¯¢æ˜¯éœ€è¦SQLçš„åŸºç¡€çš„ï¼Œå› ä¸ºè¿˜æ˜¯è¦å†™å°‘éƒ¨åˆ†çš„SQLä»£ç â€¦.QBCæŸ¥è¯¢å°±æ˜¯å®Œå…¨çš„é¢å‘å¯¹è±¡æŸ¥è¯¢â€¦ä½†æ˜¯å‘¢ï¼Œæˆ‘ä»¬ç”¨å¾—æ¯”è¾ƒå°‘ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ€ä¹ˆä½¿ç”¨å§ï¼š 123456789//åˆ›å»ºå…³äºuserå¯¹è±¡çš„criteriaå¯¹è±¡Criteria criteria = session.createCriteria(User.class);//æ·»åŠ æ¡ä»¶criteria.add(Restrictions.eq(\"id\", 1));//æŸ¥è¯¢å…¨éƒ¨æ•°æ®List list = criteria.list();System.out.println(list); æœ¬åœ°SQLæŸ¥è¯¢æœ‰çš„æ—¶å€™ï¼Œå¦‚æœSQLæ˜¯éå¸¸å¤æ‚çš„ï¼Œæˆ‘ä»¬ä¸èƒ½é HQLæŸ¥è¯¢æ¥å®ç°åŠŸèƒ½çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åŸç”Ÿçš„SQLæ¥è¿›è¡Œå¤æ‚æŸ¥è¯¢äº†ï¼ ä½†æ˜¯å‘¢ï¼Œå®ƒæœ‰ä¸€ä¸ªç¼ºé™·ï¼šå®ƒæ˜¯ä¸èƒ½è·¨å¹³å°çš„â€¦å› æ­¤æˆ‘ä»¬åœ¨ä¸»é…ç½®æ–‡ä»¶ä¸­å·²ç»é…ç½®äº†æ•°æ®åº“çš„â€œæ–¹è¨€â€œäº†ã€‚ æˆ‘ä»¬æ¥ç®€å•ä½¿ç”¨ä¸€ä¸‹æŠŠï¼š 123456//å°†æ‰€æœ‰çš„è®°å½•å°è£…æˆUserå¯¹è±¡å­˜è¿›Listé›†åˆä¸­SQLQuery sqlQuery = session.createSQLQuery(\"SELECT * FROM user\").addEntity(User.class);List list = sqlQuery.list();System.out.println(list); beginTransactionæ–¹æ³•å¼€å¯äº‹åŠ¡ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªäº‹åŠ¡å¯¹è±¡â€¦.Hibernateè§„å®šæ‰€æœ‰çš„æ•°æ®åº“æ“ä½œéƒ½å¿…é¡»åœ¨äº‹åŠ¡ç¯å¢ƒä¸‹è¿›è¡Œï¼Œå¦åˆ™æŠ¥é”™ï¼ ä¸»é…ç½®æ–‡ä»¶ä¸»é…ç½®æ–‡ä»¶ä¸»è¦é…ç½®ï¼š æ•°æ®åº“çš„ä¿¡æ¯ å…¶ä»–å‚æ•° åŠ è½½æ˜ å°„æ–‡ä»¶ å¸¸ç”¨çš„é…ç½®ä¿¡æ¯éƒ½å¯ä»¥åœ¨hibernate-distribution-3.6.0.Final\\project\\etc\\hibernate.propertiesç›®å½•ä¸‹å¯ä»¥æ‰¾åˆ° æ•°æ®åº“ä¿¡æ¯123456789&lt;!-- 1. æ•°æ®åº“è¿æ¥é…ç½® --&gt;&lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;&lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql:///hib_demo&lt;/property&gt;&lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;&lt;property name=\"hibernate.connection.password\"&gt;root&lt;/property&gt;&lt;!-- æ•°æ®åº“æ–¹æ³•é…ç½®ï¼Œ hibernateåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¼šæ ¹æ®ä¸åŒçš„æ–¹è¨€ç”Ÿæˆç¬¦åˆå½“å‰æ•°æ®åº“è¯­æ³•çš„sqlã€å¤§è‡´å¯ä»¥ç†è§£æˆï¼šä¸åŒçš„ç‰ˆæœ¬å¯¹åº”çš„SQLä¸åŒã€‘ --&gt;&lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQL5Dialect&lt;/property&gt; å…¶ä»–å‚æ•°ä¿¡æ¯å¸¸ç”¨çš„æœ‰é‚£ä¹ˆä¸‰ä¸ªï¼š 1234567&lt;!-- 2. å…¶ä»–ç›¸å…³é…ç½® --&gt;&lt;!-- 2.1 æ˜¾ç¤ºhibernateåœ¨è¿è¡Œæ—¶å€™æ‰§è¡Œçš„sqlè¯­å¥ --&gt;&lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;&lt;!-- 2.2 æ ¼å¼åŒ–sql --&gt;&lt;property name=\"hibernate.format_sql\"&gt;true&lt;/property&gt;&lt;!-- 2.3 è‡ªåŠ¨å»ºè¡¨ --&gt;&lt;property name=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/property&gt; éœ€è¦æˆ‘ä»¬æ³¨æ„çš„æ˜¯è‡ªåŠ¨å»ºè¡¨ï¼Œå…¶ä¸­å®ƒæœ‰å‡ ä¸ªå‚æ•°ï¼š create-drop æ¯æ¬¡åœ¨åˆ›å»ºsessionFactoryæ—¶å€™æ‰§è¡Œåˆ›å»ºè¡¨ã€‚å½“è°ƒç”¨sesisonFactoryçš„closeæ–¹æ³•çš„æ—¶å€™ï¼Œåˆ é™¤è¡¨ï¼ create æ¯æ¬¡éƒ½é‡æ–°å»ºè¡¨ï¼› å¦‚æœè¡¨å·²ç»å­˜åœ¨å°±å…ˆåˆ é™¤å†åˆ›å»º update å¦‚æœè¡¨ä¸å­˜åœ¨å°±åˆ›å»ºï¼› è¡¨å­˜åœ¨å°±ä¸åˆ›å»ºï¼› validate (ç”Ÿæˆç¯å¢ƒæ—¶å€™) æ‰§è¡ŒéªŒè¯ï¼š å½“æ˜ å°„æ–‡ä»¶çš„å†…å®¹ä¸æ•°æ®åº“è¡¨ç»“æ„ä¸ä¸€æ ·çš„æ—¶å€™å°±æŠ¥é”™ï¼ åŠ è½½æ˜ å°„æ–‡ä»¶å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šmappingçš„å±æ€§ä½¿ç”¨çš„æ˜¯resource! 12&lt;!--3. åŠ è½½æ˜ å°„æ–‡ä»¶--&gt;&lt;mapping resource=\"xiaoqinghua/domain/User.hbm.xml\"/&gt; åŠ è½½æ˜ å°„æ–‡ä»¶å…¶å®æˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºä¸­åŠ è½½ï¼Œä¸ä¸€å®šåœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®â€¦.ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬åœ¨æµ‹è¯•çš„æ—¶å€™ä¸€èˆ¬ä½¿ç”¨ç¨‹åºçš„æ–¹å¼å»åŠ è½½æ˜ å°„æ–‡ä»¶ é‚£ä¹ˆæ€ä¹ˆåœ¨ç¨‹åºä¸­åŠ è½½æ˜ å°„æ–‡ä»¶å‘¢ï¼Ÿ åœ¨Configurationå¯¹è±¡ä¸­æä¾›äº†addClass()çš„æ–¹æ³•ã€‚ ä¸€èˆ¬åœ°æˆ‘ä»¬çš„æ˜ å°„é…ç½®æ–‡ä»¶å’ŒJavaBeanå¯¹è±¡æ˜¯æ”¾åœ¨åŒä¸€ä¸ªåŒ…ä¸‹çš„ã€‚å¹¶ä¸”æ˜ å°„æ–‡ä»¶çš„å‘½åæ˜¯æœ‰è§„èŒƒçš„ã€‚å› æ­¤Hibernateæ˜¯å¯ä»¥é€šè¿‡æä¾›çš„JavaBeanå¯¹è±¡ä»è€Œæ‰¾åˆ°ç›¸å¯¹åº”çš„æ˜ å°„æ–‡ä»¶ï¼ 12345//è·å–åŠ è½½é…ç½®ç®¡ç†ç±»Configuration configuration = new Configuration();//åŠ è½½Userçš„æ˜ å°„æ–‡ä»¶ï¼configuration.configure().addClass(User.class); æ˜ å°„é…ç½®æ–‡ä»¶æ˜ å°„æ–‡ä»¶: æ˜ å°„ä¸€ä¸ªå®ä½“ç±»å¯¹è±¡ï¼› æè¿°ä¸€ä¸ªå¯¹è±¡æœ€ç»ˆå®ç°å¯ä»¥ç›´æ¥ä¿å­˜å¯¹è±¡æ•°æ®åˆ°æ•°æ®åº“ä¸­ é€šå¸¸åœ°ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¸€ä¸ªJavaBeanå¯¹è±¡å¯¹åº”ä¸€ä¸ªæ˜ å°„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”é…ç½®æ–‡ä»¶å’ŒJavaBeanå¯¹è±¡æ˜¯æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹çš„ æˆ‘ä»¬æŒ‰ç…§å¿«é€Ÿå…¥é—¨çš„æ˜ å°„é…ç½®æ–‡ä»¶ä¸€æ­¥ä¸€æ­¥æ¥è®²è§£ï¼š 12345678910111213141516171819&lt;!--åœ¨domainåŒ…ä¸‹--&gt;&lt;hibernate-mapping package=\"xiaoqinghua.domain\"&gt; &lt;!--ç±»åä¸ºUserï¼Œè¡¨åä¹Ÿä¸ºUser--&gt; &lt;class name=\"User\" table=\"user\"&gt; &lt;!--ä¸»é”®æ˜ å°„ï¼Œå±æ€§åä¸ºidï¼Œåˆ—åä¹Ÿä¸ºid--&gt; &lt;id name=\"id\" column=\"id\"&gt; &lt;!--æ ¹æ®åº•å±‚æ•°æ®åº“ä¸»é”®è‡ªåŠ¨å¢é•¿--&gt; &lt;generator class=\"native\"/&gt; &lt;/id&gt; &lt;!--éä¸»é”®æ˜ å°„ï¼Œå±æ€§å’Œåˆ—åä¸€ä¸€å¯¹åº”--&gt; &lt;property name=\"username\" column=\"username\"/&gt; &lt;property name=\"cellphone\" column=\"cellphone\"/&gt; &lt;property name=\"password\" column=\"password\"/&gt; &lt;/class&gt;&lt;/hibernate-mapping&gt; hibernate-mappingèŠ‚ç‚¹ å¸¸ç”¨çš„å±æ€§ï¼š package è¦æ˜ å°„çš„å¯¹è±¡æ‰€åœ¨çš„åŒ…(å¯é€‰,å¦‚æœä¸æŒ‡å®š,æ­¤æ–‡ä»¶æ‰€æœ‰çš„ç±»éƒ½è¦æŒ‡å®šå…¨è·¯å¾„) auto-import é»˜è®¤ä¸ºtrueï¼Œ åœ¨å†™hqlçš„æ—¶å€™è‡ªåŠ¨å¯¼å…¥åŒ…å å¦‚æœæŒ‡å®šä¸ºfalse, å†å†™hqlçš„æ—¶å€™å¿…é¡»è¦å†™ä¸Šç±»çš„å…¨åï¼› classèŠ‚ç‚¹ class æ˜ å°„æŸä¸€ä¸ªå¯¹è±¡çš„(ä¸€èˆ¬æƒ…å†µï¼Œä¸€ä¸ªå¯¹è±¡å†™ä¸€ä¸ªæ˜ å°„æ–‡ä»¶ï¼Œå³ä¸€ä¸ªclassèŠ‚ç‚¹) å¸¸ç”¨çš„å±æ€§ï¼š name æŒ‡å®šè¦æ˜ å°„çš„å¯¹è±¡çš„ç±»å‹ table æŒ‡å®šå¯¹è±¡å¯¹åº”çš„è¡¨ å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤ä¸å¯¹è±¡åç§°ä¸€æ · propertyèŠ‚ç‚¹ propertyæ˜¯æ™®é€šå±æ€§çš„æ˜ å°„ï¼Œå³JavaBeanæ™®é€šçš„æˆå‘˜å˜é‡å±æ€§å°±ä½¿ç”¨propertyæ¥æè¿°ï¼ å¸¸ç”¨çš„å±æ€§ï¼š name æŒ‡å®šå¯¹è±¡çš„å±æ€§åç§° column æŒ‡å®šå¯¹è±¡å±æ€§å¯¹åº”çš„è¡¨çš„å­—æ®µåç§° å¦‚æœä¸å†™é»˜è®¤ä¸å¯¹è±¡å±æ€§ä¸€è‡´ã€‚ length æŒ‡å®šå­—ç¬¦çš„é•¿åº¦, é»˜è®¤ä¸º255 type æŒ‡å®šæ˜ å°„è¡¨çš„å­—æ®µçš„ç±»å‹ï¼Œå¦‚æœä¸æŒ‡å®šä¼šåŒ¹é…å±æ€§çš„ç±»å‹ javaç±»å‹ï¼š å¿…é¡»å†™å…¨åã€ä¾‹ï¼šjava.lang.Stringã€‘ hibernateç±»å‹ï¼š ç›´æ¥å†™ç±»å‹ï¼Œéƒ½æ˜¯å°å†™ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå¦‚æœåˆ—åç§°ä¸ºæ•°æ®åº“å…³é”®å­—ï¼Œéœ€è¦ç”¨åå¼•å·æˆ–æ”¹åˆ—åã€‚å½“ç„¶å•¦ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä½¿ç”¨å…³é”®å­—æ¥ä½œä¸ºåˆ—å idèŠ‚ç‚¹ idæ˜¯ä¸»é”®æ˜ å°„â€¦. name æŒ‡å®šå¯¹è±¡çš„å±æ€§å column æŒ‡å®šå¯¹è±¡å±æ€§å¯¹åº”çš„è¡¨çš„å­—æ®µåç§° &lt;id&gt;èŠ‚ç‚¹ä¸‹è¿˜æœ‰å­èŠ‚ç‚¹&lt;generator class=&quot;&quot;/&gt; ä¸»é”®çš„è‡ªåŠ¨ç”Ÿæˆç­–ç•¥ identity è‡ªå¢é•¿(mysql,db2) sequence è‡ªå¢é•¿(åºåˆ—)ï¼Œ oracleä¸­è‡ªå¢é•¿æ˜¯ä»¥åºåˆ—æ–¹æ³•å®ç° native è‡ªå¢é•¿ä¼šæ ¹æ®åº•å±‚æ•°æ®åº“è‡ªå¢é•¿çš„æ–¹å¼é€‰æ‹©identityæˆ–sequence å¦‚æœæ˜¯mysqlæ•°æ®åº“, é‡‡ç”¨çš„è‡ªå¢é•¿æ–¹å¼æ˜¯identity å¦‚æœæ˜¯oracleæ•°æ®åº“ï¼Œ ä½¿ç”¨sequenceåºåˆ—çš„æ–¹å¼å®ç°è‡ªå¢é•¿ increment è‡ªå¢é•¿(ä¼šæœ‰å¹¶å‘è®¿é—®çš„é—®é¢˜ï¼Œä¸€èˆ¬åœ¨æœåŠ¡å™¨é›†ç¾¤ç¯å¢ƒä½¿ç”¨ä¼šå­˜åœ¨é—®é¢˜ã€‚) æŒ‡å®šä¸»é”®ç”Ÿæˆç­–ç•¥ä¸ºæ‰‹åŠ¨æŒ‡å®šä¸»é”®çš„å€¼ assigned æŒ‡å®šä¸»é”®ç”Ÿæˆç­–ç•¥ä¸ºUUIDç”Ÿæˆçš„å€¼ uuid foreign(å¤–é”®çš„æ–¹å¼ï¼Œ one-to-oneè®²) composite-id ä¸»é”®ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ï¼š å•åˆ—ä¸»é”® å¤šåˆ—å¤åˆä¸»é”® å•åˆ—ä¸»é”®å°±æ˜¯ä¸Šé¢é‚£ç§ï¼Œé‚£ä¹ˆå¦‚æœè¦ä½¿ç”¨å¤šåˆ—å¤åˆä¸»é”®å°±éœ€è¦ä½¿ç”¨&lt;composite-id&gt;èŠ‚ç‚¹æ¥é…ç½®äº† ç°åœ¨æˆ‘æœ‰è¿™ä¹ˆä¸‹é¢çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘æƒ³ä½¿ç”¨usernameå’Œpasswordä½œä¸ºå¤åˆä¸»é”® å°†usernameå’ŒpasswordæŠ½å–æˆä¸€ä¸ªç±»â€”-&gt;CompositeKeyâ€¦.å¿…é¡»å®ç°Serializableæ¥å£ åœ¨User2ä¸­éœ€è¦æŒ‡å®šä¸€ä¸ªå˜é‡æ¥ç»´æŠ¤è¿™ä¸ªä¸»é”®å¯¹è±¡","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Hibernate","slug":"Code/Hibernate","permalink":"http://xiaoqinghua.site/categories/Code/Hibernate/"}],"tags":[{"name":"Hibernate","slug":"Hibernate","permalink":"http://xiaoqinghua.site/tags/Hibernate/"}]},{"title":"MyBatisæ€»ç»“","slug":"MyBatisæ€»ç»“","date":"2017-12-10T05:22:36.000Z","updated":"2018-09-07T12:51:32.148Z","comments":true,"path":"MyBatisæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/MyBatisæ€»ç»“.html","excerpt":"","text":"MyBatis ç®€ä»‹MyBatis æœ¬æ˜¯apacheçš„ä¸€ä¸ªå¼€æºé¡¹ç›®iBatis, 2010å¹´è¿™ä¸ªé¡¹ç›®ç”±apache software foundation è¿ç§»åˆ°äº†google codeï¼Œå¹¶ä¸”æ”¹åä¸ºMyBatisï¼Œæ˜¯ä¸€ä¸ªåŸºäºJavaçš„æŒä¹…å±‚æ¡†æ¶ã€‚ æŒä¹…å±‚ï¼š å¯ä»¥å°†ä¸šåŠ¡æ•°æ®å­˜å‚¨åˆ°ç£ç›˜ï¼Œå…·å¤‡é•¿æœŸå­˜å‚¨èƒ½åŠ›ï¼Œåªè¦ç£ç›˜ä¸æŸåï¼Œåœ¨æ–­ç”µæˆ–è€…å…¶ä»–æƒ…å†µä¸‹ï¼Œé‡æ–°å¼€å¯ç³»ç»Ÿä»ç„¶å¯ä»¥è¯»å–åˆ°è¿™äº›æ•°æ®ã€‚ ä¼˜ç‚¹ï¼š å¯ä»¥ä½¿ç”¨å·¨å¤§çš„ç£ç›˜ç©ºé—´å­˜å‚¨ç›¸å½“é‡çš„æ•°æ®ï¼Œå¹¶ä¸”å¾ˆå»‰ä»· ç¼ºç‚¹ï¼šæ…¢ï¼ˆç›¸å¯¹äºå†…å­˜è€Œè¨€ï¼‰ ä¸ºä»€ä¹ˆä½¿ç”¨ MyBatisåœ¨æˆ‘ä»¬ä¼ ç»Ÿçš„ JDBC ä¸­ï¼Œæˆ‘ä»¬é™¤äº†éœ€è¦è‡ªå·±æä¾› SQL å¤–ï¼Œè¿˜å¿…é¡»æ“ä½œ Connectionã€Statmentã€ResultSetï¼Œä¸ä»…å¦‚æ­¤ï¼Œä¸ºäº†è®¿é—®ä¸åŒçš„è¡¨ï¼Œä¸åŒå­—æ®µçš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦äº›å¾ˆå¤šé›·åŒæ¨¡æ¿åŒ–çš„ä»£ç ï¼Œé—²çš„ç¹çåˆæ¯ç‡¥ã€‚ è€Œæˆ‘ä»¬åœ¨ä½¿ç”¨äº† MyBatis ä¹‹åï¼Œåªéœ€è¦æä¾› SQL è¯­å¥å°±å¥½äº†ï¼Œå…¶ä½™çš„è¯¸å¦‚ï¼šå»ºç«‹è¿æ¥ã€æ“ä½œ Statmentã€ResultSetï¼Œå¤„ç† JDBC ç›¸å…³å¼‚å¸¸ç­‰ç­‰éƒ½å¯ä»¥äº¤ç»™ MyBatis å»å¤„ç†ï¼Œæˆ‘ä»¬çš„å…³æ³¨ç‚¹äºæ˜¯å¯ä»¥å°±æ­¤é›†ä¸­åœ¨ SQL è¯­å¥ä¸Šï¼Œå…³æ³¨åœ¨å¢åˆ æ”¹æŸ¥è¿™äº›æ“ä½œå±‚é¢ä¸Šã€‚ å¹¶ä¸” MyBatis æ”¯æŒä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚ ç¬¬ä¸€ä¸ª MyBatis ç¨‹åºæ¥å®é™…å¼€å‘ä¸€ä¸ª MyBatis ç¨‹åºï¼Œæ„Ÿå—ä¸€ä¸‹ã€‚ å‡†å¤‡æ•°æ®åº“ é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ã€mybatisã€‘ï¼Œç¼–ç æ–¹å¼è®¾ç½®ä¸º UTF-8ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ªåä¸ºã€studentã€‘çš„è¡¨ï¼Œæ’å…¥å‡ è¡Œæ•°æ®ï¼š 1234567891011121314DROP DATABASE IF EXISTS mybatis;CREATE DATABASE mybatis DEFAULT CHARACTER SET utf8;use mybatis;CREATE TABLE student( id int(11) NOT NULL AUTO_INCREMENT, studentID int(11) NOT NULL UNIQUE, name varchar(255) NOT NULL, PRIMARY KEY (id)) ENGINE=InnoDB DEFAULT CHARSET=utf8;INSERT INTO student VALUES(1,1,'å°æ¸…å');INSERT INTO student VALUES(2,2,'å°æ¸…å');INSERT INTO student VALUES(3,3,'å°æ¸…å'); åˆ›å»ºå®ä½“ç±» åœ¨ Packageã€pojoã€‘ä¸‹æ–°å»ºå®ä½“ç±»ã€Studentã€‘ï¼Œç”¨äºæ˜ å°„è¡¨ studentï¼š 12345678910package pojo;public class Student &#123; int id; int studentID; String name; /* getter and setter */&#125; é…ç½®æ–‡ä»¶ mybatis-config.xml åœ¨ã€srcã€‘ç›®å½•ä¸‹åˆ›å»º MyBaits çš„ä¸»é…ç½®æ–‡ä»¶ mybatis-config.xml ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯æä¾›è¿æ¥æ•°æ®åº“ç”¨çš„é©±åŠ¨ï¼Œæ•°æ®åç§°ï¼Œç¼–ç æ–¹å¼ï¼Œè´¦å·å¯†ç ç­‰ï¼Œæˆ‘ä»¬åœ¨åé¢è¯´æ˜ï¼š 1234567891011121314151617181920212223242526&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE configuration PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;&lt;configuration&gt; &lt;!-- åˆ«å --&gt; &lt;typeAliases&gt; &lt;package name=\"pojo\"/&gt; &lt;/typeAliases&gt; &lt;!-- æ•°æ®åº“ç¯å¢ƒ --&gt; &lt;environments default=\"development\"&gt; &lt;environment id=\"development\"&gt; &lt;transactionManager type=\"JDBC\"/&gt; &lt;dataSource type=\"POOLED\"&gt; &lt;property name=\"driver\" value=\"com.mysql.jdbc.Driver\"/&gt; &lt;property name=\"url\" value=\"jdbc:mysql://localhost:3306/mybatis?characterEncoding=UTF-8\"/&gt; &lt;property name=\"username\" value=\"root\"/&gt; &lt;property name=\"password\" value=\"root\"/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;!-- æ˜ å°„æ–‡ä»¶ --&gt; &lt;mappers&gt; &lt;mapper resource=\"pojo/Student.xml\"/&gt; &lt;/mappers&gt;&lt;/configuration&gt; é…ç½®æ–‡ä»¶ Student.xml åœ¨ Packageã€pojoã€‘ä¸‹æ–°å»ºä¸€ä¸ªã€Student.xmlã€‘æ–‡ä»¶ï¼š 12345678910&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;&lt;mapper namespace=\"pojo\"&gt; &lt;select id=\"listStudent\" resultType=\"Student\"&gt; select * from student &lt;/select&gt;&lt;/mapper&gt; ç”±äºä¸Šé¢é…ç½®äº† &lt;typeAliases&gt; åˆ«åï¼Œæ‰€ä»¥åœ¨è¿™é‡Œçš„ resultType å¯ä»¥ç›´æ¥å†™ Studentï¼Œè€Œä¸ç”¨å†™ç±»çš„å…¨é™å®šå pojo.Student namespace å±æ€§å…¶å®å°±æ˜¯å¯¹ SQL è¿›è¡Œåˆ†ç±»ç®¡ç†ï¼Œå®ç°ä¸åŒä¸šåŠ¡çš„ SQL éš”ç¦» SQL è¯­å¥çš„å¢åˆ æ”¹æŸ¥å¯¹åº”çš„æ ‡ç­¾ ç¼–å†™æµ‹è¯•ç±» åœ¨ Packageã€testã€‘å°åˆ›å»ºæµ‹è¯•ç±»ã€TestMyBatisã€‘ï¼š 1234567891011121314151617181920212223242526272829package test;import org.apache.ibatis.io.Resources;import org.apache.ibatis.session.SqlSession;import org.apache.ibatis.session.SqlSessionFactory;import org.apache.ibatis.session.SqlSessionFactoryBuilder;import pojo.Student;import java.io.IOException;import java.io.InputStream;import java.util.List;public class TestMyBatis &#123; public static void main(String[] args) throws IOException &#123; // æ ¹æ® mybatis-config.xml é…ç½®çš„ä¿¡æ¯å¾—åˆ° sqlSessionFactory String resource = \"mybatis-config.xml\"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); // ç„¶åæ ¹æ® sqlSessionFactory å¾—åˆ° session SqlSession session = sqlSessionFactory.openSession(); // æœ€åé€šè¿‡ session çš„ selectList() æ–¹æ³•è°ƒç”¨ sql è¯­å¥ listStudent List&lt;Student&gt; listStudent = session.selectList(\"listStudent\"); for (Student student : listStudent) &#123; System.out.println(\"ID:\" + student.getId() + \",NAME:\" + student.getName()); &#125; &#125;&#125; è¾“å‡ºï¼š 1234ID:1,NAME:å°æ¸…åID:2,NAME:å°æ¸…åID:3,NAME:å°æ¸…å åŸºæœ¬åŸç† åº”ç”¨ç¨‹åºæ‰¾ MyBatis è¦æ•°æ® MyBatis ä»æ•°æ®åº“ä¸­æ‰¾æ¥æ•°æ® 1.é€šè¿‡ mybatis-config.xml å®šä½å“ªä¸ªæ•°æ®åº“ 2.é€šè¿‡ Student.xml æ‰§è¡Œå¯¹åº”çš„ sql è¯­å¥ 3.åŸºäº Student.xml æŠŠè¿”å›çš„æ•°æ®åº“å°è£…åœ¨ Student å¯¹è±¡ä¸­ 4.æŠŠå¤šä¸ª Student å¯¹è±¡è£…è½½ä¸€ä¸ª Student é›†åˆä¸­ è¿”å›ä¸€ä¸ª Student é›†åˆ CRUD æ“ä½œæˆ‘ä»¬æ¥çœ‹çœ‹å¸¸è§„çš„ä¸€å¥—å¢åˆ æ”¹æŸ¥åº”è¯¥æ€ä¹ˆå®ç°ï¼š é…ç½® Student.xml é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ SQL æ˜ å°„æ–‡ä»¶ä¸­æ–°å¢è¯­å¥ï¼Œç”¨æ¥æ”¯æ’‘ CRUD çš„ç³»åˆ—æ“ä½œ 1234567891011121314151617181920212223242526&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;&lt;mapper namespace=\"pojo\"&gt; &lt;select id=\"listStudent\" resultType=\"Student\"&gt; select * from student &lt;/select&gt; &lt;insert id=\"addStudent\" parameterType=\"Student\"&gt; insert into student (id, studentID, name) values (#&#123;id&#125;,#&#123;studentID&#125;,#&#123;name&#125;) &lt;/insert&gt; &lt;delete id=\"deleteStudent\" parameterType=\"Student\"&gt; delete from student where id = #&#123;id&#125; &lt;/delete&gt; &lt;select id=\"getStudent\" parameterType=\"_int\" resultType=\"Student\"&gt; select * from student where id= #&#123;id&#125; &lt;/select&gt; &lt;update id=\"updateStudent\" parameterType=\"Student\"&gt; update student set name=#&#123;name&#125; where id=#&#123;id&#125; &lt;/update&gt;&lt;/mapper&gt; parameterTypeï¼šè¦æ±‚è¾“å…¥å‚æ•°çš„ç±»å‹ resultTypeï¼šè¾“å‡ºçš„ç±»å‹ å®ç°å¢åˆ æ”¹æŸ¥1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253package test;import org.apache.ibatis.io.Resources;import org.apache.ibatis.session.SqlSession;import org.apache.ibatis.session.SqlSessionFactory;import org.apache.ibatis.session.SqlSessionFactoryBuilder;import pojo.Student;import java.io.IOException;import java.io.InputStream;import java.util.List;public class TestMyBatis &#123; public static void main(String[] args) throws IOException &#123; // æ ¹æ® mybatis-config.xml é…ç½®çš„ä¿¡æ¯å¾—åˆ° sqlSessionFactory String resource = \"mybatis-config.xml\"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); // ç„¶åæ ¹æ® sqlSessionFactory å¾—åˆ° session SqlSession session = sqlSessionFactory.openSession(); // å¢åŠ å­¦ç”Ÿ Student student1 = new Student(); student1.setId(4); student1.setStudentID(4); student1.setName(\"æ–°å¢åŠ çš„å­¦ç”Ÿ\"); session.insert(\"addStudent\", student1); // åˆ é™¤å­¦ç”Ÿ Student student2 = new Student(); student2.setId(1); session.delete(\"deleteStudent\", student2); // è·å–å­¦ç”Ÿ Student student3 = session.selectOne(\"getStudent\", 2); // ä¿®æ”¹å­¦ç”Ÿ student3.setName(\"ä¿®æ”¹çš„å­¦ç”Ÿ\"); session.update(\"updateStudent\", student3); // æœ€åé€šè¿‡ session çš„ selectList() æ–¹æ³•è°ƒç”¨ sql è¯­å¥ listStudent List&lt;Student&gt; listStudent = session.selectList(\"listStudent\"); for (Student student : listStudent) &#123; System.out.println(\"ID:\" + student.getId() + \",NAME:\" + student.getName()); &#125; // æäº¤ä¿®æ”¹ session.commit(); // å…³é—­ session session.close(); &#125;&#125; é€šè¿‡ session.insert(â€œaddStudentâ€, student1); å¢åŠ äº†ä¸€ä¸ª ID å’Œ studentID éƒ½ä¸º 4ï¼Œåå­—ä¸ºâ€œæ–°å¢åŠ çš„å­¦ç”Ÿâ€ çš„å­¦ç”Ÿ é€šè¿‡ session.delete(â€œdeleteStudentâ€, student2); åˆ é™¤äº† ID = 1 çš„å­¦ç”Ÿ é€šè¿‡ Student student3 = session.selectOne(â€œgetStudentâ€, 2); è·å–äº† ID = 2çš„å­¦ç”Ÿ é€šè¿‡ session.update(â€œupdateStudentâ€, student3); å°† ID = 2 çš„å­¦ç”Ÿçš„åå­—ä¿®æ”¹ä¸º â€œä¿®æ”¹çš„å­¦ç”Ÿâ€ é€šè¿‡ session.commit() æ¥æäº¤äº‹åŠ¡ï¼Œä¹Ÿå¯ä»¥ç®€å•ç†è§£ä¸ºæ›´æ–°åˆ°æ•°æ®åº“ æ¨¡ç³ŠæŸ¥è¯¢å¦‚æœè¦å¯¹æ•°æ®åº“ä¸­çš„ student è¡¨è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼Œéœ€è¦é€šè¿‡åŒ¹é…åå­—ä¸­çš„æŸä¸ªå­—æ¥æŸ¥è¯¢è¯¥ç”¨æˆ·ã€‚ æˆ‘ä»¬é¦–å…ˆåœ¨ Student.xml é…ç½®æ–‡ä»¶ä¸­é…ç½® SQL æ˜ å°„ï¼š 123&lt;select id=\"findStudentByName\" parameterMap=\"java.lang.String\" resultType=\"Student\"&gt; SELECT * FROM student WHERE name LIKE '%$&#123;value&#125;%' &lt;/select&gt; select æ ‡ç­¾å¯¹ä¸­ SQL è¯­å¥çš„ â€œ${}â€ ç¬¦å·ï¼Œè¡¨ç¤ºæ‹¼æ¥ SQL ä¸²ï¼Œå°†æ¥å—çš„å‚æ•°å†…å®¹ä¸åŠ ä»»ä½•ä¿®é¥°åœ°æ‹¼æ¥åœ¨ SQL ä¸­ï¼Œåœ¨ â€œ${}â€ ä¸­åªèƒ½ä½¿ç”¨ value æ¥ä»£è¡¨å…¶ä¸­çš„å‚æ•° å› ä¸ºæ˜¯æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ‰€ä»¥å¾—åˆ°çš„æŸ¥è¯¢ç»“æœå¯èƒ½ä¸æ­¢ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ SqlSession çš„ selectList() æ–¹æ³•ï¼Œå†™ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼š 12345678910111213141516@Testpublic void test() throws IOException &#123; // æ ¹æ® mybatis-config.xml é…ç½®çš„ä¿¡æ¯å¾—åˆ° sqlSessionFactory String resource = \"mybatis-config.xml\"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); // ç„¶åæ ¹æ® sqlSessionFactory å¾—åˆ° session SqlSession session = sqlSessionFactory.openSession(); // æ¨¡ç³ŠæŸ¥è¯¢ List&lt;Student&gt; students = session.selectList(\"findStudentByName\", \"å°\"); for (Student student : students) &#123; System.out.println(\"ID:\" + student.getId() + \",NAME:\" + student.getName()); &#125;&#125; æ€»ç»“ï¼š å…³äº parameterTypeï¼š å°±æ˜¯ç”¨æ¥åœ¨ SQL æ˜ å°„æ–‡ä»¶ä¸­æŒ‡å®šè¾“å…¥å‚æ•°ç±»å‹çš„ï¼Œå¯ä»¥æŒ‡å®šä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚ intã€float ç­‰ï¼‰ã€åŒ…è£…æ•°æ®ç±»å‹ï¼ˆå¦‚ Stringã€Interger ç­‰ï¼‰ä»¥åŠç”¨æˆ·è‡ªå·±ç¼–å†™çš„ JavaBean å°è£…ç±» å…³äº resultTypeï¼š åœ¨åŠ è½½ SQL é…ç½®ï¼Œå¹¶ç»‘å®šæŒ‡å®šè¾“å…¥å‚æ•°å’Œè¿è¡Œ SQL ä¹‹åï¼Œä¼šå¾—åˆ°æ•°æ®åº“è¿”å›çš„å“åº”ç»“æœï¼Œæ­¤æ—¶ä½¿ç”¨ resultType å°±æ˜¯ç”¨æ¥æŒ‡å®šæ•°æ®åº“è¿”å›çš„ä¿¡æ¯å¯¹åº”çš„ Java çš„æ•°æ®ç±»å‹ã€‚ å…³äº â€œ#{}â€ ï¼š åœ¨ä¼ ç»Ÿçš„ JDBC çš„ç¼–ç¨‹ä¸­ï¼Œå ä½ç¬¦ç”¨ â€œ?â€ æ¥è¡¨ç¤ºï¼Œç„¶åå†åŠ è½½ SQL ä¹‹å‰æŒ‰ç…§ â€œ?â€ çš„ä½ç½®è®¾ç½®å‚æ•°ã€‚è€Œ â€œ#{}â€ åœ¨ MyBatis ä¸­ä¹Ÿä»£è¡¨ä¸€ç§å ä½ç¬¦ï¼Œè¯¥ç¬¦å·æ¥å—è¾“å…¥å‚æ•°ï¼Œåœ¨å¤§æ‹¬å·ä¸­ç¼–å†™å‚æ•°åç§°æ¥æ¥å—å¯¹åº”å‚æ•°ã€‚å½“ â€œ#{}â€ æ¥å—ç®€å•ç±»å‹æ—¶å¯ä»¥ç”¨ value æˆ–è€…å…¶ä»–ä»»æ„åç§°æ¥è·å–ã€‚ å…³äº â€œ${}â€ ï¼š åœ¨ SQL é…ç½®ä¸­ï¼Œæœ‰æ—¶å€™éœ€è¦æ‹¼æ¥ SQL è¯­å¥ï¼ˆä¾‹å¦‚æ¨¡ç³ŠæŸ¥è¯¢æ—¶ï¼‰ï¼Œç”¨ â€œ#{}â€ æ˜¯æ— æ³•è¾¾åˆ°ç›®çš„çš„ã€‚åœ¨ MyBatis ä¸­ï¼Œâ€œ${}â€ ä»£è¡¨ä¸€ä¸ª â€œæ‹¼æ¥ç¬¦å·â€ ï¼Œå¯ä»¥åœ¨åŸæœ‰ SQL è¯­å¥ä¸Šæ‹¼æ¥æ–°çš„ç¬¦åˆ SQL è¯­æ³•çš„è¯­å¥ã€‚ä½¿ç”¨ â€œ${}â€ æ‹¼æ¥ç¬¦å·æ‹¼æ¥ SQL ï¼Œä¼šå¼•èµ· SQL æ³¨å…¥ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨ â€œ${}â€ã€‚ MyBatis ä½¿ç”¨åœºæ™¯ï¼š é€šè¿‡ä¸Šé¢çš„å…¥é—¨ç¨‹åºï¼Œä¸éš¾çœ‹å‡ºåœ¨è¿›è¡Œ MyBatis å¼€å‘æ—¶ï¼Œæˆ‘ä»¬çš„å¤§éƒ¨åˆ†ç²¾åŠ›éƒ½æ”¾åœ¨äº† SQL æ˜ å°„æ–‡ä»¶ä¸Šã€‚ MyBatis çš„ç‰¹ç‚¹å°±æ˜¯ä»¥ SQL è¯­å¥ä¸ºæ ¸å¿ƒçš„ä¸å®Œå…¨çš„ ORMï¼ˆå…³ç³»å‹æ˜ å°„ï¼‰æ¡†æ¶ã€‚ä¸ Hibernate ç›¸æ¯”ï¼ŒHibernate çš„å­¦ä¹ æˆæœ¬æ¯”è¾ƒé«˜ï¼Œè€Œ SQL è¯­å¥å¹¶ä¸éœ€è¦å¼€å‘äººå‘˜å®Œæˆï¼Œåªéœ€è¦è°ƒç”¨ç›¸å…³ API å³å¯ã€‚è¿™å¯¹äºå¼€å‘æ•ˆç‡æ˜¯ä¸€ä¸ªä¼˜åŠ¿ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯æ²¡åŠæ³•å¯¹ SQL è¯­å¥è¿›è¡Œä¼˜åŒ–å’Œä¿®æ”¹ã€‚è€Œ MyBatis è™½ç„¶éœ€è¦å¼€å‘äººå‘˜è‡ªå·±é…ç½® SQL è¯­å¥ï¼ŒMyBatis æ¥å®ç°æ˜ å°„å…³ç³»ï¼Œä½†æ˜¯è¿™æ ·çš„é¡¹ç›®å¯ä»¥é€‚åº”ç»å¸¸å˜åŒ–çš„é¡¹ç›®éœ€æ±‚ã€‚æ‰€ä»¥ä½¿ç”¨ MyBatis çš„åœºæ™¯æ˜¯ï¼šå¯¹ SQL ä¼˜åŒ–è¦æ±‚æ¯”è¾ƒé«˜ï¼Œæˆ–æ˜¯é¡¹ç›®éœ€æ±‚æˆ–ä¸šåŠ¡ç»å¸¸å˜åŠ¨ã€‚ MyBatis ç¼“å­˜ç»“æ„åœ¨ Web ç³»ç»Ÿä¸­ï¼Œæœ€é‡è¦çš„æ“ä½œå°±æ˜¯æŸ¥è¯¢æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™æŸ¥è¯¢æ•°æ®çš„é¢‘ç‡éå¸¸é«˜ï¼Œè¿™æ˜¯å¾ˆè€—è´¹æ•°æ®åº“èµ„æºçš„ï¼Œå¾€å¾€ä¼šå¯¼è‡´æ•°æ®åº“æŸ¥è¯¢æ•ˆç‡æä½ï¼Œå½±å“å®¢æˆ·çš„æ“ä½œä½“éªŒã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥å°†ä¸€äº›å˜åŠ¨ä¸å¤§ä¸”è®¿é—®é¢‘ç‡é«˜çš„æ•°æ®ï¼Œæ”¾ç½®åœ¨ä¸€ä¸ªç¼“å­˜å®¹å™¨ä¸­ï¼Œç”¨æˆ·ä¸‹ä¸€æ¬¡æŸ¥è¯¢æ—¶å°±ä»ç¼“å­˜å®¹å™¨ä¸­è·å–ç»“æœã€‚ MyBatis æ‹¥æœ‰è‡ªå·±çš„ç¼“å­˜ç»“æ„ï¼Œå¯ä»¥ç”¨æ¥ç¼“è§£æ•°æ®åº“å‹åŠ›ï¼ŒåŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚ Mybatis ä¸€çº§ç¼“å­˜æ˜¯ä¸€ä¸ªSqlSessionçº§åˆ«ï¼Œsqlsessionåªèƒ½è®¿é—®è‡ªå·±çš„ä¸€çº§ç¼“å­˜çš„æ•°æ® äºŒçº§ç¼“å­˜æ˜¯è·¨sqlSessionï¼Œæ˜¯mapperçº§åˆ«çš„ç¼“å­˜ï¼Œå¯¹äºmapperçº§åˆ«çš„ç¼“å­˜ä¸åŒçš„sqlsessionæ˜¯å¯ä»¥å…±äº«çš„ã€‚ ä¸€çº§æŸ¥è¯¢ç¼“å­˜ä¸€çº§ç¼“å­˜å­˜åœ¨äºæ¯ä¸€ä¸ª SqlSession ç±»çš„å®ä¾‹å¯¹è±¡ä¸­ï¼Œå½“ç¬¬ä¸€æ¬¡æŸ¥è¯¢æŸä¸€ä¸ªæ•°æ®æ—¶ï¼ŒSqlSession ç±»çš„å®ä¾‹å¯¹è±¡ä¼šå°†è¯¥æ•°æ®å­˜å…¥ä¸€çº§ç¼“å­˜åŒºåŸŸï¼Œåœ¨æ²¡æœ‰æ”¶åˆ°æ”¹å˜è¯¥æ•°æ®çš„è¯·æ±‚ä¹‹å‰ï¼Œç”¨æˆ·å†æ¬¡æŸ¥è¯¢è¯¥æ•°æ®ï¼Œéƒ½ä¼šä»ç¼“å­˜ä¸­è·å–è¯¥æ•°æ®ï¼Œè€Œä¸æ˜¯å†æ¬¡è¿æ¥æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ã€‚ MyBatis çš„ä¸€çº§ç¼“å­˜åŸç†ï¼š ç¬¬ä¸€æ¬¡å‘å‡ºä¸€ä¸ªæŸ¥è¯¢ sqlï¼Œsql æŸ¥è¯¢ç»“æœå†™å…¥ sqlsession çš„ä¸€çº§ç¼“å­˜ä¸­ï¼Œç¼“å­˜ä½¿ç”¨çš„æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ª map keyï¼šhashcode + sql + sqlè¾“å…¥å‚æ•° + è¾“å‡ºå‚æ•°ï¼ˆsqlçš„å”¯ä¸€æ ‡è¯†ï¼‰ valueï¼šç”¨æˆ·ä¿¡æ¯ åŒä¸€ä¸ª sqlsession å†æ¬¡å‘å‡ºç›¸åŒçš„ sqlï¼Œå°±ä»ç¼“å­˜ä¸­å–ä¸èµ°æ•°æ®åº“ã€‚å¦‚æœä¸¤æ¬¡ä¸­é—´å‡ºç° commit æ“ä½œï¼ˆä¿®æ”¹ã€æ·»åŠ ã€åˆ é™¤ï¼‰ï¼Œæœ¬ sqlsession ä¸­çš„ä¸€çº§ç¼“å­˜åŒºåŸŸå…¨éƒ¨æ¸…ç©ºï¼Œä¸‹æ¬¡å†å»ç¼“å­˜ä¸­æŸ¥è¯¢ä¸åˆ°æ‰€ä»¥è¦ä»æ•°æ®åº“æŸ¥è¯¢ï¼Œä»æ•°æ®åº“æŸ¥è¯¢åˆ°å†å†™å…¥ç¼“å­˜ã€‚ MyBatis ä¸€çº§ç¼“å­˜å€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼š MyBatis é»˜è®¤å°±æ˜¯æ”¯æŒä¸€çº§ç¼“å­˜çš„ï¼Œå¹¶ä¸éœ€è¦æˆ‘ä»¬é…ç½®. MyBatis å’Œ spring æ•´åˆåè¿›è¡Œ mapper ä»£ç†å¼€å‘ï¼Œä¸æ”¯æŒä¸€çº§ç¼“å­˜ï¼Œmybatis å’Œ spring æ•´åˆï¼Œspring æŒ‰ç…§ mapper çš„æ¨¡æ¿å»ç”Ÿæˆ mapper ä»£ç†å¯¹è±¡ï¼Œæ¨¡æ¿ä¸­åœ¨æœ€åç»Ÿä¸€å…³é—­ sqlsessionã€‚ äºŒçº§æŸ¥è¯¢ç¼“å­˜é—®é¢˜ï¼š æœ‰äº›æ—¶å€™ï¼Œåœ¨ Web å·¥ç¨‹ä¸­ä¼šå°†æ‰§è¡ŒæŸ¥è¯¢æ“ä½œçš„æ–¹æ³•å°è£…åœ¨æŸä¸ª Service æ–¹æ³•ä¸­ï¼Œå½“æŸ¥è¯¢å®Œä¸€æ¬¡åï¼ŒService æ–¹æ³•ç»“æŸï¼Œæ­¤æ—¶ SqlSession ç±»çš„å®ä¾‹å¯¹è±¡å°±ä¼šå…³é—­ï¼Œä¸€çº§ç¼“å­˜å°±ä¼šè¢«æ¸…ç©ºã€‚ äºŒçº§ç¼“å­˜åŸç†ï¼š äºŒçº§ç¼“å­˜çš„èŒƒå›´æ˜¯ mapper çº§åˆ«ï¼ˆmapperå³åŒä¸€ä¸ªå‘½åç©ºé—´ï¼‰ï¼Œmapper ä»¥å‘½åç©ºé—´ä¸ºå•ä½åˆ›å»ºç¼“å­˜æ•°æ®ç»“æ„ï¼Œç»“æ„æ˜¯ mapã€‚ è¦å¼€å¯äºŒçº§ç¼“å­˜ï¼Œéœ€è¦è¿›è¡Œä¸¤æ­¥æ“ä½œ åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ mybatis-config.xml ä¸­é…ç½® settingå±æ€§ï¼Œè®¾ç½®åä¸º â€œcacheEnableâ€ çš„å±æ€§å€¼ä¸º â€œtrueâ€ å³å¯ï¼š 1234&lt;settings&gt; &lt;!-- å¼€å¯äºŒçº§ç¼“å­˜ --&gt; &lt;setting name=\"cacheEnabled\" value=\"true\"/&gt;&lt;/settings&gt; æ³¨æ„ï¼š settings é…ç½®çš„ä½ç½®ä¸€å®šæ˜¯åœ¨ properties åé¢ï¼ŒtypeAliaseså‰é¢ï¼ ç„¶åç”±äºäºŒçº§ç¼“å­˜æ˜¯ Mapper çº§åˆ«çš„ï¼Œè¿˜è¦åœ¨éœ€è¦å¼€å¯äºŒçº§ç¼“å­˜çš„å…·ä½“ mapper.xml æ–‡ä»¶ä¸­å¼€å¯äºŒçº§ç¼“å­˜ï¼Œåªéœ€è¦åœ¨ç›¸åº”çš„ mapper.xml ä¸­æ·»åŠ ä¸€ä¸ª cache æ ‡ç­¾å³å¯ï¼š 12&lt;!-- å¼€å¯æœ¬ Mapper çš„ namespace ä¸‹çš„äºŒçº§ç¼“å­˜ --&gt;&lt;cache /&gt; å¼€å¯äºŒçº§ç¼“å­˜ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæŸ¥è¯¢ç»“æœæ˜ å°„çš„ POJO ç±»å®ç° java.io.serializable æ¥å£ï¼ŒäºŒçº§ç¼“å­˜å¯ä»¥å°†å†…å­˜çš„æ•°æ®å†™åˆ°ç£ç›˜ï¼Œå­˜åœ¨å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæ‰€ä»¥è¦å®ç°java.io.serializableæ¥å£ã€‚","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"MyBatis","slug":"Code/MyBatis","permalink":"http://xiaoqinghua.site/categories/Code/MyBatis/"}],"tags":[{"name":"MyBatis","slug":"MyBatis","permalink":"http://xiaoqinghua.site/tags/MyBatis/"}]},{"title":"Spring MVCæ€»ç»“","slug":"Spring-MVCæ€»ç»“","date":"2017-12-09T05:22:36.000Z","updated":"2018-09-07T10:58:51.813Z","comments":true,"path":"Spring-MVCæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Spring-MVCæ€»ç»“.html","excerpt":"","text":"MVC è®¾è®¡æ¦‚è¿°åœ¨æ—©æœŸ Java Web çš„å¼€å‘ä¸­ï¼Œç»Ÿä¸€æŠŠæ˜¾ç¤ºå±‚ã€æ§åˆ¶å±‚ã€æ•°æ®å±‚çš„æ“ä½œå…¨éƒ¨äº¤ç»™ JSP æˆ–è€… JavaBean æ¥è¿›è¡Œå¤„ç†ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º Model1ï¼š å¼Šç«¯ï¼š JSP å’Œ Java Bean ä¹‹é—´ä¸¥é‡è€¦åˆï¼ŒJava ä»£ç å’Œ HTML ä»£ç ä¹Ÿè€¦åˆåœ¨äº†ä¸€èµ· è¦æ±‚å¼€å‘è€…ä¸ä»…è¦æŒæ¡ Java ï¼Œè¿˜è¦æœ‰é«˜è¶…çš„å‰ç«¯æ°´å¹³ å‰ç«¯å’Œåç«¯ç›¸äº’ä¾èµ–ï¼Œå‰ç«¯éœ€è¦ç­‰å¾…åç«¯å®Œæˆï¼Œåç«¯ä¹Ÿä¾èµ–å‰ç«¯å®Œæˆï¼Œæ‰èƒ½è¿›è¡Œæœ‰æ•ˆçš„æµ‹è¯• ä»£ç éš¾ä»¥å¤ç”¨ æ­£å› ä¸ºä¸Šé¢çš„ç§ç§å¼Šç«¯ï¼Œæ‰€ä»¥å¾ˆå¿«è¿™ç§æ–¹å¼å°±è¢« Servlet + JSP + Java Bean æ‰€æ›¿ä»£äº†ï¼Œæ—©æœŸçš„ MVC æ¨¡å‹ï¼ˆModel2ï¼‰å°±åƒä¸‹å›¾è¿™æ ·ï¼š é¦–å…ˆç”¨æˆ·çš„è¯·æ±‚ä¼šåˆ°è¾¾ Servletï¼Œç„¶åæ ¹æ®è¯·æ±‚è°ƒç”¨ç›¸åº”çš„ Java Beanï¼Œå¹¶æŠŠæ‰€æœ‰çš„æ˜¾ç¤ºç»“æœäº¤ç»™ JSP å»å®Œæˆï¼Œè¿™æ ·çš„æ¨¡å¼æˆ‘ä»¬å°±ç§°ä¸º MVC æ¨¡å¼ã€‚ Spring MVC çš„æ¶æ„ä¸ºè§£å†³æŒä¹…å±‚ä¸­ä¸€ç›´æœªå¤„ç†å¥½çš„æ•°æ®åº“äº‹åŠ¡çš„ç¼–ç¨‹ï¼Œåˆä¸ºäº†è¿åˆ NoSQL çš„å¼ºåŠ¿å´›èµ·ï¼ŒSpring MVC ç»™å‡ºäº†æ–¹æ¡ˆï¼š ä¼ ç»Ÿçš„æ¨¡å‹å±‚è¢«æ‹†åˆ†ä¸ºäº†ä¸šåŠ¡å±‚(Service)å’Œæ•°æ®è®¿é—®å±‚ï¼ˆDAO,Data Access Objectï¼‰ã€‚åœ¨ Service ä¸‹å¯ä»¥é€šè¿‡ Spring çš„å£°æ˜å¼äº‹åŠ¡æ“ä½œæ•°æ®è®¿é—®å±‚ï¼Œè€Œåœ¨ä¸šåŠ¡å±‚ä¸Šè¿˜å…è®¸æˆ‘ä»¬è®¿é—® NoSQL ï¼Œè¿™æ ·å°±èƒ½å¤Ÿæ»¡è¶³å¼‚å†›çªèµ·çš„ NoSQL çš„ä½¿ç”¨äº†ï¼Œå®ƒå¯ä»¥å¤§å¤§æé«˜äº’è”ç½‘ç³»ç»Ÿçš„æ€§èƒ½ã€‚ ç‰¹ç‚¹ï¼š ç»“æ„æ¾æ•£ï¼Œå‡ ä¹å¯ä»¥åœ¨ Spring MVC ä¸­ä½¿ç”¨å„ç±»è§†å›¾ æ¾è€¦åˆï¼Œå„ä¸ªæ¨¡å—åˆ†ç¦» ä¸ Spring æ— ç¼é›†æˆ Hello Soring MVC åœ¨ IDEA ä¸­æ–°å»ºä¸€ä¸ª Spring MVC é¡¹ç›® ä¿®æ”¹ web.xml æŠŠ&lt;url-pattern&gt;å…ƒç´ çš„å€¼æ”¹ä¸º / ï¼Œè¡¨ç¤ºè¦æ‹¦æˆªæ‰€æœ‰çš„è¯·æ±‚ï¼Œå¹¶äº¤ç”±Spring MVCçš„åå°æ§åˆ¶å™¨æ¥å¤„ç†ï¼Œæ”¹å®Œä¹‹åï¼š 1234&lt;servlet-mapping&gt; &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; ç¼–è¾‘ dispatcher-servlet.xml è¿™ä¸ªæ–‡ä»¶åçš„å¼€å¤´ dispatcher ä¸ä¸Šé¢ web.xml ä¸­çš„ &lt;servlet-name&gt; å…ƒç´ é…ç½®çš„ dispatcher å¯¹åº”ï¼Œè¿™æ˜¯ Spring MVC çš„æ˜ å°„é…ç½®æ–‡ä»¶ï¼ˆxxx-servlet.xmlï¼‰ï¼Œæˆ‘ä»¬ç¼–è¾‘å¦‚ä¸‹ï¼š 12345678910111213141516&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"&gt; &lt;bean id=\"simpleUrlHandlerMapping\" class=\"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping\"&gt; &lt;property name=\"mappings\"&gt; &lt;props&gt; &lt;!-- /hello è·¯å¾„çš„è¯·æ±‚äº¤ç»™ id ä¸º helloController çš„æ§åˆ¶å™¨å¤„ç†--&gt; &lt;prop key=\"/hello\"&gt;helloController&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;/bean&gt; &lt;bean id=\"helloController\" class=\"controller.HelloController\"&gt;&lt;/bean&gt;&lt;/beans&gt; ç¼–å†™ HelloController åœ¨ Packagecontrollerä¸‹åˆ›å»º HelloControllerç±»ï¼Œå¹¶å®ç° org.springframework.web.servlet.mvc.Controller æ¥å£ï¼š 1234567891011package controller;import org.springframework.web.servlet.ModelAndView;import org.springframework.web.servlet.mvc.Controller;public class HelloController implements Controller&#123; @Override public ModelAndView handleRequest(javax.servlet.http.HttpServletRequest httpServletRequest, javax.servlet.http.HttpServletResponse httpServletResponse) throws Exception &#123; return null; &#125;&#125; å‡ºç°äº†é—®é¢˜ï¼š javax.servlet åŒ…æ‰¾ä¸åˆ° è§£å†³ï¼š å°†æœ¬åœ° Tomcat æœåŠ¡å™¨çš„ç›®å½•ä¸‹libæ–‡ä»¶å¤¹ä¸‹çš„ servlet-api.jar åŒ…æ‹·è´åˆ°å·¥ç¨‹libæ–‡ä»¶å¤¹ä¸‹ï¼Œæ·»åŠ ä¾èµ– Spring MVC é€šè¿‡ ModelAndView å¯¹è±¡æŠŠæ¨¡å‹å’Œè§†å›¾ç»“åˆåœ¨ä¸€èµ· 12ModelAndView mav = new ModelAndView(\"index.jsp\");mav.addObject(\"message\", \"Hello Spring MVC\"); è¿™é‡Œè¡¨ç¤ºè§†å›¾çš„æ˜¯index.jsp æ¨¡å‹æ•°æ®çš„æ˜¯ messageï¼Œå†…å®¹æ˜¯ â€œHello Spring MVCâ€ 12345678910111213package controller;import org.springframework.web.servlet.ModelAndView;import org.springframework.web.servlet.mvc.Controller;public class HelloController implements Controller &#123; public ModelAndView handleRequest(javax.servlet.http.HttpServletRequest httpServletRequest, javax.servlet.http.HttpServletResponse httpServletResponse) throws Exception &#123; ModelAndView mav = new ModelAndView(\"index.jsp\"); mav.addObject(\"message\", \"Hello Spring MVC\"); return mav; &#125;&#125; å‡†å¤‡ index.jsp å°† index.jsp çš„å†…å®¹ä¿®æ”¹ä¸ºï¼š 1234&lt;%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\" isELIgnored=\"false\"%&gt; &lt;h1&gt;$&#123;message&#125;&lt;/h1&gt; å†…å®¹å¾ˆç®€å•ï¼Œç”¨Elè¡¨è¾¾å¼æ˜¾ç¤º message çš„å†…å®¹ã€‚ éƒ¨ç½²åˆ° Tomcat åŠç›¸å…³ç¯å¢ƒ é‡å¯æœåŠ¡ï¼Œæµè§ˆå™¨è¾“å…¥åœ°å€ï¼šlocalhost/hello è·Ÿè¸ª Spring MVC çš„è¯·æ±‚æ¯å½“ç”¨æˆ·åœ¨ Web æµè§ˆå™¨ä¸­ç‚¹å‡»é“¾æ¥æˆ–è€…æäº¤è¡¨å•çš„æ—¶å€™ï¼Œè¯·æ±‚å°±å¼€å§‹å·¥ä½œäº†ï¼Œåƒæ˜¯é‚®é€’å‘˜ä¸€æ ·ï¼Œä»ç¦»å¼€æµè§ˆå™¨å¼€å§‹åˆ°è·å–å“åº”è¿”å›ï¼Œå®ƒä¼šç»å†å¾ˆå¤šç«™ç‚¹ï¼Œåœ¨æ¯ä¸€ä¸ªç«™ç‚¹éƒ½ä¼šç•™ä¸‹ä¸€äº›ä¿¡æ¯åŒæ—¶ä¹Ÿä¼šå¸¦ä¸Šå…¶ä»–ä¿¡æ¯ï¼Œä¸‹å›¾ä¸º Spring MVC çš„è¯·æ±‚æµç¨‹ï¼š DispatcherServlet ä»è¯·æ±‚ç¦»å¼€æµè§ˆå™¨ä»¥åï¼Œç¬¬ä¸€ç«™åˆ°è¾¾çš„å°±æ˜¯ DispatcherServletï¼Œçœ‹åå­—è¿™æ˜¯ä¸€ä¸ª Servletï¼Œé€šè¿‡ J2EE çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“ Servlet å¯ä»¥æ‹¦æˆªå¹¶å¤„ç† HTTP è¯·æ±‚ï¼ŒDispatcherServlet ä¼šæ‹¦æˆªæ‰€æœ‰çš„è¯·æ±‚ï¼Œå¹¶ä¸”å°†è¿™äº›è¯·æ±‚å‘é€ç»™ Spring MVC æ§åˆ¶å™¨ã€‚ 12345678910&lt;servlet&gt; &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt; &lt;!-- æ‹¦æˆªæ‰€æœ‰çš„è¯·æ±‚ --&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; DispatcherServlet çš„ä»»åŠ¡å°±æ˜¯æ‹¦æˆªè¯·æ±‚å‘é€ç»™ Spring MVC æ§åˆ¶å™¨ã€‚ å¤„ç†å™¨æ˜ å°„ï¼ˆHandlerMappingï¼‰ é—®é¢˜ï¼šå…¸å‹çš„åº”ç”¨ç¨‹åºä¸­å¯èƒ½ä¼šæœ‰å¤šä¸ªæ§åˆ¶å™¨ï¼Œè¿™äº›è¯·æ±‚åˆ°åº•åº”è¯¥å‘ç»™å“ªä¸€ä¸ªæ§åˆ¶å™¨å‘¢ï¼Ÿ æ‰€ä»¥ DispatcherServlet ä¼šæŸ¥è¯¢ä¸€ä¸ªæˆ–å¤šä¸ªå¤„ç†å™¨æ˜ å°„æ¥ç¡®å®šè¯·æ±‚çš„ä¸‹ä¸€ç«™åœ¨å“ªé‡Œï¼Œå¤„ç†å™¨æ˜ å°„ä¼šæ ¹æ®è¯·æ±‚æ‰€æºå¸¦çš„ URL ä¿¡æ¯æ¥è¿›è¡Œå†³ç­–ï¼Œä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡é…ç½® simpleUrlHandlerMapping æ¥å°† /hello åœ°å€äº¤ç»™ helloController å¤„ç†ï¼š 12345678910&lt;bean id=\"simpleUrlHandlerMapping\" class=\"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping\"&gt; &lt;property name=\"mappings\"&gt; &lt;props&gt; &lt;!-- /hello è·¯å¾„çš„è¯·æ±‚äº¤ç»™ id ä¸º helloController çš„æ§åˆ¶å™¨å¤„ç†--&gt; &lt;prop key=\"/hello\"&gt;helloController&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt;&lt;/bean&gt;&lt;bean id=\"helloController\" class=\"controller.HelloController\"&gt;&lt;/bean&gt; å¤„ç†é€‚é…å™¨ (HandlerAdapter) åœ¨è¯·æ±‚åˆ°è¾¾æ§åˆ¶å™¨ä¹‹å‰ï¼Œé¦–å…ˆä¼šç»è¿‡ä¸€ä¸ªé€‚é…å™¨ HttpMessageConverter è¯·æ±‚ç»è¿‡æ§åˆ¶å™¨ä¹‹åï¼Œä¼šç»è¿‡ä¸€ç³»åˆ—çš„æ•°æ®éªŒè¯ï¼Œæ•°æ®å¤„ç†ç­‰ï¼Œæœ€ååˆ°è¾¾Handleræ§åˆ¶å™¨ï¼ŒDispatcherServlet ä¼šå°†è¯·æ±‚å‘é€ç»™é€‰ä¸­çš„æ§åˆ¶å™¨ï¼Œåˆ°äº†æ§åˆ¶å™¨ï¼Œè¯·æ±‚ä¼šå¸ä¸‹å…¶è´Ÿè½½ï¼ˆç”¨æˆ·æäº¤çš„è¯·æ±‚ï¼‰ç­‰å¾…æ§åˆ¶å™¨å¤„ç†å®Œè¿™äº›ä¿¡æ¯ï¼š 1234public ModelAndView handleRequest(javax.servlet.http.HttpServletRequest httpServletRequest, javax.servlet.http.HttpServletResponse httpServletResponse) throws Exception &#123; // å¤„ç†é€»è¾‘ ....&#125; è¿”å› DispatcherServlet å½“æ§åˆ¶å™¨åœ¨å®Œæˆé€»è¾‘å¤„ç†åï¼Œé€šå¸¸ä¼šäº§ç”Ÿä¸€äº›ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å°±æ˜¯éœ€è¦è¿”å›ç»™ç”¨æˆ·å¹¶åœ¨æµè§ˆå™¨ä¸Šæ˜¾ç¤ºçš„ä¿¡æ¯ï¼Œå®ƒä»¬è¢«ç§°ä¸ºæ¨¡å‹ï¼ˆModelï¼‰ã€‚ä»…ä»…è¿”å›åŸå§‹çš„ä¿¡æ¯æ—¶ä¸å¤Ÿçš„â€”â€”è¿™äº›ä¿¡æ¯éœ€è¦ä»¥ç”¨æˆ·å‹å¥½çš„æ–¹å¼è¿›è¡Œæ ¼å¼åŒ–ï¼Œä¸€èˆ¬ä¼šæ˜¯ HTMLï¼Œæ‰€ä»¥ï¼Œä¿¡æ¯éœ€è¦å‘é€ç»™ä¸€ä¸ªè§†å›¾ï¼ˆviewï¼‰ï¼Œé€šå¸¸ä¼šæ˜¯ JSPã€‚ æ§åˆ¶å™¨æ‰€åšçš„æœ€åä¸€ä»¶äº‹å°±æ˜¯å°†æ¨¡å‹æ•°æ®æ‰“åŒ…ï¼Œå¹¶ä¸”è¡¨ç¤ºå‡ºç”¨äºæ¸²æŸ“è¾“å‡ºçš„è§†å›¾åï¼ˆé€»è¾‘è§†å›¾åï¼‰ã€‚å®ƒæ¥ä¸‹æ¥ä¼šå°†è¯·æ±‚è¿åŒæ¨¡å‹å’Œè§†å›¾åå‘é€å› DispatcherServletã€‚ 123456public ModelAndView handleRequest(javax.servlet.http.HttpServletRequest httpServletRequest, javax.servlet.http.HttpServletResponse httpServletResponse) throws Exception &#123; // å¤„ç†é€»è¾‘ .... // è¿”å›ç»™ DispatcherServlet return mav;&#125; è§†å›¾è§£æå™¨ è¿™æ ·ä¸€æ¥ï¼Œæ§åˆ¶å™¨å°±ä¸ä¼šå’Œç‰¹å®šçš„è§†å›¾ç›¸è€¦åˆï¼Œä¼ é€’ç»™ DispatcherServlet çš„è§†å›¾åå¹¶ä¸ç›´æ¥è¡¨ç¤ºæŸä¸ªç‰¹å®šçš„ JSPã€‚ï¼ˆå®é™…ä¸Šï¼Œå®ƒç”šè‡³ä¸èƒ½ç¡®å®šè§†å›¾å°±æ˜¯ JSPï¼‰ç›¸åï¼Œå®ƒä¼ é€’çš„ä»…ä»…æ˜¯ä¸€ä¸ªé€»è¾‘åç§°ï¼Œè¿™ä¸ªåç§°å°†ä¼šç”¨æ¥æŸ¥æ‰¾äº§ç”Ÿç»“æœçš„çœŸæ­£è§†å›¾ã€‚ DispatcherServlet å°†ä¼šä½¿ç”¨è§†å›¾è§£æå™¨ï¼ˆview resolverï¼‰æ¥å°†é€»è¾‘è§†å›¾ååŒ¹é…ä¸ºä¸€ä¸ªç‰¹å®šçš„è§†å›¾å®ç°ï¼Œå®ƒå¯èƒ½æ˜¯ä¹Ÿå¯èƒ½ä¸æ˜¯ JSP è§†å›¾ æ—¢ç„¶ DispatcherServlet å·²ç»çŸ¥é“ç”±å“ªä¸ªè§†å›¾æ¸²æŸ“ç»“æœäº†ï¼Œé‚£è¯·æ±‚çš„ä»»åŠ¡åŸºæœ¬ä¸Šä¹Ÿå°±å®Œæˆäº†ã€‚ å®ƒçš„æœ€åä¸€ç«™æ˜¯è§†å›¾çš„å®ç°ï¼Œåœ¨è¿™é‡Œå®ƒäº¤ä»˜æ¨¡å‹æ•°æ®ï¼Œè¯·æ±‚çš„ä»»åŠ¡ä¹Ÿå°±å®Œæˆäº†ã€‚è§†å›¾ä½¿ç”¨æ¨¡å‹æ•°æ®æ¸²æŸ“å‡ºç»“æœï¼Œè¿™ä¸ªè¾“å‡ºç»“æœä¼šé€šè¿‡å“åº”å¯¹è±¡ä¼ é€’ç»™å®¢æˆ·ç«¯ã€‚ 1234&lt;%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\" isELIgnored=\"false\"%&gt;&lt;h1&gt;$&#123;message&#125;&lt;/h1&gt; ä½¿ç”¨æ³¨è§£é…ç½® Spring MVCä¸Šé¢æˆ‘ä»¬å·²ç»å¯¹ Spring MVC æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œå¹¶ä¸”é€šè¿‡ XML é…ç½®çš„æ–¹å¼åˆ›å»ºäº†ç¬¬ä¸€ä¸ª Spring MVC ç¨‹åºï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åŸºäºæ³¨è§£åº”è¯¥æ€ä¹ˆå®Œæˆä¸Šè¿°ç¨‹åºçš„é…ç½®ï¼š ä¸º HelloController æ·»åŠ æ³¨è§£ 123456789101112131415package controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.servlet.ModelAndView;@Controllerpublic class HelloController&#123; @RequestMapping(\"/hello\") public ModelAndView handleRequest(javax.servlet.http.HttpServletRequest httpServletRequest, javax.servlet.http.HttpServletResponse httpServletResponse) throws Exception &#123; ModelAndView mav = new ModelAndView(\"index.jsp\"); mav.addObject(\"message\", \"Hello Spring MVC\"); return mav; &#125;&#125; æŠŠå®ç°çš„æ¥å£ä¹Ÿç»™å»æ‰ @Controller æ³¨è§£ï¼š å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªæ³¨è§£æ˜¯ç”¨æ¥å£°æ˜æ§åˆ¶å™¨çš„ï¼Œä½†å®é™…ä¸Šè¿™ä¸ªæ³¨è§£å¯¹ Spring MVC æœ¬èº«çš„å½±å“å¹¶ä¸å¤§ã€‚ï¼ˆSpring å®æˆ˜è¯´å®ƒä»…ä»…æ˜¯è¾…åŠ©å®ç°ç»„ä»¶æ‰«æï¼Œå¯ä»¥ç”¨ @Component æ³¨è§£ä»£æ›¿ï¼Œä½†æˆ‘è‡ªå·±å°è¯•äº†ä¸€ä¸‹å¹¶ä¸è¡Œï¼Œå› ä¸ºä¸Šè¿°ä¾‹å­æ²¡æœ‰é…ç½® JSP è§†å›¾è§£æå™¨æˆ‘è¿˜è‡ªå·±é…äº†ä¸€ä¸ªä»æ²¡æœ‰æˆåŠŸ...ï¼‰ @RequestMapping æ³¨è§£ï¼š å¾ˆæ˜¾ç„¶ï¼Œè¿™å°±è¡¨ç¤ºè·¯å¾„ /hello ä¼šæ˜ å°„åˆ°è¯¥æ–¹æ³•ä¸Š å–æ¶ˆä¹‹å‰çš„ XML æ³¨é‡Š åœ¨ dispatcher-servlet.xml æ–‡ä»¶ä¸­ï¼Œæ³¨é‡Šæ‰ä¹‹å‰çš„é…ç½®ï¼Œç„¶åå¢åŠ ä¸€å¥ç»„ä»¶æ‰«æï¼š 1234567891011121314151617181920&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd\"&gt; &lt;!--&lt;bean id=\"simpleUrlHandlerMapping\"--&gt; &lt;!--class=\"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping\"&gt;--&gt; &lt;!--&lt;property name=\"mappings\"&gt;--&gt; &lt;!--&lt;props&gt;--&gt; &lt;!--&amp;lt;!&amp;ndash; /hello è·¯å¾„çš„è¯·æ±‚äº¤ç»™ id ä¸º helloController çš„æ§åˆ¶å™¨å¤„ç†&amp;ndash;&amp;gt;--&gt; &lt;!--&lt;prop key=\"/hello\"&gt;helloController&lt;/prop&gt;--&gt; &lt;!--&lt;/props&gt;--&gt; &lt;!--&lt;/property&gt;--&gt; &lt;!--&lt;/bean&gt;--&gt; &lt;!--&lt;bean id=\"helloController\" class=\"controller.HelloController\"&gt;&lt;/bean&gt;--&gt; &lt;!-- æ‰«æcontrollerä¸‹çš„ç»„ä»¶ --&gt; &lt;context:component-scan base-package=\"controller\"/&gt;&lt;/beans&gt; é‡å¯æœåŠ¡å™¨ å½“é…ç½®å®Œæˆï¼Œé‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œè¾“å…¥ localhost/hello åœ°å€ä»ç„¶èƒ½çœ‹åˆ°æ•ˆæœ @RequestMapping æ³¨è§£ç»†èŠ‚å¦‚æœ @RequestMapping ä½œç”¨åœ¨ç±»ä¸Šï¼Œé‚£ä¹ˆå°±ç›¸å½“äºæ˜¯ç»™è¯¥ç±»æ‰€æœ‰é…ç½®çš„æ˜ å°„åœ°å€å‰åŠ ä¸Šäº†ä¸€ä¸ªåœ°å€ï¼Œä¾‹å¦‚ï¼š 12345678@Controller@RequestMapping(\"/xiaoqinghua\")public class HelloController &#123; @RequestMapping(\"/hello\") public ModelAndView handleRequest(....) throws Exception &#123; .... &#125;&#125; åˆ™è®¿é—®åœ°å€ï¼š localhost/wmyskxz/hello é…ç½®è§†å›¾è§£æå™¨è¿˜è®°å¾—æˆ‘ä»¬ Spring MVC çš„è¯·æ±‚æµç¨‹å—ï¼Œè§†å›¾è§£æå™¨è´Ÿè´£å®šä½è§†å›¾ï¼Œå®ƒæ¥å—ä¸€ä¸ªç”± DispaterServlet ä¼ é€’è¿‡æ¥çš„é€»è¾‘è§†å›¾åæ¥åŒ¹é…ä¸€ä¸ªç‰¹å®šçš„è§†å›¾ã€‚ éœ€æ±‚ï¼š æœ‰ä¸€äº›é¡µé¢æˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·ç”¨æˆ·ç›´æ¥è®¿é—®åˆ°ï¼Œä¾‹å¦‚æœ‰é‡è¦æ•°æ®çš„é¡µé¢ï¼Œä¾‹å¦‚æœ‰æ¨¡å‹æ•°æ®æ”¯æ’‘çš„é¡µé¢ã€‚ é€ æˆçš„é—®é¢˜ï¼š æˆ‘ä»¬å¯ä»¥åœ¨webæ ¹ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ªtest.jspæ¨¡æ‹Ÿä¸€ä¸ªé‡è¦æ•°æ®çš„é¡µé¢ï¼Œæˆ‘ä»¬ä»€ä¹ˆéƒ½ä¸ç”¨åšï¼Œé‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œç½‘é¡µä¸­è¾“å…¥ localhost/test.jsp å°±èƒ½å¤Ÿç›´æ¥è®¿é—®åˆ°äº†ï¼Œè¿™ä¼šé€ æˆæ•°æ®æ³„éœ²â€¦ å¦å¤–æˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å…¥ localhost/index.jsp è¯•è¯•ï¼Œæ ¹æ®æˆ‘ä»¬ä¸Šé¢çš„ç¨‹åºï¼Œè¿™ä¼šæ˜¯ä¸€ä¸ªç©ºç™½çš„é¡µé¢ï¼Œå› ä¸ºå¹¶æ²¡æœ‰è·å–åˆ° ${message} å‚æ•°å°±ç›´æ¥è®¿é—®äº†ï¼Œè¿™ä¼šå½±å“ç”¨æˆ·ä½“éªŒ è§£å†³æ–¹æ¡ˆæˆ‘ä»¬å°†æˆ‘ä»¬çš„ JSP æ–‡ä»¶é…ç½®åœ¨WEB-INFæ–‡ä»¶å¤¹ä¸­çš„pageæ–‡ä»¶å¤¹ä¸‹ï¼ŒWEB-INFæ˜¯ Java Web ä¸­é»˜è®¤çš„å®‰å…¨ç›®å½•ï¼Œæ˜¯ä¸å…è®¸ç”¨æˆ·ç›´æ¥è®¿é—®çš„ï¼ˆä¹Ÿå°±æ˜¯ä½ è¯´ä½ é€šè¿‡ localhost/WEB-INF/ è¿™æ ·çš„æ–¹å¼æ˜¯æ°¸è¿œè®¿é—®ä¸åˆ°çš„ï¼‰ ä½†æ˜¯æˆ‘ä»¬éœ€è¦å°†è¿™å‘Šè¯‰ç»™è§†å›¾è§£æå™¨ï¼Œæˆ‘ä»¬åœ¨ dispatcher-servlet.xml æ–‡ä»¶ä¸­åšå¦‚ä¸‹é…ç½®ï¼š 12345&lt;bean id=\"viewResolver\" class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt; &lt;property name=\"prefix\" value=\"/WEB-INF/page/\" /&gt; &lt;property name=\"suffix\" value=\".jsp\" /&gt;&lt;/bean&gt; è¿™é‡Œé…ç½®äº†ä¸€ä¸ª Spring MVC å†…ç½®çš„ä¸€ä¸ªè§†å›¾è§£æå™¨ï¼Œè¯¥è§£æå™¨æ˜¯éµå¾ªç€ä¸€ç§çº¦å®šï¼šä¼šåœ¨è§†å›¾åä¸Šæ·»åŠ å‰ç¼€å’Œåç¼€ï¼Œè¿›è€Œç¡®å®šä¸€ä¸ª Web åº”ç”¨ä¸­è§†å›¾èµ„æºçš„ç‰©ç†è·¯å¾„çš„ã€‚è®©æˆ‘ä»¬å®é™…æ¥çœ‹çœ‹æ•ˆæœï¼š ä¿®æ”¹ HelloContoller 123456@RequestMapping(\"/hello\") public ModelAndView handleRequest(javax.servlet.http.HttpServletRequest httpServletRequest, javax.servlet.http.HttpServletResponse httpServletResponse) throws Exception &#123; ModelAndView mav = new ModelAndView(\"index\"); mav.addObject(\"message\", \"Hello Spring MVC\"); return mav; &#125; é…ç½®è§†å›¾è§£æå™¨ï¼š æŒ‰ç…§ä¸Šè¿°çš„é…ç½®ï¼Œå®Œæˆï¼š 12345678910111213141516171819202122232425&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd\"&gt; &lt;!--&lt;bean id=\"simpleUrlHandlerMapping\"--&gt; &lt;!--class=\"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping\"&gt;--&gt; &lt;!--&lt;property name=\"mappings\"&gt;--&gt; &lt;!--&lt;props&gt;--&gt; &lt;!--&amp;lt;!&amp;ndash; /hello è·¯å¾„çš„è¯·æ±‚äº¤ç»™ id ä¸º helloController çš„æ§åˆ¶å™¨å¤„ç†&amp;ndash;&amp;gt;--&gt; &lt;!--&lt;prop key=\"/hello\"&gt;helloController&lt;/prop&gt;--&gt; &lt;!--&lt;/props&gt;--&gt; &lt;!--&lt;/property&gt;--&gt; &lt;!--&lt;/bean&gt;--&gt; &lt;!--&lt;bean id=\"helloController\" class=\"controller.HelloController\"&gt;&lt;/bean&gt;--&gt; &lt;!-- æ‰«æcontrollerä¸‹çš„ç»„ä»¶ --&gt; &lt;context:component-scan base-package=\"controller\"/&gt; &lt;bean id=\"viewResolver\" class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt; &lt;property name=\"prefix\" value=\"/WEB-INF/page/\" /&gt; &lt;property name=\"suffix\" value=\".jsp\" /&gt; &lt;/bean&gt;&lt;/beans&gt; å‰ªè´´ index.jsp æ–‡ä»¶ åœ¨WEB-INFæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªpageæ–‡ä»¶å¤¹ï¼Œå¹¶å°†index.jspæ–‡ä»¶å‰ªè´´åˆ°é‡Œé¢ï¼š æ›´æ–°èµ„æºé‡å¯æœåŠ¡å™¨ è®¿é—® localhost/hello è·¯å¾„ï¼Œçœ‹åˆ°æ­£ç¡®æ•ˆæœ æˆ‘ä»¬ä¼ å…¥çš„é€»è¾‘è§†å›¾åä¸º index ï¼Œå†åŠ ä¸Š â€œ/WEB-INF/page/â€ å‰ç¼€å’Œ â€œ.jspâ€ åç¼€ï¼Œå°±èƒ½ç¡®å®šç‰©ç†è§†å›¾çš„è·¯å¾„äº†ï¼Œè¿™æ ·æˆ‘ä»¬ä»¥åå°±å¯ä»¥å°†æ‰€æœ‰çš„è§†å›¾æ”¾å…¥pageæ–‡ä»¶å¤¹ä¸‹äº†ï¼ æ§åˆ¶å™¨æ¥æ”¶è¯·æ±‚æ•°æ®ä½¿ç”¨æ§åˆ¶å™¨æ¥æ”¶å‚æ•°å¾€å¾€æ˜¯ Spring MVC å¼€å‘ä¸šåŠ¡é€»è¾‘çš„ç¬¬ä¸€æ­¥ï¼Œä¸ºæ¢ç´¢ Spring MVC çš„ä¼ å‚æ–¹å¼ï¼Œä¸ºæ­¤æˆ‘ä»¬å…ˆæ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„è¡¨å•ç”¨äºæäº¤æ•°æ®ï¼š 12345678910111213141516&lt;!DOCTYPE html&gt;&lt;%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\" import=\"java.util.*\" isELIgnored=\"false\"%&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;title&gt;Spring MVC ä¼ å‚æ–¹å¼&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=\"/param\" role=\"form\"&gt; ç”¨æˆ·åï¼š&lt;input type=\"text\" name=\"userName\"&gt;&lt;br/&gt; å¯†ç ï¼š&lt;input type=\"text\" name=\"password\"&gt;&lt;br/&gt; &lt;input type=\"submit\" value=\"æ äº¤\"&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; ä½¿ç”¨ Servlet åŸç”Ÿ API å®ç°ï¼šæˆ‘ä»¬å¾ˆå®¹æ˜“çŸ¥é“ï¼Œè¡¨å•ä¼šæäº¤åˆ° /param è¿™ä¸ªç›®å½•ï¼Œæˆ‘ä»¬å…ˆæ¥ä½¿ç”¨ Servlet åŸç”Ÿçš„ API æ¥è·å–åˆ°æ•°æ®ï¼š 12345678910@RequestMapping(\"/param\")public ModelAndView getParam(HttpServletRequest request, HttpServletResponse response) &#123; String userName = request.getParameter(\"userName\"); String password = request.getParameter(\"password\"); System.out.println(userName); System.out.println(password); return null;&#125; ä½¿ç”¨åŒååŒ¹é…è§„åˆ™æˆ‘ä»¬å¯ä»¥æŠŠæ–¹æ³•å®šä¹‰çš„å½¢å‚åå­—è®¾ç½®æˆå’Œå‰å°ä¼ å…¥å‚æ•°åä¸€æ ·çš„æ–¹æ³•ï¼Œæ¥è·å–åˆ°æ•°æ®ï¼ˆåŒååŒ¹é…è§„åˆ™ï¼‰ï¼š 1234567@RequestMapping(\"/param\")public ModelAndView getParam(String userName, String password) &#123; System.out.println(userName); System.out.println(password); return null;&#125; é—®é¢˜ï¼š è¿™æ ·åˆä¼šå’Œå‰å°äº§ç”Ÿå¾ˆå¼ºçš„è€¦åˆï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›çš„ è§£å†³ï¼š ä½¿ç”¨ @RequestParam(&quot;å‰å°å‚æ•°å&quot;) æ¥æ³¨å…¥ï¼š @RequestParam æ³¨è§£ç»†èŠ‚ï¼š è¯¥æ³¨è§£æœ‰ä¸‰ä¸ªå˜é‡ï¼švalueã€requiredã€defaultvalue value ï¼šæŒ‡å®š name å±æ€§çš„åç§°æ˜¯ä»€ä¹ˆï¼Œvalue å±æ€§éƒ½å¯ä»¥é»˜è®¤ä¸å†™ required ï¼šæ˜¯å¦å¿…é¡»è¦æœ‰è¯¥å‚æ•°ï¼Œå¯ä»¥è®¾ç½®ä¸ºtrueæˆ–è€…false defaultvalue ï¼šè®¾ç½®é»˜è®¤å€¼ ä½¿ç”¨æ¨¡å‹ä¼ å‚è¦æ±‚ï¼š å‰å°å‚æ•°åå­—å¿…é¡»å’Œæ¨¡å‹ä¸­çš„å­—æ®µåä¸€æ · è®©æˆ‘ä»¬å…ˆæ¥ä¸ºæˆ‘ä»¬çš„è¡¨å•åˆ›å»ºä¸€ä¸ª User æ¨¡å‹ï¼š 123456789package pojo;public class User &#123; String userName; String password; /* getter and setter */&#125; ä¸­æ–‡ä¹±ç é—®é¢˜æ³¨æ„ï¼š è·Ÿ Servlet ä¸­çš„ä¸€æ ·ï¼Œè¯¥æ–¹æ³•åªå¯¹ POST æ–¹æ³•æœ‰æ•ˆï¼ˆå› ä¸ºæ˜¯ç›´æ¥å¤„ç†çš„ requestï¼‰ æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½® Spring MVC å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨æ¥å®Œæˆï¼Œåœ¨ web.xml ä¸­æ·»åŠ ï¼š 12345678910111213&lt;filter&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;!-- è®¾ç½®ç¼–ç æ ¼å¼ --&gt; &lt;param-value&gt;utf-8&lt;/param-value&gt; &lt;/init-param&gt;&lt;/filter&gt;&lt;filter-mapping&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt; æ§åˆ¶å™¨å›æ˜¾æ•°æ®é€šè¿‡ä¸Šé¢ï¼Œæˆ‘ä»¬çŸ¥é“äº†æ€ä¹ˆæ¥å—è¯·æ±‚æ•°æ®ï¼Œå¹¶èƒ½è§£å†³ POST ä¹±ç çš„é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆå›æ˜¾æ•°æ®å‘¢ï¼Ÿä¸ºæ­¤æˆ‘ä»¬åœ¨pageä¸‹åˆ›å»ºä¸€ä¸ªtest2.jspï¼š 1234567891011&lt;!DOCTYPE html&gt;&lt;%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\" import=\"java.util.*\" isELIgnored=\"false\" %&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Spring MVC æ•°æ®å›æ˜¾&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;å›æ˜¾æ•°æ®ï¼š$&#123;message&#125;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; ä½¿ç”¨ Servlet åŸç”Ÿ API æ¥å®ç°æˆ‘ä»¬å…ˆç”¨ Servlet åŸç”Ÿçš„ API å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼š 123456@RequestMapping(\"/value\")public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) &#123; request.setAttribute(\"message\",\"æˆåŠŸï¼\"); return new ModelAndView(\"test1\");&#125; ä½¿ç”¨ Spring MVC æ‰€æä¾›çš„ ModelAndView å¯¹è±¡1234567@RequestMapping(\"/value\")public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) &#123; ModelAndView mav = new ModelAndView(\"test1\"); mav.addObject(\"message\",\"æˆåŠŸï¼\"); return mav;&#125; ä½¿ç”¨ Model å¯¹è±¡åœ¨ Spring MVC ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éƒ½æ˜¯ä½¿ç”¨è¿™æ ·çš„æ–¹å¼æ¥ç»‘å®šæ•°æ®ï¼Œ 12345@RequestMapping(\"/value\")public String handleRequest(Model model) &#123; model.addAttribute(\"message\",\"æˆåŠŸï¼\") return \"test1\";&#125; ä½¿ç”¨ @ModelAttribute æ³¨è§£ï¼š 123456789@ModelAttributepublic void model(Model model) &#123; model.addAttribute(\"message\", \"æ³¨è§£æˆåŠŸ\");&#125;@RequestMapping(\"/value\")public String handleRequest() &#123; return \"test1\";&#125; è¿™æ ·å†™å°±ä¼šåœ¨è®¿é—®æ§åˆ¶å™¨æ–¹æ³• handleRequest() æ—¶ï¼Œä¼šé¦–å…ˆè°ƒç”¨ model() æ–¹æ³•å°† message æ·»åŠ è¿›é¡µé¢å‚æ•°ä¸­å»ï¼Œåœ¨è§†å›¾ä¸­å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä½†æ˜¯è¿™æ ·å†™ä¼šå¯¼è‡´è¯¥æ§åˆ¶å™¨æ‰€æœ‰çš„æ–¹æ³•éƒ½ä¼šé¦–å…ˆè°ƒç”¨ model() æ–¹æ³•ï¼Œä½†åŒæ ·çš„ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºå¯ä»¥åŠ å…¥å„ç§å„æ ·çš„æ•°æ®ã€‚ å®¢æˆ·ç«¯è·³è½¬å‰é¢ä¸ç®¡æ˜¯åœ°å€ /hello è·³è½¬åˆ° index.jsp è¿˜æ˜¯ /test è·³è½¬åˆ° test.jspï¼Œè¿™äº›éƒ½æ˜¯æœåŠ¡ç«¯çš„è·³è½¬ï¼Œä¹Ÿå°±æ˜¯ request.getRequestDispatcher(&quot;åœ°å€&quot;).forward(request, response); é‚£æˆ‘ä»¬å¦‚ä½•è¿›è¡Œå®¢æˆ·ç«¯è·³è½¬å‘¢ï¼Ÿæˆ‘ä»¬ç»§ç»­åœ¨ HelloController ä¸­ç¼–å†™ï¼š 123456789101112@RequestMapping(\"/hello\")public ModelAndView handleRequest(javax.servlet.http.HttpServletRequest httpServletRequest, javax.servlet.http.HttpServletResponse httpServletResponse) throws Exception &#123; ModelAndView mav = new ModelAndView(\"index\"); mav.addObject(\"message\", \"Hello Spring MVC\"); return mav;&#125;@RequestMapping(\"/jump\")public ModelAndView jump() &#123; ModelAndView mav = new ModelAndView(\"redirect:/hello\"); return mav;&#125; æˆ‘ä»¬ä½¿ç”¨ redirect:/hello å°±è¡¨ç¤ºæˆ‘ä»¬è¦è·³è½¬åˆ° /hello è¿™ä¸ªè·¯å¾„ï¼Œæˆ‘ä»¬é‡å¯æœåŠ¡å™¨ï¼Œåœ¨åœ°å€æ ä¸­è¾“å…¥ï¼šlocalhost/jump ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ° /hello è·¯å¾„ä¸‹ ä¹Ÿå¯ä»¥è¿™æ ·ç”¨ï¼š 1234@RequestMapping(\"/jump\")public String jump() &#123; return \"redirect: ./hello\";&#125; æ–‡ä»¶ä¸Šä¼ æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹ä¼ ç»Ÿçš„æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼šä¼ é€é—¨ æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹åœ¨ Spring MVC ä¸­å¦‚ä½•å®ç°æ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½ æ³¨æ„ï¼š éœ€è¦å…ˆå¯¼å…¥ commons-io-1.3.2.jar å’Œ commons-fileupload-1.2.1.jar ä¸¤ä¸ªåŒ… é…ç½®ä¸Šä¼ è§£æå™¨ åœ¨ dispatcher-servlet.xml ä¸­æ–°å¢ä¸€å¥ï¼š 1&lt;bean id=\"multipartResolver\" class=\"org.springframework.web.multipart.commons.CommonsMultipartResolver\"/&gt; å¼€å¯å¯¹ä¸Šä¼ åŠŸèƒ½çš„æ”¯æŒ ç¼–å†™ JSP æ–‡ä»¶åä¸º upload.jspï¼Œä»åˆ›å»ºåœ¨pageä¸‹ï¼š 123456789101112&lt;%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;æµ‹è¯•æ–‡ä»¶ä¸Šä¼ &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=\"/upload\" method=\"post\" enctype=\"multipart/form-data\"&gt; &lt;input type=\"file\" name=\"picture\"&gt; &lt;input type=\"submit\" value=\"ä¸Š ä¼ \"&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; ç¼–å†™æ§åˆ¶å™¨ åœ¨ Packagecontrollerä¸‹æ–°å»ºUploadControllerç±»ï¼š 12345678910111213141516171819202122package controller;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.multipart.MultipartFile;import org.springframework.web.servlet.ModelAndView;@Controllerpublic class UploadController &#123; @RequestMapping(\"/upload\") public void upload(@RequestParam(\"picture\") MultipartFile picture) throws Exception &#123; System.out.println(picture.getOriginalFilename()); &#125; @RequestMapping(\"/test2\") public ModelAndView upload() &#123; return new ModelAndView(\"upload\"); &#125;&#125; æµ‹è¯• åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ï¼šlocalhost/test2 ï¼Œé€‰æ‹©æ–‡ä»¶ç‚¹å‡»ä¸Šä¼ ï¼Œæµ‹è¯•æˆåŠŸ","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Spring","slug":"Code/Spring","permalink":"http://xiaoqinghua.site/categories/Code/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"http://xiaoqinghua.site/tags/Spring/"}]},{"title":"Spring AOPæ€»ç»“","slug":"Spring-AOPæ€»ç»“","date":"2017-12-08T05:22:36.000Z","updated":"2018-09-07T10:28:46.108Z","comments":true,"path":"Spring-AOPæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Spring-AOPæ€»ç»“.html","excerpt":"","text":"Spring AOP ç®€ä»‹å¦‚æœè¯´ IoC æ˜¯ Spring çš„æ ¸å¿ƒï¼Œé‚£ä¹ˆé¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)å°±æ˜¯ Spring æœ€ä¸ºé‡è¦çš„åŠŸèƒ½ä¹‹ä¸€äº†ï¼Œåœ¨æ•°æ®åº“äº‹åŠ¡ä¸­åˆ‡é¢ç¼–ç¨‹è¢«å¹¿æ³›ä½¿ç”¨ã€‚ AOP å³ Aspect Oriented Program é¢å‘åˆ‡é¢ç¼–ç¨‹ é¦–å…ˆï¼Œåœ¨é¢å‘åˆ‡é¢ç¼–ç¨‹çš„æ€æƒ³é‡Œé¢ï¼ŒæŠŠåŠŸèƒ½åˆ†ä¸ºæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ï¼Œå’Œå‘¨è¾¹åŠŸèƒ½ã€‚ æ‰€è°“çš„æ ¸å¿ƒä¸šåŠ¡ï¼Œæ¯”å¦‚ç™»é™†ï¼Œå¢åŠ æ•°æ®ï¼Œåˆ é™¤æ•°æ®éƒ½å«æ ¸å¿ƒä¸šåŠ¡ æ‰€è°“çš„å‘¨è¾¹åŠŸèƒ½ï¼Œæ¯”å¦‚æ€§èƒ½ç»Ÿè®¡ï¼Œæ—¥å¿—ï¼Œäº‹åŠ¡ç®¡ç†ç­‰ç­‰ å‘¨è¾¹åŠŸèƒ½åœ¨ Spring çš„é¢å‘åˆ‡é¢ç¼–ç¨‹AOPæ€æƒ³é‡Œï¼Œå³è¢«å®šä¹‰ä¸ºåˆ‡é¢ åœ¨é¢å‘åˆ‡é¢ç¼–ç¨‹AOPçš„æ€æƒ³é‡Œé¢ï¼Œæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½å’Œåˆ‡é¢åŠŸèƒ½åˆ†åˆ«ç‹¬ç«‹è¿›è¡Œå¼€å‘ï¼Œç„¶åæŠŠåˆ‡é¢åŠŸèƒ½å’Œæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ &quot;ç¼–ç»‡&quot; åœ¨ä¸€èµ·ï¼Œè¿™å°±å«AOP AOP çš„ç›®çš„AOPèƒ½å¤Ÿå°†é‚£äº›ä¸ä¸šåŠ¡æ— å…³ï¼Œå´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘æˆ–è´£ä»»ï¼ˆä¾‹å¦‚äº‹åŠ¡å¤„ç†ã€æ—¥å¿—ç®¡ç†ã€æƒé™æ§åˆ¶ç­‰ï¼‰å°è£…èµ·æ¥ï¼Œä¾¿äºå‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦ï¼Œå¹¶æœ‰åˆ©äºæœªæ¥çš„å¯æ‹“å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ AOP å½“ä¸­çš„æ¦‚å¿µï¼š åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ åœ¨å“ªäº›ç±»ï¼Œå“ªäº›æ–¹æ³•ä¸Šåˆ‡å…¥ï¼ˆwhereï¼‰ é€šçŸ¥ï¼ˆAdviceï¼‰ åœ¨æ–¹æ³•æ‰§è¡Œçš„ä»€ä¹ˆæ—¶æœºï¼ˆwhen:æ–¹æ³•å‰/æ–¹æ³•å/æ–¹æ³•å‰åï¼‰åšä»€ä¹ˆï¼ˆwhat:å¢å¼ºçš„åŠŸèƒ½ï¼‰ åˆ‡é¢ï¼ˆAspectï¼‰ åˆ‡é¢ = åˆ‡å…¥ç‚¹ + é€šçŸ¥ï¼Œé€šä¿—ç‚¹å°±æ˜¯ï¼šåœ¨ä»€ä¹ˆæ—¶æœºï¼Œä»€ä¹ˆåœ°æ–¹ï¼Œåšä»€ä¹ˆå¢å¼ºï¼ ç»‡å…¥ï¼ˆWeavingï¼‰ æŠŠåˆ‡é¢åŠ å…¥åˆ°å¯¹è±¡ï¼Œå¹¶åˆ›å»ºå‡ºä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚ï¼ˆç”± Spring æ¥å®Œæˆï¼‰ ä¸¾ä¸ªæ —å­ï¼š æˆ¿ä¸œçš„æ ¸å¿ƒä¸šåŠ¡å°±æ˜¯ç­¾åˆåŒï¼Œæ”¶æˆ¿ç§Ÿï¼Œé‚£ä¹ˆè¿™å°±å¤Ÿäº†ï¼Œå¸¦ç§Ÿå®¢çœ‹æˆ¿ï¼Œäº¤é’¥åŒ™ç­‰éƒ¨åˆ†éƒ½æ˜¯é‡å¤ä¸”è¾¹ç¼˜çš„äº‹ï¼Œäº¤ç»™ä¸­ä»‹å°±å¥½äº†ï¼Œè¿™å°±æ˜¯AOP AOP çš„ä¸€ä¸ªæ€æƒ³ï¼šè®©å…³æ³¨ç‚¹ä»£ç ä¸ä¸šåŠ¡ä»£ç åˆ†ç¦»ï¼ show me the code: åœ¨ Packagepojoä¸‹æ–°å»ºä¸€ä¸ªLandlordç±» 12345678910111213package pojo;import org.springframework.stereotype.Component;@Component(\"landlord\")public class Landlord &#123; public void service() &#123; // ä»…ä»…åªæ˜¯å®ç°äº†æ ¸å¿ƒçš„ä¸šåŠ¡åŠŸèƒ½ System.out.println(\"ç­¾åˆåŒ\"); System.out.println(\"æ”¶æˆ¿ç§Ÿ\"); &#125;&#125; åœ¨ Packageaspectä¸‹æ–°å»ºä¸€ä¸ªä¸­ä»‹å•†Brokerç±»ï¼š 12345678910111213141516171819202122package aspect;import org.aspectj.lang.annotation.After;import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Before;import org.springframework.stereotype.Component;@Component@Aspectclass Broker &#123; @Before(\"execution(* pojo.Landlord.service())\") public void before()&#123; System.out.println(\"å¸¦ç§Ÿå®¢çœ‹æˆ¿\"); System.out.println(\"è°ˆä»·æ ¼\"); &#125; @After(\"execution(* pojo.Landlord.service())\") public void after()&#123; System.out.println(\"äº¤é’¥åŒ™\"); &#125;&#125; åœ¨ applicationContext.xml ä¸­é…ç½®è‡ªåŠ¨æ³¨å…¥ï¼Œå¹¶å‘Šè¯‰ Spring IoC å®¹å™¨å»å“ªé‡Œæ‰«æè¿™ä¸¤ä¸ª Beanï¼š 12345678910111213&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:aop=\"http://www.springframework.org/schema/aop\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd\"&gt; &lt;context:component-scan base-package=\"aspect\" /&gt; &lt;context:component-scan base-package=\"pojo\" /&gt; &lt;aop:aspectj-autoproxy/&gt;&lt;/beans&gt; åœ¨ Packagetestä¸‹ç¼–å†™æµ‹è¯•ä»£ç ï¼š 1234567891011121314151617package test;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import pojo.Landlord;public class TestSpring &#123; public static void main(String[] args) &#123; ApplicationContext context = new ClassPathXmlApplicationContext(\"applicationContext.xml\"); Landlord landlord = (Landlord) context.getBean(\"landlord\", Landlord.class); landlord.service(); &#125;&#125; åœ¨ Landlord çš„ service() æ–¹æ³•ä¸­ä»…ä»…å®ç°äº†æ ¸å¿ƒçš„ä¸šåŠ¡ä»£ç ï¼Œå…¶ä½™çš„å…³æ³¨ç‚¹åŠŸèƒ½æ˜¯æ ¹æ®æˆ‘ä»¬è®¾ç½®çš„åˆ‡é¢è‡ªåŠ¨è¡¥å…¨çš„ã€‚ ä½¿ç”¨æ³¨è§£æ¥å¼€å‘ Spring AOPä½¿ç”¨æ³¨è§£çš„æ–¹å¼å·²ç»é€æ¸æˆä¸ºäº†ä¸»æµï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨ä¸Šé¢çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ç”¨æ³¨è§£æ¥å¼€å‘ Spring AOP ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©è¿æ¥ç‚¹Spring æ˜¯æ–¹æ³•çº§åˆ«çš„ AOP æ¡†æ¶ï¼Œæˆ‘ä»¬ä¸»è¦ä¹Ÿæ˜¯ä»¥æŸä¸ªç±»çš„æŸä¸ªæ–¹æ³•ä½œä¸ºè¿æ¥ç‚¹ï¼Œå¦ä¸€ç§è¯´æ³•å°±æ˜¯ï¼šé€‰æ‹©å“ªä¸€ä¸ªç±»çš„å“ªä¸€æ–¹æ³•ç”¨ä»¥å¢å¼ºåŠŸèƒ½ã€‚ 1234567// ....public void service() &#123; // ä»…ä»…åªæ˜¯å®ç°äº†æ ¸å¿ƒçš„ä¸šåŠ¡åŠŸèƒ½ System.out.println(\"ç­¾åˆåŒ\"); System.out.println(\"æ”¶æˆ¿ç§Ÿ\");&#125;// .... æˆ‘ä»¬åœ¨è¿™é‡Œå°±é€‰æ‹©ä¸Šè¿° Landlord ç±»ä¸­çš„ service() æ–¹æ³•ä½œä¸ºè¿æ¥ç‚¹ã€‚ ç¬¬äºŒæ­¥ï¼šåˆ›å»ºåˆ‡é¢é€‰æ‹©å¥½äº†è¿æ¥ç‚¹å°±å¯ä»¥åˆ›å»ºåˆ‡é¢äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåˆ‡é¢ç†è§£ä¸ºä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œå½“ç¨‹åºè¿è¡Œåˆ°è¿æ¥ç‚¹çš„æ—¶å€™ï¼Œè¢«æ‹¦æˆªä¸‹æ¥ï¼Œåœ¨å¼€å¤´åŠ å…¥äº†åˆå§‹åŒ–çš„æ–¹æ³•ï¼Œåœ¨ç»“å°¾ä¹ŸåŠ å…¥äº†é”€æ¯çš„æ–¹æ³•è€Œå·²ï¼Œåœ¨ Spring ä¸­åªè¦ä½¿ç”¨ @Aspect æ³¨è§£ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆ Spring IoC å®¹å™¨å°±ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªåˆ‡é¢äº†ï¼š 12345678910111213141516171819202122package aspect;import org.aspectj.lang.annotation.After;import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Before;import org.springframework.stereotype.Component;@Component@Aspectclass Broker &#123; @Before(\"execution(* pojo.Landlord.service())\") public void before()&#123; System.out.println(\"å¸¦ç§Ÿå®¢çœ‹æˆ¿\"); System.out.println(\"è°ˆä»·æ ¼\"); &#125; @After(\"execution(* pojo.Landlord.service())\") public void after()&#123; System.out.println(\"äº¤é’¥åŒ™\"); &#125;&#125; æ³¨æ„ï¼š è¢«å®šä¹‰ä¸ºåˆ‡é¢çš„ç±»ä»ç„¶æ˜¯ä¸€ä¸ª Bean ï¼Œéœ€è¦ @Component æ³¨è§£æ ‡æ³¨ @Before: å‰ç½®é€šçŸ¥ï¼Œåœ¨è¿æ¥ç‚¹æ–¹æ³•å‰è°ƒç”¨ @Around: ç¯ç»•é€šçŸ¥ï¼Œå®ƒå°†è¦†ç›–åŸæœ‰æ–¹æ³•ï¼Œä½†æ˜¯å…è®¸ä½ é€šè¿‡åå°„è°ƒç”¨åŸæœ‰æ–¹æ³•ï¼Œåé¢ä¼šè®² @After: åç½®é€šçŸ¥ï¼Œåœ¨è¿æ¥ç‚¹æ–¹æ³•åè°ƒç”¨ @AfterReturning: è¿”å›é€šçŸ¥ï¼Œåœ¨è¿æ¥ç‚¹æ–¹æ³•æ‰§è¡Œå¹¶æ­£å¸¸è¿”å›åè°ƒç”¨ï¼Œè¦æ±‚è¿æ¥ç‚¹æ–¹æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ @AfterThrowing: å¼‚å¸¸é€šçŸ¥ï¼Œå½“è¿æ¥ç‚¹æ–¹æ³•å¼‚å¸¸æ—¶è°ƒç”¨ ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰åˆ‡ç‚¹åœ¨ä¸Šé¢çš„æ³¨è§£ä¸­å®šä¹‰äº† execution çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ŒSpring é€šè¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼åˆ¤æ–­å…·ä½“è¦æ‹¦æˆªçš„æ˜¯å“ªä¸€ä¸ªç±»çš„å“ªä¸€ä¸ªæ–¹æ³•ï¼š 1execution(* pojo.Landlord.service()) ä¾æ¬¡å¯¹è¿™ä¸ªè¡¨è¾¾å¼ä½œå‡ºåˆ†æï¼š executionï¼šä»£è¡¨æ‰§è¡Œæ–¹æ³•çš„æ—¶å€™ä¼šè§¦å‘ ï¼šä»£è¡¨ä»»æ„è¿”å›ç±»å‹çš„æ–¹æ³• pojo.Landlordï¼šä»£è¡¨ç±»çš„å…¨é™å®šå service()ï¼šè¢«æ‹¦æˆªçš„æ–¹æ³•åç§° é€šè¿‡ä¸Šé¢çš„è¡¨è¾¾å¼ï¼ŒSpring å°±ä¼šçŸ¥é“åº”è¯¥æ‹¦æˆª pojo.Lnadlord ç±»ä¸‹çš„ service() æ–¹æ³•ã€‚ä¸Šé¢çš„æ¼”ç¤ºç±»è¿˜å¥½ï¼Œå¦‚æœå¤šå‡ºéƒ½éœ€è¦å†™è¿™æ ·çš„è¡¨è¾¾å¼éš¾å…ä¼šæœ‰äº›å¤æ‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ @Pointcut æ³¨è§£æ¥å®šä¹‰ä¸€ä¸ªåˆ‡ç‚¹æ¥é¿å…è¿™æ ·çš„éº»çƒ¦ï¼š 123456789101112131415161718192021222324252627package aspect;import org.aspectj.lang.annotation.After;import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Before;import org.aspectj.lang.annotation.Pointcut;import org.springframework.stereotype.Component;@Component@Aspectclass Broker &#123; @Pointcut(\"execution(* pojo.Landlord.service())\") public void lService() &#123; &#125; @Before(\"lService()\") public void before() &#123; System.out.println(\"å¸¦ç§Ÿå®¢çœ‹æˆ¿\"); System.out.println(\"è°ˆä»·æ ¼\"); &#125; @After(\"lService()\") public void after() &#123; System.out.println(\"äº¤é’¥åŒ™\"); &#125;&#125; ç¯ç»•é€šçŸ¥æˆ‘ä»¬æ¥æ¢è®¨ä¸€ä¸‹ç¯ç»•é€šçŸ¥ï¼Œè¿™æ˜¯ Spring AOP ä¸­æœ€å¼ºå¤§çš„é€šçŸ¥ï¼Œå› ä¸ºå®ƒé›†æˆäº†å‰ç½®é€šçŸ¥å’Œåç½®é€šçŸ¥ï¼Œå®ƒä¿ç•™äº†è¿æ¥ç‚¹åŸæœ‰çš„æ–¹æ³•çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å®ƒåŠå¼ºå¤§åˆçµæ´»ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738package aspect;import org.aspectj.lang.ProceedingJoinPoint;import org.aspectj.lang.annotation.Around;import org.aspectj.lang.annotation.Aspect;import org.springframework.stereotype.Component;@Component@Aspectclass Broker &#123;// æ³¨é‡Šæ‰ä¹‹å‰çš„ @Before å’Œ @After æ³¨è§£ä»¥åŠå¯¹åº”çš„æ–¹æ³•// @Before(\"execution(* pojo.Landlord.service())\")// public void before() &#123;// System.out.println(\"å¸¦ç§Ÿå®¢çœ‹æˆ¿\");// System.out.println(\"è°ˆä»·æ ¼\");// &#125;//// @After(\"execution(* pojo.Landlord.service())\")// public void after() &#123;// System.out.println(\"äº¤é’¥åŒ™\");// &#125; // ä½¿ç”¨ @Around æ³¨è§£æ¥åŒæ—¶å®Œæˆå‰ç½®å’Œåç½®é€šçŸ¥ @Around(\"execution(* pojo.Landlord.service())\") public void around(ProceedingJoinPoint joinPoint) &#123; System.out.println(\"å¸¦ç§Ÿå®¢çœ‹æˆ¿\"); System.out.println(\"è°ˆä»·æ ¼\"); try &#123; joinPoint.proceed(); &#125; catch (Throwable throwable) &#123; throwable.printStackTrace(); &#125; System.out.println(\"äº¤é’¥åŒ™\"); &#125;&#125;","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Spring","slug":"Code/Spring","permalink":"http://xiaoqinghua.site/categories/Code/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"http://xiaoqinghua.site/tags/Spring/"}]},{"title":"Spring Beanæ€»ç»“","slug":"Spring-Beanæ€»ç»“","date":"2017-12-03T05:22:36.000Z","updated":"2018-09-07T10:28:28.979Z","comments":true,"path":"Spring-Beanæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Spring-Beanæ€»ç»“.html","excerpt":"","text":"è£…é… Bean çš„æ¦‚è¿°å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šä½¿ç”¨ ApplicationContext çš„å…·ä½“å®ç°ç±»ï¼Œå› ä¸ºå¯¹åº”çš„ Spring IoCå®¹å™¨åŠŸèƒ½ç›¸å¯¹å¼ºå¤§ã€‚ è€Œåœ¨ Spring ä¸­æä¾›äº† 3 ç§æ–¹æ³•è¿›è¡Œé…ç½®ï¼š åœ¨ XML æ–‡ä»¶ä¸­æ˜¾å¼é…ç½® åœ¨ Java çš„æ¥å£å’Œç±»ä¸­å®ç°é…ç½® éšå¼ Bean çš„å‘ç°æœºåˆ¶å’Œè‡ªåŠ¨è£…é…åŸåˆ™ æ–¹å¼é€‰æ‹©çš„åŸåˆ™åœ¨ç°å®çš„å·¥ä½œä¸­ï¼Œè¿™ 3 ç§æ–¹å¼éƒ½ä¼šè¢«ç”¨åˆ°ï¼Œå¹¶ä¸”åœ¨å­¦ä¹ å’Œå·¥ä½œä¹‹ä¸­å¸¸å¸¸æ··åˆä½¿ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œç»™å‡ºä¸€äº›å…³äºè¿™ 3 ç§ä¼˜å…ˆçº§çš„å»ºè®®ï¼š æœ€ä¼˜å…ˆï¼šé€šè¿‡éšå¼ Bean çš„å‘ç°æœºåˆ¶å’Œè‡ªåŠ¨è£…é…çš„åŸåˆ™: åŸºäºçº¦å®šç”±äºé…ç½®çš„åŸåˆ™ï¼Œè¿™ç§æ–¹å¼åº”è¯¥æ˜¯æœ€ä¼˜å…ˆçš„ å¥½å¤„ï¼šå‡å°‘ç¨‹åºå¼€å‘è€…çš„å†³å®šæƒï¼Œç®€å•åˆä¸å¤±çµæ´»ã€‚ å…¶æ¬¡ï¼šJava æ¥å£å’Œç±»ä¸­é…ç½®å®ç°é…ç½®: åœ¨æ²¡æœ‰åŠæ³•ä½¿ç”¨è‡ªåŠ¨è£…é…åŸåˆ™çš„æƒ…å†µä¸‹åº”è¯¥ä¼˜å…ˆè€ƒè™‘æ­¤ç±»æ–¹æ³• å¥½å¤„ï¼šé¿å… XML é…ç½®çš„æ³›æ»¥ï¼Œä¹Ÿæ›´ä¸ºå®¹æ˜“ã€‚ å…¸å‹åœºæ™¯ï¼šä¸€ä¸ªçˆ¶ç±»æœ‰å¤šä¸ªå­ç±»ï¼Œæ¯”å¦‚å­¦ç”Ÿç±»æœ‰ä¸¤ä¸ªå­ç±»ï¼Œä¸€ä¸ªç”·å­¦ç”Ÿç±»å’Œå¥³å­¦ç”Ÿç±»ï¼Œé€šè¿‡ IoC å®¹å™¨åˆå§‹åŒ–ä¸€ä¸ªå­¦ç”Ÿç±»ï¼Œå®¹å™¨å°†æ— æ³•çŸ¥é“ä½¿ç”¨å“ªä¸ªå­ç±»å»åˆå§‹åŒ–ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ Java çš„æ³¨è§£é…ç½®å»æŒ‡å®šã€‚ æœ€åï¼šXML æ–¹å¼é…ç½®: åœ¨ä¸Šè¿°æ–¹æ³•éƒ½æ— æ³•ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆä¹Ÿåªèƒ½é€‰æ‹© XML é…ç½®çš„æ–¹å¼ã€‚ å¥½å¤„ï¼šç®€å•æ˜“æ‡‚ï¼ˆå½“ç„¶ï¼Œç‰¹åˆ«æ˜¯å¯¹äºåˆå­¦è€…ï¼‰ å…¸å‹åœºæ™¯ï¼šå½“ä½¿ç”¨ç¬¬ä¸‰æ–¹ç±»çš„æ—¶å€™ï¼Œæœ‰äº›ç±»å¹¶ä¸æ˜¯æˆ‘ä»¬å¼€å‘çš„ï¼Œæˆ‘ä»¬æ— æ³•ä¿®æ”¹é‡Œé¢çš„ä»£ç ï¼Œè¿™ä¸ªæ—¶å€™å°±é€šè¿‡ XML çš„æ–¹å¼é…ç½®ä½¿ç”¨äº†ã€‚ é€šè¿‡ XML é…ç½®è£…é… Beanä½¿ç”¨ XML è£…é… Bean éœ€è¦å®šä¹‰å¯¹åº”çš„ XMLï¼Œè¿™é‡Œéœ€è¦å¼•å…¥å¯¹åº”çš„ XML æ¨¡å¼ï¼ˆXSDï¼‰æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šå®šä¹‰é…ç½® Spring Bean çš„ä¸€äº›å…ƒç´ ï¼Œå½“æˆ‘ä»¬åœ¨ IDEA ä¸­åˆ›å»º XML æ–‡ä»¶æ—¶ï¼Œä¼šæœ‰å‹å¥½çš„æç¤ºï¼š ä¸€ä¸ªç®€å•çš„ XML é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š 123456&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;&lt;/beans&gt; è¿™å°±åªæ˜¯ä¸€ä¸ªæ ¼å¼æ–‡ä»¶ï¼Œå¼•å…¥äº†ä¸€ä¸ª beans çš„å®šä¹‰ï¼Œå¼•å…¥äº† xsd æ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ ¹å…ƒç´ ï¼Œè¿™æ ·å®ƒæ‰€å®šä¹‰çš„å…ƒç´ å°†å¯ä»¥å®šä¹‰å¯¹åº”çš„ Spring Bean è£…é…ç®€æ˜“å€¼å…ˆæ¥ä¸€ä¸ªæœ€ç®€å•çš„è£…é…ï¼š 123&lt;bean id=\"myBean\" class=\"com.xiaoqinghua.TestBean\"&gt; &lt;property name=\"name\" value=\"æµ‹è¯•\" /&gt;&lt;/bean&gt; id å±æ€§æ˜¯ Spring èƒ½æ‰¾åˆ°å½“å‰ Bean çš„ä¸€ä¸ªä¾èµ–çš„ç¼–å·ï¼Œéµå®ˆ XML è¯­æ³•çš„ ID å”¯ä¸€æ€§çº¦æŸã€‚å¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œå¯ä»¥ä½¿ç”¨å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦ã€ä¸‹åˆ’çº¿ã€å¥å·ã€å†’å·ï¼Œä¸èƒ½ä»¥ / å¼€å¤´ã€‚ä¸è¿‡ id å±æ€§ä¸æ˜¯ä¸€ä¸ªå¿…éœ€çš„å±æ€§ï¼Œname å±æ€§ä¹Ÿå¯ä»¥å®šä¹‰ bean å…ƒç´ çš„åç§°ï¼Œèƒ½ä»¥é€—å·æˆ–ç©ºæ ¼éš”å¼€èµ·å¤šä¸ªåˆ«åï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å¾ˆå¤šçš„ç‰¹æ®Šå­—ç¬¦ï¼Œæ¯”å¦‚åœ¨ Spring å’Œ Spring MVCçš„æ•´åˆä¸­ï¼Œå°±å¾—ä½¿ç”¨ name å±æ€§æ¥å®šä¹‰ bean çš„åç§°ï¼Œå¹¶ä¸”ä½¿ç”¨ / å¼€å¤´ã€‚æ³¨æ„ï¼š ä» Spring 3.1 å¼€å§‹ï¼Œid å±æ€§ä¹Ÿå¯ä»¥æ˜¯ String ç±»å‹äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ id å±æ€§ä¹Ÿå¯ä»¥ä½¿ç”¨ / å¼€å¤´ï¼Œè€Œ bean å…ƒç´ çš„ id çš„å”¯ä¸€æ€§ç”±å®¹å™¨è´Ÿè´£æ£€æŸ¥ã€‚å¦‚æœ id å’Œ name å±æ€§éƒ½æ²¡æœ‰å£°æ˜çš„è¯ï¼Œé‚£ä¹ˆ Spring å°†ä¼šé‡‡ç”¨ â€œå…¨é™å®šå#{number}â€ çš„æ ¼å¼ç”Ÿæˆç¼–å·ã€‚ ä¾‹å¦‚è¿™é‡Œï¼Œå¦‚æœæ²¡æœ‰å£°æ˜ â€œid=&quot;myBean&quot;â€ çš„è¯ï¼Œé‚£ä¹ˆ Spring ä¸ºå…¶ç”Ÿæˆçš„ç¼–å·å°±æ˜¯ â€œcom.xiaoqinghua.TestBean#0â€ï¼Œå½“å®ƒç¬¬äºŒæ¬¡å£°æ˜æ²¡æœ‰ id å±æ€§çš„ Bean æ—¶ï¼Œç¼–å·å°±æ˜¯ â€œcom.xiaoqinghua.TestBean#1â€ï¼Œä»¥æ­¤ç±»æ¨ã€‚ class å±æ€§æ˜¾ç„¶å°±æ˜¯ä¸€ä¸ªç±»çš„å…¨é™å®šå property å…ƒç´ æ˜¯å®šä¹‰ç±»çš„å±æ€§ï¼Œå…¶ä¸­çš„ name å±æ€§å®šä¹‰çš„æ˜¯å±æ€§çš„åç§°ï¼Œè€Œ value æ˜¯å®ƒçš„å€¼ã€‚ è£…é…é›†åˆæœ‰äº›æ—¶å€™æˆ‘ä»¬éœ€è¦è£…é…ä¸€äº›å¤æ‚çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ Setã€Mapã€Listã€Array å’Œ Properties ç­‰ï¼Œæ–°å»ºä¸€ä¸ª ComplexAssembly ç±»ï¼š 12345678910111213141516import java.util.List;import java.util.Map;import java.util.Properties;import java.util.Set;public class ComplexAssembly &#123; private Long id; private List&lt;String&gt; list; private Map&lt;String, String&gt; map; private Properties properties; private Set&lt;String&gt; set; private String[] array; /* setter and getter */&#125; è¿™ä¸ª Bean æ²¡æœ‰ä»»ä½•çš„å®é™…æ„ä¹‰ï¼Œåªæ˜¯ä¸ºäº†ä»‹ç»å¦‚ä½•è£…é…è¿™äº›å¸¸ç”¨çš„é›†åˆç±»ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;bean id=\"complexAssembly\" class=\"pojo.ComplexAssembly\"&gt; &lt;!-- è£…é…Longç±»å‹çš„id --&gt; &lt;property name=\"id\" value=\"1\"/&gt; &lt;!-- è£…é…Listç±»å‹çš„list --&gt; &lt;property name=\"list\"&gt; &lt;list&gt; &lt;value&gt;value-list-1&lt;/value&gt; &lt;value&gt;value-list-2&lt;/value&gt; &lt;value&gt;value-list-3&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;!-- è£…é…Mapç±»å‹çš„map --&gt; &lt;property name=\"map\"&gt; &lt;map&gt; &lt;entry key=\"key1\" value=\"value-key-1\"/&gt; &lt;entry key=\"key2\" value=\"value-key-2\"/&gt; &lt;entry key=\"key3\" value=\"value-key-2\"/&gt; &lt;/map&gt; &lt;/property&gt; &lt;!-- è£…é…Propertiesç±»å‹çš„properties --&gt; &lt;property name=\"properties\"&gt; &lt;props&gt; &lt;prop key=\"prop1\"&gt;value-prop-1&lt;/prop&gt; &lt;prop key=\"prop2\"&gt;value-prop-2&lt;/prop&gt; &lt;prop key=\"prop3\"&gt;value-prop-3&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;!-- è£…é…Setç±»å‹çš„set --&gt; &lt;property name=\"set\"&gt; &lt;set&gt; &lt;value&gt;value-set-1&lt;/value&gt; &lt;value&gt;value-set-2&lt;/value&gt; &lt;value&gt;value-set-3&lt;/value&gt; &lt;/set&gt; &lt;/property&gt; &lt;!-- è£…é…String[]ç±»å‹çš„array --&gt; &lt;property name=\"array\"&gt; &lt;array&gt; &lt;value&gt;value-array-1&lt;/value&gt; &lt;value&gt;value-array-2&lt;/value&gt; &lt;value&gt;value-array-3&lt;/value&gt; &lt;/array&gt; &lt;/property&gt;&lt;/bean&gt; æ€»ç»“ï¼š List å±æ€§ä¸ºå¯¹åº”çš„ &lt;list&gt; å…ƒç´ è¿›è¡Œè£…é…ï¼Œç„¶åé€šè¿‡å¤šä¸ª &lt;value&gt; å…ƒç´ è®¾å€¼ Map å±æ€§ä¸ºå¯¹åº”çš„ &lt;map&gt; å…ƒç´ è¿›è¡Œè£…é…ï¼Œç„¶åé€šè¿‡å¤šä¸ª &lt;entry&gt; å…ƒç´ è®¾å€¼ï¼Œåªæ˜¯ entry åŒ…å«ä¸€ä¸ªé”®å€¼å¯¹(key-value)çš„è®¾ç½® Properties å±æ€§ä¸ºå¯¹åº”çš„ &lt;properties&gt; å…ƒç´ è¿›è¡Œè£…é…ï¼Œé€šè¿‡å¤šä¸ª å…ƒç´ è®¾å€¼ï¼Œåªæ˜¯ properties å…ƒç´ æœ‰ä¸€ä¸ªå¿…å¡«å±æ€§ key ï¼Œç„¶åå¯ä»¥è®¾ç½®å€¼ Set å±æ€§ä¸ºå¯¹åº”çš„ &lt;set&gt; å…ƒç´ è¿›è¡Œè£…é…ï¼Œç„¶åé€šè¿‡å¤šä¸ª &lt;value&gt; å…ƒç´ è®¾å€¼ å¯¹äºæ•°ç»„è€Œè¨€ï¼Œå¯ä»¥ä½¿ç”¨ &lt;array&gt; è®¾ç½®å€¼ï¼Œç„¶åé€šè¿‡å¤šä¸ª &lt;value&gt; å…ƒç´ è®¾å€¼ã€‚ ä¸Šé¢çœ‹åˆ°äº†å¯¹ç®€å• String ç±»å‹çš„å„ä¸ªé›†åˆçš„è£…è½½ï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™å¯èƒ½éœ€è¦æ›´ä¸ºå¤æ‚çš„è£…è½½ï¼Œæ¯”å¦‚ä¸€ä¸ª List å¯ä»¥æ˜¯ä¸€ä¸ªç³»åˆ—ç±»çš„å¯¹è±¡ï¼Œä¸ºæ­¤éœ€è¦å®šä¹‰æ³¨å…¥çš„ç›¸å…³ä¿¡æ¯ï¼Œå…¶å®è·Ÿä¸Šé¢çš„é…ç½®æ²¡ä»€ä¹ˆä¸¤æ ·ï¼Œåªä¸è¿‡åŠ å…¥äº† ref è¿™ä¸€ä¸ªå±æ€§è€Œå·²ï¼š é›†åˆæ³¨å…¥æ€»ç»“ï¼š List å±æ€§ä½¿ç”¨ å…ƒç´ å®šä¹‰æ³¨å…¥ï¼Œä½¿ç”¨å¤šä¸ª å…ƒç´ çš„ Bean å±æ€§å»å¼•ç”¨ä¹‹å‰å®šä¹‰å¥½çš„ Bean 123456&lt;property name=\"list\"&gt; &lt;list&gt; &lt;ref bean=\"bean1\"/&gt; &lt;ref bean=\"bean2\"/&gt; &lt;/list&gt;&lt;/property&gt; Map å±æ€§ä½¿ç”¨ å…ƒç´ å®šä¹‰æ³¨å…¥ï¼Œä½¿ç”¨å¤šä¸ª å…ƒç´ çš„ key-ref å±æ€§å»å¼•ç”¨ä¹‹å‰å®šä¹‰å¥½çš„ Bean ä½œä¸ºé”®ï¼Œè€Œç”¨ value-ref å±æ€§å¼•ç”¨ä¹‹å‰å®šä¹‰å¥½çš„ Bean ä½œä¸ºå€¼ 12345&lt;property name=\"map\"&gt; &lt;map&gt; &lt;entry key-ref=\"keyBean\" value-ref=\"valueBean\"/&gt; &lt;/map&gt;&lt;/property&gt; Set å±æ€§ä½¿ç”¨ å…ƒç´ å®šä¹‰æ³¨å…¥ï¼Œä½¿ç”¨å¤šä¸ª å…ƒç´ çš„ bean å»å¼•ç”¨ä¹‹å‰å®šä¹‰å¥½çš„ Bean 12345&lt;property name=\"set\"&gt; &lt;set&gt; &lt;ref bean=\"bean\"/&gt; &lt;/set&gt;&lt;/property&gt; å‘½åç©ºé—´è£…é…é™¤äº†ä¸Šè¿°çš„é…ç½®ä¹‹å¤–ï¼Œ Spring è¿˜æä¾›äº†å¯¹åº”çš„å‘½åç©ºé—´çš„å®šä¹‰ï¼Œåªæ˜¯åœ¨ä½¿ç”¨å‘½åç©ºé—´çš„æ—¶å€™è¦å…ˆå¼•å…¥å¯¹åº”çš„å‘½åç©ºé—´å’Œ XML æ¨¡å¼ï¼ˆXSDï¼‰æ–‡ä»¶ã€‚ c-å‘½åç©ºé—´ c-å‘½åç©ºé—´æ˜¯åœ¨ Spring 3.0 ä¸­å¼•å…¥çš„ï¼Œå®ƒæ˜¯åœ¨ XML ä¸­æ›´ä¸ºç®€æ´åœ°æè¿°æ„é€ å™¨å‚æ•°çš„æ–¹å¼ï¼Œè¦ä½¿ç”¨å®ƒçš„è¯ï¼Œå¿…é¡»è¦åœ¨ XML çš„é¡¶éƒ¨å£°æ˜å…¶æ¨¡å¼ï¼š æ³¨æ„ï¼šæ˜¯é€šè¿‡æ„é€ å™¨å‚æ•°çš„æ–¹å¼ ç°åœ¨å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰è¿™ä¹ˆä¸€ä¸ªç±»ï¼š 1234567891011public class Student &#123; int id; String name; public Student(int id, String name) &#123; this.id = id; this.name = name; &#125; // setter and getter&#125; åœ¨ c-å‘½åç©ºé—´å’Œæ¨¡å¼å£°æ˜ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å®ƒæ¥å£°æ˜æ„é€ å™¨å‚æ•°äº†ï¼š 123456789&lt;!-- å¼•å…¥ c-å‘½åç©ºé—´ä¹‹å‰ --&gt;&lt;bean name=\"student1\" class=\"pojo.Student\"&gt; &lt;constructor-arg name=\"id\" value=\"1\" /&gt; &lt;constructor-arg name=\"name\" value=\"å­¦ç”Ÿ1\"/&gt;&lt;/bean&gt;&lt;!-- å¼•å…¥ c-å‘½åç©ºé—´ä¹‹å --&gt;&lt;bean name=\"student2\" class=\"pojo.Student\" c:id=\"2\" c:name=\"å­¦ç”Ÿ2\"/&gt; c-å‘½åç©ºé—´å±æ€§åä»¥ â€œc:â€ å¼€å¤´ï¼Œä¹Ÿå°±æ˜¯å‘½åç©ºé—´çš„å‰ç¼€ã€‚æ¥ä¸‹æ¥å°±æ˜¯è¦è£…é…çš„æ„é€ å™¨å‚æ•°åï¼Œåœ¨æ­¤ä¹‹åå¦‚æœéœ€è¦æ³¨å…¥å¯¹è±¡çš„è¯åˆ™è¦è·Ÿä¸Š -refï¼ˆå¦‚c:card-ref=&quot;idCard1&quot;ï¼Œåˆ™å¯¹ card è¿™ä¸ªæ„é€ å™¨å‚æ•°æ³¨å…¥ä¹‹å‰é…ç½®çš„åä¸º idCard1 çš„ beanï¼‰ å¾ˆæ˜¾ç„¶ï¼Œä½¿ç”¨ c-å‘½åç©ºé—´å±æ€§è¦æ¯”ä½¿ç”¨ &lt;constructor-arg&gt; å…ƒç´ ç²¾ç®€ï¼Œå¹¶ä¸”ä¼šç›´æ¥å¼•ç”¨æ„é€ å™¨ä¹‹ä¸­å‚æ•°çš„åç§°ï¼Œè¿™æœ‰åˆ©äºæˆ‘ä»¬ä½¿ç”¨çš„å®‰å…¨æ€§ã€‚ æˆ‘ä»¬æœ‰å¦å¤–ä¸€ç§æ›¿ä»£æ–¹å¼ï¼š 12&lt;bean name=\"student2\" class=\"pojo.Student\" c:_0=\"3\" c:_1=\"å­¦ç”Ÿ3\"/&gt; æˆ‘ä»¬å°†å‚æ•°çš„åç§°æ›¿æ¢æˆäº† â€œ0â€ å’Œ â€œ1â€ ï¼Œä¹Ÿå°±æ˜¯å‚æ•°çš„ç´¢å¼•ã€‚å› ä¸ºåœ¨ XML ä¸­ä¸å…è®¸æ•°å­—ä½œä¸ºå±æ€§çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œå› æ­¤å¿…é¡»è¦æ·»åŠ ä¸€ä¸ªä¸‹åˆ’çº¿æ¥ä½œä¸ºå‰ç¼€ã€‚ p-å‘½åç©ºé—´ c-å‘½åç©ºé—´é€šè¿‡æ„é€ å™¨æ³¨å…¥çš„æ–¹å¼æ¥é…ç½® beanï¼Œp-å‘½åç©ºé—´åˆ™æ˜¯ç”¨setterçš„æ³¨å…¥æ–¹å¼æ¥é…ç½® bean ï¼ŒåŒæ ·çš„ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥å£°æ˜ï¼š ç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ p-å‘½åç©ºé—´æ¥è®¾ç½®å±æ€§ï¼š 123456789&lt;!-- å¼•å…¥p-å‘½åç©ºé—´ä¹‹å‰ --&gt;&lt;bean name=\"student1\" class=\"pojo.Student\"&gt; &lt;property name=\"id\" value=\"1\" /&gt; &lt;property name=\"name\" value=\"å­¦ç”Ÿ1\"/&gt;&lt;/bean&gt;&lt;!-- å¼•å…¥p-å‘½åç©ºé—´ä¹‹å --&gt;&lt;bean name=\"student2\" class=\"pojo.Student\" p:id=\"2\" p:name=\"å­¦ç”Ÿ2\"/&gt; æˆ‘ä»¬éœ€è¦å…ˆåˆ æ‰ Student ç±»ä¸­çš„æ„é€ å‡½æ•°ï¼Œä¸ç„¶ XML çº¦æŸä¼šæç¤ºæˆ‘ä»¬é…ç½® &lt;constructor-arg&gt; å…ƒç´ ã€‚ åŒæ ·çš„ï¼Œå¦‚æœå±æ€§éœ€è¦æ³¨å…¥å…¶ä»– Bean çš„è¯ä¹Ÿå¯ä»¥åœ¨åé¢è·Ÿä¸Š -refï¼š 12&lt;bean name=\"student2\" class=\"pojo.Student\" p:id=\"2\" p:name=\"å­¦ç”Ÿ2\" p:cdCard-ref=\"cdCard1\"/&gt; util-å‘½åç©ºé—´ å·¥å…·ç±»çš„å‘½åç©ºé—´ï¼Œå¯ä»¥ç®€åŒ–é›†åˆç±»å…ƒç´ çš„é…ç½®ï¼ŒåŒæ ·çš„æˆ‘ä»¬éœ€è¦å¼•å…¥å…¶å£°æ˜ï¼ˆæ— éœ€æ‹…å¿ƒæ€ä¹ˆå£°æ˜çš„é—®é¢˜ï¼ŒIDEAä¼šæœ‰å¾ˆå‹å¥½çš„æç¤ºï¼‰ï¼š æˆ‘ä»¬æ¥çœ‹çœ‹å¼•å…¥å‰åçš„å˜åŒ–ï¼š 12345678910111213&lt;!-- å¼•å…¥util-å‘½åç©ºé—´ä¹‹å‰ --&gt;&lt;property name=\"list\"&gt; &lt;list&gt; &lt;ref bean=\"bean1\"/&gt; &lt;ref bean=\"bean2\"/&gt; &lt;/list&gt;&lt;/property&gt;&lt;!-- å¼•å…¥util-å‘½åç©ºé—´ä¹‹å --&gt;&lt;util:list id=\"list\"&gt; &lt;ref bean=\"bean1\"/&gt; &lt;ref bean=\"bean2\"/&gt;&lt;/util:list&gt; &lt;util:list&gt; åªæ˜¯ util-å‘½åç©ºé—´ä¸­çš„å¤šä¸ªå…ƒç´ ä¹‹ä¸€ï¼Œä¸‹è¡¨æä¾›äº† util-å‘½åç©ºé—´æä¾›çš„æ‰€æœ‰å…ƒç´ ï¼š ps: é©¬ä¸¹çš„ï¼Œè¿™ä¸ªä¸»é¢˜ä¸æ”¯æŒ markdown çš„è¡¨æ ¼è¯­æ³•ï¼Œfuck å…ƒç´  æè¿° &lt;util:constant&gt; å¼•ç”¨æŸä¸ªç±»å‹çš„ public static åŸŸï¼Œå¹¶å°†å…¶æš´éœ²ä¸º bean &lt;util:list&gt; åˆ›å»ºä¸€ä¸ª java.util.List ç±»å‹çš„ beanï¼Œå…¶ä¸­åŒ…å«å€¼æˆ–å¼•ç”¨ &lt;util:map&gt; åˆ›å»ºä¸€ä¸ª java.util.map ç±»å‹çš„ beanï¼Œå…¶ä¸­åŒ…å«å€¼æˆ–å¼•ç”¨ &lt;util:properties&gt; åˆ›å»ºä¸€ä¸ª java.util.Properties ç±»å‹çš„ bean &lt;util:property-path&gt; å¼•ç”¨ä¸€ä¸ª bean çš„å±æ€§ï¼ˆæˆ–å†…åµŒå±æ€§ï¼‰ï¼Œå¹¶å°†å…¶æš´éœ²ä¸º bean &lt;util:set&gt; åˆ›å»ºä¸€ä¸ª java.util.Set ç±»å‹çš„ beanï¼Œå…¶ä¸­åŒ…å«å€¼æˆ–å¼•ç”¨ å¼•å…¥å…¶ä»–é…ç½®æ–‡ä»¶åœ¨å®é™…å¼€å‘ä¸­ï¼Œéšç€åº”ç”¨ç¨‹åºè§„æ¨¡çš„å¢åŠ ï¼Œç³»ç»Ÿä¸­ &lt;bean&gt; å…ƒç´ é…ç½®çš„æ•°é‡ä¹Ÿä¼šå¤§å¤§å¢åŠ ï¼Œå¯¼è‡´ applicationContext.xml é…ç½®æ–‡ä»¶å˜å¾—éå¸¸è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ã€‚ è§£å†³æ–¹æ¡ˆï¼šè®© applicationContext.xml æ–‡ä»¶åŒ…å«å…¶ä»–é…ç½®æ–‡ä»¶å³å¯ ä½¿ç”¨ &lt;import&gt; å…ƒç´ å¼•å…¥å…¶ä»–é…ç½®æ–‡ä»¶ 1.åœ¨srcæ–‡ä»¶ä¸‹æ–°å»ºä¸€ä¸ª bean.xml æ–‡ä»¶ï¼Œå†™å¥½åŸºç¡€çš„çº¦æŸï¼ŒæŠŠ applicationContext.xml æ–‡ä»¶ä¸­é…ç½®çš„ &lt;bean&gt; å…ƒç´ å¤åˆ¶è¿›å» 2.åœ¨ applicationContext.xml æ–‡ä»¶ä¸­å†™å…¥ï¼š 1&lt;import resource=\"bean.xml\" /&gt; é€šè¿‡æ³¨è§£è£…é… Beanä¸Šé¢ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨ XML çš„æ–¹å¼å»è£…é… Beanï¼Œä½†æ˜¯æ›´å¤šçš„æ—¶å€™å·²ç»ä¸å†æ¨èä½¿ç”¨ XML çš„æ–¹å¼å»è£…é… Beanï¼Œæ›´å¤šçš„æ—¶å€™å›è€ƒè™‘ä½¿ç”¨æ³¨è§£ï¼ˆannotationï¼‰ çš„æ–¹å¼å»è£…é… Beanã€‚ ä¼˜åŠ¿ï¼š å¯ä»¥å‡å°‘ XML çš„é…ç½®ï¼Œå½“é…ç½®é¡¹å¤šçš„æ—¶å€™ï¼Œè‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œæ—¢èƒ½å®ç° XML çš„åŠŸèƒ½ï¼Œä¹Ÿæä¾›äº†è‡ªåŠ¨è£…é…çš„åŠŸèƒ½ï¼Œé‡‡ç”¨äº†è‡ªåŠ¨è£…é…åï¼Œç¨‹åºçŒ¿æ‰€éœ€è¦åšçš„å†³æ–­å°±å°‘äº†ï¼Œæ›´åŠ æœ‰åˆ©äºå¯¹ç¨‹åºçš„å¼€å‘ï¼Œè¿™å°±æ˜¯â€œçº¦å®šå¤§äºé…ç½®â€çš„å¼€å‘åŸåˆ™ åœ¨ Spring ä¸­ï¼Œå®ƒæä¾›äº†ä¸¤ç§æ–¹å¼æ¥è®© Spring IoC å®¹å™¨å‘ç° beanï¼š ç»„ä»¶æ‰«æï¼šé€šè¿‡å®šä¹‰èµ„æº(xmlæ–‡ä»¶)çš„æ–¹å¼ï¼Œè®© Spring IoC å®¹å™¨æ‰«æå¯¹åº”çš„åŒ…ï¼Œä»è€ŒæŠŠ bean è£…é…è¿›æ¥ã€‚ è‡ªåŠ¨è£…é…ï¼šé€šè¿‡æ³¨è§£å®šä¹‰ï¼Œä½¿å¾—ä¸€äº›ä¾èµ–å…³ç³»å¯ä»¥é€šè¿‡æ³¨è§£å®Œæˆã€‚ ä½¿ç”¨@Compoent è£…é… Beanæˆ‘ä»¬æŠŠä¹‹å‰åˆ›å»ºçš„ Student ç±»æ”¹ä¸€ä¸‹ï¼š 1234567891011@Component(value = \"student1\")public class Student &#123; @Value(\"1\") int id; @Value(\"student_name_1\") String name; // getter and setter&#125; @Componentæ³¨è§£ï¼š è¡¨ç¤º Spring IoC ä¼šæŠŠè¿™ä¸ªç±»æ‰«ææˆä¸€ä¸ª bean å®ä¾‹ï¼Œè€Œå…¶ä¸­çš„ value å±æ€§ä»£è¡¨è¿™ä¸ªç±»åœ¨ Spring ä¸­çš„ idï¼Œè¿™å°±ç›¸å½“äºåœ¨ XML ä¸­å®šä¹‰çš„ Bean çš„ idï¼š&lt;bean id=&quot;student1&quot; class=&quot;pojo.Student&quot; /&gt;ï¼Œä¹Ÿå¯ä»¥ç®€å†™æˆ @Component(&quot;student1&quot;)ï¼Œç”šè‡³ç›´æ¥å†™æˆ @Component ï¼Œå¯¹äºä¸å†™çš„ï¼ŒSpring IoC å®¹å™¨å°±é»˜è®¤ä»¥ç±»åæ¥å‘½åä½œä¸º idï¼Œåªä¸è¿‡é¦–å­—æ¯å°å†™ï¼Œé…ç½®åˆ°å®¹å™¨ä¸­ã€‚ @Valueæ³¨è§£ï¼š è¡¨ç¤ºå€¼çš„æ³¨å…¥ï¼Œè·Ÿåœ¨ XML ä¸­å†™ value å±æ€§æ˜¯ä¸€æ ·çš„ã€‚ è¿™æ ·æˆ‘ä»¬å°±å£°æ˜å¥½äº†æˆ‘ä»¬è¦åˆ›å»ºçš„ä¸€ä¸ª Beanï¼Œå°±åƒåœ¨ XML ä¸­å†™ä¸‹äº†è¿™æ ·ä¸€å¥è¯ï¼š 1234&lt;bean name=\"student1\" class=\"pojo.Student\"&gt; &lt;property name=\"id\" value=\"1\" /&gt; &lt;property name=\"name\" value=\"student_name_1\"/&gt;&lt;/bean&gt; ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å£°æ˜äº†è¿™ä¸ªç±»ï¼Œå¹¶ä¸èƒ½è¿›è¡Œä»»ä½•çš„æµ‹è¯•ï¼Œå› ä¸º Spring IoC å¹¶ä¸çŸ¥é“è¿™ä¸ª Bean çš„å­˜åœ¨ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª StudentConfig ç±»å»å‘Šè¯‰ Spring IoC ï¼š 12345import org.springframework.context.annotation.ComponentScan;@ComponentScanpublic class StudentConfig &#123;&#125; è¿™ä¸ªç±»ååˆ†ç®€å•ï¼Œæ²¡æœ‰ä»»ä½•é€»è¾‘ï¼Œä½†æ˜¯éœ€è¦è¯´æ˜ä¸¤ç‚¹ï¼š StudentConfig ç±» å’Œ Student ç±»ä½äºåŒä¸€åŒ…åä¸‹ @ComponentScanæ³¨è§£ï¼š ä»£è¡¨è¿›è¡Œæ‰«æï¼Œé»˜è®¤æ˜¯æ‰«æå½“å‰åŒ…çš„è·¯å¾„ï¼Œæ‰«ææ‰€æœ‰å¸¦æœ‰ @Component æ³¨è§£çš„ POJOã€‚ è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ Spring å®šä¹‰å¥½çš„ Spring IoC å®¹å™¨çš„å®ç°ç±»â€”â€”AnnotationConfigApplicationContext å»ç”Ÿæˆ IoC å®¹å™¨äº†ï¼š 123ApplicationContext context = new AnnotationConfigApplicationContext(StudentConfig.class);Student student = (Student) context.getBean(\"student1\", Student.class);student.printInformation(); è¿™é‡Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº† AnnotationConfigApplicationContext ç±»å»åˆå§‹åŒ– Spring IoC å®¹å™¨ï¼Œå®ƒçš„é…ç½®é¡¹æ˜¯ StudentConfig ç±»ï¼Œè¿™æ · Spring IoC å°±ä¼šæ ¹æ®æ³¨è§£çš„é…ç½®å»è§£æå¯¹åº”çš„èµ„æºï¼Œæ¥ç”Ÿæˆ IoC å®¹å™¨äº†ã€‚ æ˜æ˜¾çš„å¼Šç«¯ï¼š å¯¹äº @ComponentScan æ³¨è§£ï¼Œå®ƒåªæ˜¯æ‰«ææ‰€åœ¨åŒ…çš„ Java ç±»ï¼Œä½†æ˜¯æ›´å¤šçš„æ—¶å€™æˆ‘ä»¬å¸Œæœ›çš„æ˜¯å¯ä»¥æ‰«ææˆ‘ä»¬æŒ‡å®šçš„ç±» ä¸Šé¢çš„ä¾‹å­åªæ˜¯æ³¨å…¥äº†ä¸€äº›ç®€å•çš„å€¼ï¼Œæµ‹è¯•å‘ç°ï¼Œé€šè¿‡ @Value æ³¨è§£å¹¶ä¸èƒ½æ³¨å…¥å¯¹è±¡ @Component æ³¨è§£å­˜åœ¨ç€ä¸¤ä¸ªé…ç½®é¡¹ï¼š basePackagesï¼šå®ƒæ˜¯ç”± base å’Œ package ä¸¤ä¸ªå•è¯ç»„æˆçš„ï¼Œè€Œ package è¿˜æ˜¯ç”¨äº†å¤æ•°ï¼Œæ„å‘³ç€å®ƒå¯ä»¥é…ç½®ä¸€ä¸ª Java åŒ…çš„æ•°ç»„ï¼ŒSpring ä¼šæ ¹æ®å®ƒçš„é…ç½®æ‰«æå¯¹åº”çš„åŒ…å’Œå­åŒ…ï¼Œå°†é…ç½®å¥½çš„ Bean è£…é…è¿›æ¥ basePackageClassesï¼šå®ƒç”± baseã€package å’Œ class ä¸‰ä¸ªå•è¯ç»„æˆï¼Œé‡‡ç”¨å¤æ•°ï¼Œæ„å‘³ç€å®ƒå¯ä»¥é…ç½®å¤šä¸ªç±»ï¼Œ Spring ä¼šæ ¹æ®é…ç½®çš„ç±»æ‰€åœ¨çš„åŒ…ï¼Œä¸ºåŒ…å’Œå­åŒ…è¿›è¡Œæ‰«æè£…é…å¯¹åº”é…ç½®çš„ Bean æˆ‘ä»¬æ¥è¯•ç€é‡æ„ä¹‹å‰å†™çš„ StudentConfig ç±»æ¥éªŒè¯ä¸Šé¢ä¸¤ä¸ªé…ç½®é¡¹ï¼š 1234567891011121314import org.springframework.context.annotation.ComponentScan;@ComponentScan(basePackages = \"pojo\")public class StudentConfig &#123;&#125;// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ` å®‡å®™è¶…çº§æ— æ•Œåˆ†å‰²çº¿`â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” package pojo;import org.springframework.context.annotation.ComponentScan;@ComponentScan(basePackageClasses = pojo.Student.class)public class StudentConfig &#123;&#125; å¯¹äº basePackages å’Œ basePackageClasses çš„é€‰æ‹©é—®é¢˜ï¼š basePackages çš„å¯è¯»æ€§ä¼šæ›´å¥½ä¸€äº›ï¼Œæ‰€ä»¥åœ¨é¡¹ç›®ä¸­ä¼šä¼˜å…ˆé€‰æ‹©ä½¿ç”¨å®ƒï¼Œä½†æ˜¯åœ¨éœ€è¦å¤§é‡é‡æ„çš„å·¥ç¨‹ä¸­ï¼Œå°½é‡ä¸è¦ä½¿ç”¨basePackagesï¼Œå› ä¸ºå¾ˆå¤šæ—¶å€™é‡æ„ä¿®æ”¹åŒ…åéœ€è¦åå¤åœ°é…ç½®ï¼Œè€Œ IDE ä¸ä¼šç»™ä½ ä»»ä½•çš„æç¤ºï¼Œè€Œé‡‡ç”¨basePackageClassesä¼šæœ‰é”™è¯¯æç¤ºã€‚ è‡ªåŠ¨è£…é…â€”â€”@Autowiredä¸Šé¢æåˆ°çš„ä¸¤ä¸ªå¼Šç«¯ä¹‹ä¸€å°±æ˜¯æ²¡æœ‰åŠæ³•æ³¨å…¥å¯¹è±¡ï¼Œé€šè¿‡è‡ªåŠ¨è£…é…æˆ‘ä»¬å°†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æ‰€è°“è‡ªåŠ¨è£…é…æŠ€æœ¯æ˜¯ä¸€ç§ç”± Spring è‡ªå·±å‘ç°å¯¹åº”çš„ Beanï¼Œè‡ªåŠ¨å®Œæˆè£…é…å·¥ä½œçš„æ–¹å¼ï¼Œå®ƒä¼šåº”ç”¨åˆ°ä¸€ä¸ªååˆ†å¸¸ç”¨çš„æ³¨è§£ @Autowired ä¸Šï¼Œè¿™ä¸ªæ—¶å€™ Spring ä¼šæ ¹æ®ç±»å‹å»å¯»æ‰¾å®šä¹‰çš„ Bean ç„¶åå°†å…¶æ³¨å…¥ï¼Œå¬èµ·æ¥å¾ˆç¥å¥‡ï¼Œè®©æˆ‘ä»¬å®é™…æ¥çœ‹ä¸€çœ‹ï¼š å…ˆåœ¨ Packageserviceä¸‹åˆ›å»ºä¸€ä¸ª StudentService æ¥å£ï¼š 12345package service;public interface StudentService &#123; public void printStudentInfo();&#125; ä½¿ç”¨æ¥å£æ˜¯ Spring æ¨èçš„æ–¹å¼ï¼Œè¿™æ ·å¯ä»¥æ›´ä¸ºçµæ´»ï¼Œå¯ä»¥å°†å®šä¹‰å’Œå®ç°åˆ†ç¦» ä¸ºä¸Šé¢çš„æ¥å£åˆ›å»ºä¸€ä¸ª StudentServiceImp å®ç°ç±»ï¼š 123456789101112131415161718package service;import org.springframework.beans.factory.annotation.Autowired;import pojo.Student;@Component(\"studentService\")public class StudentServiceImp implements StudentService &#123; @Autowired private Student student = null; // getter and setter public void printStudentInfo() &#123; System.out.println(\"å­¦ç”Ÿçš„ id ä¸ºï¼š\" + student.getName()); System.out.println(\"å­¦ç”Ÿçš„ name ä¸ºï¼š\" + student.getName()); &#125;&#125; è¯¥å®ç°ç±»å®ç°äº†æ¥å£çš„ printStudentInfo() æ–¹æ³•ï¼Œæ‰“å°å‡ºæˆå‘˜å¯¹è±¡ student çš„ç›¸å…³ä¿¡æ¯ï¼Œè¿™é‡Œçš„ @Autowiredæ³¨è§£ï¼Œè¡¨ç¤ºåœ¨ Spring IoC å®šä½æ‰€æœ‰çš„ Bean åï¼Œè¿™ä¸ªå­—æ®µéœ€è¦æŒ‰ç±»å‹æ³¨å…¥ï¼Œè¿™æ · IoC å®¹å™¨å°±ä¼šå¯»æ‰¾èµ„æºï¼Œç„¶åå°†å…¶æ³¨å…¥ã€‚ ç¼–å†™æµ‹è¯•ç±»ï¼š 12345678// ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹ StudentConfig ç±»ï¼Œå‘Šè¯‰ Spring IoC åœ¨å“ªé‡Œå»æ‰«æå®ƒï¼špackage pojo;import org.springframework.context.annotation.ComponentScan;@ComponentScan(basePackages = &#123;\"pojo\", \"service\"&#125;)public class StudentConfig &#123;&#125; 123// æˆ–è€…ä¹Ÿå¯ä»¥åœ¨ XML æ–‡ä»¶ä¸­å£°æ˜å»å“ªé‡Œåšæ‰«æ&lt;context:component-scan base-package=\"pojo\" /&gt;&lt;context:component-scan base-package=\"service\" /&gt; 123456789101112131415161718192021// ç¬¬äºŒæ­¥ï¼šç¼–å†™æµ‹è¯•ç±»ï¼špackage test;import org.springframework.context.ApplicationContext;import org.springframework.context.annotation.AnnotationConfigApplicationContext;import pojo.StudentConfig;import service.StudentService;import service.StudentServiceImp;public class TestSpring &#123; public static void main(String[] args) &#123; // é€šè¿‡æ³¨è§£çš„æ–¹å¼åˆå§‹åŒ– Spring IoC å®¹å™¨ ApplicationContext context = new AnnotationConfigApplicationContext(StudentConfig.class); StudentService studentService = context.getBean(\"studentService\", StudentServiceImp.class); studentService.printStudentInfo(); &#125;&#125;å­¦ç”Ÿçš„ id ä¸ºï¼šstudent_id_1å­¦ç”Ÿçš„ name ä¸ºï¼šstudent_name_1 å†æ¬¡ç†è§£ï¼š @Autowired æ³¨è§£è¡¨ç¤ºåœ¨ Spring IoC å®šä½æ‰€æœ‰çš„ Bean åï¼Œå†æ ¹æ®ç±»å‹å¯»æ‰¾èµ„æºï¼Œç„¶åå°†å…¶æ³¨å…¥ã€‚ è¿‡ç¨‹ï¼š å®šä¹‰ Bean â€”â€”&gt; åˆå§‹åŒ– Beanï¼ˆæ‰«æï¼‰ â€”â€”&gt; æ ¹æ®å±æ€§éœ€è¦ä» Spring IoC å®¹å™¨ä¸­æœå¯»æ»¡è¶³è¦æ±‚çš„ Bean â€”â€”&gt; æ»¡è¶³è¦æ±‚åˆ™æ³¨å…¥ é—®é¢˜ï¼š IoC å®¹å™¨å¯èƒ½ä¼šå¯»æ‰¾å¤±è´¥ï¼Œæ­¤æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring IoC å®¹å™¨ä¼šè®¤ä¸ºä¸€å®šè¦æ‰¾åˆ°å¯¹åº”çš„ Bean æ¥æ³¨å…¥åˆ°è¿™ä¸ªå­—æ®µï¼Œä½†æœ‰äº›æ—¶å€™å¹¶ä¸æ˜¯ä¸€å®šéœ€è¦ï¼Œæ¯”å¦‚æ—¥å¿—ï¼‰ è§£å†³ï¼š é€šè¿‡é…ç½®é¡¹ required æ¥æ”¹å˜ï¼Œæ¯”å¦‚ @Autowired(required = false) @Autowired æ³¨è§£ä¸ä»…ä»…èƒ½é…ç½®åœ¨å±æ€§ä¹‹ä¸Šï¼Œè¿˜å…è®¸æ–¹æ³•é…ç½®ï¼Œå¸¸è§çš„ Bean çš„ setter æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥å®Œæˆæ³¨å…¥ï¼Œæ€»ä¹‹ä¸€åˆ‡éœ€è¦ Spring IoC å»å¯»æ‰¾ Bean èµ„æºçš„åœ°æ–¹éƒ½å¯ä»¥ç”¨åˆ°ï¼Œä¾‹å¦‚ï¼š 1234567public class JuiceMaker &#123; // ...... @Autowired public void setSource(Source source) &#123; this.source = source; &#125;&#125; åœ¨å¤§éƒ¨åˆ†çš„é…ç½®ä¸­éƒ½æ¨èä½¿ç”¨è¿™æ ·çš„è‡ªåŠ¨æ³¨å…¥æ¥å®Œæˆï¼Œè¿™æ˜¯ Spring IoC å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨è£…é…å®Œæˆçš„ï¼Œè¿™æ ·ä½¿å¾—é…ç½®å¤§å¹…åº¦å‡å°‘ï¼Œæ»¡è¶³çº¦å®šä¼˜äºé…ç½®çš„åŸåˆ™ï¼Œå¢å¼ºç¨‹åºçš„å¥å£®æ€§ã€‚ è‡ªåŠ¨è£…é…çš„æ­§ä¹‰æ€§ï¼ˆ@Primaryå’Œ@Qualifierï¼‰åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨ @Autowired æ³¨è§£æ¥è‡ªåŠ¨æ³¨å…¥ä¸€ä¸ª Source ç±»å‹çš„ Bean èµ„æºï¼Œä½†å¦‚æœæˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ª Srouce ç±»å‹çš„èµ„æºï¼ŒSpring IoC å°±ä¼šä¸çŸ¥æ‰€æªï¼Œä¸çŸ¥é“ç©¶ç«Ÿè¯¥å¼•å…¥å“ªä¸€ä¸ª Beanï¼š 12345678910&lt;bean name=\"source1\" class=\"pojo.Source\"&gt; &lt;property name=\"fruit\" value=\"æ©™å­\"/&gt; &lt;property name=\"sugar\" value=\"å¤šç³–\"/&gt; &lt;property name=\"size\" value=\"è¶…å¤§æ¯\"/&gt;&lt;/bean&gt;&lt;bean name=\"source2\" class=\"pojo.Source\"&gt; &lt;property name=\"fruit\" value=\"æ©™å­\"/&gt; &lt;property name=\"sugar\" value=\"å°‘ç³–\"/&gt; &lt;property name=\"size\" value=\"å°æ¯\"/&gt;&lt;/bean&gt; æˆ‘ä»¬å¯ä»¥ä¼šæƒ³åˆ° Spring IoC æœ€åº•å±‚çš„å®¹å™¨æ¥å£â€”â€”BeanFactory çš„å®šä¹‰ï¼Œå®ƒå­˜åœ¨ä¸€ä¸ªæŒ‰ç…§ç±»å‹è·å– Bean çš„æ–¹æ³•ï¼Œæ˜¾ç„¶é€šè¿‡ Source.class ä½œä¸ºå‚æ•°æ— æ³•åˆ¤æ–­ä½¿ç”¨å“ªä¸ªç±»å®ä¾‹è¿›è¡Œè¿”å›ï¼Œè¿™å°±æ˜¯è‡ªåŠ¨è£…é…çš„æ­§ä¹‰æ€§ã€‚ ä¸ºäº†æ¶ˆé™¤æ­§ä¹‰æ€§ï¼ŒSpring æä¾›äº†ä¸¤ä¸ªæ³¨è§£ï¼š @Primaryæ³¨è§£ï¼š ä»£è¡¨é¦–è¦çš„ï¼Œå½“ Spring IoC æ£€æµ‹åˆ°æœ‰å¤šä¸ªç›¸åŒç±»å‹çš„ Bean èµ„æºçš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆæ³¨å…¥ä½¿ç”¨è¯¥æ³¨è§£çš„ç±»ã€‚ é—®é¢˜ï¼šè¯¥æ³¨è§£åªæ˜¯è§£å†³äº†é¦–è¦çš„é—®é¢˜ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰é€‰æ‹©æ€§çš„é—®é¢˜ @Qualifieræ³¨è§£ï¼š ä¸Šé¢æ‰€è°ˆåŠçš„æ­§ä¹‰æ€§ï¼Œä¸€ä¸ªé‡è¦çš„åŸå› æ˜¯ Spring åœ¨å¯»æ‰¾ä¾èµ–æ³¨å…¥çš„æ—¶å€™æ˜¯æŒ‰ç…§ç±»å‹æ³¨å…¥å¼•èµ·çš„ã€‚é™¤äº†æŒ‰ç±»å‹æŸ¥æ‰¾ Beanï¼ŒSpring IoC å®¹å™¨æœ€åº•å±‚çš„æ¥å£ BeanFactory è¿˜æä¾›äº†æŒ‰åå­—æŸ¥æ‰¾çš„æ–¹æ³•ï¼Œå¦‚æœæŒ‰ç…§åå­—æ¥æŸ¥æ‰¾å’Œæ³¨å…¥ä¸å°±èƒ½æ¶ˆé™¤æ­§ä¹‰æ€§äº†å—ï¼Ÿ ä½¿ç”¨æ–¹æ³•ï¼š æŒ‡å®šæ³¨å…¥åç§°ä¸º &quot;source1&quot; çš„ Bean èµ„æº: 12345678public class JuiceMaker &#123; ...... @Autowired @Qualifier(\"source1\") public void setSource(Source source) &#123; this.source = source; &#125;&#125; ä½¿ç”¨@Bean è£…é… Beané—®é¢˜ï¼š ä»¥ä¸Šéƒ½æ˜¯é€šè¿‡ @Component æ³¨è§£æ¥è£…é… Bean ï¼Œå¹¶ä¸”åªèƒ½æ³¨è§£åœ¨ç±»ä¸Šï¼Œå½“ä½ éœ€è¦å¼•ç”¨ç¬¬ä¸‰æ–¹åŒ…çš„ï¼ˆjar æ–‡ä»¶ï¼‰ï¼Œè€Œä¸”å¾€å¾€å¹¶æ²¡æœ‰è¿™äº›åŒ…çš„æºç ï¼Œè¿™æ—¶å€™å°†æ— æ³•ä¸ºè¿™äº›åŒ…çš„ç±»åŠ å…¥ @Component æ³¨è§£ï¼Œè®©å®ƒä»¬å˜æˆå¼€å‘ç¯å¢ƒä¸­çš„ Bean èµ„æºã€‚ è§£å†³æ–¹æ¡ˆï¼š è‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»æ¥æ‰©å±•åŒ…é‡Œçš„ç±»ï¼Œç„¶åå†æ–°ç±»ä¸Šä½¿ç”¨ @Component æ³¨è§£ï¼Œä½†è¿™æ ·å¾ˆ low ä½¿ç”¨ @Bean æ³¨è§£ï¼Œæ³¨è§£åˆ°æ–¹æ³•ä¹‹ä¸Šï¼Œä½¿å…¶æˆä¸º Spring ä¸­è¿”å›å¯¹è±¡ä¸º Spring çš„ Bean èµ„æºã€‚ æˆ‘ä»¬åœ¨ Package pojo ä¸‹æ–°å»ºä¸€ä¸ªç”¨æ¥æµ‹è¯• @Bean æ³¨è§£çš„ç±»ï¼š 1234567891011121314package pojo;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;@Configurationpublic class BeanTester &#123; @Bean(name = \"testBean\") public String test() &#123; String str = \"æµ‹è¯•@Beanæ³¨è§£\"; return str; &#125;&#125; @Configuration æ³¨è§£ç›¸å½“äº XML æ–‡ä»¶çš„æ ¹å…ƒç´ ï¼Œå¿…é¡»è¦ï¼Œæœ‰äº†æ‰èƒ½è§£æå…¶ä¸­çš„ @Bean æ³¨è§£ ç„¶åæˆ‘ä»¬åœ¨æµ‹è¯•ç±»ä¸­ç¼–å†™ä»£ç ï¼Œä» Spring IoC å®¹å™¨ä¸­è·å–åˆ°è¿™ä¸ª Bean ï¼š 1234// åœ¨ pojo åŒ…ä¸‹æ‰«æApplicationContext context = new AnnotationConfigApplicationContext(\"pojo\");// å› ä¸ºè¿™é‡Œè·å–åˆ°çš„ Bean å°±æ˜¯ String ç±»å‹æ‰€ä»¥ç›´æ¥è¾“å‡ºSystem.out.println(context.getBean(\"testBean\")); @Bean çš„é…ç½®é¡¹ä¸­åŒ…å« 4 ä¸ªé…ç½®é¡¹ï¼š nameï¼š æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå…è®¸é…ç½®å¤šä¸ª BeanName autowireï¼š æ ‡å¿—æ˜¯å¦æ˜¯ä¸€ä¸ªå¼•ç”¨çš„ Bean å¯¹è±¡ï¼Œé»˜è®¤å€¼æ˜¯ Autowire.NO initMethodï¼š è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³• destroyMethodï¼š è‡ªå®šä¹‰é”€æ¯æ–¹æ³• ä½¿ç”¨ @Bean æ³¨è§£çš„å¥½å¤„å°±æ˜¯èƒ½å¤ŸåŠ¨æ€è·å–ä¸€ä¸ª Bean å¯¹è±¡ï¼Œèƒ½å¤Ÿæ ¹æ®ç¯å¢ƒä¸åŒå¾—åˆ°ä¸åŒçš„ Bean å¯¹è±¡ã€‚æˆ–è€…è¯´å°† Spring å’Œå…¶ä»–ç»„ä»¶åˆ†ç¦»ï¼ˆå…¶ä»–ç»„ä»¶ä¸ä¾èµ– Springï¼Œä½†æ˜¯åˆæƒ³ Spring ç®¡ç†ç”Ÿæˆçš„ Beanï¼‰ Bean çš„ä½œç”¨åŸŸåœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼ŒSpring IoC å®¹å™¨åªä¼šå¯¹ä¸€ä¸ª Bean åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé€šè¿‡ Spring IoC å®¹å™¨è·å–å¤šä¸ªå®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ @Scope æ³¨è§£æˆ–è€… &lt;bean&gt; å…ƒç´ ä¸­çš„ scope å±æ€§æ¥è®¾ç½®ï¼Œä¾‹å¦‚ï¼š 1234// XML ä¸­è®¾ç½®ä½œç”¨åŸŸ&lt;bean id=\"\" class=\"\" scope=\"prototype\" /&gt;// ä½¿ç”¨æ³¨è§£è®¾ç½®ä½œç”¨åŸŸ@Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE) Spring æä¾›äº† 5 ç§ä½œç”¨åŸŸï¼Œå®ƒä¼šæ ¹æ®æƒ…å†µæ¥å†³å®šæ˜¯å¦ç”Ÿæˆæ–°çš„å¯¹è±¡ï¼š ä½œç”¨åŸŸç±»åˆ« æè¿° singleton(å•ä¾‹) åœ¨Spring IoCå®¹å™¨ä¸­ä»…å­˜åœ¨ä¸€ä¸ªBeanå®ä¾‹ ï¼ˆé»˜è®¤çš„scopeï¼‰ prototype(å¤šä¾‹) æ¯æ¬¡ä»å®¹å™¨ä¸­è°ƒç”¨Beanæ—¶ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå³æ¯æ¬¡è°ƒç”¨getBean()æ—¶ ï¼Œç›¸å½“äºæ‰§è¡Œnew XxxBean()ï¼šä¸ä¼šåœ¨å®¹å™¨å¯åŠ¨æ—¶åˆ›å»ºå¯¹è±¡ request(è¯·æ±‚) ç”¨äºwebå¼€å‘ï¼Œå°†Beanæ”¾å…¥requestèŒƒå›´ ï¼Œrequest.setAttribute(â€œxxxâ€) ï¼Œ åœ¨åŒä¸€ä¸ªrequest è·å¾—åŒä¸€ä¸ªBean session(ä¼šè¯) ç”¨äºwebå¼€å‘ï¼Œå°†Bean æ”¾å…¥SessionèŒƒå›´ï¼Œåœ¨åŒä¸€ä¸ªSession è·å¾—åŒä¸€ä¸ªBean globalSession(å…¨å±€ä¼šè¯) ä¸€èˆ¬ç”¨äº Porlet åº”ç”¨ç¯å¢ƒ , åˆ†å¸ƒå¼ç³»ç»Ÿå­˜åœ¨å…¨å±€ session æ¦‚å¿µï¼ˆå•ç‚¹ç™»å½•ï¼‰ï¼Œå¦‚æœä¸æ˜¯ porlet ç¯å¢ƒï¼ŒglobalSession ç­‰åŒäº Session åœ¨å¼€å‘ä¸­ä¸»è¦ä½¿ç”¨ scope=&quot;singleton&quot;ã€scope=&quot;prototype&quot;ï¼Œå¯¹äºMVCä¸­çš„Actionä½¿ç”¨prototypeç±»å‹ï¼Œå…¶ä»–ä½¿ç”¨singletonï¼ŒSpringå®¹å™¨ä¼šç®¡ç† Action å¯¹è±¡çš„åˆ›å»º,æ­¤æ—¶æŠŠ Action çš„ä½œç”¨åŸŸè®¾ç½®ä¸º prototype. æ‰©å±•é˜…è¯»ï¼š@Profile æ³¨è§£ ã€ æ¡ä»¶åŒ–è£…é… Bean Spring è¡¨è¾¾å¼è¯­è¨€ç®€è¦è¯´æ˜Spring è¿˜æä¾›äº†æ›´çµæ´»çš„æ³¨å…¥æ–¹å¼ï¼Œé‚£å°±æ˜¯ Spring è¡¨è¾¾å¼ï¼Œå®é™…ä¸Š Spring EL è¿œæ¯”ä»¥ä¸Šæ³¨å…¥æ–¹å¼éƒ½è¦å¼ºå¤§ï¼Œå®ƒæ‹¥æœ‰å¾ˆå¤šåŠŸèƒ½ï¼š ä½¿ç”¨ Bean çš„ id æ¥å¼•ç”¨ Bean è°ƒç”¨æŒ‡å®šå¯¹è±¡çš„æ–¹æ³•å’Œè®¿é—®å¯¹è±¡çš„å±æ€§ è¿›è¡Œè¿ç®— æä¾›æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é… é›†åˆé…ç½® æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä½¿ç”¨ Spring è¡¨è¾¾å¼çš„ä¾‹å­ï¼š 1234567891011121314151617181920package pojo;import org.springframework.beans.factory.annotation.Value;import org.springframework.stereotype.Component;@Component(\"elBean\")public class ElBean &#123; // é€šè¿‡ beanName è·å– beanï¼Œç„¶åæ³¨å…¥ @Value(\"#&#123;role&#125;\") private Role role; // è·å– bean çš„å±æ€§ id @Value(\"#&#123;role.id&#125;\") private Long id; // è°ƒç”¨ bean çš„ getNote æ–¹æ³• @Value(\"#&#123;role.getNote().toString()&#125;\") private String note; /* getter and setter */&#125; ä¸å±æ€§æ–‡ä»¶ä¸­è¯»å–ä½¿ç”¨çš„ â€œ$â€ ä¸åŒï¼Œåœ¨ Spring EL ä¸­åˆ™ä½¿ç”¨ â€œ#â€ æ‰©å±•é˜…è¯»ï¼š Spring è¡¨è¾¾å¼è¯­è¨€","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Spring","slug":"Code/Spring","permalink":"http://xiaoqinghua.site/categories/Code/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"http://xiaoqinghua.site/tags/Spring/"}]},{"title":"Springä¹‹IoCæ€»ç»“","slug":"Springä¹‹IoCæ€»ç»“","date":"2017-12-03T02:58:53.000Z","updated":"2018-09-07T05:19:46.631Z","comments":true,"path":"Springä¹‹IoCæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Springä¹‹IoCæ€»ç»“.html","excerpt":"","text":"Spring IoC é˜è¿°è¿™å°±æ˜¯ä¸€ç§æ§åˆ¶åè½¬çš„ç†å¿µï¼šæ§åˆ¶åè½¬æ˜¯ä¸€ç§é€šè¿‡æè¿°ï¼ˆåœ¨ Java ä¸­å¯ä»¥æ˜¯ XML æˆ–è€…æ³¨è§£ï¼‰å¹¶é€šè¿‡ç¬¬ä¸‰æ–¹ï¼ˆSpringï¼‰å»äº§ç”Ÿæˆ–è·å–ç‰¹å®šå¯¹è±¡çš„æ–¹å¼ã€‚ å¥½å¤„ï¼š é™ä½å¯¹è±¡ä¹‹é—´çš„è€¦åˆ æˆ‘ä»¬ä¸éœ€è¦ç†è§£ä¸€ä¸ªç±»çš„å…·ä½“å®ç°ï¼Œåªéœ€è¦çŸ¥é“å®ƒæœ‰ä»€ä¹ˆç”¨å°±å¥½äº†ï¼ˆç›´æ¥å‘ IoC å®¹å™¨æ‹¿ï¼‰ ä¸»åŠ¨åˆ›å»ºçš„æ¨¡å¼ä¸­ï¼Œè´£ä»»å½’äºå¼€å‘è€…ï¼Œè€Œåœ¨è¢«åŠ¨çš„æ¨¡å¼ä¸‹ï¼Œè´£ä»»å½’äº IoC å®¹å™¨ï¼ŒåŸºäºè¿™æ ·çš„è¢«åŠ¨å½¢å¼ï¼Œæˆ‘ä»¬å°±è¯´å¯¹è±¡è¢«æ§åˆ¶åè½¬äº†ã€‚ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯åè½¬äº†æ§åˆ¶ï¼‰ Spring IoC å®¹å™¨Spring ä¼šæä¾› IoC å®¹å™¨æ¥ç®¡ç†å’Œå®¹çº³æˆ‘ä»¬æ‰€å¼€å‘çš„å„ç§å„æ ·çš„ Beanï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ä»ä¸­è·å–å„ç§å‘å¸ƒåœ¨ Spring IoC å®¹å™¨é‡Œçš„ Beanï¼Œå¹¶ä¸”é€šè¿‡æè¿°å¯ä»¥å¾—åˆ°å®ƒã€‚ Spring IoC å®¹å™¨çš„è®¾è®¡Spring IoC å®¹å™¨çš„è®¾è®¡ä¸»è¦æ˜¯åŸºäºä»¥ä¸‹ä¸¤ä¸ªæ¥å£ï¼š BeanFactory ApplicationContext å…¶ä¸­ ApplicationContext æ˜¯ BeanFactory çš„å­æ¥å£ä¹‹ä¸€ï¼Œæ¢å¥è¯è¯´ï¼šBeanFactory æ˜¯ Spring IoC å®¹å™¨æ‰€å®šä¹‰çš„æœ€åº•åº•æ¥å£ï¼Œè€Œ ApplicationContext æ˜¯å…¶æœ€é«˜çº§æ¥å£ä¹‹ä¸€ï¼Œå¹¶å¯¹ BeanFactory åŠŸèƒ½åšäº†è®¸å¤šçš„æ‰©å±•ï¼Œæ‰€ä»¥åœ¨ç»å¤§éƒ¨åˆ†çš„å·¥ä½œåœºæ™¯ä¸‹ï¼Œéƒ½ä¼šä½¿ç”¨ ApplicationContext ä½œä¸º Spring IoC å®¹å™¨ã€‚ BeanFactoryä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥å‡ ä¹çœ‹åˆ°ï¼Œ BeanFactory ä½äºè®¾è®¡çš„æœ€åº•å±‚ï¼Œå®ƒæä¾›äº† Spring IoC æœ€åº•å±‚çš„è®¾è®¡ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¯¥ç±»ä¸­æä¾›äº†å“ªäº›æ–¹æ³• 1234567891011121314151617181920212223242526String FACTORY_BEAN_PREFIX = \"&amp;\";Object getBean(String name) throws BeansException;&lt;T&gt; T getBean(String name, @Nullable Class&lt;T&gt; requiredType) throws BeansException;Object getBean(String name, Object... args) throws BeansException;&lt;T&gt; T getBean(Class&lt;T&gt; requiredType) throws BeansException;&lt;T&gt; T getBean(Class&lt;T&gt; requiredType, Object... args) throws BeansException;boolean containsBean(String name);boolean isSingleton(String name) throws NoSuchBeanDefinitionException;boolean isPrototype(String name) throws NoSuchBeanDefinitionException;boolean isTypeMatch(String name, ResolvableType typeToMatch) throws NoSuchBeanDefinitionException;boolean isTypeMatch(String name, @Nullable Class&lt;?&gt; typeToMatch) throws NoSuchBeanDefinitionException;@NullableClass&lt;?&gt; getType(String name) throws NoSuchBeanDefinitionException;String[] getAliases(String name); ç”±äºè¿™ä¸ªæ¥å£çš„é‡è¦æ€§ï¼Œæ‰€ä»¥æœ‰å¿…è¦åœ¨è¿™é‡Œä½œä¸€ä¸‹ç®€çŸ­çš„è¯´æ˜ï¼š getBean å¯¹åº”äº†å¤šä¸ªæ–¹æ³•æ¥è·å–é…ç½®ç»™ Spring IoC å®¹å™¨çš„ Beanã€‚ æŒ‰ç…§ç±»å‹æ‹¿ beanï¼š 1bean = (Bean) factory.getBean(Bean.class); æ³¨æ„ï¼šè¦æ±‚åœ¨ Spring ä¸­åªé…ç½®äº†ä¸€ä¸ªè¿™ç§ç±»å‹çš„å®ä¾‹ï¼Œå¦åˆ™æŠ¥é”™ã€‚ï¼ˆå¦‚æœæœ‰å¤šä¸ªé‚£ Spring å°±æ‡µäº†ï¼Œä¸çŸ¥é“è¯¥è·å–å“ªä¸€ä¸ªï¼‰ æŒ‰ç…§ bean çš„åå­—æ‹¿ bean: 1bean = (Bean) factory.getBean(\"beanName\"); æ³¨æ„ï¼šè¿™ç§æ–¹æ³•ä¸å¤ªå®‰å…¨ï¼ŒIDE ä¸ä¼šæ£€æŸ¥å…¶å®‰å…¨æ€§ï¼ˆå…³è”æ€§ï¼‰ æŒ‰ç…§åå­—å’Œç±»å‹æ‹¿ beanï¼šï¼ˆæ¨èï¼‰ 1bean = (Bean) factory.getBean(\"beanName\", Bean.class); isSingleton ç”¨äºåˆ¤æ–­æ˜¯å¦å•ä¾‹ï¼Œå¦‚æœåˆ¤æ–­ä¸ºçœŸï¼Œå…¶æ„æ€æ˜¯è¯¥ Bean åœ¨å®¹å™¨ä¸­æ˜¯ä½œä¸ºä¸€ä¸ªå”¯ä¸€å•ä¾‹å­˜åœ¨çš„ã€‚è€ŒisPrototypeåˆ™ç›¸åï¼Œå¦‚æœåˆ¤æ–­ä¸ºçœŸï¼Œæ„æ€æ˜¯å½“ä½ ä»å®¹å™¨ä¸­è·å– Beanï¼Œå®¹å™¨å°±ä¸ºä½ ç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚ æ³¨æ„ï¼šåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œã€isSingletonã€‘ä¸º tureï¼Œè€Œã€isPrototypeã€‘ä¸º false å…³äº type çš„åŒ¹é…ï¼Œè¿™æ˜¯ä¸€ä¸ªæŒ‰ Java ç±»å‹åŒ¹é…çš„æ–¹å¼ getAliasesæ–¹æ³•æ˜¯è·å–åˆ«åçš„æ–¹æ³• è¿™å°±æ˜¯ Spring IoC æœ€åº•å±‚çš„è®¾è®¡ï¼Œæ‰€æœ‰å…³äº Spring IoC çš„å®¹å™¨å°†ä¼šéµå®ˆå®ƒæ‰€å®šä¹‰çš„æ–¹æ³•ã€‚ ApplicationContextæ ¹æ® ApplicationContext çš„ç±»ç»§æ‰¿å…³ç³»å›¾ï¼Œå¯ä»¥çœ‹åˆ° ApplicationContext æ¥å£æ‰©å±•äº†è®¸è®¸å¤šå¤šçš„æ¥å£ï¼Œå› æ­¤å®ƒçš„åŠŸèƒ½ååˆ†å¼ºå¤§ï¼Œæ‰€ä»¥åœ¨å®é™…åº”ç”¨ä¸­å¸¸å¸¸ä¼šä½¿ç”¨åˆ°çš„æ˜¯ ApplicationContext æ¥å£ï¼Œå› ä¸º BeanFactory çš„æ–¹æ³•å’ŒåŠŸèƒ½è¾ƒå°‘ï¼Œè€Œ ApplicationContext çš„æ–¹æ³•å’ŒåŠŸèƒ½è¾ƒå¤šã€‚ æˆ‘ä»¬æ¥è®¤è¯†ä¸€ä¸ª ApplicationContext çš„å®ç°ç±»â€”â€”ClassPathXmlApplicationContextã€‚ 12ApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\");Source source = (Source) context.getBean(\"source\", Source.class); è¿™æ ·å°±ä¼šä½¿ç”¨ Application çš„å®ç°ç±» ClassPathXmlApplicationContext å»åˆå§‹åŒ– Spring IoC å®¹å™¨ï¼Œç„¶åå¼€å‘è€…å°±å¯ä»¥é€šè¿‡ IoC å®¹å™¨æ¥è·å–èµ„æºäº†å•¦ï¼ ApplicationContext å¸¸è§å®ç°ç±»ï¼š1.ClassPathXmlApplicationContextï¼š è¯»å–classpathä¸­çš„èµ„æº 1ApplicationContext ctx = new ClassPathXmlApplicationContext(\"applicationContext.xml\"); 2:FileSystemXmlApplicationContext: è¯»å–æŒ‡å®šè·¯å¾„çš„èµ„æº 1ApplicationContext ac = new FileSystemXmlApplicationContext(\"c:/applicationContext.xml\"); 3.XmlWebApplicationContext: éœ€è¦åœ¨Webçš„ç¯å¢ƒä¸‹æ‰å¯ä»¥è¿è¡Œ 1234XmlWebApplicationContext ac = new XmlWebApplicationContext(); // è¿™æ—¶å¹¶æ²¡æœ‰åˆå§‹åŒ–å®¹å™¨ac.setServletContext(servletContext); // éœ€è¦æŒ‡å®šServletContextå¯¹è±¡ac.setConfigLocation(\"/WEB-INF/applicationContext.xml\"); // æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ï¼Œå¼€å¤´çš„æ–œçº¿è¡¨ç¤ºWebåº”ç”¨çš„æ ¹ç›®å½•ac.refresh(); // åˆå§‹åŒ–å®¹å™¨ BeanFactory å’Œ ApplicationContext çš„åŒºåˆ«ï¼š BeanFactoryï¼šæ˜¯Springä¸­æœ€åº•å±‚çš„æ¥å£ï¼Œåªæä¾›äº†æœ€ç®€å•çš„IoCåŠŸèƒ½,è´Ÿè´£é…ç½®ï¼Œåˆ›å»ºå’Œç®¡ç†beanã€‚åœ¨åº”ç”¨ä¸­ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ BeanFactoryï¼Œè€Œæ¨èä½¿ç”¨ApplicationContextï¼ˆåº”ç”¨ä¸Šä¸‹æ–‡ï¼‰ï¼ŒåŸå› å¦‚ä¸‹ã€‚ ApplicationContextï¼š ç»§æ‰¿äº† BeanFactoryï¼Œæ‹¥æœ‰äº†åŸºæœ¬çš„ IoC åŠŸèƒ½ï¼› é™¤æ­¤ä¹‹å¤–ï¼ŒApplicationContext è¿˜æä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼š æ”¯æŒå›½é™…åŒ–ï¼› æ”¯æŒæ¶ˆæ¯æœºåˆ¶ï¼› æ”¯æŒç»Ÿä¸€çš„èµ„æºåŠ è½½ï¼› æ”¯æŒAOPåŠŸèƒ½ï¼› Spring IoC çš„å®¹å™¨çš„åˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥è™½ç„¶ Spring IoC å®¹å™¨çš„ç”Ÿæˆååˆ†çš„å¤æ‚ï¼Œä½†æ˜¯å¤§ä½“äº†è§£ä¸€ä¸‹ Spring IoC åˆå§‹åŒ–çš„è¿‡ç¨‹è¿˜æ˜¯å¿…è¦çš„ã€‚è¿™å¯¹äºç†è§£ Spring çš„ä¸€ç³»åˆ—è¡Œä¸ºæ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚ æ³¨æ„ï¼šBean çš„å®šä¹‰å’Œåˆå§‹åŒ–åœ¨ Spring IoC å®¹å™¨æ˜¯ä¸¤å¤§æ­¥éª¤ï¼Œå®ƒæ˜¯å…ˆå®šä¹‰ï¼Œç„¶ååˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥çš„ã€‚ Bean çš„å®šä¹‰åˆ†ä¸º 3 æ­¥ï¼š Resource å®šä½ Spring IoC å®¹å™¨å…ˆæ ¹æ®å¼€å‘è€…çš„é…ç½®ï¼Œè¿›è¡Œèµ„æºçš„å®šä½ï¼Œåœ¨ Spring çš„å¼€å‘ä¸­ï¼Œé€šè¿‡ XML æˆ–è€…æ³¨è§£éƒ½æ˜¯ååˆ†å¸¸è§çš„æ–¹å¼ï¼Œå®šä½çš„å†…å®¹æ˜¯ç”±å¼€å‘è€…æä¾›çš„ã€‚ BeanDefinition çš„è½½å…¥ è¿™ä¸ªæ—¶å€™åªæ˜¯å°† Resource å®šä½åˆ°çš„ä¿¡æ¯ï¼Œä¿å­˜åˆ° Bean å®šä¹‰ï¼ˆBeanDefinitionï¼‰ä¸­ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šåˆ›å»º Bean çš„å®ä¾‹ BeanDefinition çš„æ³¨å†Œ è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å°† BeanDefinition çš„ä¿¡æ¯å‘å¸ƒåˆ° Spring IoC å®¹å™¨ä¸­ æ³¨æ„ï¼šæ­¤æ—¶ä»ç„¶æ²¡æœ‰å¯¹åº”çš„ Bean çš„å®ä¾‹ã€‚ åšå®Œäº†ä»¥ä¸Š 3 æ­¥ï¼ŒBean å°±åœ¨ Spring IoC å®¹å™¨ä¸­è¢«å®šä¹‰äº†ï¼Œè€Œæ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œæ›´æ²¡æœ‰å®Œæˆä¾èµ–æ³¨å…¥ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ³¨å…¥å…¶é…ç½®çš„èµ„æºç»™ Beanï¼Œé‚£ä¹ˆå®ƒè¿˜ä¸èƒ½å®Œå…¨ä½¿ç”¨ã€‚ å¯¹äºåˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥ï¼ŒSpring Bean è¿˜æœ‰ä¸€ä¸ªé…ç½®é€‰é¡¹â€”â€”lazy-initï¼Œå…¶å«ä¹‰å°±æ˜¯æ˜¯å¦åˆå§‹åŒ– Spring Beanã€‚åœ¨æ²¡æœ‰ä»»ä½•é…ç½®çš„æƒ…å†µä¸‹ï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º defaultï¼Œå®é™…å€¼ä¸º falseï¼Œä¹Ÿå°±æ˜¯ Spring IoC é»˜è®¤ä¼šè‡ªåŠ¨åˆå§‹åŒ– Beanã€‚å¦‚æœå°†å…¶è®¾ç½®ä¸º trueï¼Œé‚£ä¹ˆåªæœ‰å½“æˆ‘ä»¬ä½¿ç”¨ Spring IoC å®¹å™¨çš„ getBean æ–¹æ³•è·å–å®ƒæ—¶ï¼Œå®ƒæ‰ä¼šè¿›è¡Œ Bean çš„åˆå§‹åŒ–ï¼Œå®Œæˆä¾èµ–æ³¨å…¥ã€‚","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Spring","slug":"Code/Spring","permalink":"http://xiaoqinghua.site/categories/Code/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"http://xiaoqinghua.site/tags/Spring/"}]},{"title":"Springæ€»ç»“","slug":"Springæ€»ç»“","date":"2017-12-02T02:58:53.000Z","updated":"2018-09-07T10:27:12.252Z","comments":true,"path":"Springæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Springæ€»ç»“.html","excerpt":"","text":"è®¤è¯† Spring æ¡†æ¶Spring æ¡†æ¶æ˜¯ Java åº”ç”¨æœ€å¹¿çš„æ¡†æ¶ï¼Œå®ƒçš„æˆåŠŸæ¥æºäºç†å¿µï¼Œè€Œä¸æ˜¯æŠ€æœ¯æœ¬èº«ï¼Œå®ƒçš„ç†å¿µåŒ…æ‹¬ IoC (Inversion of Controlï¼Œæ§åˆ¶åè½¬) å’Œ AOP(Aspect Oriented Programmingï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹)ã€‚ ä»€ä¹ˆæ˜¯ Springï¼š Spring æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ DI / IoC å’Œ AOP å®¹å™¨çš„å¼€æºæ¡†æ¶ï¼Œæ¥æºäº Rod Johnson åœ¨å…¶è‘—ä½œã€ŠExpert one on one J2EE design and developmentã€‹ä¸­é˜è¿°çš„éƒ¨åˆ†ç†å¿µå’ŒåŸå‹è¡ç”Ÿè€Œæ¥ã€‚ Spring æå€¡ä»¥â€œæœ€å°‘ä¾µå…¥â€çš„æ–¹å¼æ¥ç®¡ç†åº”ç”¨ä¸­çš„ä»£ç ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥éšæ—¶å®‰è£…æˆ–è€…å¸è½½ Spring é€‚ç”¨èŒƒå›´ï¼šä»»ä½• Java åº”ç”¨ Spring çš„æ ¹æœ¬ä½¿å‘½ï¼šç®€åŒ– Java å¼€å‘ å°½ç®¡ J2EE èƒ½å¤Ÿèµ¶ä¸Š Spring çš„æ­¥ä¼ï¼Œä½† Spring å¹¶æ²¡æœ‰åœæ­¢å‰è¿›ï¼Œ Spring ç»§ç»­åœ¨å…¶ä»–é¢†åŸŸå‘å±•ï¼Œè€Œ J2EE åˆ™åˆšåˆšå¼€å§‹æ¶‰åŠè¿™äº›é¢†åŸŸï¼Œæˆ–è€…è¿˜æ²¡æœ‰å®Œå…¨å¼€å§‹åœ¨è¿™äº›é¢†åŸŸçš„åˆ›æ–°ã€‚ç§»åŠ¨å¼€å‘ã€ç¤¾äº¤ API é›†æˆã€NoSQL æ•°æ®åº“ã€äº‘è®¡ç®—ä»¥åŠå¤§æ•°æ®éƒ½æ˜¯ Spring æ­£åœ¨æ¶‰è¶³å’Œåˆ›æ–°çš„é¢†åŸŸã€‚Spring çš„å‰æ™¯ä¾ç„¶ä¼šå¾ˆç¾å¥½ã€‚ Spring ä¸­å¸¸ç”¨æœ¯è¯­ æ¡†æ¶ï¼šæ˜¯èƒ½å®Œæˆä¸€å®šåŠŸèƒ½çš„åŠæˆå“ã€‚ æ¡†æ¶èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å®Œæˆçš„æ˜¯ï¼šé¡¹ç›®çš„æ•´ä½“æ¡†æ¶ã€ä¸€äº›åŸºç¡€åŠŸèƒ½ã€è§„å®šäº†ç±»å’Œå¯¹è±¡å¦‚ä½•åˆ›å»ºï¼Œå¦‚ä½•åä½œç­‰ï¼Œå½“æˆ‘ä»¬å¼€å‘ä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œæ¡†æ¶å¸®åŠ©æˆ‘ä»¬å®Œæˆäº†ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œæˆ‘ä»¬è‡ªå·±å†å®Œæˆä¸€éƒ¨åˆ†ï¼Œé‚£è¿™ä¸ªé¡¹ç›®å°±å®Œæˆäº†ã€‚ éä¾µå…¥å¼è®¾è®¡ï¼š ä»æ¡†æ¶çš„è§’åº¦å¯ä»¥ç†è§£ä¸ºï¼šæ— éœ€ç»§æ‰¿æ¡†æ¶æä¾›çš„ä»»ä½•ç±»è¿™æ ·æˆ‘ä»¬åœ¨æ›´æ¢æ¡†æ¶æ—¶ï¼Œä¹‹å‰å†™è¿‡çš„ä»£ç å‡ ä¹å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚ è½»é‡çº§å’Œé‡é‡çº§ï¼š è½»é‡çº§æ˜¯ç›¸å¯¹äºé‡é‡çº§è€Œè¨€çš„ï¼Œè½»é‡çº§ä¸€èˆ¬å°±æ˜¯éå…¥ä¾µæ€§çš„ã€æ‰€ä¾èµ–çš„ä¸œè¥¿éå¸¸å°‘ã€èµ„æºå ç”¨éå¸¸å°‘ã€éƒ¨ç½²ç®€å•ç­‰ç­‰ï¼Œå…¶å®å°±æ˜¯æ¯”è¾ƒå®¹æ˜“ä½¿ç”¨ï¼Œè€Œé‡é‡çº§æ­£å¥½ç›¸åã€‚ JavaBeanï¼š å³ç¬¦åˆ JavaBean è§„èŒƒçš„ Java ç±» POJOï¼šå³ Plain Old Java Objectsï¼Œç®€å•è€å¼ Java å¯¹è±¡ å®ƒå¯ä»¥åŒ…å«ä¸šåŠ¡é€»è¾‘æˆ–æŒä¹…åŒ–é€»è¾‘ï¼Œä½†ä¸æ‹…å½“ä»»ä½•ç‰¹æ®Šè§’è‰²ä¸”ä¸ç»§æ‰¿æˆ–ä¸å®ç°ä»»ä½•å…¶å®ƒJavaæ¡†æ¶çš„ç±»æˆ–æ¥å£ã€‚ æ³¨æ„ï¼šbean çš„å„ç§åç§°â€”â€”è™½ç„¶ Spring ç”¨ bean æˆ–è€… JavaBean æ¥è¡¨ç¤ºåº”ç”¨ç»„ä»¶ï¼Œä½†å¹¶ä¸æ„å‘³ç€ Spring ç»„ä»¶å¿…é¡»éµå¾ª JavaBean è§„èŒƒï¼Œä¸€ä¸ª Spring ç»„ä»¶å¯ä»¥æ˜¯ä»»æ„å½¢å¼çš„ POJOã€‚ å®¹å™¨ï¼š åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­å®¹å™¨å°±æ˜¯ä¸€ç§ç››æ”¾ä¸œè¥¿çš„å™¨å…·ï¼Œä»ç¨‹åºè®¾è®¡è§’åº¦çœ‹å°±æ˜¯è£…å¯¹è±¡çš„çš„å¯¹è±¡ï¼Œå› ä¸ºå­˜åœ¨æ”¾å…¥ã€æ‹¿å‡ºç­‰æ“ä½œï¼Œæ‰€ä»¥å®¹å™¨è¿˜è¦ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚ Spring çš„ä¼˜åŠ¿ ä½ä¾µå…¥ / ä½è€¦åˆ ï¼ˆé™ä½ç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ï¼Œå®ç°è½¯ä»¶å„å±‚ä¹‹é—´çš„è§£è€¦ï¼‰ å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼ˆåŸºäºåˆ‡é¢å’Œæƒ¯ä¾‹ï¼‰ æ–¹ä¾¿é›†æˆå…¶ä»–æ¡†æ¶ï¼ˆå¦‚MyBatisã€Hibernateï¼‰ é™ä½ Java å¼€å‘éš¾åº¦ Spring æ¡†æ¶ä¸­åŒ…æ‹¬äº† J2EE ä¸‰å±‚çš„æ¯ä¸€å±‚çš„è§£å†³æ–¹æ¡ˆï¼ˆä¸€ç«™å¼ï¼‰ Spring èƒ½å¸®æˆ‘ä»¬åšä»€ä¹ˆ Spring èƒ½å¸®æˆ‘ä»¬æ ¹æ®é…ç½®æ–‡ä»¶åˆ›å»ºåŠç»„è£…å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ Spring é¢å‘åˆ‡é¢ç¼–ç¨‹èƒ½å¸®åŠ©æˆ‘ä»¬æ— è€¦åˆçš„å®ç°æ—¥å¿—è®°å½•ï¼Œæ€§èƒ½ç»Ÿè®¡ï¼Œå®‰å…¨æ§åˆ¶ã€‚ Spring èƒ½éå¸¸ç®€å•çš„å¸®æˆ‘ä»¬ç®¡ç†æ•°æ®åº“äº‹åŠ¡ã€‚ Spring è¿˜æä¾›äº†ä¸ç¬¬ä¸‰æ–¹æ•°æ®è®¿é—®æ¡†æ¶ï¼ˆå¦‚Hibernateã€JPAï¼‰æ— ç¼é›†æˆï¼Œè€Œä¸”è‡ªå·±ä¹Ÿæä¾›äº†ä¸€å¥—JDBCè®¿é—®æ¨¡æ¿æ¥æ–¹ä¾¿æ•°æ®åº“è®¿é—®ã€‚ Spring è¿˜æä¾›ä¸ç¬¬ä¸‰æ–¹Webï¼ˆå¦‚Struts1/2ã€JSFï¼‰æ¡†æ¶æ— ç¼é›†æˆï¼Œè€Œä¸”è‡ªå·±ä¹Ÿæä¾›äº†ä¸€å¥—Spring MVCæ¡†æ¶ï¼Œæ¥æ–¹ä¾¿webå±‚æ­å»ºã€‚ Spring èƒ½æ–¹ä¾¿çš„ä¸Java EEï¼ˆå¦‚Java Mailã€ä»»åŠ¡è°ƒåº¦ï¼‰æ•´åˆï¼Œä¸æ›´å¤šæŠ€æœ¯æ•´åˆï¼ˆæ¯”å¦‚ç¼“å­˜æ¡†æ¶ï¼‰ã€‚ Spring çš„æ¡†æ¶ç»“æ„ Data Access/Integrationå±‚åŒ…å«æœ‰JDBCã€ORMã€OXMã€JMSå’ŒTransactionæ¨¡å—ã€‚ Webå±‚åŒ…å«äº†Webã€Web-Servletã€WebSocketã€Web-Porletæ¨¡å—ã€‚ AOPæ¨¡å—æä¾›äº†ä¸€ä¸ªç¬¦åˆAOPè”ç›Ÿæ ‡å‡†çš„é¢å‘åˆ‡é¢ç¼–ç¨‹çš„å®ç°ã€‚ Core Container(æ ¸å¿ƒå®¹å™¨)ï¼šåŒ…å«æœ‰Beansã€Coreã€Contextå’ŒSpELæ¨¡å—ã€‚ Testæ¨¡å—æ”¯æŒä½¿ç”¨JUnitå’ŒTestNGå¯¹Springç»„ä»¶è¿›è¡Œæµ‹è¯•ã€‚ Spring IoC å’Œ DI ç®€ä»‹IoCï¼šInverse of Controlï¼ˆæ§åˆ¶åè½¬ï¼‰ è¯»ä½œâ€œåè½¬æ§åˆ¶â€ï¼Œæ›´å¥½ç†è§£ï¼Œä¸æ˜¯ä»€ä¹ˆæŠ€æœ¯ï¼Œè€Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œå°±æ˜¯å°†åŸæœ¬åœ¨ç¨‹åºä¸­æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒï¼Œäº¤ç”±Springæ¡†æ¶æ¥ç®¡ç†ã€‚ æ­£æ§ï¼šè‹¥è¦ä½¿ç”¨æŸä¸ªå¯¹è±¡ï¼Œéœ€è¦è‡ªå·±å»è´Ÿè´£å¯¹è±¡çš„åˆ›å»º åæ§ï¼šè‹¥è¦ä½¿ç”¨æŸä¸ªå¯¹è±¡ï¼Œåªéœ€è¦ä» Spring å®¹å™¨ä¸­è·å–éœ€è¦ä½¿ç”¨çš„å¯¹è±¡ï¼Œä¸å…³å¿ƒå¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æŠŠåˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒåè½¬ç»™äº†Springæ¡†æ¶ å¥½è±åæ³•åˆ™ï¼šDonâ€™t call me ,Iâ€™ll call you ä¸€ä¸ªä¾‹å­æ§åˆ¶åè½¬æ˜¾ç„¶æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªé²œæ˜çš„ä¾‹å­æ¥è¯´æ˜ã€‚ åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œäººä»¬è¦ç”¨åˆ°ä¸€æ ·ä¸œè¥¿çš„æ—¶å€™ï¼Œç¬¬ä¸€ååº”å°±æ˜¯å»æ‰¾åˆ°è¿™ä»¶ä¸œè¥¿ï¼Œæ¯”å¦‚æƒ³å–æ–°é²œæ©™æ±ï¼Œåœ¨æ²¡æœ‰é¥®å“åº—çš„æ—¥å­é‡Œï¼Œæœ€ç›´è§‚çš„åšæ³•å°±æ˜¯ï¼šä¹°æœæ±æœºã€ä¹°æ©™å­ï¼Œç„¶åå‡†å¤‡å¼€æ°´ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šè¿™äº›éƒ½æ˜¯ä½ è‡ªå·±â€œä¸»åŠ¨â€åˆ›é€ çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ¯æ©™æ±éœ€è¦ä½ è‡ªå·±åˆ›é€ ã€‚ ç„¶è€Œåˆ°äº†ä»Šæ—¶ä»Šæ—¥ï¼Œç”±äºé¥®å“åº—çš„ç››è¡Œï¼Œå½“æˆ‘ä»¬æƒ³å–æ©™æ±æ—¶ï¼Œç¬¬ä¸€æƒ³æ³•å°±è½¬æ¢æˆäº†æ‰¾åˆ°é¥®å“åº—çš„è”ç³»æ–¹å¼ï¼Œé€šè¿‡ç”µè¯ç­‰æ¸ é“æè¿°ä½ çš„éœ€è¦ã€åœ°å€ã€è”ç³»æ–¹å¼ç­‰ï¼Œä¸‹è®¢å•ç­‰å¾…ï¼Œè¿‡ä¸€ä¼šå„¿å°±ä¼šæœ‰äººé€æ¥æ©™æ±äº†ã€‚ è¯·æ³¨æ„ä½ å¹¶æ²¡æœ‰â€œä¸»åŠ¨â€å»åˆ›é€ æ©™æ±ï¼Œæ©™æ±æ˜¯ç”±é¥®å“åº—åˆ›é€ çš„ï¼Œè€Œä¸æ˜¯ä½ ï¼Œç„¶è€Œä¹Ÿå®Œå…¨è¾¾åˆ°äº†ä½ çš„è¦æ±‚ï¼Œç”šè‡³æ¯”ä½ åˆ›é€ çš„è¦å¥½ä¸Šé‚£ä¹ˆä¸€äº›ã€‚ å†™ä¸€ä¸ª pojo 123456public class Source &#123; private String fruit; // ç±»å‹ private String sugar; // ç³–åˆ†æè¿° private String size; // å¤§å°æ¯ /* setter and getter */&#125; å»ºä¸€ä¸ª \bapplication.xmlï¼Œ\bé€šè¿‡ xml æ–‡ä»¶\bé…ç½®\bçš„æ–¹å¼è£…é…æˆ‘ä»¬çš„ bean 1234567891011&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"&gt; &lt;bean name=\"source\" class=\"pojo.Source\"&gt; &lt;property name=\"fruit\" value=\"æ©™å­\"/&gt; &lt;property name=\"sugar\" value=\"å¤šç³–\"/&gt; &lt;property name=\"size\" value=\"è¶…å¤§æ¯\"/&gt; &lt;/bean&gt;&lt;/beans&gt; è¿è¡Œ 1234567891011121314151617181920212223import org.junit.Test;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import pojo.Source;public class TestSpring &#123; @Test public void test()&#123; ApplicationContext context = new ClassPathXmlApplicationContext( new String[]&#123;\"applicationContext.xml\"&#125; ); Source source = (Source) context.getBean(\"source\"); System.out.println(source.getFruit()); System.out.println(source.getSugar()); System.out.println(source.getSize()); &#125;&#125;æ©™å­å¤šç³–è¶…å¤§æ¯ æ€»ç»“ï¼š ä¼ ç»Ÿçš„æ–¹å¼ï¼š é€šè¿‡new å…³é”®å­—ä¸»åŠ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡ IOCæ–¹å¼ï¼š å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç”±Springæ¥ç®¡ç†ï¼Œç›´æ¥ä»Springé‚£é‡Œå»è·å–ä¸€ä¸ªå¯¹è±¡ã€‚ IOCæ˜¯åè½¬æ§åˆ¶ (Inversion Of Control)çš„ç¼©å†™ï¼Œå°±åƒæ§åˆ¶æƒä»æœ¬æ¥åœ¨è‡ªå·±æ‰‹é‡Œï¼Œäº¤ç»™äº†Springã€‚ DIï¼šDependency Injectionï¼ˆä¾èµ–æ³¨å…¥ï¼‰æŒ‡ Spring åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œå°†å¯¹è±¡ä¾èµ–å±æ€§ï¼ˆç®€å•å€¼ï¼Œé›†åˆï¼Œå¯¹è±¡ï¼‰é€šè¿‡é…ç½®è®¾å€¼ç»™è¯¥å¯¹è±¡ ç»§ç»­ä¸Šé¢çš„ä¾‹å­ å†™ä¸€ä¸ª JuiceMaker ç±»ï¼š 123456789101112public class JuiceMaker &#123; // å”¯ä¸€å…³è”äº†ä¸€ä¸ª Source å¯¹è±¡ private Source source = null; /* setter and getter */ public String makeJuice()&#123; String juice = \"xxxç”¨æˆ·ç‚¹äº†ä¸€æ¯\" + source.getFruit() + source.getSugar() + source.getSize(); return juice; &#125;&#125; åœ¨ xml æ–‡ä»¶ä¸­é…ç½® JuiceMaker å¯¹è±¡ï¼š æ³¨æ„ï¼šè¿™é‡Œè¦ä½¿ç”¨ ref æ¥æ³¨å…¥å¦ä¸€ä¸ªå¯¹è±¡ 1234567891011121314&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"&gt; &lt;bean name=\"source\" class=\"pojo.Source\"&gt; &lt;property name=\"fruit\" value=\"æ©™å­\"/&gt; &lt;property name=\"sugar\" value=\"å¤šç³–\"/&gt; &lt;property name=\"size\" value=\"è¶…å¤§æ¯\"/&gt; &lt;/bean&gt; &lt;bean name=\"juickMaker\" class=\"pojo.JuiceMaker\"&gt; &lt;property name=\"source\" ref=\"source\" /&gt; &lt;/bean&gt;&lt;/beans&gt; åœ¨æµ‹è¯•ä»£ç ä¸­\båŠ å…¥ï¼š 1234JuiceMaker juiceMaker = (JuiceMaker) context.getBean(\"juickMaker\");System.out.println(juiceMaker.makeJuice());xxxç”¨æˆ·ç‚¹äº†ä¸€æ¯æ©™å­å¤šç³–è¶…å¤§æ¯ æ€»ç»“ï¼šIoC å’Œ DI å…¶å®æ˜¯åŒä¸€ä¸ªæ¦‚å¿µçš„ä¸åŒè§’åº¦æè¿°ï¼ŒDI ç›¸å¯¹ IoC è€Œè¨€ï¼Œæ˜ç¡®æè¿°äº†â€œè¢«æ³¨å…¥å¯¹è±¡ä¾èµ– IoC å®¹å™¨é…ç½®ä¾èµ–å¯¹è±¡â€ IoC å¦‚ä½•å®ç°çš„æœ€åæˆ‘ä»¬ç®€å•è¯´è¯´IoCæ˜¯å¦‚ä½•å®ç°çš„ã€‚æƒ³è±¡ä¸€ä¸‹å¦‚æœæˆ‘ä»¬è‡ªå·±æ¥å®ç°è¿™ä¸ªä¾èµ–æ³¨å…¥çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬æ€ä¹ˆæ¥åšï¼Ÿ æ— å¤–ä¹ï¼š è¯»å–æ ‡æ³¨æˆ–è€…é…ç½®æ–‡ä»¶ï¼Œçœ‹çœ‹JuiceMakerä¾èµ–çš„æ˜¯å“ªä¸ªSourceï¼Œæ‹¿åˆ°ç±»å ä½¿ç”¨åå°„çš„APIï¼ŒåŸºäºç±»åå®ä¾‹åŒ–å¯¹åº”çš„å¯¹è±¡å®ä¾‹ å°†å¯¹è±¡å®ä¾‹ï¼Œé€šè¿‡æ„é€ å‡½æ•°æˆ–è€… setterï¼Œä¼ é€’ç»™ JuiceMaker æˆ‘ä»¬å‘ç°å…¶å®è‡ªå·±æ¥å®ç°ä¹Ÿä¸æ˜¯å¾ˆéš¾ï¼ŒSpringå®é™…ä¹Ÿå°±æ˜¯è¿™ä¹ˆåšçš„ã€‚è¿™ä¹ˆçœ‹çš„è¯å…¶å®IoCå°±æ˜¯ä¸€ä¸ªå·¥å‚æ¨¡å¼çš„å‡çº§ç‰ˆï¼å½“ç„¶è¦åšä¸€ä¸ªæˆç†Ÿçš„IoCæ¡†æ¶ï¼Œè¿˜æ˜¯éå¸¸å¤šç»†è‡´çš„å·¥ä½œè¦åšï¼ŒSpringä¸ä»…æä¾›äº†ä¸€ä¸ªå·²ç»æˆä¸ºä¸šç•Œæ ‡å‡†çš„Java IoCæ¡†æ¶ï¼Œè¿˜æä¾›äº†æ›´å¤šå¼ºå¤§çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å¤§å®¶å°±åˆ«å»é€ è½®å­å•¦ï¼å¸Œæœ›äº†è§£IoCæ›´å¤šå®ç°ç»†èŠ‚ä¸å¦¨é€šè¿‡å­¦ä¹ Springçš„æºç æ¥åŠ æ·±ç†è§£ï¼ Spring AOP ç®€ä»‹å¦‚æœè¯´ IoC æ˜¯ Spring çš„æ ¸å¿ƒï¼Œé‚£ä¹ˆé¢å‘åˆ‡é¢ç¼–ç¨‹å°±æ˜¯ Spring æœ€ä¸ºé‡è¦çš„åŠŸèƒ½ä¹‹ä¸€äº†ï¼Œåœ¨æ•°æ®åº“äº‹åŠ¡ä¸­åˆ‡é¢ç¼–ç¨‹è¢«å¹¿æ³›ä½¿ç”¨ã€‚ AOP å³ Aspect Oriented Program é¢å‘åˆ‡é¢ç¼–ç¨‹é¦–å…ˆï¼Œåœ¨é¢å‘åˆ‡é¢ç¼–ç¨‹çš„æ€æƒ³é‡Œé¢ï¼ŒæŠŠåŠŸèƒ½åˆ†ä¸ºæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ï¼Œå’Œå‘¨è¾¹åŠŸèƒ½ã€‚ æ‰€è°“çš„æ ¸å¿ƒä¸šåŠ¡ï¼Œæ¯”å¦‚ç™»é™†ï¼Œå¢åŠ æ•°æ®ï¼Œåˆ é™¤æ•°æ®éƒ½å«æ ¸å¿ƒä¸šåŠ¡ æ‰€è°“çš„å‘¨è¾¹åŠŸèƒ½ï¼Œæ¯”å¦‚æ€§èƒ½ç»Ÿè®¡ï¼Œæ—¥å¿—ï¼Œäº‹åŠ¡ç®¡ç†ç­‰ç­‰ å‘¨è¾¹åŠŸèƒ½åœ¨ Spring çš„é¢å‘åˆ‡é¢ç¼–ç¨‹AOPæ€æƒ³é‡Œï¼Œå³è¢«å®šä¹‰ä¸ºåˆ‡é¢ åœ¨é¢å‘åˆ‡é¢ç¼–ç¨‹AOPçš„æ€æƒ³é‡Œé¢ï¼Œæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½å’Œåˆ‡é¢åŠŸèƒ½åˆ†åˆ«ç‹¬ç«‹è¿›è¡Œå¼€å‘ï¼Œç„¶åæŠŠåˆ‡é¢åŠŸèƒ½å’Œæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ â€œç¼–ç»‡â€ åœ¨ä¸€èµ·ï¼Œè¿™å°±å«AOP AOP çš„ç›®çš„AOPèƒ½å¤Ÿå°†é‚£äº›ä¸ä¸šåŠ¡æ— å…³ï¼Œå´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘æˆ–è´£ä»»ï¼ˆä¾‹å¦‚äº‹åŠ¡å¤„ç†ã€æ—¥å¿—ç®¡ç†ã€æƒé™æ§åˆ¶ç­‰ï¼‰å°è£…èµ·æ¥ï¼Œä¾¿äºå‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦ï¼Œå¹¶æœ‰åˆ©äºæœªæ¥çš„å¯æ‹“å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ AOP å½“ä¸­çš„æ¦‚å¿µï¼š åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ åœ¨å“ªäº›ç±»ï¼Œå“ªäº›æ–¹æ³•ä¸Šåˆ‡å…¥ï¼ˆwhereï¼‰ é€šçŸ¥ï¼ˆAdviceï¼‰ åœ¨æ–¹æ³•æ‰§è¡Œçš„ä»€ä¹ˆæ—¶æœºï¼ˆwhen:æ–¹æ³•å‰/æ–¹æ³•å/æ–¹æ³•å‰åï¼‰åšä»€ä¹ˆï¼ˆwhat:å¢å¼ºçš„åŠŸèƒ½ï¼‰ åˆ‡é¢ï¼ˆAspectï¼‰ åˆ‡é¢ = åˆ‡å…¥ç‚¹ + é€šçŸ¥ï¼Œé€šä¿—ç‚¹å°±æ˜¯ï¼šåœ¨ä»€ä¹ˆæ—¶æœºï¼Œä»€ä¹ˆåœ°æ–¹ï¼Œåšä»€ä¹ˆå¢å¼ºï¼ ç»‡å…¥ï¼ˆWeavingï¼‰ æŠŠåˆ‡é¢åŠ å…¥åˆ°å¯¹è±¡ï¼Œå¹¶åˆ›å»ºå‡ºä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚ï¼ˆç”± Spring æ¥å®Œæˆï¼‰ AOP \bç¤ºä¾‹ åˆ›å»ºä¸€ä¸ª ProdectServiceç±» 12345public class ProductService &#123; public void doSomeService()&#123; System.out.println(\"doSomeService\"); &#125;&#125; åœ¨ application.xml ä¸­è£…é…è¯¥ bean 1&lt;bean name=\"productService\" class=\"service.ProductService\" /&gt; æ–°å»ºä¸€ä¸ª LoggerAspect ç±» 1234567891011import org.aspectj.lang.ProceedingJoinPoint;public class LoggerAspect &#123; public Object log(ProceedingJoinPoint joinPoint) throws Throwable &#123; System.out.println(\"start log:\" + joinPoint.getSignature().getName()); Object object = joinPoint.proceed(); System.out.println(\"end log:\" + joinPoint.getSignature().getName()); return object; &#125;&#125; åœ¨ application.xml ä¸­ç”³æ˜ä¸šåŠ¡å¯¹è±¡å’Œæ—¥å¿—åˆ‡é¢ 1234567891011121314151617181920212223242526272829303132&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:context=\"http://www.springframework.org/schema/context\" xsi:schemaLocation=\" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd\"&gt; &lt;bean name=\"productService\" class=\"service.ProductService\" /&gt; &lt;bean id=\"loggerAspect\" class=\"aspect.LoggerAspect\"/&gt; &lt;!-- é…ç½®AOP --&gt; &lt;aop:config&gt; &lt;!-- whereï¼šåœ¨å“ªäº›åœ°æ–¹ï¼ˆåŒ….ç±».æ–¹æ³•ï¼‰åšå¢åŠ  --&gt; &lt;aop:pointcut id=\"loggerCutpoint\" expression=\"execution(* service.ProductService.*(..)) \"/&gt; &lt;!-- what:åšä»€ä¹ˆå¢å¼º --&gt; &lt;aop:aspect id=\"logAspect\" ref=\"loggerAspect\"&gt; &lt;!-- when:åœ¨ä»€ä¹ˆæ—¶æœºï¼ˆæ–¹æ³•å‰/å/å‰åï¼‰ --&gt; &lt;aop:around pointcut-ref=\"loggerCutpoint\" method=\"log\"/&gt; &lt;/aop:aspect&gt; &lt;/aop:config&gt;&lt;/beans&gt; æµ‹è¯• 123456789101112131415161718192021import org.junit.Test;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import pojo.Source;public class TestSpring &#123; @Test public void test()&#123; ApplicationContext context = new ClassPathXmlApplicationContext( new String[]&#123;\"applicationContext.xml\"&#125; ); ProductService ps = (ProductService) context.getBean(\"productService\"); ps.doSomeService(); &#125;&#125;start log:doSomeServicedoSomeServiceend log:doSomeService","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Spring","slug":"Code/Spring","permalink":"http://xiaoqinghua.site/categories/Code/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"http://xiaoqinghua.site/tags/Spring/"}]},{"title":"Java I/Oæ€»ç»“","slug":"Java-I-Oæ€»ç»“","date":"2017-11-25T10:25:51.000Z","updated":"2018-09-06T12:28:06.503Z","comments":true,"path":"Java-I-Oæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Java-I-Oæ€»ç»“.html","excerpt":"","text":"ä¸€ã€æ¦‚è§ˆJava çš„ I/O å¤§æ¦‚å¯ä»¥åˆ†æˆä»¥ä¸‹å‡ ç±»ï¼š ç£ç›˜æ“ä½œï¼šFile å­—èŠ‚æ“ä½œï¼šInputStream å’Œ OutputStream å­—ç¬¦æ“ä½œï¼šReader å’Œ Writer å¯¹è±¡æ“ä½œï¼šSerializable ç½‘ç»œæ“ä½œï¼šSocket non-blockingè¾“å…¥/è¾“å‡ºï¼šNIO äºŒã€ç£ç›˜æ“ä½œFile ç±»å¯ä»¥ç”¨äºè¡¨ç¤ºæ–‡ä»¶å’Œç›®å½•çš„ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒä¸è¡¨ç¤ºæ–‡ä»¶çš„å†…å®¹ã€‚ é€’å½’åœ°åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼š 123456789101112public static void listAllFiles(File dir) &#123; if (dir == null || !dir.exists()) &#123; return; &#125; if (dir.isFile()) &#123; System.out.println(dir.getName()); return; &#125; for (File file : dir.listFiles()) &#123; listAllFiles(file); &#125;&#125; ä¸‰ã€å­—èŠ‚æ“ä½œå®ç°æ–‡ä»¶å¤åˆ¶ 12345678910111213141516public static void copyFile(String src, String dist) throws IOException &#123; FileInputStream in = new FileInputStream(src); FileOutputStream out = new FileOutputStream(dist); byte[] buffer = new byte[20 * 1024]; // read() æœ€å¤šè¯»å– buffer.length ä¸ªå­—èŠ‚ // è¿”å›çš„æ˜¯å®é™…è¯»å–çš„ä¸ªæ•° // è¿”å› -1 çš„æ—¶å€™è¡¨ç¤ºè¯»åˆ° eofï¼Œå³æ–‡ä»¶å°¾ while (in.read(buffer, 0, buffer.length) != -1) &#123; out.write(buffer); &#125; in.close(); out.close();&#125; è£…é¥°è€…æ¨¡å¼Java I/O ä½¿ç”¨äº†è£…é¥°è€…æ¨¡å¼æ¥å®ç°ã€‚ä»¥ InputStream ä¸ºä¾‹ï¼Œ InputStream æ˜¯æŠ½è±¡ç»„ä»¶ï¼› FileInputStream æ˜¯ InputStream çš„å­ç±»ï¼Œå±äºå…·ä½“ç»„ä»¶ï¼Œæä¾›äº†å­—èŠ‚æµçš„è¾“å…¥æ“ä½œï¼› FilterInputStream å±äºæŠ½è±¡è£…é¥°è€…ï¼Œè£…é¥°è€…ç”¨äºè£…é¥°ç»„ä»¶ï¼Œä¸ºç»„ä»¶æä¾›é¢å¤–çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ BufferedInputStream ä¸º FileInputStream æä¾›ç¼“å­˜çš„åŠŸèƒ½ã€‚ å®ä¾‹åŒ–ä¸€ä¸ªå…·æœ‰ç¼“å­˜åŠŸèƒ½çš„å­—èŠ‚æµå¯¹è±¡æ—¶ï¼Œåªéœ€è¦åœ¨ FileInputStream å¯¹è±¡ä¸Šå†å¥—ä¸€å±‚ BufferedInputStream å¯¹è±¡å³å¯ã€‚ 12FileInputStream fileInputStream = new FileInputStream(filePath);BufferedInputStream bufferedInputStream = new BufferedInputStream(fileInputStream); DataInputStream è£…é¥°è€…æä¾›äº†å¯¹æ›´å¤šæ•°æ®ç±»å‹è¿›è¡Œè¾“å…¥çš„æ“ä½œï¼Œæ¯”å¦‚ intã€double ç­‰åŸºæœ¬ç±»å‹ã€‚ å››ã€å­—ç¬¦æ“ä½œç¼–ç ä¸è§£ç ç¼–ç å°±æ˜¯æŠŠå­—ç¬¦è½¬æ¢ä¸ºå­—èŠ‚ï¼Œè€Œè§£ç æ˜¯æŠŠå­—èŠ‚é‡æ–°ç»„åˆæˆå­—ç¬¦ã€‚ å¦‚æœç¼–ç å’Œè§£ç è¿‡ç¨‹ä½¿ç”¨ä¸åŒçš„ç¼–ç æ–¹å¼é‚£ä¹ˆå°±å‡ºç°äº†ä¹±ç ã€‚ GBK ç¼–ç ä¸­ï¼Œä¸­æ–‡å­—ç¬¦å  2 ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡å­—ç¬¦å  1 ä¸ªå­—èŠ‚ï¼› UTF-8 ç¼–ç ä¸­ï¼Œä¸­æ–‡å­—ç¬¦å  3 ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡å­—ç¬¦å  1 ä¸ªå­—èŠ‚ UTF-16be ç¼–ç ä¸­ï¼Œä¸­æ–‡å­—ç¬¦å’Œè‹±æ–‡å­—ç¬¦éƒ½å  2 ä¸ªå­—èŠ‚ã€‚ UTF-16be ä¸­çš„ be æŒ‡çš„æ˜¯ Big Endianï¼Œä¹Ÿå°±æ˜¯å¤§ç«¯ã€‚ç›¸åº”åœ°ä¹Ÿæœ‰ UTF-16leï¼Œle æŒ‡çš„æ˜¯ Little Endianï¼Œä¹Ÿå°±æ˜¯å°ç«¯ã€‚ Java ä½¿ç”¨åŒå­—èŠ‚ç¼–ç  UTF-16beï¼Œè¿™ä¸æ˜¯æŒ‡ Java åªæ”¯æŒè¿™ä¸€ç§ç¼–ç æ–¹å¼ï¼Œè€Œæ˜¯è¯´ char è¿™ç§ç±»å‹ä½¿ç”¨ UTF-16be è¿›è¡Œç¼–ç ã€‚char ç±»å‹å  16 ä½ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼ŒJava ä½¿ç”¨è¿™ç§åŒå­—èŠ‚ç¼–ç æ˜¯ä¸ºäº†è®©ä¸€ä¸ªä¸­æ–‡æˆ–è€…ä¸€ä¸ªè‹±æ–‡éƒ½èƒ½ä½¿ç”¨ä¸€ä¸ª char æ¥å­˜å‚¨ã€‚ String çš„ç¼–ç æ–¹å¼String å¯ä»¥çœ‹æˆä¸€ä¸ªå­—ç¬¦åºåˆ—ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªç¼–ç æ–¹å¼å°†å®ƒç¼–ç ä¸ºå­—èŠ‚åºåˆ—ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªç¼–ç æ–¹å¼å°†ä¸€ä¸ªå­—èŠ‚åºåˆ—è§£ç ä¸º Stringã€‚ 1234String str1 = \"ä¸­æ–‡\";byte[] bytes = str1.getBytes(\"UTF-8\");String str2 = new String(bytes, \"UTF-8\");System.out.println(str2); åœ¨è°ƒç”¨æ— å‚æ•° getBytes() æ–¹æ³•æ—¶ï¼Œé»˜è®¤çš„ç¼–ç æ–¹å¼ä¸æ˜¯ UTF-16beã€‚åŒå­—èŠ‚ç¼–ç çš„å¥½å¤„æ˜¯å¯ä»¥ä½¿ç”¨ä¸€ä¸ª char å­˜å‚¨ä¸­æ–‡å’Œè‹±æ–‡ï¼Œè€Œå°† String è½¬ä¸º bytes[] å­—èŠ‚æ•°ç»„å°±ä¸å†éœ€è¦è¿™ä¸ªå¥½å¤„ï¼Œå› æ­¤ä¹Ÿå°±ä¸å†éœ€è¦åŒå­—èŠ‚ç¼–ç ã€‚ getBytes() çš„é»˜è®¤ç¼–ç æ–¹å¼ä¸å¹³å°æœ‰å…³ï¼Œä¸€èˆ¬ä¸º UTF-8 1byte[] bytes = str1.getBytes(); Reader ä¸ Writerä¸ç®¡æ˜¯ç£ç›˜è¿˜æ˜¯ç½‘ç»œä¼ è¾“ï¼Œæœ€å°çš„å­˜å‚¨å•å…ƒéƒ½æ˜¯å­—èŠ‚ï¼Œè€Œä¸æ˜¯å­—ç¬¦ã€‚ä½†æ˜¯åœ¨ç¨‹åºä¸­æ“ä½œçš„é€šå¸¸æ˜¯å­—ç¬¦å½¢å¼çš„æ•°æ®ï¼Œå› æ­¤éœ€è¦æä¾›å¯¹å­—ç¬¦è¿›è¡Œæ“ä½œçš„æ–¹æ³•ã€‚ InputStreamReader å®ç°ä»å­—èŠ‚æµè§£ç æˆå­—ç¬¦æµï¼› OutputStreamWriter å®ç°å­—ç¬¦æµç¼–ç æˆä¸ºå­—èŠ‚æµã€‚ å®ç°é€è¡Œè¾“å‡ºæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ 123456789101112131415public static void readFileContent(String filePath) throws IOException &#123; FileReader fileReader = new FileReader(filePath); BufferedReader bufferedReader = new BufferedReader(fileReader); String line; while ((line = bufferedReader.readLine()) != null) &#123; System.out.println(line); &#125; // è£…é¥°è€…æ¨¡å¼ä½¿å¾— BufferedReader ç»„åˆäº†ä¸€ä¸ª Reader å¯¹è±¡ // åœ¨è°ƒç”¨ BufferedReader çš„ close() æ–¹æ³•æ—¶ä¼šå»è°ƒç”¨ Reader çš„ close() æ–¹æ³• // å› æ­¤åªè¦ä¸€ä¸ª close() è°ƒç”¨å³å¯ bufferedReader.close();&#125; äº”ã€å¯¹è±¡æ“ä½œåºåˆ—åŒ–åºåˆ—åŒ–å°±æ˜¯å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆå­—èŠ‚åºåˆ—ï¼Œæ–¹ä¾¿å­˜å‚¨å’Œä¼ è¾“ã€‚ åºåˆ—åŒ–ï¼šObjectOutputStream.writeObject() ååºåˆ—åŒ–ï¼šObjectInputStream.readObject() ä¸ä¼šå¯¹é™æ€å˜é‡è¿›è¡Œåºåˆ—åŒ–ï¼Œå› ä¸ºåºåˆ—åŒ–åªæ˜¯ä¿å­˜å¯¹è±¡çš„çŠ¶æ€ï¼Œé™æ€å˜é‡å±äºç±»çš„çŠ¶æ€ã€‚ Serializableåºåˆ—åŒ–çš„ç±»éœ€è¦å®ç° Serializable æ¥å£ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ ‡å‡†ï¼Œæ²¡æœ‰ä»»ä½•æ–¹æ³•éœ€è¦å®ç°ï¼Œä½†æ˜¯å¦‚æœä¸å»å®ç°å®ƒçš„è¯è€Œè¿›è¡Œåºåˆ—åŒ–ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ 123456789101112131415161718192021222324252627282930public static void main(String[] args) throws IOException, ClassNotFoundException &#123; A a1 = new A(123, \"abc\"); String objectFile = \"file/a1\"; ObjectOutputStream objectOutputStream = new ObjectOutputStream(new FileOutputStream(objectFile)); objectOutputStream.writeObject(a1); objectOutputStream.close(); ObjectInputStream objectInputStream = new ObjectInputStream(new FileInputStream(objectFile)); A a2 = (A) objectInputStream.readObject(); objectInputStream.close(); System.out.println(a2);&#125;private static class A implements Serializable &#123; private int x; private String y; A(int x, String y) &#123; this.x = x; this.y = y; &#125; @Override public String toString() &#123; return \"x = \" + x + \" \" + \"y = \" + y; &#125;&#125; transienttransient å…³é”®å­—å¯ä»¥ä½¿ä¸€äº›å±æ€§ä¸ä¼šè¢«åºåˆ—åŒ–ã€‚ ArrayList ä¸­å­˜å‚¨æ•°æ®çš„æ•°ç»„ elementData æ˜¯ç”¨ transient ä¿®é¥°çš„ï¼Œå› ä¸ºè¿™ä¸ªæ•°ç»„æ˜¯åŠ¨æ€æ‰©å±•çš„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç©ºé—´éƒ½è¢«ä½¿ç”¨ï¼Œå› æ­¤å°±ä¸éœ€è¦æ‰€æœ‰çš„å†…å®¹éƒ½è¢«åºåˆ—åŒ–ã€‚é€šè¿‡é‡å†™åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ–¹æ³•ï¼Œä½¿å¾—å¯ä»¥åªåºåˆ—åŒ–æ•°ç»„ä¸­æœ‰å†…å®¹çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚ 1private transient Object[] elementData; å…­ã€ç½‘ç»œæ“ä½œJava ä¸­çš„ç½‘ç»œæ”¯æŒï¼š InetAddressï¼šç”¨äºè¡¨ç¤ºç½‘ç»œä¸Šçš„ç¡¬ä»¶èµ„æºï¼Œå³ IP åœ°å€ï¼› URLï¼šç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼› Socketsï¼šä½¿ç”¨ TCP åè®®å®ç°ç½‘ç»œé€šä¿¡ï¼› Datagramï¼šä½¿ç”¨ UDP åè®®å®ç°ç½‘ç»œé€šä¿¡ã€‚ InetAddressæ²¡æœ‰å…¬æœ‰çš„æ„é€ å‡½æ•°ï¼Œåªèƒ½é€šè¿‡é™æ€æ–¹æ³•æ¥åˆ›å»ºå®ä¾‹ã€‚ 12InetAddress.getByName(String host);InetAddress.getByAddress(byte[] address); URLå¯ä»¥ç›´æ¥ä» URL ä¸­è¯»å–å­—èŠ‚æµæ•°æ®ã€‚ 1234567891011121314151617181920public static void main(String[] args) throws IOException &#123; URL url = new URL(\"http://www.google.com\"); /* å­—èŠ‚æµ */ InputStream is = url.openStream(); /* å­—ç¬¦æµ */ InputStreamReader isr = new InputStreamReader(is, \"utf-8\"); /* æä¾›ç¼“å­˜åŠŸèƒ½ */ BufferedReader br = new BufferedReader(isr); String line; while ((line = br.readLine()) != null) &#123; System.out.println(line); &#125; br.close();&#125; Sockets ServerSocketï¼šæœåŠ¡å™¨ç«¯ç±» Socketï¼šå®¢æˆ·ç«¯ç±» æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é€šè¿‡ InputStream å’Œ OutputStream è¿›è¡Œè¾“å…¥è¾“å‡ºã€‚ Datagram DatagramSocketï¼šé€šä¿¡ç±» DatagramPacketï¼šæ•°æ®åŒ…ç±» ä¸ƒã€NIO Java NIO Tutorial Java NIO æµ…æ IBM: NIO å…¥é—¨ æ–°çš„è¾“å…¥/è¾“å‡º (NIO) åº“æ˜¯åœ¨ JDK 1.4 ä¸­å¼•å…¥çš„ï¼Œå¼¥è¡¥äº†åŸæ¥çš„ I/O çš„ä¸è¶³ï¼Œæä¾›äº†é«˜é€Ÿçš„ã€é¢å‘å—çš„ I/Oã€‚ æµä¸å—I/O ä¸ NIO æœ€é‡è¦çš„åŒºåˆ«æ˜¯æ•°æ®æ‰“åŒ…å’Œä¼ è¾“çš„æ–¹å¼ï¼ŒI/O ä»¥æµçš„æ–¹å¼å¤„ç†æ•°æ®ï¼Œè€Œ NIO ä»¥å—çš„æ–¹å¼å¤„ç†æ•°æ®ã€‚ é¢å‘æµçš„ I/O ä¸€æ¬¡å¤„ç†ä¸€ä¸ªå­—èŠ‚æ•°æ®ï¼šä¸€ä¸ªè¾“å…¥æµäº§ç”Ÿä¸€ä¸ªå­—èŠ‚æ•°æ®ï¼Œä¸€ä¸ªè¾“å‡ºæµæ¶ˆè´¹ä¸€ä¸ªå­—èŠ‚æ•°æ®ã€‚ä¸ºæµå¼æ•°æ®åˆ›å»ºè¿‡æ»¤å™¨éå¸¸å®¹æ˜“ï¼Œé“¾æ¥å‡ ä¸ªè¿‡æ»¤å™¨ï¼Œä»¥ä¾¿æ¯ä¸ªè¿‡æ»¤å™¨åªè´Ÿè´£å¤æ‚å¤„ç†æœºåˆ¶çš„ä¸€éƒ¨åˆ†ã€‚ä¸åˆ©çš„ä¸€é¢æ˜¯ï¼Œé¢å‘æµçš„ I/O é€šå¸¸ç›¸å½“æ…¢ã€‚ é¢å‘å—çš„ I/O ä¸€æ¬¡å¤„ç†ä¸€ä¸ªæ•°æ®å—ï¼ŒæŒ‰å—å¤„ç†æ•°æ®æ¯”æŒ‰æµå¤„ç†æ•°æ®è¦å¿«å¾—å¤šã€‚ä½†æ˜¯é¢å‘å—çš„ I/O ç¼ºå°‘ä¸€äº›é¢å‘æµçš„ I/O æ‰€å…·æœ‰çš„ä¼˜é›…æ€§å’Œç®€å•æ€§ã€‚ I/O åŒ…å’Œ NIO å·²ç»å¾ˆå¥½åœ°é›†æˆäº†ï¼Œjava.io. å·²ç»ä»¥ NIO ä¸ºåŸºç¡€é‡æ–°å®ç°äº†ï¼Œæ‰€ä»¥ç°åœ¨å®ƒå¯ä»¥åˆ©ç”¨ NIO çš„ä¸€äº›ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œjava.io. åŒ…ä¸­çš„ä¸€äº›ç±»åŒ…å«ä»¥å—çš„å½¢å¼è¯»å†™æ•°æ®çš„æ–¹æ³•ï¼Œè¿™ä½¿å¾—å³ä½¿åœ¨é¢å‘æµçš„ç³»ç»Ÿä¸­ï¼Œå¤„ç†é€Ÿåº¦ä¹Ÿä¼šæ›´å¿«ã€‚ é€šé“ä¸ç¼“å†²åŒº é€šé“ é€šé“ Channel æ˜¯å¯¹åŸ I/O åŒ…ä¸­çš„æµçš„æ¨¡æ‹Ÿï¼Œå¯ä»¥é€šè¿‡å®ƒè¯»å–å’Œå†™å…¥æ•°æ®ã€‚ é€šé“ä¸æµçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œæµåªèƒ½åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šç§»åŠ¨(ä¸€ä¸ªæµå¿…é¡»æ˜¯ InputStream æˆ–è€… OutputStream çš„å­ç±»)ï¼Œè€Œé€šé“æ˜¯åŒå‘çš„ï¼Œå¯ä»¥ç”¨äºè¯»ã€å†™æˆ–è€…åŒæ—¶ç”¨äºè¯»å†™ã€‚ é€šé“åŒ…æ‹¬ä»¥ä¸‹ç±»å‹ï¼š FileChannelï¼šä»æ–‡ä»¶ä¸­è¯»å†™æ•°æ®ï¼› DatagramChannelï¼šé€šè¿‡ UDP è¯»å†™ç½‘ç»œä¸­æ•°æ®ï¼› SocketChannelï¼šé€šè¿‡ TCP è¯»å†™ç½‘ç»œä¸­æ•°æ®ï¼› ServerSocketChannelï¼šå¯ä»¥ç›‘å¬æ–°è¿›æ¥çš„ TCP è¿æ¥ï¼Œå¯¹æ¯ä¸€ä¸ªæ–°è¿›æ¥çš„è¿æ¥éƒ½ä¼šåˆ›å»ºä¸€ä¸ª SocketChannelã€‚ ç¼“å†²åŒº å‘é€ç»™ä¸€ä¸ªé€šé“çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»é¦–å…ˆæ”¾åˆ°ç¼“å†²åŒºä¸­ï¼ŒåŒæ ·åœ°ï¼Œä»é€šé“ä¸­è¯»å–çš„ä»»ä½•æ•°æ®éƒ½è¦å…ˆè¯»åˆ°ç¼“å†²åŒºä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ä¼šç›´æ¥å¯¹é€šé“è¿›è¡Œè¯»å†™æ•°æ®ï¼Œè€Œæ˜¯è¦å…ˆç»è¿‡ç¼“å†²åŒºã€‚ ç¼“å†²åŒºå®è´¨ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä½†å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ç¼“å†²åŒºæä¾›äº†å¯¹æ•°æ®çš„ç»“æ„åŒ–è®¿é—®ï¼Œè€Œä¸”è¿˜å¯ä»¥è·Ÿè¸ªç³»ç»Ÿçš„è¯»/å†™è¿›ç¨‹ã€‚ ç¼“å†²åŒºåŒ…æ‹¬ä»¥ä¸‹ç±»å‹ï¼š ByteBuffer CharBuffer ShortBuffer IntBuffer LongBuffer FloatBuffer DoubleBuffer ç¼“å†²åŒºçŠ¶æ€å˜é‡ capacityï¼šæœ€å¤§å®¹é‡ï¼› positionï¼šå½“å‰å·²ç»è¯»å†™çš„å­—èŠ‚æ•°ï¼› limitï¼šè¿˜å¯ä»¥è¯»å†™çš„å­—èŠ‚æ•°ã€‚ çŠ¶æ€å˜é‡çš„æ”¹å˜è¿‡ç¨‹ä¸¾ä¾‹ï¼š â‘  æ–°å»ºä¸€ä¸ªå¤§å°ä¸º 8 ä¸ªå­—èŠ‚çš„ç¼“å†²åŒºï¼Œæ­¤æ—¶ position ä¸º 0ï¼Œè€Œ limit = capacity = 8ã€‚capacity å˜é‡ä¸ä¼šæ”¹å˜ï¼Œä¸‹é¢çš„è®¨è®ºä¼šå¿½ç•¥å®ƒã€‚ â‘¡ ä»è¾“å…¥é€šé“ä¸­è¯»å– 5 ä¸ªå­—èŠ‚æ•°æ®å†™å…¥ç¼“å†²åŒºä¸­ï¼Œæ­¤æ—¶ position ç§»åŠ¨è®¾ç½®ä¸º 5ï¼Œlimit ä¿æŒä¸å˜ã€‚ â‘¢ åœ¨å°†ç¼“å†²åŒºçš„æ•°æ®å†™åˆ°è¾“å‡ºé€šé“ä¹‹å‰ï¼Œéœ€è¦å…ˆè°ƒç”¨ flip() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°† limit è®¾ç½®ä¸ºå½“å‰ positionï¼Œå¹¶å°† position è®¾ç½®ä¸º 0ã€‚ â‘£ ä»ç¼“å†²åŒºä¸­å– 4 ä¸ªå­—èŠ‚åˆ°è¾“å‡ºç¼“å†²ä¸­ï¼Œæ­¤æ—¶ position è®¾ä¸º 4ã€‚ â‘¤ æœ€åéœ€è¦è°ƒç”¨ clear() æ–¹æ³•æ¥æ¸…ç©ºç¼“å†²åŒºï¼Œæ­¤æ—¶ position å’Œ limit éƒ½è¢«è®¾ç½®ä¸ºæœ€åˆä½ç½®ã€‚ æ–‡ä»¶ NIO å®ä¾‹ä»¥ä¸‹å±•ç¤ºäº†ä½¿ç”¨ NIO å¿«é€Ÿå¤åˆ¶æ–‡ä»¶çš„å®ä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637public static void fastCopy(String src, String dist) throws IOException &#123; /* è·å¾—æºæ–‡ä»¶çš„è¾“å…¥å­—èŠ‚æµ */ FileInputStream fin = new FileInputStream(src); /* è·å–è¾“å…¥å­—èŠ‚æµçš„æ–‡ä»¶é€šé“ */ FileChannel fcin = fin.getChannel(); /* è·å–ç›®æ ‡æ–‡ä»¶çš„è¾“å‡ºå­—èŠ‚æµ */ FileOutputStream fout = new FileOutputStream(dist); /* è·å–è¾“å‡ºå­—èŠ‚æµçš„æ–‡ä»¶é€šé“ */ FileChannel fcout = fout.getChannel(); /* ä¸ºç¼“å†²åŒºåˆ†é… 1024 ä¸ªå­—èŠ‚ */ ByteBuffer buffer = ByteBuffer.allocateDirect(1024); while (true) &#123; /* ä»è¾“å…¥é€šé“ä¸­è¯»å–æ•°æ®åˆ°ç¼“å†²åŒºä¸­ */ int r = fcin.read(buffer); /* read() è¿”å› -1 è¡¨ç¤º EOF */ if (r == -1) &#123; break; &#125; /* åˆ‡æ¢è¯»å†™ */ buffer.flip(); /* æŠŠç¼“å†²åŒºçš„å†…å®¹å†™å…¥è¾“å‡ºæ–‡ä»¶ä¸­ */ fcout.write(buffer); /* æ¸…ç©ºç¼“å†²åŒº */ buffer.clear(); &#125;&#125; é€‰æ‹©å™¨NIO å¸¸å¸¸è¢«å«åšéé˜»å¡ IOï¼Œä¸»è¦æ˜¯å› ä¸º NIO åœ¨ç½‘ç»œé€šä¿¡ä¸­çš„éé˜»å¡ç‰¹æ€§è¢«å¹¿æ³›ä½¿ç”¨ã€‚ NIO å®ç°äº† IO å¤šè·¯å¤ç”¨ä¸­çš„ Reactor æ¨¡å‹ï¼Œä¸€ä¸ªçº¿ç¨‹ Thread ä½¿ç”¨ä¸€ä¸ªé€‰æ‹©å™¨ Selector é€šè¿‡è½®è¯¢çš„æ–¹å¼å»ç›‘å¬å¤šä¸ªé€šé“ Channel ä¸Šçš„äº‹ä»¶ï¼Œä»è€Œè®©ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥å¤„ç†å¤šä¸ªäº‹ä»¶ã€‚ é€šè¿‡é…ç½®ç›‘å¬çš„é€šé“ Channel ä¸ºéé˜»å¡ï¼Œé‚£ä¹ˆå½“ Channel ä¸Šçš„ IO äº‹ä»¶è¿˜æœªåˆ°è¾¾æ—¶ï¼Œå°±ä¸ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ä¸€ç›´ç­‰å¾…ï¼Œè€Œæ˜¯ç»§ç»­è½®è¯¢å…¶å®ƒ Channelï¼Œæ‰¾åˆ° IO äº‹ä»¶å·²ç»åˆ°è¾¾çš„ Channel æ‰§è¡Œã€‚ å› ä¸ºåˆ›å»ºå’Œåˆ‡æ¢çº¿ç¨‹çš„å¼€é”€å¾ˆå¤§ï¼Œå› æ­¤ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†å¤šä¸ªäº‹ä»¶è€Œä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªäº‹ä»¶ï¼Œå¯¹äº IO å¯†é›†å‹çš„åº”ç”¨å…·æœ‰å¾ˆå¥½åœ°æ€§èƒ½ã€‚ åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰å¥—æ¥å­— Channel æ‰èƒ½é…ç½®ä¸ºéé˜»å¡ï¼Œè€Œ FileChannel ä¸èƒ½ï¼Œä¸º FileChannel é…ç½®éé˜»å¡ä¹Ÿæ²¡æœ‰æ„ä¹‰ã€‚FSo åˆ›å»ºé€‰æ‹©å™¨ 1Selector selector = Selector.open(); å°†é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ä¸Š 123ServerSocketChannel ssChannel = ServerSocketChannel.open();ssChannel.configureBlocking(false);ssChannel.register(selector, SelectionKey.OP_ACCEPT); é€šé“å¿…é¡»é…ç½®ä¸ºéé˜»å¡æ¨¡å¼ï¼Œå¦åˆ™ä½¿ç”¨é€‰æ‹©å™¨å°±æ²¡æœ‰ä»»ä½•æ„ä¹‰äº†ï¼Œå› ä¸ºå¦‚æœé€šé“åœ¨æŸä¸ªäº‹ä»¶ä¸Šè¢«é˜»å¡ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¸èƒ½å“åº”å…¶å®ƒäº‹ä»¶ï¼Œå¿…é¡»ç­‰å¾…è¿™ä¸ªäº‹ä»¶å¤„ç†å®Œæ¯•æ‰èƒ½å»å¤„ç†å…¶å®ƒäº‹ä»¶ï¼Œæ˜¾ç„¶è¿™å’Œé€‰æ‹©å™¨çš„ä½œç”¨èƒŒé“è€Œé©°ã€‚ åœ¨å°†é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ä¸Šæ—¶ï¼Œè¿˜éœ€è¦æŒ‡å®šè¦æ³¨å†Œçš„å…·ä½“äº‹ä»¶ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ï¼š SelectionKey.OP_CONNECT SelectionKey.OP_ACCEPT SelectionKey.OP_READ SelectionKey.OP_WRITE å®ƒä»¬åœ¨ SelectionKey çš„å®šä¹‰å¦‚ä¸‹ï¼š 1234public static final int OP_READ = 1 &lt;&lt; 0;public static final int OP_WRITE = 1 &lt;&lt; 2;public static final int OP_CONNECT = 1 &lt;&lt; 3;public static final int OP_ACCEPT = 1 &lt;&lt; 4; å¯ä»¥çœ‹å‡ºæ¯ä¸ªäº‹ä»¶å¯ä»¥è¢«å½“æˆä¸€ä¸ªä½åŸŸï¼Œä»è€Œç»„æˆäº‹ä»¶é›†æ•´æ•°ã€‚ä¾‹å¦‚ï¼š 1int interestSet = SelectionKey.OP_READ | SelectionKey.OP_WRITE; ç›‘å¬äº‹ä»¶ 1int num = selector.select(); ä½¿ç”¨ select() æ¥ç›‘å¬åˆ°è¾¾çš„äº‹ä»¶ï¼Œå®ƒä¼šä¸€ç›´é˜»å¡ç›´åˆ°æœ‰è‡³å°‘ä¸€ä¸ªäº‹ä»¶åˆ°è¾¾ã€‚ è·å–åˆ°è¾¾çš„äº‹ä»¶ 1234567891011Set&lt;SelectionKey&gt; keys = selector.selectedKeys();Iterator&lt;SelectionKey&gt; keyIterator = keys.iterator();while (keyIterator.hasNext()) &#123; SelectionKey key = keyIterator.next(); if (key.isAcceptable()) &#123; // ... &#125; else if (key.isReadable()) &#123; // ... &#125; keyIterator.remove();&#125; äº‹ä»¶å¾ªç¯ å› ä¸ºä¸€æ¬¡ select() è°ƒç”¨ä¸èƒ½å¤„ç†å®Œæ‰€æœ‰çš„äº‹ä»¶ï¼Œå¹¶ä¸”æœåŠ¡å™¨ç«¯æœ‰å¯èƒ½éœ€è¦ä¸€ç›´ç›‘å¬äº‹ä»¶ï¼Œå› æ­¤æœåŠ¡å™¨ç«¯å¤„ç†äº‹ä»¶çš„ä»£ç ä¸€èˆ¬ä¼šæ”¾åœ¨ä¸€ä¸ªæ­»å¾ªç¯å†…ã€‚ 1234567891011121314while (true) &#123; int num = selector.select(); Set&lt;SelectionKey&gt; keys = selector.selectedKeys(); Iterator&lt;SelectionKey&gt; keyIterator = keys.iterator(); while (keyIterator.hasNext()) &#123; SelectionKey key = keyIterator.next(); if (key.isAcceptable()) &#123; // ... &#125; else if (key.isReadable()) &#123; // ... &#125; keyIterator.remove(); &#125;&#125; Socket NIO å®ä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778public class NIOServer &#123; public static void main(String[] args) throws IOException &#123; // åˆ›å»ºé€‰æ‹©å™¨ Selector selector = Selector.open(); // åˆ›å»ºä¸€ä¸ªé€šé“ ServerSocketChannel ssChannel = ServerSocketChannel.open(); // è®¾ç½®è¿™ä¸ªé€šé“æ˜¯éé˜»å¡çš„ ssChannel.configureBlocking(false); // å°†è¿™ä¸ªé€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ä¸Šï¼ŒåŒæ—¶ç»‘å®šäº†æ³¨å†Œçš„äº‹ä»¶ ssChannel.register(selector, SelectionKey.OP_ACCEPT); // åˆ›å»ºä¸€ä¸ª socket ServerSocket serverSocket = ssChannel.socket(); // ç»‘å®š ip å’Œ ç«¯å£ InetSocketAddress address = new InetSocketAddress(\"127.0.0.1\", 8888); serverSocket.bind(address); // å¾ªç¯å¤„ç† while (true) &#123; // é€‰æ‹©å™¨å¼€å§‹é€‰æ‹© selector.select(); Set&lt;SelectionKey&gt; keys = selector.selectedKeys(); Iterator&lt;SelectionKey&gt; keyIterator = keys.iterator(); while (keyIterator.hasNext()) &#123; SelectionKey key = keyIterator.next(); if (key.isAcceptable()) &#123; ServerSocketChannel ssChannel1 = (ServerSocketChannel) key.channel(); // æœåŠ¡å™¨ä¼šä¸ºæ¯ä¸ªæ–°è¿æ¥åˆ›å»ºä¸€ä¸ª SocketChannel SocketChannel sChannel = ssChannel1.accept(); sChannel.configureBlocking(false); // è¿™ä¸ªæ–°è¿æ¥ä¸»è¦ç”¨äºä»å®¢æˆ·ç«¯è¯»å–æ•°æ® sChannel.register(selector, SelectionKey.OP_READ); &#125; else if (key.isReadable()) &#123; SocketChannel sChannel = (SocketChannel) key.channel(); System.out.println(readDataFromSocketChannel(sChannel)); sChannel.close(); &#125; keyIterator.remove(); &#125; &#125; &#125; private static String readDataFromSocketChannel(SocketChannel sChannel) throws IOException &#123; ByteBuffer buffer = ByteBuffer.allocate(1024); StringBuilder data = new StringBuilder(); while (true) &#123; buffer.clear(); int n = sChannel.read(buffer); if (n == -1) &#123; break; &#125; buffer.flip(); int limit = buffer.limit(); char[] dst = new char[limit]; for (int i = 0; i &lt; limit; i++) &#123; dst[i] = (char) buffer.get(i); &#125; data.append(dst); buffer.clear(); &#125; return data.toString(); &#125;&#125; 12345678910public class NIOClient &#123; public static void main(String[] args) throws IOException &#123; Socket socket = new Socket(\"127.0.0.1\", 8888); OutputStream out = socket.getOutputStream(); String s = \"hello world\"; out.write(s.getBytes()); out.close(); &#125;&#125; å†…å­˜æ˜ å°„æ–‡ä»¶å†…å­˜æ˜ å°„æ–‡ä»¶ I/O æ˜¯ä¸€ç§è¯»å’Œå†™æ–‡ä»¶æ•°æ®çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥æ¯”å¸¸è§„çš„åŸºäºæµæˆ–è€…åŸºäºé€šé“çš„ I/O å¿«å¾—å¤šã€‚ å‘å†…å­˜æ˜ å°„æ–‡ä»¶å†™å…¥å¯èƒ½æ˜¯å±é™©çš„ï¼Œåªæ˜¯æ”¹å˜æ•°ç»„çš„å•ä¸ªå…ƒç´ è¿™æ ·çš„ç®€å•æ“ä½œï¼Œå°±å¯èƒ½ä¼šç›´æ¥ä¿®æ”¹ç£ç›˜ä¸Šçš„æ–‡ä»¶ã€‚ä¿®æ”¹æ•°æ®ä¸å°†æ•°æ®ä¿å­˜åˆ°ç£ç›˜æ˜¯æ²¡æœ‰åˆ†å¼€çš„ã€‚ ä¸‹é¢ä»£ç è¡Œå°†æ–‡ä»¶çš„å‰ 1024 ä¸ªå­—èŠ‚æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œmap() æ–¹æ³•è¿”å›ä¸€ä¸ª MappedByteBufferï¼Œå®ƒæ˜¯ ByteBuffer çš„å­ç±»ã€‚å› æ­¤ï¼Œå¯ä»¥åƒä½¿ç”¨å…¶ä»–ä»»ä½• ByteBuffer ä¸€æ ·ä½¿ç”¨æ–°æ˜ å°„çš„ç¼“å†²åŒºï¼Œæ“ä½œç³»ç»Ÿä¼šåœ¨éœ€è¦æ—¶è´Ÿè´£æ‰§è¡Œæ˜ å°„ã€‚ 1MappedByteBuffer mbb = fc.map(FileChannel.MapMode.READ_WRITE, 0, 1024); å¯¹æ¯”NIO ä¸æ™®é€š I/O çš„åŒºåˆ«ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š NIO æ˜¯éé˜»å¡çš„ï¼› NIO é¢å‘å—ï¼ŒI/O é¢å‘æµã€‚","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Javaè™šæ‹Ÿæœºæ€»ç»“","slug":"Javaè™šæ‹Ÿæœºæ€»ç»“","date":"2017-11-19T02:50:07.000Z","updated":"2018-09-06T08:23:20.686Z","comments":true,"path":"Javaè™šæ‹Ÿæœºæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Javaè™šæ‹Ÿæœºæ€»ç»“.html","excerpt":"","text":"ä¸€ã€è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ ç¨‹åºè®¡æ•°å™¨è®°å½•æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼ˆå¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯æœ¬åœ°æ–¹æ³•åˆ™ä¸ºç©ºï¼‰ã€‚ Java è™šæ‹Ÿæœºæ ˆæ¯ä¸ª Java æ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€å¸¸é‡æ± å¼•ç”¨ç­‰ä¿¡æ¯ã€‚ä»æ–¹æ³•è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨ Java è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚ å¯ä»¥é€šè¿‡ -Xss è¿™ä¸ªè™šæ‹Ÿæœºå‚æ•°æ¥æŒ‡å®šæ¯ä¸ªçº¿ç¨‹çš„ Java è™šæ‹Ÿæœºæ ˆå†…å­˜å¤§å°ï¼š 1java -Xss512M HackTheJava è¯¥åŒºåŸŸå¯èƒ½æŠ›å‡ºä»¥ä¸‹å¼‚å¸¸ï¼š å½“çº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦è¶…è¿‡æœ€å¤§å€¼ï¼Œä¼šæŠ›å‡º StackOverflowError å¼‚å¸¸ï¼› æ ˆè¿›è¡ŒåŠ¨æ€æ‰©å±•æ—¶å¦‚æœæ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿå†…å­˜ï¼Œä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚ æœ¬åœ°æ–¹æ³•æ ˆæœ¬åœ°æ–¹æ³•æ ˆä¸ Java è™šæ‹Ÿæœºæ ˆç±»ä¼¼ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«åªä¸è¿‡æ˜¯æœ¬åœ°æ–¹æ³•æ ˆä¸ºæœ¬åœ°æ–¹æ³•æœåŠ¡ã€‚ æœ¬åœ°æ–¹æ³•ä¸€èˆ¬æ˜¯ç”¨å…¶å®ƒè¯­è¨€ï¼ˆCã€C++ æˆ–æ±‡ç¼–è¯­è¨€ç­‰ï¼‰ç¼–å†™çš„ï¼Œå¹¶ä¸”è¢«ç¼–è¯‘ä¸ºåŸºäºæœ¬æœºç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„ç¨‹åºï¼Œå¯¹å¾…è¿™äº›æ–¹æ³•éœ€è¦ç‰¹åˆ«å¤„ç†ã€‚ å † (Heap)æ‰€æœ‰å¯¹è±¡éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ï¼Œæ˜¯åƒåœ¾æ”¶é›†çš„ä¸»è¦åŒºåŸŸï¼ˆâ€GC å †â€ï¼‰ã€‚ ç°ä»£çš„åƒåœ¾æ”¶é›†å™¨åŸºæœ¬éƒ½æ˜¯é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œå…¶ä¸»è¦çš„æ€æƒ³æ˜¯é’ˆå¯¹ä¸åŒç±»å‹çš„å¯¹è±¡é‡‡å–ä¸åŒçš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Œå¯ä»¥å°†å †åˆ†æˆä¸¤å—ï¼š æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰åˆ†ä¸º Eden survivor1 survicor2 8:1:1 è€å¹´ä»£ï¼ˆOld Generationï¼‰ å †ä¸éœ€è¦è¿ç»­å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€å¢åŠ å…¶å†…å­˜ï¼Œå¢åŠ å¤±è´¥ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚ å¯ä»¥é€šè¿‡ -Xms å’Œ -Xmx ä¸¤ä¸ªè™šæ‹Ÿæœºå‚æ•°æ¥æŒ‡å®šä¸€ä¸ªç¨‹åºçš„å †å†…å­˜å¤§å°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®åˆå§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°è®¾ç½®æœ€å¤§å€¼ã€‚ 1java -Xms1M -Xmx2M HackTheJava æ–¹æ³•åŒºç”¨äºå­˜æ”¾å·²è¢«åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚ å’Œå †ä¸€æ ·ä¸éœ€è¦è¿ç»­çš„å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€æ‰©å±•ï¼ŒåŠ¨æ€æ‰©å±•å¤±è´¥ä¸€æ ·ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚ å¯¹è¿™å—åŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶çš„ä¸»è¦ç›®æ ‡æ˜¯å¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»çš„å¸è½½ï¼Œä½†æ˜¯ä¸€èˆ¬æ¯”è¾ƒéš¾å®ç°ã€‚ HotSpot è™šæ‹Ÿæœº(sun å…¬å¸å®ç°çš„åŸºäºæ ˆçš„è™šæ‹Ÿæœºï¼Œgoogle ä¹Ÿå®ç°äº†ä¸€æ¬¾åŸºäºç¨‹åºè®¡æ•°å™¨çš„ï¼Œä½†æ˜¯ä¸ºäº†å¹³å°é€šç”¨æ€§å’Œä¼ è¾“ç´§å‡‘æ€§ï¼ŒåŸºäºæ ˆçš„è®¾è®¡ä¼˜äºåŸºäºè®¡æ•°å™¨çš„å®ç°ï¼Œä½†æ˜¯æ€§èƒ½å’Œç©ºé—´åˆéœ€è¦å†ä¸€æ¬¡æƒè¡¡)æŠŠå®ƒå½“æˆæ°¸ä¹…ä»£æ¥è¿›è¡Œåƒåœ¾å›æ”¶ã€‚ä½†æ˜¯å¾ˆéš¾ç¡®å®šæ°¸ä¹…ä»£çš„å¤§å°ï¼Œå› ä¸ºå®ƒå—åˆ°å¾ˆå¤šå› ç´ å½±å“ï¼Œå¹¶ä¸”æ¯æ¬¡ Full GC ä¹‹åæ°¸ä¹…ä»£çš„å¤§å°éƒ½ä¼šæ”¹å˜ï¼Œæ‰€ä»¥ç»å¸¸ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ ä¸ºäº†æ›´å®¹æ˜“ç®¡ç†æ–¹æ³•åŒºï¼Œä» JDK 1.8 å¼€å§‹ï¼Œç§»é™¤æ°¸ä¹…ä»£ï¼Œå¹¶æŠŠæ–¹æ³•åŒºç§»è‡³å…ƒç©ºé—´ï¼Œå®ƒä½äºæœ¬åœ°å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯è™šæ‹Ÿæœºå†…å­˜ä¸­ã€‚ è¿è¡Œæ—¶å¸¸é‡æ± è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ† Class æ–‡ä»¶ä¸­çš„å¸¸é‡æ± ï¼ˆç¼–è¯‘å™¨ç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼‰ä¼šåœ¨ç±»åŠ è½½åè¢«æ”¾å…¥è¿™ä¸ªåŒºåŸŸã€‚ é™¤äº†åœ¨ç¼–è¯‘æœŸç”Ÿæˆçš„å¸¸é‡ï¼Œè¿˜å…è®¸åŠ¨æ€ç”Ÿæˆï¼Œä¾‹å¦‚ String ç±»çš„ intern()ã€‚ ç›´æ¥å†…å­˜åœ¨ JDK 1.4 ä¸­æ–°åŠ å…¥äº† NIO ç±»ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ Native å‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼ˆNative å †ï¼‰ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨ Java å †é‡Œçš„ DirectByteBuffer å¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚ è¿™æ ·èƒ½åœ¨ä¸€äº›åœºæ™¯ä¸­æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†åœ¨ Java å †å’Œ Native å †ä¸­æ¥å›å¤åˆ¶æ•°æ®ã€‚ äºŒã€åƒåœ¾æ”¶é›†åƒåœ¾æ”¶é›†ä¸»è¦æ˜¯é’ˆå¯¹å †å’Œæ–¹æ³•åŒºè¿›è¡Œã€‚ ç¨‹åºè®¡æ•°å™¨ã€Javaæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆè¿™ä¸‰ä¸ªåŒºåŸŸå±äºçº¿ç¨‹ç§æœ‰çš„ï¼Œåªå­˜åœ¨äºçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œçº¿ç¨‹ç»“æŸä¹‹åä¹Ÿä¼šæ¶ˆå¤±ï¼Œå› æ­¤ä¸éœ€è¦å¯¹è¿™ä¸‰ä¸ªåŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶ã€‚ åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶ å¼•ç”¨è®¡æ•°ç®—æ³• ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œå½“å¯¹è±¡å¢åŠ ä¸€ä¸ªå¼•ç”¨æ—¶è®¡æ•°å™¨åŠ  1ï¼Œå¼•ç”¨å¤±æ•ˆæ—¶è®¡æ•°å™¨å‡ 1ã€‚å¼•ç”¨è®¡æ•°ä¸º 0çš„å¯¹è±¡å¯è¢«å›æ”¶ã€‚ ä¸¤ä¸ªå¯¹è±¡å‡ºç°å¾ªç¯å¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œæ­¤æ—¶å¼•ç”¨è®¡æ•°å™¨æ°¸è¿œä¸ä¸º 0ï¼Œå¯¼è‡´æ— æ³•å¯¹å®ƒä»¬è¿›è¡Œå›æ”¶ã€‚ æ­£å› ä¸ºå¾ªç¯å¼•ç”¨çš„å­˜åœ¨ï¼Œå› æ­¤ Java è™šæ‹Ÿæœºä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•ã€‚ 1234567891011public class ReferenceCountingGC &#123; public Object instance = null; public static void main(String[] args) &#123; ReferenceCountingGC objectA = new ReferenceCountingGC(); ReferenceCountingGC objectB = new ReferenceCountingGC(); objectA.instance = objectB; objectB.instance = objectA; &#125;&#125; å¯è¾¾æ€§åˆ†æç®—æ³• é€šè¿‡ GC Roots ä½œä¸ºèµ·å§‹ç‚¹è¿›è¡Œæœç´¢ï¼Œèƒ½å¤Ÿåˆ°è¾¾åˆ°çš„å¯¹è±¡éƒ½æ˜¯å­˜æ´»çš„ï¼Œä¸å¯è¾¾çš„å¯¹è±¡å¯è¢«å›æ”¶ã€‚ Java è™šæ‹Ÿæœºä½¿ç”¨è¯¥ç®—æ³•æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶ï¼Œåœ¨ Java ä¸­ GC Roots ä¸€èˆ¬åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š Javaæ ˆä¸­å±€éƒ¨å˜é‡è¡¨ä¸­å¼•ç”¨çš„å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­ JNI ä¸­å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­çš„å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºçš„å›æ”¶ å› ä¸ºæ–¹æ³•åŒºä¸»è¦å­˜æ”¾æ°¸ä¹…ä»£å¯¹è±¡ï¼Œè€Œæ°¸ä¹…ä»£å¯¹è±¡çš„å›æ”¶ç‡æ¯”æ–°ç”Ÿä»£ä½å¾ˆå¤šï¼Œå› æ­¤åœ¨æ–¹æ³•åŒºä¸Šè¿›è¡Œå›æ”¶æ€§ä»·æ¯”ä¸é«˜ã€‚ ä¸»è¦æ˜¯å¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»çš„å¸è½½ã€‚ åœ¨å¤§é‡ä½¿ç”¨åå°„ã€åŠ¨æ€ä»£ç†ã€CGLib ç­‰ ByteCode æ¡†æ¶ã€åŠ¨æ€ç”Ÿæˆ JSP ä»¥åŠ OSGi è¿™ç±»é¢‘ç¹è‡ªå®šä¹‰ ClassLoader çš„åœºæ™¯éƒ½éœ€è¦è™šæ‹Ÿæœºå…·å¤‡ç±»å¸è½½åŠŸèƒ½ï¼Œä»¥ä¿è¯ä¸ä¼šå‡ºç°å†…å­˜æº¢å‡ºã€‚ ç±»çš„å¸è½½æ¡ä»¶å¾ˆå¤šï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼Œå¹¶ä¸”æ»¡è¶³äº†ä¹Ÿä¸ä¸€å®šä¼šè¢«å¸è½½ï¼š è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚ åŠ è½½è¯¥ç±»çš„ ClassLoader å·²ç»è¢«å›æ”¶ã€‚ è¯¥ç±»å¯¹åº”çš„ Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œä¹Ÿå°±æ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»æ–¹æ³•ã€‚ å¯ä»¥é€šè¿‡ -Xnoclassgc å‚æ•°æ¥æ§åˆ¶æ˜¯å¦å¯¹ç±»è¿›è¡Œå¸è½½ã€‚ finalize() finalize() ç±»ä¼¼ C++ çš„ææ„å‡½æ•°ï¼Œç”¨æ¥åšå…³é—­å¤–éƒ¨èµ„æºç­‰å·¥ä½œã€‚ä½†æ˜¯ try-finally ç­‰æ–¹å¼å¯ä»¥åšçš„æ›´å¥½ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•è¿è¡Œä»£ä»·é«˜æ˜‚ï¼Œä¸ç¡®å®šæ€§å¤§ï¼Œæ— æ³•ä¿è¯å„ä¸ªå¯¹è±¡çš„è°ƒç”¨é¡ºåºï¼Œå› æ­¤æœ€å¥½ä¸è¦ä½¿ç”¨ã€‚ å½“ä¸€ä¸ªå¯¹è±¡å¯è¢«å›æ”¶æ—¶ï¼Œå¦‚æœéœ€è¦æ‰§è¡Œè¯¥å¯¹è±¡çš„ finalize() æ–¹æ³•ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½åœ¨è¯¥æ–¹æ³•ä¸­è®©å¯¹è±¡é‡æ–°è¢«å¼•ç”¨ï¼Œä»è€Œå®ç°è‡ªæ•‘ã€‚è‡ªæ•‘åªèƒ½è¿›è¡Œä¸€æ¬¡ï¼Œ å¼•ç”¨ç±»å‹æ— è®ºæ˜¯é€šè¿‡å¼•ç”¨è®¡ç®—ç®—æ³•åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨æ•°é‡ï¼Œè¿˜æ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯è¾¾ï¼Œåˆ¤å®šå¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶éƒ½ä¸å¼•ç”¨æœ‰å…³ã€‚ Java æä¾›äº†å››ç§å¼ºåº¦ä¸åŒçš„å¼•ç”¨ç±»å‹ã€‚ å¼ºå¼•ç”¨ è¢«å¼ºå¼•ç”¨å…³è”çš„å¯¹è±¡ä¸ä¼šè¢«å›æ”¶ã€‚ ä½¿ç”¨ new ä¸€ä¸ªæ–°å¯¹è±¡çš„æ–¹å¼æ¥åˆ›å»ºå¼ºå¼•ç”¨ã€‚ 1Object obj = new Object(); è½¯å¼•ç”¨ è¢«è½¯å¼•ç”¨å…³è”çš„å¯¹è±¡åªæœ‰åœ¨å†…å­˜ä¸å¤Ÿçš„æƒ…å†µä¸‹æ‰ä¼šè¢«å›æ”¶ã€‚ ä½¿ç”¨ SoftReference ç±»æ¥åˆ›å»ºè½¯å¼•ç”¨ã€‚ 123Object obj = new Object();SoftReference&lt;Object&gt; sf = new SoftReference&lt;Object&gt;(obj);obj = null; // ä½¿å¯¹è±¡åªè¢«è½¯å¼•ç”¨å…³è” å¼±å¼•ç”¨ è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ä¸€å®šä¼šè¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåªèƒ½å­˜æ´»åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶å‘ç”Ÿä¹‹å‰ã€‚ ä½¿ç”¨ WeakReference ç±»æ¥å®ç°å¼±å¼•ç”¨ã€‚ 123Object obj = new Object();WeakReference&lt;Object&gt; wf = new WeakReference&lt;Object&gt;(obj);obj = null; // ä½¿å¯¹è±¡åªè¢«å¼±å¼•ç”¨å…³è” è™šå¼•ç”¨ åˆç§°ä¸ºå¹½çµå¼•ç”¨æˆ–è€…å¹»å½±å¼•ç”¨ã€‚ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨ï¼Œå®Œå…¨ä¸ä¼šå¯¹å…¶ç”Ÿå­˜æ—¶é—´æ„æˆå½±å“ï¼Œä¹Ÿæ— æ³•é€šè¿‡è™šå¼•ç”¨å–å¾—ä¸€ä¸ªå¯¹è±¡ã€‚ ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„å°±æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚ ä½¿ç”¨ PhantomReference æ¥å®ç°è™šå¼•ç”¨ã€‚ 123Object obj = new Object();PhantomReference&lt;Object&gt; pf = new PhantomReference&lt;Object&gt;(obj);obj = null; // ä½¿å¯¹è±¡åªè¢«è™šå¼•ç”¨å…³è” åƒåœ¾æ”¶é›†ç®—æ³• æ ‡è®° - æ¸…é™¤ å°†å­˜æ´»çš„å¯¹è±¡è¿›è¡Œæ ‡è®°ï¼Œç„¶åæ¸…ç†æ‰æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚ ä¸è¶³ï¼š æ ‡è®°å’Œæ¸…é™¤è¿‡ç¨‹æ•ˆç‡éƒ½ä¸é«˜ï¼› ä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ï¼Œå¯¼è‡´æ— æ³•ç»™å¤§å¯¹è±¡åˆ†é…å†…å­˜ã€‚ æ ‡è®° - æ•´ç† è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚ å¤åˆ¶ å°†å†…å­˜åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œå½“è¿™ä¸€å—å†…å­˜ç”¨å®Œäº†å°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´è¿›è¡Œä¸€æ¬¡æ¸…ç†ã€‚ ä¸»è¦ä¸è¶³æ˜¯åªä½¿ç”¨äº†å†…å­˜çš„ä¸€åŠã€‚ ç°åœ¨çš„å•†ä¸šè™šæ‹Ÿæœºéƒ½é‡‡ç”¨è¿™ç§æ”¶é›†ç®—æ³•æ¥å›æ”¶æ–°ç”Ÿä»£ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯å°†æ–°ç”Ÿä»£åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œè€Œæ˜¯åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„ Eden ç©ºé—´å’Œä¸¤å—è¾ƒå°çš„ Survivor ç©ºé—´ï¼Œæ¯æ¬¡ä½¿ç”¨ Eden ç©ºé—´å’Œå…¶ä¸­ä¸€å— Survivorã€‚åœ¨å›æ”¶æ—¶ï¼Œå°† Eden å’Œ Survivor ä¸­è¿˜å­˜æ´»ç€çš„å¯¹è±¡ä¸€æ¬¡æ€§å¤åˆ¶åˆ°å¦ä¸€å— Survivor ç©ºé—´ä¸Šï¼Œæœ€åæ¸…ç† Eden å’Œä½¿ç”¨è¿‡çš„é‚£ä¸€å— Survivorã€‚ HotSpot è™šæ‹Ÿæœºçš„ Eden å’Œ Survivor çš„å¤§å°æ¯”ä¾‹é»˜è®¤ä¸º 8:1ï¼Œä¿è¯äº†å†…å­˜çš„åˆ©ç”¨ç‡è¾¾åˆ° 90%ã€‚å¦‚æœæ¯æ¬¡å›æ”¶æœ‰å¤šäº 10% çš„å¯¹è±¡å­˜æ´»ï¼Œé‚£ä¹ˆä¸€å— Survivor ç©ºé—´å°±ä¸å¤Ÿç”¨äº†ï¼Œæ­¤æ—¶éœ€è¦ä¾èµ–äºè€å¹´ä»£è¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œä¹Ÿå°±æ˜¯å€Ÿç”¨è€å¹´ä»£çš„ç©ºé—´å­˜å‚¨æ”¾ä¸ä¸‹çš„å¯¹è±¡ã€‚ åˆ†ä»£æ”¶é›† ç°åœ¨çš„å•†ä¸šè™šæ‹Ÿæœºé‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œå®ƒæ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ï¼Œä¸åŒå—é‡‡ç”¨é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚ ä¸€èˆ¬å°†å †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚ æ–°ç”Ÿä»£ä½¿ç”¨ï¼šå¤åˆ¶ç®—æ³• è€å¹´ä»£ä½¿ç”¨ï¼šæ ‡è®° - æ¸…é™¤ æˆ–è€… æ ‡è®° - æ•´ç† ç®—æ³• åƒåœ¾æ”¶é›†å™¨ ä»¥ä¸Šæ˜¯ HotSpot è™šæ‹Ÿæœºä¸­çš„ 7 ä¸ªåƒåœ¾æ”¶é›†å™¨ï¼Œè¿çº¿è¡¨ç¤ºåƒåœ¾æ”¶é›†å™¨å¯ä»¥é…åˆä½¿ç”¨ã€‚ å•çº¿ç¨‹ä¸å¤šçº¿ç¨‹ï¼šå•çº¿ç¨‹æŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨åªä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ”¶é›†ï¼Œè€Œå¤šçº¿ç¨‹ä½¿ç”¨å¤šä¸ªçº¿ç¨‹ï¼› ä¸²è¡Œä¸å¹¶è¡Œï¼šä¸²è¡ŒæŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨ä¸ç”¨æˆ·ç¨‹åºäº¤æ›¿æ‰§è¡Œï¼Œè¿™æ„å‘³ç€åœ¨æ‰§è¡Œåƒåœ¾æ”¶é›†çš„æ—¶å€™éœ€è¦åœé¡¿ç”¨æˆ·ç¨‹åºï¼›å¹¶è¡ŒæŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨å’Œç”¨æˆ·ç¨‹åºåŒæ—¶æ‰§è¡Œã€‚é™¤äº† CMS å’Œ G1 ä¹‹å¤–ï¼Œå…¶å®ƒåƒåœ¾æ”¶é›†å™¨éƒ½æ˜¯ä»¥ä¸²è¡Œçš„æ–¹å¼æ‰§è¡Œã€‚ Serial æ”¶é›†å™¨ Serial ç¿»è¯‘ä¸ºä¸²è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¥ä¸²è¡Œçš„æ–¹å¼æ‰§è¡Œã€‚ å®ƒæ˜¯å•çº¿ç¨‹çš„æ”¶é›†å™¨ï¼Œåªä¼šä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œã€‚ å®ƒçš„ä¼˜ç‚¹æ˜¯ç®€å•é«˜æ•ˆï¼Œå¯¹äºå•ä¸ª CPU ç¯å¢ƒæ¥è¯´ï¼Œç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œå› æ­¤æ‹¥æœ‰æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚ å®ƒæ˜¯ Client æ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œå› ä¸ºåœ¨è¯¥åº”ç”¨åœºæ™¯ä¸‹ï¼Œåˆ†é…ç»™è™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸€èˆ¬æ¥è¯´ä¸ä¼šå¾ˆå¤§ã€‚Serial æ”¶é›†å™¨æ”¶é›†å‡ åå…†ç”šè‡³ä¸€ä¸¤ç™¾å…†çš„æ–°ç”Ÿä»£åœé¡¿æ—¶é—´å¯ä»¥æ§åˆ¶åœ¨ä¸€ç™¾å¤šæ¯«ç§’ä»¥å†…ï¼Œåªè¦ä¸æ˜¯å¤ªé¢‘ç¹ï¼Œè¿™ç‚¹åœé¡¿æ˜¯å¯ä»¥æ¥å—çš„ã€‚ ParNew æ”¶é›†å™¨ å®ƒæ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ã€‚ æ˜¯ Server æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºé¦–é€‰æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œé™¤äº†æ€§èƒ½åŸå› å¤–ï¼Œä¸»è¦æ˜¯å› ä¸ºé™¤äº† Serial æ”¶é›†å™¨ï¼Œåªæœ‰å®ƒèƒ½ä¸ CMS æ”¶é›†å™¨é…åˆå·¥ä½œã€‚ é»˜è®¤å¼€å¯çš„çº¿ç¨‹æ•°é‡ä¸ CPU æ•°é‡ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨ -XX:ParallelGCThreads å‚æ•°æ¥è®¾ç½®çº¿ç¨‹æ•°ã€‚ Parallel Scavenge æ”¶é›†å™¨ ä¸ ParNew ä¸€æ ·æ˜¯å¤šçº¿ç¨‹æ”¶é›†å™¨ã€‚ å…¶å®ƒæ”¶é›†å™¨å…³æ³¨ç‚¹æ˜¯å°½å¯èƒ½ç¼©çŸ­åƒåœ¾æ”¶é›†æ—¶ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼Œè€Œå®ƒçš„ç›®æ ‡æ˜¯è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡ï¼Œå®ƒè¢«ç§°ä¸ºâ€œååé‡ä¼˜å…ˆâ€æ”¶é›†å™¨ã€‚ è¿™é‡Œçš„ååé‡æŒ‡ CPU ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´å æ€»æ—¶é—´çš„æ¯”å€¼ã€‚ åœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºï¼Œè‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½æå‡ç”¨æˆ·ä½“éªŒã€‚è€Œé«˜ååé‡åˆ™å¯ä»¥é«˜æ•ˆç‡åœ°åˆ©ç”¨ CPU æ—¶é—´ï¼Œå°½å¿«å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡ï¼Œé€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚ ç¼©çŸ­åœé¡¿æ—¶é—´æ˜¯ä»¥ç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´æ¥æ¢å–çš„ï¼šæ–°ç”Ÿä»£ç©ºé—´å˜å°ï¼Œåƒåœ¾å›æ”¶å˜å¾—é¢‘ç¹ï¼Œå¯¼è‡´ååé‡ä¸‹é™ã€‚ å¯ä»¥é€šè¿‡ä¸€ä¸ªå¼€å…³å‚æ•°æ‰“å¼€ GC è‡ªé€‚åº”çš„è°ƒèŠ‚ç­–ç•¥ï¼ˆGC Ergonomicsï¼‰ï¼Œå°±ä¸éœ€è¦æ‰‹å·¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ï¼ˆ-Xmnï¼‰ã€Eden å’Œ Survivor åŒºçš„æ¯”ä¾‹ã€æ™‹å‡è€å¹´ä»£å¯¹è±¡å¹´é¾„ç­‰ç»†èŠ‚å‚æ•°äº†ã€‚è™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´è¿™äº›å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–è€…æœ€å¤§çš„ååé‡ã€‚ Serial Old æ”¶é›†å™¨ æ˜¯ Serial æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œä¹Ÿæ˜¯ç»™ Client æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä½¿ç”¨ã€‚ å¦‚æœç”¨åœ¨ Server æ¨¡å¼ä¸‹ï¼Œå®ƒæœ‰ä¸¤å¤§ç”¨é€”ï¼š åœ¨ JDK 1.5 ä»¥åŠä¹‹å‰ç‰ˆæœ¬ï¼ˆParallel Old è¯ç”Ÿä»¥å‰ï¼‰ä¸­ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ã€‚ ä½œä¸º CMS æ”¶é›†å™¨çš„åå¤‡é¢„æ¡ˆï¼Œåœ¨å¹¶å‘æ”¶é›†å‘ç”Ÿ Concurrent Mode Failure æ—¶ä½¿ç”¨ã€‚ Parallel Old æ”¶é›†å™¨ æ˜¯ Parallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ã€‚ åœ¨æ³¨é‡ååé‡ä»¥åŠ CPU èµ„æºæ•æ„Ÿçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavenge åŠ  Parallel Old æ”¶é›†å™¨ã€‚ CMS æ”¶é›†å™¨ CMSï¼ˆConcurrent Mark Sweepï¼‰ï¼ŒMark Sweep æŒ‡çš„æ˜¯æ ‡è®° - æ¸…é™¤ç®—æ³•ã€‚ åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæµç¨‹ï¼š åˆå§‹æ ‡è®°ï¼šä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹ GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œéœ€è¦åœé¡¿ã€‚ å¹¶å‘æ ‡è®°ï¼šè¿›è¡Œ GC Roots Tracing çš„è¿‡ç¨‹ï¼Œå®ƒåœ¨æ•´ä¸ªå›æ”¶è¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿ï¼Œä¸éœ€è¦åœé¡¿ã€‚ é‡æ–°æ ‡è®°ï¼šä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œéœ€è¦åœé¡¿ã€‚ å¹¶å‘æ¸…é™¤ï¼šä¸éœ€è¦åœé¡¿ã€‚ åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤è¿‡ç¨‹ä¸­ï¼Œæ”¶é›†å™¨çº¿ç¨‹éƒ½å¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œä¸éœ€è¦è¿›è¡Œåœé¡¿ã€‚ å…·æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š ååé‡ä½ï¼šä½åœé¡¿æ—¶é—´æ˜¯ä»¥ç‰ºç‰²ååé‡ä¸ºä»£ä»·çš„ï¼Œå¯¼è‡´ CPU åˆ©ç”¨ç‡ä¸å¤Ÿé«˜ã€‚ æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼Œå¯èƒ½å‡ºç° Concurrent Mode Failureã€‚æµ®åŠ¨åƒåœ¾æ˜¯æŒ‡å¹¶å‘æ¸…é™¤é˜¶æ®µç”±äºç”¨æˆ·çº¿ç¨‹ç»§ç»­è¿è¡Œè€Œäº§ç”Ÿçš„åƒåœ¾ï¼Œè¿™éƒ¨åˆ†åƒåœ¾åªèƒ½åˆ°ä¸‹ä¸€æ¬¡ GC æ—¶æ‰èƒ½è¿›è¡Œå›æ”¶ã€‚ç”±äºæµ®åŠ¨åƒåœ¾çš„å­˜åœ¨ï¼Œå› æ­¤éœ€è¦é¢„ç•™å‡ºä¸€éƒ¨åˆ†å†…å­˜ï¼Œæ„å‘³ç€ CMS æ”¶é›†ä¸èƒ½åƒå…¶å®ƒæ”¶é›†å™¨é‚£æ ·ç­‰å¾…è€å¹´ä»£å¿«æ»¡çš„æ—¶å€™å†å›æ”¶ã€‚å¦‚æœé¢„ç•™çš„å†…å­˜ä¸å¤Ÿå­˜æ”¾æµ®åŠ¨åƒåœ¾ï¼Œå°±ä¼šå‡ºç° Concurrent Mode Failureï¼Œè¿™æ—¶è™šæ‹Ÿæœºå°†ä¸´æ—¶å¯ç”¨ Serial Old æ¥æ›¿ä»£ CMSã€‚ æ ‡è®° - æ¸…é™¤ç®—æ³•å¯¼è‡´çš„ç©ºé—´ç¢ç‰‡ï¼Œå¾€å¾€å‡ºç°è€å¹´ä»£ç©ºé—´å‰©ä½™ï¼Œä½†æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§è¿ç»­ç©ºé—´æ¥åˆ†é…å½“å‰å¯¹è±¡ï¼Œä¸å¾—ä¸æå‰è§¦å‘ä¸€æ¬¡ Full GC G1 æ”¶é›†å™¨ G1ï¼ˆGarbage-Firstï¼‰ï¼Œå®ƒæ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ï¼Œåœ¨å¤šCPU å’Œå¤§å†…å­˜çš„åœºæ™¯ä¸‹æœ‰å¾ˆå¥½çš„æ€§èƒ½ã€‚HotSpotå¼€å‘å›¢é˜Ÿèµ‹äºˆå®ƒçš„ä½¿å‘½æ˜¯æœªæ¥å¯ä»¥æ›¿æ¢æ‰ CMS æ”¶é›†å™¨ã€‚ å †è¢«åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œå…¶å®ƒæ”¶é›†å™¨è¿›è¡Œæ”¶é›†çš„èŒƒå›´éƒ½æ˜¯æ•´ä¸ªæ–°ç”Ÿä»£æˆ–è€…è€å¹´ä»£ï¼Œè€Œ G1 å¯ä»¥ç›´æ¥å¯¹æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸€èµ·å›æ”¶ã€‚ G1 æŠŠå †åˆ’åˆ†æˆå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼Œæ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†ç‰©ç†éš”ç¦»ã€‚ é€šè¿‡å¼•å…¥ Region çš„æ¦‚å¿µï¼Œä»è€Œå°†åŸæ¥çš„ä¸€æ•´å—å†…å­˜ç©ºé—´åˆ’åˆ†æˆå¤šä¸ªçš„å°ç©ºé—´ï¼Œä½¿å¾—æ¯ä¸ªå°ç©ºé—´å¯ä»¥å•ç‹¬è¿›è¡Œåƒåœ¾å›æ”¶ã€‚è¿™ç§åˆ’åˆ†æ–¹æ³•å¸¦æ¥äº†å¾ˆå¤§çš„çµæ´»æ€§ï¼Œä½¿å¾—å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹æˆä¸ºå¯èƒ½ã€‚é€šè¿‡è®°å½•æ¯ä¸ªRegionåƒåœ¾å›æ”¶æ—¶é—´ä»¥åŠå›æ”¶æ‰€è·å¾—çš„ç©ºé—´ï¼ˆè¿™ä¸¤ä¸ªå€¼æ˜¯é€šè¿‡è¿‡å»å›æ”¶çš„ç»éªŒè·å¾—ï¼‰ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„ Regionã€‚ æ¯ä¸ª Region éƒ½æœ‰ä¸€ä¸ª Remembered Setï¼Œç”¨æ¥è®°å½•è¯¥ Region å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡æ‰€åœ¨çš„ Regionã€‚é€šè¿‡ä½¿ç”¨ Remembered Setï¼Œåœ¨åšå¯è¾¾æ€§åˆ†æçš„æ—¶å€™å°±å¯ä»¥é¿å…å…¨å †æ‰«æã€‚ å¦‚æœä¸è®¡ç®—ç»´æŠ¤ Remembered Set çš„æ“ä½œï¼ŒG1 æ”¶é›†å™¨çš„è¿ä½œå¤§è‡´å¯åˆ’åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š åˆå§‹æ ‡è®° å¹¶å‘æ ‡è®° æœ€ç»ˆæ ‡è®°ï¼šä¸ºäº†ä¿®æ­£åœ¨å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†æ ‡è®°è®°å½•ï¼Œè™šæ‹Ÿæœºå°†è¿™æ®µæ—¶é—´å¯¹è±¡å˜åŒ–è®°å½•åœ¨çº¿ç¨‹çš„ Remembered Set Logs é‡Œé¢ï¼Œæœ€ç»ˆæ ‡è®°é˜¶æ®µéœ€è¦æŠŠ Remembered Set Logs çš„æ•°æ®åˆå¹¶åˆ° Remembered Set ä¸­ã€‚è¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†æ˜¯å¯å¹¶è¡Œæ‰§è¡Œã€‚ ç­›é€‰å›æ”¶ï¼šé¦–å…ˆå¯¹å„ä¸ª Region ä¸­çš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„ GC åœé¡¿æ—¶é—´æ¥åˆ¶å®šå›æ”¶è®¡åˆ’ã€‚æ­¤é˜¶æ®µå…¶å®ä¹Ÿå¯ä»¥åšåˆ°ä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºåªå›æ”¶ä¸€éƒ¨åˆ† Regionï¼Œæ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„ï¼Œè€Œä¸”åœé¡¿ç”¨æˆ·çº¿ç¨‹å°†å¤§å¹…åº¦æé«˜æ”¶é›†æ•ˆç‡ã€‚ å…·å¤‡å¦‚ä¸‹ç‰¹ç‚¹ï¼š ç©ºé—´æ•´åˆï¼šæ•´ä½“æ¥çœ‹æ˜¯åŸºäºâ€œæ ‡è®° - æ•´ç†â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼Œä»å±€éƒ¨ï¼ˆä¸¤ä¸ª Region ä¹‹é—´ï¼‰ä¸Šæ¥çœ‹æ˜¯åŸºäºâ€œå¤åˆ¶â€ç®—æ³•å®ç°çš„ï¼Œè¿™æ„å‘³ç€è¿è¡ŒæœŸé—´ä¸ä¼šäº§ç”Ÿå†…å­˜ç©ºé—´ç¢ç‰‡ã€‚ å¯é¢„æµ‹çš„åœé¡¿ï¼šèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨ GC ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡ N æ¯«ç§’ã€‚ ä¸‰ã€å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥Minor GC å’Œ Full GC Minor GCï¼šå‘ç”Ÿåœ¨æ–°ç”Ÿä»£ä¸Šï¼Œå› ä¸ºæ–°ç”Ÿä»£å¯¹è±¡å­˜æ´»æ—¶é—´å¾ˆçŸ­ï¼Œå› æ­¤ Minor GC ä¼šé¢‘ç¹æ‰§è¡Œï¼Œæ‰§è¡Œçš„é€Ÿåº¦ä¸€èˆ¬ä¹Ÿä¼šæ¯”è¾ƒå¿«ã€‚ Full GCï¼šå‘ç”Ÿåœ¨è€å¹´ä»£ä¸Šï¼Œè€å¹´ä»£å¯¹è±¡å…¶å­˜æ´»æ—¶é—´é•¿ï¼Œå› æ­¤ Full GC å¾ˆå°‘æ‰§è¡Œï¼Œæ‰§è¡Œé€Ÿåº¦ä¼šæ¯” Minor GC æ…¢å¾ˆå¤šã€‚ å†…å­˜åˆ†é…ç­–ç•¥ å¯¹è±¡ä¼˜å…ˆåœ¨ Eden åˆ†é… å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£ Eden åŒºåˆ†é…ï¼Œå½“ Eden åŒºç©ºé—´ä¸å¤Ÿæ—¶ï¼Œå‘èµ· Minor GCã€‚ å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ å¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼Œæœ€å…¸å‹çš„å¤§å¯¹è±¡æ˜¯é‚£ç§å¾ˆé•¿çš„å­—ç¬¦ä¸²ä»¥åŠæ•°ç»„ã€‚ ç»å¸¸å‡ºç°å¤§å¯¹è±¡ä¼šæå‰è§¦å‘åƒåœ¾æ”¶é›†ä»¥è·å–è¶³å¤Ÿçš„è¿ç»­ç©ºé—´åˆ†é…ç»™å¤§å¯¹è±¡ã€‚ -XX:PretenureSizeThresholdï¼Œå¤§äºæ­¤å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ï¼Œé¿å…åœ¨ Eden åŒºå’Œ Survivor åŒºä¹‹é—´çš„å¤§é‡å†…å­˜å¤åˆ¶ã€‚ é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ ä¸ºå¯¹è±¡å®šä¹‰å¹´é¾„è®¡æ•°å™¨ï¼Œå¯¹è±¡åœ¨ Eden å‡ºç”Ÿå¹¶ç»è¿‡ Minor GC ä¾ç„¶å­˜æ´»ï¼Œå°†ç§»åŠ¨åˆ° Survivor ä¸­ï¼Œå¹´é¾„å°±å¢åŠ  1 å²ï¼Œå¢åŠ åˆ°ä¸€å®šå¹´é¾„åˆ™ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚ -XX:MaxTenuringThreshold ç”¨æ¥å®šä¹‰å¹´é¾„çš„é˜ˆå€¼ã€‚ åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š è™šæ‹Ÿæœºå¹¶ä¸æ˜¯æ°¸è¿œåœ°è¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ° MaxTenuringThreshold æ‰èƒ½æ™‹å‡è€å¹´ä»£ï¼Œå¦‚æœåœ¨ Survivor ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œåˆ™å¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— éœ€ç­‰åˆ° MaxTenuringThreshold ä¸­è¦æ±‚çš„å¹´é¾„ã€‚ ç©ºé—´åˆ†é…æ‹…ä¿ åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœæ¡ä»¶æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆ Minor GC å¯ä»¥ç¡®è®¤æ˜¯å®‰å…¨çš„ã€‚ å¦‚æœä¸æˆç«‹çš„è¯è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ HandlePromotionFailure è®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ï¼Œå¦‚æœå…è®¸é‚£ä¹ˆå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼›å¦‚æœå°äºï¼Œæˆ–è€… HandlePromotionFailure è®¾ç½®ä¸å…è®¸å†’é™©ï¼Œé‚£ä¹ˆå°±è¦è¿›è¡Œä¸€æ¬¡ Full GCã€‚ Full GC çš„è§¦å‘æ¡ä»¶å¯¹äº Minor GCï¼Œå…¶è§¦å‘æ¡ä»¶éå¸¸ç®€å•ï¼Œå½“ Eden ç©ºé—´æ»¡æ—¶ï¼Œå°±å°†è§¦å‘ä¸€æ¬¡ Minor GCã€‚è€Œ Full GC åˆ™ç›¸å¯¹å¤æ‚ï¼Œæœ‰ä»¥ä¸‹æ¡ä»¶ï¼š è°ƒç”¨ System.gc() åªæ˜¯å»ºè®®è™šæ‹Ÿæœºæ‰§è¡Œ Full GCï¼Œä½†æ˜¯è™šæ‹Ÿæœºä¸ä¸€å®šçœŸæ­£å»æ‰§è¡Œã€‚ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè€Œæ˜¯è®©è™šæ‹Ÿæœºç®¡ç†å†…å­˜ã€‚ è€å¹´ä»£ç©ºé—´ä¸è¶³ è€å¹´ä»£ç©ºé—´ä¸è¶³çš„å¸¸è§åœºæ™¯ä¸ºå‰æ–‡æ‰€è®²çš„å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ç­‰ã€‚ ä¸ºäº†é¿å…ä»¥ä¸ŠåŸå› å¼•èµ·çš„ Full GCï¼Œåº”å½“å°½é‡ä¸è¦åˆ›å»ºè¿‡å¤§çš„å¯¹è±¡ä»¥åŠæ•°ç»„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥é€šè¿‡ -Xmn è™šæ‹Ÿæœºå‚æ•°è°ƒå¤§æ–°ç”Ÿä»£çš„å¤§å°ï¼Œè®©å¯¹è±¡å°½é‡åœ¨æ–°ç”Ÿä»£è¢«å›æ”¶æ‰ï¼Œä¸è¿›å…¥è€å¹´ä»£ã€‚è¿˜å¯ä»¥é€šè¿‡ -XX:MaxTenuringThreshold è°ƒå¤§å¯¹è±¡è¿›å…¥è€å¹´ä»£çš„å¹´é¾„ï¼Œè®©å¯¹è±¡åœ¨æ–°ç”Ÿä»£å¤šå­˜æ´»ä¸€æ®µæ—¶é—´ã€‚ ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ ä½¿ç”¨å¤åˆ¶ç®—æ³•çš„ Minor GC éœ€è¦è€å¹´ä»£çš„å†…å­˜ç©ºé—´ä½œæ‹…ä¿ï¼Œå¦‚æœæ‹…ä¿å¤±è´¥ä¼šæ‰§è¡Œä¸€æ¬¡ Full GCã€‚å…·ä½“å†…å®¹è¯·å‚è€ƒä¸Šé¢çš„ç¬¬äº”å°èŠ‚ã€‚ JDK 1.7 åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³ åœ¨ JDK 1.7 åŠä»¥å‰ï¼ŒHotSpot è™šæ‹Ÿæœºä¸­çš„æ–¹æ³•åŒºæ˜¯ç”¨æ°¸ä¹…ä»£å®ç°çš„ï¼Œæ°¸ä¹…ä»£ä¸­å­˜æ”¾çš„ä¸ºä¸€äº› Class çš„ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ã€‚ å½“ç³»ç»Ÿä¸­è¦åŠ è½½çš„ç±»ã€åå°„çš„ç±»å’Œè°ƒç”¨çš„æ–¹æ³•è¾ƒå¤šæ—¶ï¼Œæ°¸ä¹…ä»£å¯èƒ½ä¼šè¢«å æ»¡ï¼Œåœ¨æœªé…ç½®ä¸ºé‡‡ç”¨ CMS GC çš„æƒ…å†µä¸‹ä¹Ÿä¼šæ‰§è¡Œ Full GCã€‚å¦‚æœç»è¿‡ Full GC ä»ç„¶å›æ”¶ä¸äº†ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºä¼šæŠ›å‡º java.lang.OutOfMemoryErrorã€‚ ä¸ºé¿å…ä»¥ä¸ŠåŸå› å¼•èµ·çš„ Full GCï¼Œå¯é‡‡ç”¨çš„æ–¹æ³•ä¸ºå¢å¤§æ°¸ä¹…ä»£ç©ºé—´æˆ–è½¬ä¸ºä½¿ç”¨ CMS GCã€‚ Concurrent Mode Failure æ‰§è¡Œ CMS GC çš„è¿‡ç¨‹ä¸­åŒæ—¶æœ‰å¯¹è±¡è¦æ”¾å…¥è€å¹´ä»£ï¼Œè€Œæ­¤æ—¶è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ˆå¯èƒ½æ˜¯ GC è¿‡ç¨‹ä¸­æµ®åŠ¨åƒåœ¾è¿‡å¤šå¯¼è‡´æš‚æ—¶æ€§çš„ç©ºé—´ä¸è¶³ï¼‰ï¼Œä¾¿ä¼šæŠ¥ Concurrent Mode Failure é”™è¯¯ï¼Œå¹¶è§¦å‘ Full GCã€‚ å››ã€ç±»åŠ è½½æœºåˆ¶ç±»æ˜¯åœ¨è¿è¡ŒæœŸé—´ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶åŠ¨æ€åŠ è½½çš„ï¼Œè€Œä¸æ˜¯ç¼–è¯‘æ—¶æœŸä¸€æ¬¡æ€§åŠ è½½ã€‚å› ä¸ºå¦‚æœåœ¨ç¼–è¯‘æ—¶æœŸä¸€æ¬¡æ€§åŠ è½½ï¼Œé‚£ä¹ˆä¼šå ç”¨å¾ˆå¤šçš„å†…å­˜ã€‚ ç±»çš„ç”Ÿå‘½å‘¨æœŸ åŒ…æ‹¬ä»¥ä¸‹ 7 ä¸ªé˜¶æ®µï¼š åŠ è½½ï¼ˆLoadingï¼‰ éªŒè¯ï¼ˆVerificationï¼‰ å‡†å¤‡ï¼ˆPreparationï¼‰ è§£æï¼ˆResolutionï¼‰ åˆå§‹åŒ–ï¼ˆInitializationï¼‰ ä½¿ç”¨ï¼ˆUsingï¼‰ å¸è½½ï¼ˆUnloadingï¼‰ ç±»åŠ è½½è¿‡ç¨‹åŒ…å«äº†åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æå’Œåˆå§‹åŒ–è¿™ 5 ä¸ªé˜¶æ®µã€‚ åŠ è½½ åŠ è½½æ˜¯ç±»åŠ è½½çš„ä¸€ä¸ªé˜¶æ®µï¼Œæ³¨æ„ä¸è¦æ··æ·†ã€‚ åŠ è½½è¿‡ç¨‹å®Œæˆä»¥ä¸‹ä¸‰ä»¶äº‹ï¼š é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚ å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶å­˜å‚¨ç»“æ„ã€‚ åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„ Class å¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ã€‚ å…¶ä¸­äºŒè¿›åˆ¶å­—èŠ‚æµå¯ä»¥ä»ä»¥ä¸‹æ–¹å¼ä¸­è·å–ï¼š ä» ZIP åŒ…è¯»å–ï¼Œæˆä¸º JARã€EARã€WAR æ ¼å¼çš„åŸºç¡€ã€‚ ä»ç½‘ç»œä¸­è·å–ï¼Œæœ€å…¸å‹çš„åº”ç”¨æ˜¯ Appletã€‚ è¿è¡Œæ—¶è®¡ç®—ç”Ÿæˆï¼Œä¾‹å¦‚åŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œåœ¨ java.lang.reflect.Proxy ä½¿ç”¨ ProxyGenerator.generateProxyClass çš„ä»£ç†ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚ ç”±å…¶ä»–æ–‡ä»¶ç”Ÿæˆï¼Œä¾‹å¦‚ç”± JSP æ–‡ä»¶ç”Ÿæˆå¯¹åº”çš„ Class ç±»ã€‚ éªŒè¯ ç¡®ä¿ Class æ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚ å‡†å¤‡ ç±»å˜é‡æ˜¯è¢« static ä¿®é¥°çš„å˜é‡ï¼Œå‡†å¤‡é˜¶æ®µä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®åˆå§‹å€¼ï¼Œä½¿ç”¨çš„æ˜¯æ–¹æ³•åŒºçš„å†…å­˜ã€‚ å®ä¾‹å˜é‡ä¸ä¼šåœ¨è¿™é˜¶æ®µåˆ†é…å†…å­˜ï¼Œå®ƒå°†ä¼šåœ¨å¯¹è±¡å®ä¾‹åŒ–æ—¶éšç€å¯¹è±¡ä¸€èµ·åˆ†é…åœ¨å †ä¸­ã€‚ æ³¨æ„ï¼Œå®ä¾‹åŒ–ä¸æ˜¯ç±»åŠ è½½çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œç±»åŠ è½½å‘ç”Ÿåœ¨æ‰€æœ‰å®ä¾‹åŒ–æ“ä½œä¹‹å‰ï¼Œå¹¶ä¸”ç±»åŠ è½½åªè¿›è¡Œä¸€æ¬¡ï¼Œå®ä¾‹åŒ–å¯ä»¥è¿›è¡Œå¤šæ¬¡ã€‚ åˆå§‹å€¼ä¸€èˆ¬ä¸º 0 å€¼ï¼Œä¾‹å¦‚ä¸‹é¢çš„ç±»å˜é‡ value è¢«åˆå§‹åŒ–ä¸º 0 è€Œä¸æ˜¯ 123ã€‚ 1public static int value = 123; å¦‚æœç±»å˜é‡æ˜¯å¸¸é‡ï¼Œé‚£ä¹ˆä¼šæŒ‰ç…§è¡¨è¾¾å¼æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œä¸æ˜¯èµ‹å€¼ä¸º 0ã€‚ 1public static final int value = 123; è§£æ å°†å¸¸é‡æ± çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ å…¶ä¸­è§£æè¿‡ç¨‹åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥åœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹åå†å¼€å§‹ï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒ Java çš„åŠ¨æ€ç»‘å®šã€‚ åˆå§‹åŒ– åˆå§‹åŒ–é˜¶æ®µæ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„ Java ç¨‹åºä»£ç ã€‚åˆå§‹åŒ–é˜¶æ®µå³è™šæ‹Ÿæœºæ‰§è¡Œç±»æ„é€ å™¨ &lt;clinit&gt;() æ–¹æ³•çš„è¿‡ç¨‹ã€‚ åœ¨å‡†å¤‡é˜¶æ®µï¼Œç±»å˜é‡å·²ç»èµ‹è¿‡ä¸€æ¬¡ç³»ç»Ÿè¦æ±‚çš„åˆå§‹å€¼ï¼Œè€Œåœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œæ ¹æ®ç¨‹åºå‘˜é€šè¿‡ç¨‹åºåˆ¶å®šçš„ä¸»è§‚è®¡åˆ’å»åˆå§‹åŒ–ç±»å˜é‡å’Œå…¶å®ƒèµ„æºã€‚ &lt;clinit&gt;() æ–¹æ³•å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€è¯­å¥å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ï¼Œç¼–è¯‘å™¨æ”¶é›†çš„é¡ºåºç”±è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºå†³å®šã€‚ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œé™æ€è¯­å¥å—åªèƒ½è®¿é—®åˆ°å®šä¹‰åœ¨å®ƒä¹‹å‰çš„ç±»å˜é‡ï¼Œå®šä¹‰åœ¨å®ƒä¹‹åçš„ç±»å˜é‡åªèƒ½èµ‹å€¼ï¼Œä¸èƒ½è®¿é—®ã€‚ä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š 1234567public class Test &#123; static &#123; i = 0; // ç»™å˜é‡èµ‹å€¼å¯ä»¥æ­£å¸¸ç¼–è¯‘é€šè¿‡ System.out.print(i); // è¿™å¥ç¼–è¯‘å™¨ä¼šæç¤ºâ€œéæ³•å‘å‰å¼•ç”¨â€ &#125; static int i = 1;&#125; ä¸ç±»çš„æ„é€ å‡½æ•°ï¼ˆæˆ–è€…è¯´å®ä¾‹æ„é€ å™¨ &lt;init&gt;()ï¼‰ä¸åŒï¼Œä¸éœ€è¦æ˜¾å¼çš„è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ã€‚è™šæ‹Ÿæœºä¼šè‡ªåŠ¨ä¿è¯åœ¨å­ç±»çš„ &lt;clinit&gt;() æ–¹æ³•è¿è¡Œä¹‹å‰ï¼Œçˆ¶ç±»çš„ () æ–¹æ³•å·²ç»æ‰§è¡Œç»“æŸã€‚å› æ­¤è™šæ‹Ÿæœºä¸­ç¬¬ä¸€ä¸ªæ‰§è¡Œ () æ–¹æ³•çš„ç±»è‚¯å®šä¸º java.lang.Objectã€‚ ç”±äºçˆ¶ç±»çš„ () æ–¹æ³•å…ˆæ‰§è¡Œï¼Œä¹Ÿå°±æ„ 1234567891011121314static class Parent &#123; public static int A = 1; static &#123; A = 2; &#125;&#125;static class Sub extends Parent &#123; public static int B = A;&#125;public static void main(String[] args) &#123; System.out.println(Sub.B); // 2&#125; () æ–¹æ³•å¯¹äºç±»æˆ–æ¥å£ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­ä¸åŒ…å«é™æ€è¯­å¥å—ï¼Œä¹Ÿæ²¡æœ‰å¯¹ç±»å˜é‡çš„èµ‹å€¼æ“ä½œï¼Œç¼–è¯‘å™¨å¯ä»¥ä¸ä¸ºè¯¥ç±»ç”Ÿæˆ () æ–¹æ³•ã€‚ æ¥å£ä¸­ä¸å¯ä»¥ä½¿ç”¨é™æ€è¯­å¥å—ï¼Œä½†ä»ç„¶æœ‰ç±»å˜é‡åˆå§‹åŒ–çš„èµ‹å€¼æ“ä½œï¼Œå› æ­¤æ¥å£ä¸ç±»ä¸€æ ·éƒ½ä¼šç”Ÿæˆ () æ–¹æ³•ã€‚ä½†æ¥å£ä¸ç±»ä¸åŒçš„æ˜¯ï¼Œæ‰§è¡Œæ¥å£çš„ () æ–¹æ³•ä¸éœ€è¦å…ˆæ‰§è¡Œçˆ¶æ¥å£çš„ () æ–¹æ³•ã€‚åªæœ‰å½“çˆ¶æ¥å£ä¸­å®šä¹‰çš„å˜é‡ä½¿ç”¨æ—¶ï¼Œçˆ¶æ¥å£æ‰ä¼šåˆå§‹åŒ–ã€‚å¦å¤–ï¼Œæ¥å£çš„å®ç°ç±»åœ¨åˆå§‹åŒ–æ—¶ä¹Ÿä¸€æ ·ä¸ä¼šæ‰§è¡Œæ¥å£çš„ () æ–¹æ³•ã€‚ è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„ () æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¢«æ­£ç¡®çš„åŠ é”å’ŒåŒæ­¥ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¿™ä¸ªç±»çš„ () æ–¹æ³•ï¼Œå…¶å®ƒçº¿ç¨‹éƒ½ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æ´»åŠ¨çº¿ç¨‹æ‰§è¡Œ () æ–¹æ³•å®Œæ¯•ã€‚å¦‚æœåœ¨ä¸€ä¸ªç±»çš„ () æ–¹æ³•ä¸­æœ‰è€—æ—¶çš„æ“ä½œï¼Œå°±å¯èƒ½é€ æˆå¤šä¸ªçº¿ç¨‹é˜»å¡ï¼Œåœ¨å®é™…è¿‡ç¨‹ä¸­æ­¤ç§é˜»å¡å¾ˆéšè”½ã€‚ ç±»åˆå§‹åŒ–æ—¶æœº ä¸»åŠ¨å¼•ç”¨ è™šæ‹Ÿæœºè§„èŒƒä¸­å¹¶æ²¡æœ‰å¼ºåˆ¶çº¦æŸä½•æ—¶è¿›è¡ŒåŠ è½½ï¼Œä½†æ˜¯è§„èŒƒä¸¥æ ¼è§„å®šäº†æœ‰ä¸”åªæœ‰ä¸‹åˆ—äº”ç§æƒ…å†µå¿…é¡»å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼ˆåŠ è½½ã€éªŒè¯ã€å‡†å¤‡éƒ½ä¼šéšä¹‹å‘ç”Ÿï¼‰ï¼š é‡åˆ° newã€getstaticã€putstaticã€invokestatic è¿™å››æ¡å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™å¿…é¡»å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚æœ€å¸¸è§çš„ç”Ÿæˆè¿™ 4 æ¡æŒ‡ä»¤çš„åœºæ™¯æ˜¯ï¼šä½¿ç”¨ new å…³é”®å­—å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ï¼›è¯»å–æˆ–è®¾ç½®ä¸€ä¸ªç±»çš„é™æ€å­—æ®µï¼ˆè¢« final ä¿®é¥°ã€å·²åœ¨ç¼–è¯‘æœŸæŠŠç»“æœæ”¾å…¥å¸¸é‡æ± çš„é™æ€å­—æ®µé™¤å¤–ï¼‰çš„æ—¶å€™ï¼›ä»¥åŠè°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•çš„æ—¶å€™ã€‚ ä½¿ç”¨ java.lang.reflect åŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚ å½“åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚ å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šä¸€ä¸ªè¦æ‰§è¡Œçš„ä¸»ç±»ï¼ˆåŒ…å« main() æ–¹æ³•çš„é‚£ä¸ªç±»ï¼‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ–è¿™ä¸ªä¸»ç±»ï¼› å½“ä½¿ç”¨ JDK 1.7 çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ª java.lang.invoke.MethodHandle å®ä¾‹æœ€åçš„è§£æç»“æœä¸º REF_getStatic, REF_putStatic, REF_invokeStatic çš„æ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ï¼› è¢«åŠ¨å¼•ç”¨ ä»¥ä¸Š 5 ç§åœºæ™¯ä¸­çš„è¡Œä¸ºç§°ä¸ºå¯¹ä¸€ä¸ªç±»è¿›è¡Œä¸»åŠ¨å¼•ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ‰€æœ‰å¼•ç”¨ç±»çš„æ–¹å¼éƒ½ä¸ä¼šè§¦å‘åˆå§‹åŒ–ï¼Œç§°ä¸ºè¢«åŠ¨å¼•ç”¨ã€‚è¢«åŠ¨å¼•ç”¨çš„å¸¸è§ä¾‹å­åŒ…æ‹¬ï¼š é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œä¸ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ–ã€‚ 1System.out.println(SubClass.value); // value å­—æ®µåœ¨ SuperClass ä¸­å®šä¹‰ é€šè¿‡æ•°ç»„å®šä¹‰æ¥å¼•ç”¨ç±»ï¼Œä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–ã€‚è¯¥è¿‡ç¨‹ä¼šå¯¹æ•°ç»„ç±»è¿›è¡Œåˆå§‹åŒ–ï¼Œæ•°ç»„ç±»æ˜¯ä¸€ä¸ªç”±è™šæ‹Ÿæœºè‡ªåŠ¨ç”Ÿæˆçš„ã€ç›´æ¥ç»§æ‰¿è‡ª Object çš„å­ç±»ï¼Œå…¶ä¸­åŒ…å«äº†æ•°ç»„çš„å±æ€§å’Œæ–¹æ³•ã€‚ 1SuperClass[] sca = new SuperClass[10]; å¸¸é‡åœ¨ç¼–è¯‘é˜¶æ®µä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­ï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ç›´æ¥å¼•ç”¨åˆ°å®šä¹‰å¸¸é‡çš„ç±»ï¼Œå› æ­¤ä¸ä¼šè§¦å‘å®šä¹‰å¸¸é‡çš„ç±»çš„åˆå§‹åŒ–ã€‚ 1System.out.println(ConstClass.HELLOWORLD); ç±»ä¸ç±»åŠ è½½å™¨ä¸¤ä¸ªç±»ç›¸ç­‰éœ€è¦ç±»æœ¬èº«ç›¸ç­‰ï¼Œå¹¶ä¸”ä½¿ç”¨åŒä¸€ä¸ªç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸€ä¸ªç±»åŠ è½½å™¨éƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç±»åç§°ç©ºé—´ã€‚ è¿™é‡Œçš„ç›¸ç­‰ï¼ŒåŒ…æ‹¬ç±»çš„ Class å¯¹è±¡çš„ equals() æ–¹æ³•ã€isAssignableFrom() æ–¹æ³•ã€isInstance() æ–¹æ³•çš„è¿”å›ç»“æœä¸º trueï¼Œä¹ŸåŒ…æ‹¬ä½¿ç”¨ instanceof å…³é”®å­—åšå¯¹è±¡æ‰€å±å…³ç³»åˆ¤å®šç»“æœä¸º trueã€‚ ç±»åŠ è½½å™¨åˆ†ç±»ä» Java è™šæ‹Ÿæœºçš„è§’åº¦æ¥è®²ï¼Œåªå­˜åœ¨ä»¥ä¸‹ä¸¤ç§ä¸åŒçš„ç±»åŠ è½½å™¨ï¼š å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰ï¼Œè¿™ä¸ªç±»åŠ è½½å™¨ç”¨C++å®ç°ï¼Œæ˜¯è™šæ‹Ÿæœºè‡ªèº«çš„ä¸€éƒ¨åˆ†ï¼› æ‰€æœ‰å…¶ä»–ç±»çš„åŠ è½½å™¨ï¼Œè¿™äº›ç±»ç”± Java å®ç°ï¼Œç‹¬ç«‹äºè™šæ‹Ÿæœºå¤–éƒ¨ï¼Œå¹¶ä¸”å…¨éƒ½ç»§æ‰¿è‡ªæŠ½è±¡ç±» java.lang.ClassLoaderã€‚ ä» Java å¼€å‘äººå‘˜çš„è§’åº¦çœ‹ï¼Œç±»åŠ è½½å™¨å¯ä»¥åˆ’åˆ†å¾—æ›´ç»†è‡´ä¸€äº›ï¼š å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰æ­¤ç±»åŠ è½½å™¨è´Ÿè´£å°†å­˜æ”¾åœ¨ &lt;JRE_HOME&gt;\\lib ç›®å½•ä¸­çš„ï¼Œæˆ–è€…è¢« -Xbootclasspath å‚æ•°æ‰€æŒ‡å®šçš„è·¯å¾„ä¸­çš„ï¼Œå¹¶ä¸”æ˜¯è™šæ‹Ÿæœºè¯†åˆ«çš„ï¼ˆä»…æŒ‰ç…§æ–‡ä»¶åè¯†åˆ«ï¼Œå¦‚ rt.jarï¼Œåå­—ä¸ç¬¦åˆçš„ç±»åº“å³ä½¿æ”¾åœ¨ lib ç›®å½•ä¸­ä¹Ÿä¸ä¼šè¢«åŠ è½½ï¼‰ç±»åº“åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­ã€‚å¯åŠ¨ç±»åŠ è½½å™¨æ— æ³•è¢« Java ç¨‹åºç›´æ¥å¼•ç”¨ï¼Œç”¨æˆ·åœ¨ç¼–å†™è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ—¶ï¼Œå¦‚æœéœ€è¦æŠŠåŠ è½½è¯·æ±‚å§”æ´¾ç»™å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œç›´æ¥ä½¿ç”¨ null ä»£æ›¿å³å¯ã€‚ æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰è¿™ä¸ªç±»åŠ è½½å™¨æ˜¯ç”± ExtClassLoaderï¼ˆsun.misc.Launcher$ExtClassLoaderï¼‰å®ç°çš„ã€‚å®ƒè´Ÿè´£å°† &lt;JAVA_HOME&gt;/lib/ext æˆ–è€…è¢« java.ext.dir ç³»ç»Ÿå˜é‡æ‰€æŒ‡å®šè·¯å¾„ä¸­çš„æ‰€æœ‰ç±»åº“åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨æ‰©å±•ç±»åŠ è½½å™¨ã€‚ åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰è¿™ä¸ªç±»åŠ è½½å™¨æ˜¯ç”± AppClassLoaderï¼ˆsun.misc.Launcher$AppClassLoaderï¼‰å®ç°çš„ã€‚ç”±äºè¿™ä¸ªç±»åŠ è½½å™¨æ˜¯ ClassLoader ä¸­çš„ getSystemClassLoader() æ–¹æ³•çš„è¿”å›å€¼ï¼Œå› æ­¤ä¸€èˆ¬ç§°ä¸ºç³»ç»Ÿç±»åŠ è½½å™¨ã€‚å®ƒè´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆClassPathï¼‰ä¸Šæ‰€æŒ‡å®šçš„ç±»åº“ï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªç±»åŠ è½½å™¨ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­æ²¡æœ‰è‡ªå®šä¹‰è¿‡è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªå°±æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ã€‚ åŒäº²å§”æ´¾æ¨¡å‹åº”ç”¨ç¨‹åºéƒ½æ˜¯ç”±ä¸‰ç§ç±»åŠ è½½å™¨ç›¸äº’é…åˆè¿›è¡ŒåŠ è½½çš„ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œè¿˜å¯ä»¥åŠ å…¥è‡ªå·±å®šä¹‰çš„ç±»åŠ è½½å™¨ã€‚ ä¸‹å›¾å±•ç¤ºçš„ç±»åŠ è½½å™¨ä¹‹é—´çš„å±‚æ¬¡å…³ç³»ï¼Œç§°ä¸ºç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å‹ï¼ˆParents Delegation Modelï¼‰ã€‚è¯¥æ¨¡å‹è¦æ±‚é™¤äº†é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨å¤–ï¼Œå…¶ä½™çš„ç±»åŠ è½½å™¨éƒ½åº”æœ‰è‡ªå·±çš„çˆ¶ç±»åŠ è½½å™¨ã€‚è¿™é‡Œç±»åŠ è½½å™¨ä¹‹é—´çš„çˆ¶å­å…³ç³»ä¸€èˆ¬é€šè¿‡ç»„åˆï¼ˆCompositionï¼‰å…³ç³»æ¥å®ç°ï¼Œè€Œä¸æ˜¯é€šè¿‡ç»§æ‰¿ï¼ˆInheritanceï¼‰çš„å…³ç³»å®ç°ã€‚ å·¥ä½œè¿‡ç¨‹ ä¸€ä¸ªç±»åŠ è½½å™¨é¦–å…ˆå°†ç±»åŠ è½½è¯·æ±‚ä¼ é€åˆ°çˆ¶ç±»åŠ è½½å™¨ï¼Œåªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆç±»åŠ è½½è¯·æ±‚æ—¶è‡ªå·±æ‰å°è¯•åŠ è½½ã€‚ å¥½å¤„ ä½¿å¾— Java ç±»éšç€å®ƒçš„ç±»åŠ è½½å™¨ä¸€èµ·å…·æœ‰ä¸€ç§å¸¦æœ‰ä¼˜å…ˆçº§çš„å±‚æ¬¡å…³ç³»ï¼Œä»è€Œä½¿å¾—åŸºç¡€ç±»å¾—åˆ°ç»Ÿä¸€ã€‚ ä¾‹å¦‚ java.lang.Object å­˜æ”¾åœ¨ rt.jar ä¸­ï¼Œå¦‚æœç¼–å†™å¦å¤–ä¸€ä¸ª java.lang.Object çš„ç±»å¹¶æ”¾åˆ° ClassPath ä¸­ï¼Œç¨‹åºå¯ä»¥ç¼–è¯‘é€šè¿‡ã€‚ç”±äºåŒäº²å§”æ´¾æ¨¡å‹çš„å­˜åœ¨ï¼Œæ‰€ä»¥åœ¨ rt.jar ä¸­çš„ Object æ¯”åœ¨ ClassPath ä¸­çš„ Object ä¼˜å…ˆçº§æ›´é«˜ï¼Œè¿™æ˜¯å› ä¸º rt.jar ä¸­çš„ Object ä½¿ç”¨çš„æ˜¯å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œè€Œ ClassPath ä¸­çš„ Object ä½¿ç”¨çš„æ˜¯åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ã€‚rt.jar ä¸­çš„ Object ä¼˜å…ˆçº§æ›´é«˜ï¼Œé‚£ä¹ˆç¨‹åºä¸­æ‰€æœ‰çš„ Object éƒ½æ˜¯è¿™ä¸ª Objectã€‚ å®ç° ä»¥ä¸‹æ˜¯æŠ½è±¡ç±» java.lang.ClassLoader çš„ä»£ç ç‰‡æ®µï¼Œå…¶ä¸­çš„ loadClass() æ–¹æ³•è¿è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼šå…ˆæ£€æŸ¥ç±»æ˜¯å¦å·²ç»åŠ è½½è¿‡ï¼Œå¦‚æœæ²¡æœ‰åˆ™è®©çˆ¶ç±»åŠ è½½å™¨å»åŠ è½½ã€‚å½“çˆ¶ç±»åŠ è½½å™¨åŠ è½½å¤±è´¥æ—¶æŠ›å‡º ClassNotFoundExceptionï¼Œæ­¤æ—¶å°è¯•è‡ªå·±å»åŠ è½½ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041public abstract class ClassLoader &#123; // The parent class loader for delegation private final ClassLoader parent; public Class&lt;?&gt; loadClass(String name) throws ClassNotFoundException &#123; return loadClass(name, false); &#125; protected Class&lt;?&gt; loadClass(String name, boolean resolve) throws ClassNotFoundException &#123; synchronized (getClassLoadingLock(name)) &#123; // First, check if the class has already been loaded Class&lt;?&gt; c = findLoadedClass(name); if (c == null) &#123; try &#123; if (parent != null) &#123; c = parent.loadClass(name, false); &#125; else &#123; c = findBootstrapClassOrNull(name); &#125; &#125; catch (ClassNotFoundException e) &#123; // ClassNotFoundException thrown if class not found // from the non-null parent class loader &#125; if (c == null) &#123; // If still not found, then invoke findClass in order // to find the class. c = findClass(name); &#125; &#125; if (resolve) &#123; resolveClass(c); &#125; return c; &#125; &#125; protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException &#123; throw new ClassNotFoundException(name); &#125;&#125; è‡ªå®šä¹‰ç±»åŠ è½½å™¨å®ç°FileSystemClassLoader æ˜¯è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œç»§æ‰¿è‡ª java.lang.ClassLoaderï¼Œç”¨äºåŠ è½½æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ç±»ã€‚å®ƒé¦–å…ˆæ ¹æ®ç±»çš„å…¨ååœ¨æ–‡ä»¶ç³»ç»Ÿä¸ŠæŸ¥æ‰¾ç±»çš„å­—èŠ‚ä»£ç æ–‡ä»¶ï¼ˆ.class æ–‡ä»¶ï¼‰ï¼Œç„¶åè¯»å–è¯¥æ–‡ä»¶å†…å®¹ï¼Œæœ€åé€šè¿‡ defineClass() æ–¹æ³•æ¥æŠŠè¿™äº›å­—èŠ‚ä»£ç è½¬æ¢æˆ java.lang.Class ç±»çš„å®ä¾‹ã€‚ java.lang.ClassLoader çš„ loadClass() å®ç°äº†åŒäº²å§”æ´¾æ¨¡å‹çš„é€»è¾‘ï¼Œå› æ­¤è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¸€èˆ¬ä¸å»é‡å†™å®ƒï¼Œä½†æ˜¯éœ€è¦é‡å†™ findClass() æ–¹æ³•ã€‚ æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Javaå¹¶å‘æ€»ç»“","slug":"Javaå¹¶å‘æ€»ç»“","date":"2017-11-18T07:52:59.000Z","updated":"2018-09-05T09:15:10.335Z","comments":true,"path":"Javaå¹¶å‘æ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Javaå¹¶å‘æ€»ç»“.html","excerpt":"","text":"ä¸€ã€çº¿ç¨‹çŠ¶æ€è½¬æ¢ æ–°å»º (New)çº¿ç¨‹åˆ›å»ºåä½†æœªå¯åŠ¨ å¯è¿è¡Œ (Runnable)åŒ…å«äº†æ“ä½œç³»ç»Ÿçº¿ç¨‹çŠ¶æ€ä¸­çš„Runningå’ŒReady é˜»å¡ (Blocking)ç­‰å¾…è·å–ä¸€ä¸ªæ’å®ƒé”ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹é‡Šæ”¾äº†é”å°±ä¼šç»“æŸæ­¤çŠ¶æ€ æ— é™æœŸç­‰å¾… (Waiting)ç­‰å¾…å…¶ä»–çº¿ç¨‹æ˜¾ç¤ºåœ°å”¤é†’ï¼Œå¦åˆ™ä¸ä¼šè¢«åˆ†é…CPUæ—¶é—´ç‰‡ è¿›å…¥æ–¹æ³• æ²¡æœ‰è®¾ç½®Timeoutçš„Object.wait()æ–¹æ³• æ²¡æœ‰è®¾ç½®Timeoutçš„Object.join()æ–¹æ³• LockSupport.park()æ–¹æ³• é€€å‡ºæ–¹æ³• Object.notify()/Object.notifyAll() è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯• é™æœŸç­‰å¾… (Timed Waiting)æ— éœ€ç­‰å¾…å…¶å®ƒçº¿ç¨‹æ˜¾ç¤ºåœ°å”¤é†’ï¼Œåœ¨ä¸€å®šæ—¶é—´ä¹‹åä¼šè¢«ç³»ç»Ÿé‚£ä¸ªè‡ªåŠ¨å”¤é†’ è°ƒç”¨Thread.sleep()æ–¹æ³•ä½¿çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…çŠ¶æ€æ—¶ï¼Œå¸¸å¸¸ç”¨ä½¿ä¸€ä¸ªçº¿ç¨‹ç¡çœ è¿›è¡Œæè¿° è°ƒç”¨Object.wait()æ–¹æ³•ä½¿çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…æˆ–è€…æ— é™æœŸç­‰å¾…æ—¶ï¼Œå¸¸å¸¸ç”¨æŒ‚èµ·ä¸€ä¸ªçº¿ç¨‹\bè¿›è¡Œæè¿° ç¡çœ å’ŒæŒ‚èµ·æ˜¯ç”¨æ¥æè¿°è¡Œä¸ºï¼Œè€Œé˜»å¡å’Œç­‰å¾…ç”¨æ¥æè¿°çŠ¶æ€ é˜»å¡å’Œç­‰å¾…çš„åŒºåˆ«åœ¨äºï¼Œé˜»å¡æ˜¯è¢«åŠ¨çš„ï¼Œå®ƒæ˜¯åœ¨ç­‰å¾…\bè·å–ä¸€ä¸ªæ’å®ƒé”ã€‚è€Œç­‰å¾…æ˜¯ä¸»åŠ¨çš„ï¼Œé€šè¿‡è°ƒç”¨Thread.sleep()å’ŒObject.wait()ç­‰æ–¹æ³•è¿›å…¥ è¿›å…¥æ–¹æ³• Thread.sleep()æ–¹æ³• è®¾ç½®äº†Timeoutå‚æ•°çš„Object.wait() è®¾ç½®äº†Timeoutå‚æ•°çš„Thread.join() LockSupprot.parkNanos()æ–¹æ³• LockSupprot.parkUtil()æ–¹æ³• é€€å‡ºæ–¹æ³• æ—¶é—´ç»“æŸ æ—¶é—´ç»“æŸ/Object.notify()/Objcet.notifyAll() \bæ—¶é—´ç»“æŸ/è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯• æ­»äº¡ (Terminated)å¯ä»¥æ˜¯çº¿ç¨‹ç»“æŸä»»åŠ¡ä¹‹åè‡ªå·±ç»“æŸï¼Œæˆ–è€…äº§ç”Ÿäº†å¼‚å¸¸è€Œ\bç»“æŸ äºŒã€ä½¿ç”¨çº¿ç¨‹æœ‰ä¸‰ç§ä½¿ç”¨çº¿ç¨‹çš„æ–¹æ³•: å®ç° Runnableæ¥å£ å®ç° Callableæ¥å£ \bç»§æ‰¿ Threadç±» \bå®ç°Runnableå’ŒCallableæ¥å£çš„ç±»åªèƒ½å½“åšä¸€ä¸ªå¯ä»¥å†çº¿ç¨‹ä¸­è¿è¡Œçš„ä»»åŠ¡ï¼Œä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„çº¿ç¨‹ï¼Œå› æ­¤æœ€åè¿˜éœ€è¦é€šè¿‡Thread\bæ¥è°ƒç”¨ã€‚å¯ä»¥è¯´ä»»åŠ¡æ˜¯é€šè¿‡çº¿ç¨‹é©±åŠ¨ä»è€Œæ‰§è¡Œçš„ å®ç°Runnableæ¥å£éœ€è¦å®ç°run()æ–¹æ³• é€šè¿‡Threadè°ƒç”¨start()æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ 12345public class MyRunnable implements Runnable &#123; public void run() &#123; // ... &#125;&#125; 12345public static void main(String[] args) &#123; MyRunnable instance = new MyRunnable(); Thread thread = new Thread(instance); thread.start();&#125; \b\bå®ç° Callable æ¥å£ä¸ Runnableç›¸æ¯”ï¼ŒCallable å¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼é€šè¿‡ FutureTask è¿›è¡Œå°è£…ã€‚ 12345public class MyCallable implements Callable&lt;Integer&gt; &#123; public Integer call() &#123; return 123; &#125;&#125; 1234567public static void main(String[] args) throws ExecutionException, InterruptedException &#123; MyCallable mc = new MyCallable(); FutureTask&lt;Integer&gt; ft = new FutureTask&lt;&gt;(mc); Thread thread = new Thread(ft); thread.start(); System.out.println(ft.get());&#125; ç»§æ‰¿ Thread ç±»åŒæ ·ä¹Ÿæ˜¯éœ€è¦å®ç°run()æ–¹æ³•ï¼Œå› ä¸ºThreadç±»ä¹Ÿå®ç°äº†Runnableæ¥å£ å½“è°ƒç”¨start()æ–¹æ³•å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå°†è¯¥çº¿ç¨‹æ”¾å…¥å°±ç»ªé˜Ÿåˆ—ä¸­ç­‰å¾…è¢«è°ƒåº¦ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¢«è°ƒåº¦æ—¶ä¼šæ‰§è¡Œè¯¥çº¿ç¨‹çš„run()æ–¹æ³• 12345public class NyThread extends Thread &#123; public void run() &#123; // ... &#125;&#125; 1234public static void main(String[] args) &#123; MyThread mt = new Thread(); mt.start();&#125; å®ç°æ¥å£ VS ç»§æ‰¿ Threadå®ç°æ¥å£ä¼šæ›´å¥½ï¼š Java ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œå› æ­¤ç»§æ‰¿äº† Thread ç±»å°±æ— æ³•ç»§æ‰¿å…¶ä»–ç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ ç±»å¯èƒ½åªè¦æ±‚å¯æ‰§è¡Œå°±è¡Œï¼Œç»§æ‰¿æ•´ä¸ª Thread ç±»å¼€é”€è¿‡å¤§ åŸºç¡€çº¿ç¨‹æœºåˆ¶ExecutorExecutor ç®¡ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œï¼Œè€Œæ— éœ€ç¨‹åºå‘˜æ˜¾ç¤ºåœ°ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™é‡Œçš„å¼‚æ­¥æ˜¯æŒ‡å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œäº’ä¸å¹²æ‰°ï¼Œä¸éœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œ ä¸»è¦æœ‰ä¸‰ç§ Executor: CachedThreadPool: ä¸€ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ FixedThreadPool: æ‰€æœ‰ä»»åŠ¡åªèƒ½ä½¿ç”¨å›ºå®šå¤§å°çš„çº¿ç¨‹ SingleThreadExecutor: ç›¸å½“äºå¤§å°ä¸º1çš„ FixedThreadPool 1234567public static void main(Stringp[] args) &#123; ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; 5; i++) &#123; executorService.execute(new MyRunnable)); &#125; executorService.shutdown();&#125; Daemonå®ˆæŠ¤çº¿ç¨‹æ—¶ç¨‹åºè¿è¡Œæ—¶åœ¨åå°æä¾›æœåŠ¡çš„çº¿ç¨‹ï¼Œä¸å±äºç¨‹åºä¸­ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ† å½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹\bç»“æŸæ—¶ï¼Œç¨‹åºä¹Ÿå°±ç»ˆæ­¢ï¼ŒåŒäº‹ä¼šæ€æ­»æ‰€æœ‰å®ˆæŠ¤çº¿ç¨‹ main() å±äºéå®ˆæŠ¤çº¿ç¨‹ ä½¿ç”¨ setDaemon() æ–¹æ³•å°†ä¸€ä¸ªçº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ 1234public static void main(String[] agrs) &#123; Thread thread = new Thread(new MyRunnable); thread.setDaemon(true);&#125; sleep()Thread.sleep(millisec)æ–¹æ³•ä¼šä¼‘çœ å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ï¼Œmillisec å•ä½ä¸º\bæ¯«ç§’ sleep() å¯èƒ½ä¼šæŠ›å‡º InterruptedExceptionï¼Œå› ä¸ºä¸€åœºä¸èƒ½å¤¸çº¿ç¨‹ä¼ æ’­å› main()ä¸­ï¼Œå› æ­¤å¿…é¡»åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ï¼Œçº¿ç¨‹ä¸­æŠ›å‡ºçš„å…¶ä»–å¼‚å¸¸ä¹Ÿéœ€è¦å†æœ¬åœ°è¿›è¡Œå¤„ç† 1234567public void run() &#123; try &#123; Thread.sleep(3000); &#125; catch (InterruptedExcetion e) &#123; e.printStackTrace(); &#125;&#125; yield()å¯¹é™æ€æ–¹æ³• Thread.yield() çš„è°ƒç”¨å£°æ˜äº†å½“å‰çº¿ç¨‹å·²ç»å®Œæˆäº†ç”Ÿå‘½å‘¨æœŸ\bä¸­çš„æœ€é‡è¦éƒ¨åˆ†ï¼Œå¯ä»¥åˆ‡æ¢ç»™å…¶ä»–çº¿ç¨‹æ¥æ‰§è¡Œã€‚è¯¥æ–¹æ³•åªæ˜¯\bå¯¹çº¿ç¨‹è°ƒåº¦å™¨çš„ä¸€ä¸ªå»ºè®®ï¼Œè€Œä¸”ä¹Ÿåªæ˜¯å»ºè®®å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…¶ä»–çº¿ç¨‹å¯ä»¥è¿è¡Œã€‚ 123public void run() &#123; Thread.yield();&#125; å››ã€ä¸­æ–­ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åä¼šè‡ªåŠ¨ç»“æŸï¼Œå¦‚æœåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¼šæå‰ç»“æŸ InterruptedExcetioné€šè¿‡è°ƒç”¨ä¸€ä¸ªçº¿ç¨‹çš„ interrupt() æ¥\bä¸­æ–­è¯¥çº¿ç¨‹ï¼Œå¦‚æœè¯¥çº¿ç¨‹å¤„äºé˜»å¡ã€é™æœŸç­‰å¾…æˆ–è€…æ— é™æœŸç­‰å¾…çŠ¶æ€ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡º InterruptedExcetionï¼Œ ä»è€Œæå‰ç»“æŸè¯¥çº¿ç¨‹ã€‚ä½†æ˜¯\bä¸èƒ½ä¸­æ–­ I/O é˜»å¡å’Œ synchronized é˜»å¡é” å¯¹äºä»¥ä¸‹ä»£ç ï¼Œåœ¨ main() ä¸­å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¹‹åå†ä¸­æ–­å®ƒï¼Œç”±äºçº¿ç¨‹ä¸­è°ƒç”¨äº† Thread.sleep()æ–¹æ³•ï¼Œå› æ­¤ä¼šæŠ›å‡ºä¸€ä¸ª InterruptedExcetionï¼Œ ä»è€Œæå‰ç»“æŸçº¿ç¨‹ï¼Œä¸æ‰§è¡Œä¹‹åçš„è¯­å¥ 123456789101112131415161718192021public class InterruptedExample &#123; private static class MyThread1 extends Thread &#123; @Override public void run() &#123; try &#123; Thread.sleep(2000); System.out.println(\"Thread run\"); &#125; catch (InterruptedExcetion e) &#123; e.printStackTrace(); &#125; &#125; &#125;&#125;```javaMain runjava.lang.InterruptedException: sleep interrupted at java.lang.Thread.sleep(Native Method) at InterruptExample.lambda$main$0(InterruptExample.java:5) at InterruptExample$$Lambda$1/713338599.run(Unknown Source) at java.lang.Thread.run(Thread.java:745) interrupted()å¦‚æœä¸€ä¸ªçº¿ç¨‹çš„ run() æ–¹æ³•æ‰§è¡Œä¸€ä¸ªæ— çº¿å¾ªç¯ï¼Œå¹¶ä¸”æ²¡æœ‰æ‰§è¡Œ sleep() ç­‰ä¼šæŠ›å‡º InterruptedExcetion çš„æ“ä½œï¼Œé‚£ä¹ˆè°ƒç”¨çº¿ç¨‹çš„ interrupt()æ–¹æ³•å°±æ— æ³•ä½¿çº¿ç¨‹æå‰ç»“æŸ ä½†æ˜¯è°ƒç”¨ interrupt() æ–¹æ³•ä¼šè®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ï¼Œæ­¤æ—¶è°ƒç”¨ interrupted() æ–¹æ³•ä¼šè¿”å› trueã€‚ å› æ­¤å¯ä»¥å†å¾ªç¯ä½“ä¸­ä½¿ç”¨ interrupted() æ–¹æ³•æ¥åˆ¤æ–­çº¿ç¨‹æ˜¯å¦\bå¤„äºä¸­æ–­çŠ¶æ€ï¼Œä»è€Œæå‰ç»“æŸçº¿ç¨‹ 123456789101112public class InterruptExample &#123; private static class MyThread2 extends Thread &#123; @Override public void run() &#123; while (!interrupted()) &#123; // ... &#125; System.out.println(\"Thread end\"); &#125; &#125;&#125; 1234567public static void main(String[] agrs) &#123; Thread thread2 = new MyThread2(); thread2.start(); thread2.interrupt();&#125;Thread end Executor çš„ä¸­æ–­æ“ä½œè°ƒç”¨ Executor çš„ shutdown()\b æ–¹æ³•ä¼šç­‰å¾…çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åå†å…³é—­ï¼Œä½†æ˜¯å¦‚æœè°ƒç”¨çš„æ˜¯ shutdownNow() æ–¹æ³•ï¼Œåˆ™ç›¸å½“äºè°ƒç”¨æ¯ä¸ªçº¿ç¨‹çš„ interrupt() æ–¹æ³• ä»¥ä¸‹ä½¿ç”¨ Lambda åˆ›å»ºçº¿ç¨‹ï¼Œç›¸å½“äº\båˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨çº¿ç¨‹ 12345678910111213public static void main(String[] agrs) &#123; ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; &#123; try &#123; Thread.sleep(2000); System.out.println(\"Thread run\"); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;); executorService.shutdownNow(); System.out.println(\"Mian run\");&#125; å¦‚æœåªæƒ³ä¸­æ–­ Executor ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ submit() æ–¹æ³•æ¥æäº¤ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª Future&lt;?&gt; å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨è¯¥å¯¹è±¡çš„ cancel(true) æ–¹æ³•å°±å¯ä»¥ä¸­æ–­çº¿ç¨‹ã€‚ 1234Future&lt;?&gt; future = executorService.submit(() -&gt; &#123; // ..&#125;);future.cancel(true); äº”ã€äº’æ–¥åŒæ­¥Java æä¾›äº†ä¸¤ç§é”æœºåˆ¶æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®ï¼Œç¬¬ä¸€ä¸ªæ˜¯JVM å®ç°çš„ synchronizedï¼Œè€Œå¦ä¸€ä¸ªæ˜¯ JDK å®ç°çš„ ReentrantLockã€‚ synchronized åŒæ­¥ä¸€ä¸ªä»£ç å— 12345public void func() &#123; synchronized (this) &#123; // ... &#125;&#125; å®ƒåªä½œç”¨äºåŒä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœè°ƒç”¨ä¸¤ä¸ªå¯¹è±¡ä¸Šçš„åŒæ­¥ä»£ç å—ï¼Œå°±ä¸ä¼šè¿›è¡ŒåŒæ­¥ã€‚ å¯¹äºä»¥ä¸‹ä»£ç ï¼Œä½¿ç”¨ ExecutorService æ‰§è¡Œäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œç”±äºè°ƒç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„åŒæ­¥ä»£ç å—ï¼Œå› æ­¤è¿™ä¸¤ä¸ªçº¿ç¨‹ä¼šè¿›è¡ŒåŒæ­¥ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åŒæ­¥è¯­å¥å—æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°±å¿…é¡»ç­‰å¾…ã€‚ 12345678910public class SynchronizedExample &#123; public void func1() &#123; synchronized (this) &#123; for (int i = 0; i &lt; 10; i++) &#123; System.out.print(i + \" \"); &#125; &#125; &#125;&#125; 12345678public static void main(String[] args) &#123; SynchronizedExample e1 = new SynchronizedExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; e1.func1()); executorService.execute(() -&gt; e1.func1());&#125;0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 å¯¹äºä»¥ä¸‹ä»£ç ï¼Œä¸¤ä¸ªçº¿ç¨‹è°ƒç”¨äº†ä¸åŒå¯¹è±¡çš„åŒæ­¥ä»£ç å—ï¼Œå› æ­¤è¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¸éœ€è¦åŒæ­¥ã€‚ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œä¸¤ä¸ªçº¿ç¨‹äº¤å‰æ‰§è¡Œã€‚ 123456789public static void main(String[] args) &#123; SynchronizedExample e1 = new SynchronizedExample(); SynchronizedExample e2 = new SynchronizedExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; e1.func1()); executorService.execute(() -&gt; e2.func1());&#125;0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 åŒæ­¥ä¸€ä¸ªæ–¹æ³• 123public synchronized void func () &#123; // ...&#125; å®ƒå’ŒåŒæ­¥ä»£ç å—ä¸€æ ·ï¼Œä½œç”¨äºåŒä¸€ä¸ªå¯¹è±¡ã€‚ åŒæ­¥ä¸€ä¸ªç±» 12345public void func() &#123; synchronized (SynchronizedExample.class) &#123; // ... &#125;&#125; ä½œç”¨äºæ•´ä¸ªç±»ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªçº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡ä¸Šçš„è¿™ç§åŒæ­¥è¯­å¥ï¼Œä¹Ÿä¼šè¿›è¡ŒåŒæ­¥ã€‚ 12345678910public class SynchronizedExample &#123; public void func2() &#123; synchronized (SynchronizedExample.class) &#123; for (int i = 0; i &lt; 10; i++) &#123; System.out.print(i + \" \"); &#125; &#125; &#125;&#125; 12345678public static void main(String[] args) &#123; SynchronizedExample e1 = new SynchronizedExample(); SynchronizedExample e2 = new SynchronizedExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; e1.func2()); executorService.execute(() -&gt; e2.func2());&#125;0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 åŒæ­¥ä¸€ä¸ªé™æ€æ–¹æ³• 123public synchronized static void fun() &#123; // ...&#125; ä½œç”¨äºæ•´ä¸ªç±»ã€‚ ReentrantLock å¯é‡å…¥é”ReentrantLock æ˜¯ java.util.concurrentï¼ˆJ.U.Cï¼‰åŒ…ä¸­çš„é”ã€‚ 12345678910111213141516public class LockExample &#123; private Lock lock = new ReentrantLock(); public void func() &#123; lock.lock(); try &#123; for (int i = 0; i &lt; 10; i++) &#123; System.out.print(i + \" \"); &#125; &#125; finally &#123; // é‡Šæ”¾é”ï¼Œä»è€Œé¿å…æ­»é” lock.unlock(); &#125; &#125;&#125; 12345678public static void main(String[] agrs) &#123; LockExample lockExample = new LockExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; lockExample.execute()); executorService.execute(() -&gt; lockExample.execute());&#125;0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 æ¯”è¾ƒ é”çš„å®ç° synchronized æ˜¯ JVM å®ç°çš„ï¼Œè€Œ ReentrantLock æ˜¯ JDK å®ç°çš„ã€‚ æ€§èƒ½ æ–°ç‰ˆæœ¬ Java å¯¹ synchronized è¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼Œä¾‹å¦‚è‡ªæ—‹é”ç­‰ï¼Œsynchronized ä¸ ReentrantLock å¤§è‡´ç›¸åŒã€‚ ç­‰å¾…å¯ä¸­æ–­ å½“æŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾é”çš„æ—¶å€™ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ã€‚ ReentrantLock å¯ä¸­æ–­ï¼Œè€Œ synchronized ä¸è¡Œã€‚ å…¬å¹³é” å…¬å¹³é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºæ¥ä¾æ¬¡è·å¾—é”ã€‚ synchronized ä¸­çš„é”æ˜¯éå…¬å¹³çš„ï¼ŒReentrantLock é»˜è®¤æƒ…å†µä¸‹ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ˜¯å…¬å¹³çš„ã€‚ é”ç»‘å®šå¤šä¸ªæ¡ä»¶ ä¸€ä¸ª ReentrantLock å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ª Condition å¯¹è±¡ã€‚ ä½¿ç”¨é€‰æ‹©é™¤ééœ€è¦ä½¿ç”¨ ReentrantLock çš„é«˜çº§åŠŸèƒ½ï¼Œå¦åˆ™ä¼˜å…ˆä½¿ç”¨ synchronizedã€‚è¿™æ˜¯å› ä¸º synchronized æ˜¯ JVM å®ç°çš„ä¸€ç§é”æœºåˆ¶ï¼ŒJVM åŸç”Ÿåœ°æ”¯æŒå®ƒï¼Œè€Œ ReentrantLock ä¸æ˜¯æ‰€æœ‰çš„ JDK ç‰ˆæœ¬éƒ½æ”¯æŒã€‚å¹¶ä¸”ä½¿ç”¨ synchronized ä¸ç”¨æ‹…å¿ƒæ²¡æœ‰é‡Šæ”¾é”è€Œå¯¼è‡´æ­»é”é—®é¢˜ï¼Œå› ä¸º JVM ä¼šç¡®ä¿é”çš„é‡Šæ”¾ã€‚ çº¿ç¨‹ä¹‹é—´çš„åä½œå½“å¤šä¸ªçº¿ç¨‹å¯ä»¥ä¸€èµ·å·¥ä½œå»è§£å†³æŸä¸ªé—®é¢˜æ—¶ï¼Œå¦‚æœæŸäº›éƒ¨åˆ†å¿…é¡»åœ¨å…¶ä»–éƒ¨åˆ†ä¹‹å‰å®Œæˆ\bï¼Œé‚£ä¹ˆä¹…éœ€è¦å¯¹\bçº¿ç¨‹è¿›è¡Œåè°ƒ join()åœ¨çº¿ç¨‹ä¸­è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œä¼šå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œè€Œä¸æ˜¯å¿™ç­‰å¾…ï¼Œç›´åˆ°ç›®æ ‡çº¿ç¨‹ç»“æŸã€‚ å¯¹äºä»¥ä¸‹ä»£ç ï¼Œè™½ç„¶ b çº¿ç¨‹å…ˆå¯åŠ¨ï¼Œä½†æ˜¯å› ä¸ºåœ¨ b çº¿ç¨‹ä¸­è°ƒç”¨äº† a çº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œb çº¿ç¨‹ä¼šç­‰å¾… a çº¿ç¨‹ç»“æŸæ‰ç»§ç»­æ‰§è¡Œï¼Œå› æ­¤æœ€åèƒ½å¤Ÿä¿è¯ a çº¿ç¨‹çš„è¾“å‡ºå…ˆäº b çº¿ç¨‹çš„è¾“å‡ºã€‚ 1234567891011121314151617181920212223242526272829303132333435public class JoinExample &#123; private class A extends Thread &#123; @Override public void run() &#123; System.out.println(\"A\"); &#125; &#125; private class B extends Thread &#123; private A a; B(A a) &#123; this.a = a; &#125; @Override public void run() &#123; try &#123; a.join(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(\"B\"); &#125; &#125; public void test() &#123; A a = new A(); B b = new B(a); b.start(); a.start(); &#125;&#125; 1234567public static void main(String[] agrs) &#123; JoinExample example = new JoinExample(); example.test();&#125;AB wait()ï¼Œnotify(),notifyAll()è°ƒç”¨ wait() ä½¿å¾—çº¿ç¨‹ç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³ï¼Œçº¿ç¨‹åœ¨ç­‰å¾…æ—¶ä¼šè¢«æŒ‚èµ·ï¼Œå½“å…¶ä»–çº¿ç¨‹çš„è¿è¡Œä½¿å¾—è¿™ä¸ªæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå…¶å®ƒçº¿ç¨‹ä¼šè°ƒç”¨ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ã€‚ å®ƒä»¬éƒ½å±äº Object çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸å±äº Threadã€‚ åªèƒ½ç”¨åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º IllegalMonitorStateExeceptionã€‚ ä½¿ç”¨ wait() æŒ‚èµ·æœŸé—´ï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾é”ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœæ²¡æœ‰é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±æ— æ³•è¿›å…¥å¯¹è±¡çš„åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ï¼Œé‚£ä¹ˆå°±æ— æ³•æ‰§è¡Œ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ï¼Œé€ æˆæ­»é”ã€‚ 12345678910111213141516public class WaitNotifyExample &#123; public synchronized void before() &#123; System.out.print(\"before\"); notifyAll(); &#125; public synchronized void after() &#123; try &#123; wait(); &#125; catch (InterruptedException) &#123; e.printStackTrace(); &#125; System.out.print(\"after\"); &#125;&#125; 123456789public static void main(String[] agrs) &#123; ExecutorService executorService = Executors.newCachedThreadPool(); WaitNotifyExample example = new WaitNotifyExample(); executorService.execute(() -&gt; example.after()); executorService.execute(() -&gt; example.before());&#125;beforeafter wait() å’Œ sleep() çš„åŒºåˆ« wait() æ˜¯ Object çš„æ–¹æ³•ï¼Œè€Œ sleep() æ˜¯ Thread çš„é™æ€æ–¹æ³•ï¼› wait() ä¼šé‡Šæ”¾é”ï¼Œsleep() ä¸ä¼šã€‚ await() signal() signalAll()java.util.concurrent ç±»åº“ä¸­æä¾›äº† Condition ç±»æ¥å®ç°çº¿ç¨‹ä¹‹é—´çš„åè°ƒï¼Œå¯ä»¥åœ¨ Condition ä¸Šè°ƒç”¨ await() æ–¹æ³•ä½¿çº¿ç¨‹ç­‰å¾…ï¼Œå…¶å®ƒçº¿ç¨‹è°ƒç”¨ signal() æˆ– signalAll() æ–¹æ³•å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚ ç›¸æ¯”äº wait() è¿™ç§ç­‰å¾…æ–¹å¼ï¼Œawait() å¯ä»¥æŒ‡å®šç­‰å¾…çš„æ¡ä»¶ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚ ä½¿ç”¨ Lock æ¥è·å–ä¸€ä¸ª Condition å¯¹è±¡ã€‚ 123456789101112131415161718192021222324252627public class AwaitSignalExample &#123; private Lock lock = new ReentrantLock(); private Condition condition = lock.newCondition(); public void before() &#123; lock.lock(); try &#123; System.out.println(\"before\"); condition.signalAll(); &#125; finally &#123; lock.unlock(); &#125; &#125; public void after() &#123; lock.lock(); try &#123; condition.await(); System.out.println(\"after\"); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;&#125; 123456789public static void main(String[] args) &#123; ExecutorService executorService = Executors.newCachedThreadPool(); AwaitSignalExample example = new AwaitSignalExample(); executorService.execute(() -&gt; example.after()); executorService.execute(() -&gt; example.before());&#125;beforeafter ä¸ƒã€J.U.C - AQSjava.util.concurrentï¼ˆJ.U.Cï¼‰å¤§å¤§æé«˜äº†å¹¶å‘æ€§èƒ½ï¼ŒAQS è¢«è®¤ä¸ºæ˜¯ J.U.C çš„æ ¸å¿ƒã€‚ CountDownLatchç”¨æ¥æ§åˆ¶ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¤šä¸ªçº¿ç¨‹ã€‚ ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ cntï¼Œæ¯æ¬¡è°ƒç”¨ countDown() æ–¹æ³•ä¼šè®©è®¡æ•°å™¨çš„å€¼å‡ 1ï¼Œå‡åˆ° 0 çš„æ—¶å€™ï¼Œé‚£äº›å› ä¸ºè°ƒç”¨ await() æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹å°±ä¼šè¢«å”¤é†’ã€‚ 12345678910111213141516171819202122public class CountDownLatchExample &#123; public static void main(String[] agrs) &#123; final int totalThread = 10; CountDownLatch countDownLatch = new CountDownLatch(totalThread); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; totalThread; i++) &#123; executorService.execute(() -&gt; &#123; System.out.print(\"run..\"); countDownLatch.countDown(); &#125;); &#125; countDownLatch.await(); System.out.print(\"end..\"); executorService.shutdown(); &#125;&#125;æ‰“å° 9 æ¬¡ run \bï¼Œæœ€åä¸€æ¬¡ endç›¸å½“äºè®©ä¸»çº¿ç¨‹ç­‰å¾…\bå¾ªç¯çš„çº¿ç¨‹æ‰§è¡Œå®Œä¹‹åï¼Œå†æ‰§è¡Œrun..run..run..run..run..run..run..run..run..run..end CyclicBarrierç”¨æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œåªæœ‰å½“å¤šä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾æ—¶ï¼Œè¿™äº›çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚ å’Œ CountdownLatch ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡ç»´æŠ¤è®¡æ•°å™¨æ¥å®ç°çš„ã€‚çº¿ç¨‹æ‰§è¡Œ await() æ–¹æ³•ä¹‹åè®¡æ•°å™¨ä¼šå‡ 1ï¼Œå¹¶è¿›è¡Œç­‰å¾…ï¼Œç›´åˆ°è®¡æ•°å™¨ä¸º 0ï¼Œæ‰€æœ‰è°ƒç”¨ awati() æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚ CyclicBarrier å’Œ CountdownLatch çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼ŒCyclicBarrier çš„è®¡æ•°å™¨é€šè¿‡è°ƒç”¨ reset() æ–¹æ³•å¯ä»¥å¾ªç¯ä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒæ‰å«åšå¾ªç¯å±éšœã€‚ CyclicBarrier æœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œå…¶ä¸­ parties æŒ‡ç¤ºè®¡æ•°å™¨çš„åˆå§‹å€¼ï¼ŒbarrierAction åœ¨æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœçš„æ—¶å€™ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ 12345678910public CyclicBarrier(int parties, Runnable barrierAction) &#123; if (parties &lt;= 0) throw new IllegalArgumentException(); this.parties = parties; this.count = parties; this.barrierCommand = barrierAction;&#125;public CyclicBarrier(int parties) &#123; this(parties, null);&#125; 1234567891011121314151617181920212223public class CyclicBarrierExample &#123; public static void main(String[] args) &#123; final int totalThread = 10; CyclicBarrier cyclicBarrier = new CyclicBarrier(totalThread); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; totalThread; i++) &#123; executorService.execute(() -&gt; &#123; System.out.print(\"before..\"); try &#123; cyclicBarrier.await(); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; System.out.print(\"after..\"); &#125;); &#125; executorService.shutdown(); &#125;&#125;before..before..before..before..before..before..before..before..before..before..after..after..after..after..after..after..after..after..after..after.. SemaphoreSemaphore ç±»ä¼¼äºæ“ä½œç³»ç»Ÿä¸­çš„ä¿¡å·é‡ï¼Œå¯ä»¥æ§åˆ¶å¯¹äº’æ–¥èµ„æºçš„è®¿é—®çº¿ç¨‹æ•°ã€‚ ä»¥ä¸‹ä»£ç æ¨¡æ‹Ÿäº†å¯¹æŸä¸ªæœåŠ¡çš„å¹¶å‘è¯·æ±‚ï¼Œæ¯æ¬¡åªèƒ½æœ‰ 3 ä¸ªå®¢æˆ·ç«¯åŒæ—¶è®¿é—®ï¼Œè¯·æ±‚æ€»æ•°ä¸º 10ã€‚ 1234567891011121314151617181920212223public class SemaphoreExample &#123; public static void main(String[] args) &#123; final int clientCount = 3; final int totalRequestCount = 10; Semaphore semaphore = new Semaphore(clientCount); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; totalRequestCount; i++) &#123; executorService.execute(()-&gt;&#123; try &#123; semaphore.acquire(); System.out.print(semaphore.availablePermits() + \" \"); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; semaphore.release(); &#125; &#125;); &#125; executorService.shutdown(); &#125;&#125;2 1 2 2 2 2 2 1 2 2 å…«ã€J.U.C - å…¶å®ƒç»„ä»¶FutureTaskåœ¨ä»‹ç» Callable æ—¶æˆ‘ä»¬çŸ¥é“å®ƒå¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼é€šè¿‡ Future è¿›è¡Œå°è£…ã€‚FutureTask å®ç°äº† RunnableFuture æ¥å£ï¼Œè¯¥æ¥å£ç»§æ‰¿è‡ª Runnable å’Œ Future æ¥å£ï¼Œè¿™ä½¿å¾— FutureTask æ—¢å¯ä»¥å½“åšä¸€ä¸ªä»»åŠ¡æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥æœ‰è¿”å›å€¼ã€‚ 1public class FutureTask&lt;V&gt; implements RunnableFuture&lt;V&gt; 1public interface RunnableFuture&lt;V&gt; extends Runnable, Future&lt;V&gt; FutureTask å¯ç”¨äºå¼‚æ­¥è·å–æ‰§è¡Œç»“æœæˆ–å–æ¶ˆæ‰§è¡Œä»»åŠ¡çš„åœºæ™¯ã€‚å½“ä¸€ä¸ªè®¡ç®—ä»»åŠ¡éœ€è¦æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ FutureTask æ¥å°è£…è¿™ä¸ªä»»åŠ¡ï¼Œä¸»çº¿ç¨‹åœ¨å®Œæˆè‡ªå·±çš„ä»»åŠ¡ä¹‹åå†å»è·å–ç»“æœã€‚ 1234567891011121314151617181920212223242526272829public class FutureTaskExample &#123; public static void main(String[] args) throws ExecutionException, InterruptedException &#123; FutureTask&lt;Integer&gt; futureTask = new FutureTask&lt;Integer&gt;(new Callable&lt;Integer&gt;() &#123; @Override public Integer call() throws Exception &#123; int result = 0; for (int i = 0; i &lt; 100; i++) &#123; Thread.sleep(10); result += i; &#125; return result; &#125; &#125;); Thread computeThread = new Thread(futureTask); computeThread.start(); Thread otherThread = new Thread(() -&gt; &#123; System.out.println(\"other task is running...\"); try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;); otherThread.start(); System.out.println(futureTask.get()); &#125;&#125; 12other task is running...4950 BlockingQueuejava.util.concurrent.BlockingQueue æ¥å£æœ‰ä»¥ä¸‹é˜»å¡é˜Ÿåˆ—çš„å®ç°ï¼š FIFO é˜Ÿåˆ— ï¼šLinkedBlockingQueueã€ArrayBlockingQueueï¼ˆå›ºå®šé•¿åº¦ï¼‰ ä¼˜å…ˆçº§é˜Ÿåˆ— ï¼šPriorityBlockingQueue æä¾›äº†é˜»å¡çš„ take() å’Œ put() æ–¹æ³•ï¼šå¦‚æœé˜Ÿåˆ—ä¸ºç©º take() å°†é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰å†…å®¹ï¼›å¦‚æœé˜Ÿåˆ—ä¸ºæ»¡ put() å°†é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—æœ‰ç©ºé—²ä½ç½®ã€‚ ä½¿ç”¨ BlockingQueue å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public class ProducerConsumer &#123; private static BlockingQueue&lt;String&gt; queue = new ArrayBlockingQueue&lt;&gt;(5); private static class Producer extends Thread &#123; @Override public void run() &#123; try &#123; queue.put(\"product\"); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.print(\"produce..\"); &#125; &#125; private static class Consumer extends Thread &#123; @Override public void run() &#123; try &#123; String product = queue.take(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.print(\"consume..\"); &#125; &#125;&#125;public static void main(String[] args) &#123; for (int i = 0; i &lt; 2; i++) &#123; Producer producer = new Producer(); producer.start(); &#125; for (int i = 0; i &lt; 5; i++) &#123; Consumer consumer = new Consumer(); consumer.start(); &#125; for (int i = 0; i &lt; 3; i++) &#123; Producer producer = new Producer(); producer.start(); &#125;&#125;produce..produce..consume..consume..produce..consume..produce..consume..produce..consume.. ForkJoinä¸»è¦ç”¨äºå¹¶è¡Œè®¡ç®—ä¸­ï¼Œå’Œ MapReduce åŸç†ç±»ä¼¼ï¼Œéƒ½æ˜¯æŠŠå¤§çš„è®¡ç®—ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡å¹¶è¡Œè®¡ç®—ã€‚ 123456789101112131415161718192021222324252627282930public class ForkJoinExample extends RecursiveTask&lt;Integer&gt; &#123; private final int threshold = 5; private int first; private int last; public ForkJoinExample(int first, int last) &#123; this.first = first; this.last = last; &#125; @Override protected Integer compute() &#123; int result = 0; if (last - first &lt;= threshold) &#123; // ä»»åŠ¡è¶³å¤Ÿå°åˆ™ç›´æ¥è®¡ç®— for (int i = first; i &lt;= last; i++) &#123; result += i; &#125; &#125; else &#123; // æ‹†åˆ†æˆå°ä»»åŠ¡ int middle = first + (last - first) / 2; ForkJoinExample leftTask = new ForkJoinExample(first, middle); ForkJoinExample rightTask = new ForkJoinExample(middle + 1, last); leftTask.fork(); rightTask.fork(); result = leftTask.join() + rightTask.join(); &#125; return result; &#125;&#125; 123456public static void main(String[] args) throws ExecutionException, InterruptedException &#123; ForkJoinExample example = new ForkJoinExample(1, 10000); ForkJoinPool forkJoinPool = new ForkJoinPool(); Future result = forkJoinPool.submit(example); System.out.println(result.get());&#125; ForkJoin ä½¿ç”¨ ForkJoinPool æ¥å¯åŠ¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ•°é‡å–å†³äº CPU æ ¸æ•°ã€‚ 1public class ForkJoinPool extends AbstractExecutorService ForkJoinPool å®ç°äº†å·¥ä½œçªƒå–ç®—æ³•æ¥æé«˜ CPU çš„åˆ©ç”¨ç‡ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ç»´æŠ¤äº†ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜å‚¨éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚å·¥ä½œçªƒå–ç®—æ³•å…è®¸ç©ºé—²çš„çº¿ç¨‹ä»å…¶å®ƒçº¿ç¨‹çš„åŒç«¯é˜Ÿåˆ—ä¸­çªƒå–ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œã€‚çªƒå–çš„ä»»åŠ¡å¿…é¡»æ˜¯æœ€æ™šçš„ä»»åŠ¡ï¼Œé¿å…å’Œé˜Ÿåˆ—æ‰€å±çº¿ç¨‹å‘ç”Ÿç«äº‰ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒThread2 ä» Thread1 çš„é˜Ÿåˆ—ä¸­æ‹¿å‡ºæœ€æ™šçš„ Task1 ä»»åŠ¡ï¼ŒThread1 ä¼šæ‹¿å‡º Task2 æ¥æ‰§è¡Œï¼Œè¿™æ ·å°±é¿å…å‘ç”Ÿç«äº‰ã€‚ä½†æ˜¯å¦‚æœé˜Ÿåˆ—ä¸­åªæœ‰ä¸€ä¸ªä»»åŠ¡æ—¶è¿˜æ˜¯ä¼šå‘ç”Ÿç«äº‰ã€‚ ä¹ã€çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹å¦‚æœå¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…±äº«æ•°æ®è¿›è¡Œè®¿é—®è€Œä¸é‡‡å–åŒæ­¥æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆæ“ä½œçš„ç»“æœæ˜¯ä¸ä¸€è‡´çš„ã€‚ ä»¥ä¸‹ä»£ç æ¼”ç¤ºäº† 1000 ä¸ªçº¿ç¨‹åŒæ—¶å¯¹ cnt æ‰§è¡Œè‡ªå¢æ“ä½œï¼Œæ“ä½œç»“æŸä¹‹åå®ƒçš„å€¼æœ‰å¯èƒ½å°äº 1000ã€‚ 123456789101112public class ThreadUnsafeExample &#123; private int cnt = 0; public void add() &#123; cnt++; &#125; public int get() &#123; return cnt; &#125;&#125; 12345678910111213141516public static void main(String[] args) throws InterruptedException &#123; final int threadSize = 1000; ThreadUnsafeExample example = new ThreadUnsafeExample(); final CountDownLatch countDownLatch = new CountDownLatch(threadSize); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; threadSize; i++) &#123; executorService.execute(() -&gt; &#123; example.add(); countDownLatch.countDown(); &#125;); &#125; countDownLatch.await(); executorService.shutdown(); System.out.println(example.get());&#125;998 å¯ä»¥ç”¨ synchronized åŒæ­¥ add()æ–¹æ³• åã€Java å†…å­˜æ¨¡å‹Java å†…å­˜æ¨¡å‹è¯•å›¾å±è”½å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚ï¼Œä»¥å®ç°è®© Java ç¨‹åºåœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœã€‚ ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜å¤„ç†å™¨ä¸Šçš„å¯„å­˜å™¨çš„è¯»å†™çš„é€Ÿåº¦æ¯”å†…å­˜å¿«å‡ ä¸ªæ•°é‡çº§ï¼Œä¸ºäº†è§£å†³è¿™ç§é€Ÿåº¦çŸ›ç›¾ï¼Œåœ¨å®ƒä»¬ä¹‹é—´åŠ å…¥äº†é«˜é€Ÿç¼“å­˜ã€‚ åŠ å…¥é«˜é€Ÿç¼“å­˜å¸¦æ¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç¼“å­˜ä¸€è‡´æ€§ã€‚å¦‚æœå¤šä¸ªç¼“å­˜å…±äº«åŒä¸€å—ä¸»å†…å­˜åŒºåŸŸï¼Œé‚£ä¹ˆå¤šä¸ªç¼“å­˜çš„æ•°æ®å¯èƒ½ä¼šä¸ä¸€è‡´ï¼Œéœ€è¦ä¸€äº›åè®®æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹è¿˜æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œå·¥ä½œå†…å­˜å­˜å‚¨åœ¨é«˜é€Ÿç¼“å­˜æˆ–è€…å¯„å­˜å™¨ä¸­ï¼Œä¿å­˜äº†è¯¥çº¿ç¨‹ä½¿ç”¨çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬æ‹·è´ã€‚ çº¿ç¨‹åªèƒ½ç›´æ¥æ“ä½œå·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œä¸åŒçº¿ç¨‹ä¹‹é—´çš„å˜é‡å€¼ä¼ é€’éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆã€‚ å†…å­˜é—´äº¤äº’æ“ä½œJava å†…å­˜æ¨¡å‹å®šä¹‰äº† 8 ä¸ªæ“ä½œæ¥å®Œæˆä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜çš„äº¤äº’æ“ä½œã€‚ readï¼šæŠŠä¸€ä¸ªå˜é‡çš„å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°å·¥ä½œå†…å­˜ä¸­ loadï¼šåœ¨ read ä¹‹åæ‰§è¡Œï¼ŒæŠŠ read å¾—åˆ°çš„å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ useï¼šæŠŠå·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ assignï¼šæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶åˆ°çš„å€¼èµ‹ç»™å·¥ä½œå†…å­˜çš„å˜é‡ storeï¼šæŠŠå·¥ä½œå†…å­˜çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­ writeï¼šåœ¨ store ä¹‹åæ‰§è¡Œï¼ŒæŠŠ store å¾—åˆ°çš„å€¼æ”¾å…¥ä¸»å†…å­˜çš„å˜é‡ä¸­ lockï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ unlock å†…å­˜æ¨¡å‹ä¸‰å¤§ç‰¹æ€§ åŸå­æ€§ Java å†…å­˜æ¨¡å‹ä¿è¯äº† readã€loadã€useã€assignã€storeã€writeã€lock å’Œ unlockæ“ä½œå…·æœ‰åŸå­æ€§ ä¾‹å¦‚å¯¹ä¸€ä¸ª int ç±»å‹çš„å˜é‡æ‰§è¡Œ assign èµ‹å€¼æ“ä½œï¼Œè¿™ä¸ªæ“ä½œå°±æ˜¯åŸå­æ€§çš„ã€‚ ä½†æ˜¯ Java å†…å­˜æ¨¡å‹å…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢« volatile ä¿®é¥°çš„ 64 ä½æ•°æ®ï¼ˆlongï¼Œdoubleï¼‰çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸ºä¸¤æ¬¡ 32 ä½çš„æ“ä½œæ¥è¿›è¡Œï¼Œå³ loadã€storeã€read å’Œ write æ“ä½œå¯ä»¥ä¸å…·å¤‡åŸå­æ€§ã€‚ æœ‰ä¸€ä¸ªé”™è¯¯è®¤è¯†å°±æ˜¯ï¼Œint ç­‰åŸå­æ€§çš„ç±»å‹åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚å‰é¢çš„çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œcnt å±äº int ç±»å‹å˜é‡ï¼Œ1000 ä¸ªçº¿ç¨‹å¯¹å®ƒè¿›è¡Œè‡ªå¢æ“ä½œä¹‹åï¼Œå¾—åˆ°çš„å€¼ä¸º 997 è€Œä¸æ˜¯ 1000ã€‚ ä¸ºäº†æ–¹ä¾¿è®¨è®ºï¼Œå°†å†…å­˜é—´çš„äº¤äº’æ“ä½œç®€åŒ–ä¸º 3 ä¸ªï¼šloadã€assignã€storeã€‚ ä¸‹å›¾æ¼”ç¤ºäº†ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹ cnt è¿›è¡Œæ“ä½œï¼Œloadã€assignã€store è¿™ä¸€ç³»åˆ—æ“ä½œæ•´ä½“ä¸Šçœ‹ä¸å…·å¤‡åŸå­æ€§ï¼Œé‚£ä¹ˆåœ¨ T1 ä¿®æ”¹ cnt å¹¶ä¸”è¿˜æ²¡æœ‰å°†ä¿®æ”¹åçš„å€¼å†™å…¥ä¸»å†…å­˜ï¼ŒT2 ä¾ç„¶å¯ä»¥è¯»å…¥æ—§å€¼ã€‚å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹è™½ç„¶æ‰§è¡Œäº†ä¸¤æ¬¡è‡ªå¢è¿ç®—ï¼Œä½†æ˜¯ä¸»å†…å­˜ä¸­ cnt çš„å€¼æœ€åä¸º 1 è€Œä¸æ˜¯ 2ã€‚å› æ­¤å¯¹ int ç±»å‹è¯»å†™æ“ä½œæ»¡è¶³åŸå­æ€§åªæ˜¯è¯´æ˜ loadã€assignã€store è¿™äº›å•ä¸ªæ“ä½œå…·å¤‡åŸå­æ€§ã€‚ AtomicInteger èƒ½ä¿è¯å¤šä¸ªçº¿ç¨‹ä¿®æ”¹çš„åŸå­æ€§ã€‚ ä½¿ç”¨ AtomicInteger é‡å†™ä¹‹å‰çº¿ç¨‹ä¸å®‰å…¨çš„ä»£ç ä¹‹åå¾—åˆ°ä»¥ä¸‹çº¿ç¨‹å®‰å…¨å®ç°ï¼š 123456789101112public class AtomicExample &#123; private AtomicInteger cnt = new AtomicInteger(); public void add() &#123; cnt.incrementAndGet(); &#125; public int get() &#123; return cnt.get(); &#125;&#125; 123456789101112131415public static void main(String[] args) throws InterruptedException &#123; final int threadSize = 1000; AtomicExample example = new AtomicExample(); // åªä¿®æ”¹è¿™æ¡è¯­å¥ final CountDownLatch countDownLatch = new CountDownLatch(threadSize); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; threadSize; i++) &#123; executorService.execute(() -&gt; &#123; example.add(); countDownLatch.countDown(); &#125;); &#125; countDownLatch.await(); executorService.shutdown(); System.out.println(example.get());&#125; é™¤äº†ä½¿ç”¨åŸå­ç±»ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ synchronized äº’æ–¥é”æ¥ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚å®ƒå¯¹åº”çš„å†…å­˜é—´äº¤äº’æ“ä½œä¸ºï¼šlock å’Œ unlockï¼Œåœ¨è™šæ‹Ÿæœºå®ç°ä¸Šå¯¹åº”çš„å­—èŠ‚ç æŒ‡ä»¤ä¸º monitorenter å’Œ monitorexitã€‚ å¯è§æ€§ å¯è§æ€§æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ã€‚Java å†…å­˜æ¨¡å‹æ˜¯é€šè¿‡åœ¨å˜é‡ä¿®æ”¹åå°†æ–°å€¼åŒæ­¥å›ä¸»å†…å­˜ï¼Œåœ¨å˜é‡è¯»å–å‰ä»ä¸»å†…å­˜åˆ·æ–°å˜é‡å€¼æ¥å®ç°å¯è§æ€§çš„ã€‚ ä¸»è¦æœ‰æœ‰ä¸‰ç§å®ç°å¯è§æ€§çš„æ–¹å¼ï¼š volatile synchronizedï¼Œå¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œ unlock æ“ä½œä¹‹å‰ï¼Œå¿…é¡»æŠŠå˜é‡å€¼åŒæ­¥å›ä¸»å†…å­˜ã€‚ finalï¼Œè¢« final å…³é”®å­—ä¿®é¥°çš„å­—æ®µåœ¨æ„é€ å™¨ä¸­ä¸€æ—¦åˆå§‹åŒ–å®Œæˆï¼Œå¹¶ä¸”æ²¡æœ‰å‘ç”Ÿ this é€ƒé€¸ï¼ˆå…¶å®ƒçº¿ç¨‹é€šè¿‡ this å¼•ç”¨è®¿é—®åˆ°åˆå§‹åŒ–äº†ä¸€åŠçš„å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±èƒ½çœ‹è§ final å­—æ®µçš„å€¼ã€‚ å¯¹å‰é¢çš„çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹ä¸­çš„ cnt å˜é‡ä½¿ç”¨ volatile ä¿®é¥°ï¼Œä¸èƒ½è§£å†³çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ï¼Œå› ä¸º volatile å¹¶ä¸èƒ½ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚ æœ‰åºæ€§ æœ‰åºæ€§æ˜¯æŒ‡ï¼šåœ¨æœ¬çº¿ç¨‹å†…è§‚å¯Ÿï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ‰åºçš„ã€‚åœ¨ä¸€ä¸ªçº¿ç¨‹è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æ— åºçš„ï¼Œæ— åºæ˜¯å› ä¸ºå‘ç”Ÿäº†æŒ‡ä»¤é‡æ’åºã€‚åœ¨ Java å†…å­˜æ¨¡å‹ä¸­ï¼Œå…è®¸ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œé‡æ’åºè¿‡ç¨‹ä¸ä¼šå½±å“åˆ°å•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œï¼Œå´ä¼šå½±å“åˆ°å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚ volatile å…³é”®å­—é€šè¿‡æ·»åŠ å†…å­˜å±éšœçš„æ–¹å¼æ¥ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œå³é‡æ’åºæ—¶ä¸èƒ½æŠŠåé¢çš„æŒ‡ä»¤æ”¾åˆ°å†…å­˜å±éšœä¹‹å‰ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡ synchronized æ¥ä¿è¯æœ‰åºæ€§ï¼Œå®ƒä¿è¯æ¯ä¸ªæ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œç›¸å½“äºæ˜¯è®©çº¿ç¨‹é¡ºåºæ‰§è¡ŒåŒæ­¥ä»£ç ã€‚ å…ˆè¡Œå‘ç”ŸåŸåˆ™ä¸Šé¢æåˆ°äº†å¯ä»¥ç”¨ volatile å’Œ synchronized æ¥ä¿è¯æœ‰åºæ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒJVM è¿˜è§„å®šäº†å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œè®©ä¸€ä¸ªæ“ä½œæ— éœ€æ§åˆ¶å°±èƒ½å…ˆäºå¦ä¸€ä¸ªæ“ä½œå®Œæˆã€‚ å•ä¸€çº¿ç¨‹åŸåˆ™ Single Thread rule åœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼Œåœ¨ç¨‹åºå‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢çš„æ“ä½œã€‚ ç®¡ç¨‹é”å®šè§„åˆ™ Monitor Lock Rule ä¸€ä¸ª unlock æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„ lock æ“ä½œã€‚ volatile å˜é‡è§„åˆ™ Volatile Variable Rule å¯¹ä¸€ä¸ª volatile å˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œã€‚ çº¿ç¨‹å¯åŠ¨è§„åˆ™ Thread Start Rule Thread å¯¹è±¡çš„ start() æ–¹æ³•è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚ çº¿ç¨‹åŠ å…¥è§„åˆ™ Thread Join Rule Thread å¯¹è±¡çš„ç»“æŸå…ˆè¡Œå‘ç”Ÿäº join() æ–¹æ³•è¿”å›ã€‚ çº¿ç¨‹ä¸­æ–­è§„åˆ™ Thread Interruption Rule å¯¹çº¿ç¨‹ interrupt() æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡ interrupted() æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚ å¯¹è±¡ç»ˆç»“è§„åˆ™ Finalizer Rule ä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆï¼ˆæ„é€ å‡½æ•°æ‰§è¡Œç»“æŸï¼‰å…ˆè¡Œå‘ç”Ÿäºå®ƒçš„ finalize() æ–¹æ³•çš„å¼€å§‹ã€‚ ä¼ é€’æ€§ Transitivity å¦‚æœæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Bï¼Œæ“ä½œ B å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cï¼Œé‚£ä¹ˆæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cã€‚ åä¸€ã€çº¿ç¨‹å®‰å…¨çº¿ç¨‹å®‰å…¨å®šä¹‰ ä¸€ä¸ªç±»åœ¨å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å®‰å…¨è°ƒç”¨æ—¶å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ çº¿ç¨‹å®‰å…¨åˆ†ç±» çº¿ç¨‹å®‰å…¨ä¸æ˜¯ä¸€ä¸ªéçœŸå³å‡çš„å‘½é¢˜ï¼Œå¯ä»¥å°†å…±äº«æ•°æ®æŒ‰ç…§å®‰å…¨ç¨‹åº¦çš„å¼ºå¼±é¡ºåºåˆ†æˆä»¥ä¸‹äº”ç±»ï¼šä¸å¯å˜ã€ç»å¯¹çº¿ç¨‹å®‰å…¨ã€ç›¸å¯¹çº¿ç¨‹å®‰å…¨ã€çº¿ç¨‹å…¼å®¹å’Œçº¿ç¨‹å¯¹ç«‹ã€‚ ä¸å¯å˜ ä¸å¯å˜ï¼ˆImmutableï¼‰çš„å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸éœ€è¦å†é‡‡å–ä»»ä½•çš„çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½ã€‚åªè¦ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡è¢«æ­£ç¡®åœ°æ„å»ºå‡ºæ¥ï¼Œæ°¸è¿œä¹Ÿä¸ä¼šçœ‹åˆ°å®ƒåœ¨å¤šä¸ªçº¿ç¨‹ä¹‹ä¸­å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚ å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œåº”å½“å°½é‡ä½¿å¯¹è±¡æˆä¸ºä¸å¯å˜ï¼Œæ¥æ»¡è¶³çº¿ç¨‹å®‰å…¨ã€‚ ä¸å¯å˜çš„ç±»å‹ï¼š final å…³é”®å­—ä¿®é¥°çš„åŸºæœ¬æ•°æ®ç±»å‹ String æšä¸¾ç±»å‹ Number éƒ¨åˆ†å­ç±»ï¼Œå¦‚ Long å’Œ Double ç­‰æ•°å€¼åŒ…è£…ç±»å‹ï¼ŒBigInteger å’Œ BigDecimal ç­‰å¤§æ•°æ®ç±»å‹ã€‚ä½†åŒä¸º Number çš„åŸå­ç±» AtomicInteger å’Œ AtomicLong åˆ™æ˜¯å¯å˜çš„ã€‚ å¯¹äºé›†åˆç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ Collections.unmodifiableXXX() æ–¹æ³•æ¥è·å–ä¸€ä¸ªä¸å¯å˜çš„é›†åˆã€‚ ç»å¯¹çº¿ç¨‹å®‰å…¨ ä¸ç®¡è¿è¡Œæ—¶ç¯å¢ƒå¦‚ä½•ï¼Œè°ƒç”¨è€…éƒ½ä¸éœ€è¦ä»»ä½•é¢å¤–çš„åŒæ­¥æªæ–½ã€‚ ç›¸å¯¹çº¿ç¨‹å®‰å…¨ ç›¸å¯¹çº¿ç¨‹å®‰å…¨éœ€è¦ä¿è¯å¯¹è¿™ä¸ªå¯¹è±¡å•ç‹¬çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™ä¸éœ€è¦åšé¢å¤–çš„ä¿éšœæªæ–½ã€‚ä½†æ˜¯å¯¹äºä¸€äº›ç‰¹å®šé¡ºåºçš„è¿ç»­è°ƒç”¨ï¼Œå°±å¯èƒ½éœ€è¦åœ¨è°ƒç”¨ç«¯ä½¿ç”¨é¢å¤–çš„åŒæ­¥æ‰‹æ®µæ¥ä¿è¯è°ƒç”¨çš„æ­£ç¡®æ€§ã€‚ åœ¨ Java è¯­è¨€ä¸­ï¼Œå¤§éƒ¨åˆ†çš„çº¿ç¨‹å®‰å…¨ç±»éƒ½å±äºè¿™ç§ç±»å‹ï¼Œä¾‹å¦‚ Vectorã€HashTableã€Collections çš„ synchronizedCollection() æ–¹æ³•åŒ…è£…çš„é›†åˆç­‰ã€‚ å¯¹äºä¸‹é¢çš„ä»£ç ï¼Œå¦‚æœåˆ é™¤å…ƒç´ çš„çº¿ç¨‹åˆ é™¤äº† Vector çš„ä¸€ä¸ªå…ƒç´ ï¼Œè€Œè·å–å…ƒç´ çš„çº¿ç¨‹è¯•å›¾è®¿é—®ä¸€ä¸ªå·²ç»è¢«åˆ é™¤çš„å…ƒç´ ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡º ArrayIndexOutOfBoundsExceptionã€‚ çº¿ç¨‹å…¼å®¹ çº¿ç¨‹å…¼å®¹æ˜¯æŒ‡å¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åœ¨è°ƒç”¨ç«¯æ­£ç¡®åœ°ä½¿ç”¨åŒæ­¥æ‰‹æ®µæ¥ä¿è¯å¯¹è±¡åœ¨å¹¶å‘ç¯å¢ƒä¸­å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ï¼Œæˆ‘ä»¬å¹³å¸¸è¯´ä¸€ä¸ªç±»ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œç»å¤§å¤šæ•°æ—¶å€™æŒ‡çš„æ˜¯è¿™ä¸€ç§æƒ…å†µã€‚Java API ä¸­å¤§éƒ¨åˆ†çš„ç±»éƒ½æ˜¯å±äºçº¿ç¨‹å…¼å®¹çš„ï¼Œå¦‚ä¸å‰é¢çš„ Vector å’Œ HashTable ç›¸å¯¹åº”çš„é›†åˆç±» ArrayList å’Œ HashMap ç­‰ã€‚ çº¿ç¨‹å¯¹ç«‹ çº¿ç¨‹å¯¹ç«‹æ˜¯æŒ‡æ— è®ºè°ƒç”¨ç«¯æ˜¯å¦é‡‡å–äº†åŒæ­¥æªæ–½ï¼Œéƒ½æ— æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¹¶å‘ä½¿ç”¨çš„ä»£ç ã€‚ç”±äº Java è¯­è¨€å¤©ç”Ÿå°±å…·å¤‡å¤šçº¿ç¨‹ç‰¹æ€§ï¼Œçº¿ç¨‹å¯¹ç«‹è¿™ç§æ’æ–¥å¤šçº¿ç¨‹çš„ä»£ç æ˜¯å¾ˆå°‘å‡ºç°çš„ï¼Œè€Œä¸”é€šå¸¸éƒ½æ˜¯æœ‰å®³çš„ï¼Œåº”å½“å°½é‡é¿å…ã€‚ çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³• äº’æ–¥åŒæ­¥(é˜»å¡åŒæ­¥) synchronized å’Œ ReentrantLockã€‚ éé˜»å¡åŒæ­¥ äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥ã€‚ äº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œæ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œé‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œå®ƒéƒ½è¦è¿›è¡ŒåŠ é”ï¼ˆè¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”ï¼‰ã€ç”¨æˆ·æ€æ ¸å¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦å”¤é†’ç­‰æ“ä½œã€‚ ï¼ˆä¸€ï¼‰CAS éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥: å…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶å®ƒçº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼Œå¦åˆ™é‡‡å–è¡¥å¿æªæ–½ï¼ˆä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼‰ã€‚è¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½ä¸éœ€è¦å°†çº¿ç¨‹é˜»å¡ï¼Œå› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ã€‚ ä¹è§‚é”éœ€è¦æ“ä½œå’Œå†²çªæ£€æµ‹è¿™ä¸¤ä¸ªæ­¥éª¤å…·å¤‡åŸå­æ€§ï¼Œè¿™é‡Œå°±ä¸èƒ½å†ä½¿ç”¨äº’æ–¥åŒæ­¥æ¥ä¿è¯äº†ï¼Œåªèƒ½é ç¡¬ä»¶æ¥å®Œæˆã€‚ç¡¬ä»¶æ”¯æŒçš„åŸå­æ€§æ“ä½œæœ€å…¸å‹çš„æ˜¯ï¼šæ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare-and-Swapï¼ŒCASï¼‰ã€‚CAS æŒ‡ä»¤éœ€è¦æœ‰ 3 ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜åœ°å€ Vã€æ—§çš„é¢„æœŸå€¼ A å’Œæ–°å€¼ Bã€‚å½“æ‰§è¡Œæ“ä½œæ—¶ï¼Œåªæœ‰å½“ V çš„å€¼ç­‰äº Aï¼Œæ‰å°† V çš„å€¼æ›´æ–°ä¸º Bã€‚ ï¼ˆäºŒï¼‰AtomicInteger J.U.C åŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±» AtomicInteger çš„æ–¹æ³•è°ƒç”¨äº† Unsafe ç±»çš„ CAS æ“ä½œã€‚ ä»¥ä¸‹ä»£ç ä½¿ç”¨äº† AtomicInteger æ‰§è¡Œäº†è‡ªå¢çš„æ“ä½œã€‚ 12345private AtomicInteger cnt = new AtomicInteger();public void add() &#123; cnt.incrementAndGet();&#125; ä»¥ä¸‹ä»£ç æ˜¯ incrementAndGet() çš„æºç ï¼Œå®ƒè°ƒç”¨äº† Unsafe çš„ getAndAddInt() ã€‚ 123public final int incrementAndGet() &#123; return unsafe.getAndAddInt(this, valueOffset, 1) + 1;&#125; ä»¥ä¸‹ä»£ç æ˜¯ getAndAddInt() æºç ï¼Œvar1 æŒ‡ç¤ºå¯¹è±¡å†…å­˜åœ°å€ï¼Œvar2 æŒ‡ç¤ºè¯¥å­—æ®µç›¸å¯¹å¯¹è±¡å†…å­˜åœ°å€çš„åç§»ï¼Œvar4 æŒ‡ç¤ºæ“ä½œéœ€è¦åŠ çš„æ•°å€¼ï¼Œè¿™é‡Œä¸º 1ã€‚é€šè¿‡ getIntVolatile(var1, var2) å¾—åˆ°æ—§çš„é¢„æœŸå€¼ï¼Œé€šè¿‡è°ƒç”¨ compareAndSwapInt() æ¥è¿›è¡Œ CAS æ¯”è¾ƒï¼Œå¦‚æœè¯¥å­—æ®µå†…å­˜åœ°å€ä¸­çš„å€¼ç­‰äº var5ï¼Œé‚£ä¹ˆå°±æ›´æ–°å†…å­˜åœ°å€ä¸º var1+var2 çš„å˜é‡ä¸º var5+var4ã€‚ å¯ä»¥çœ‹åˆ° getAndAddInt() åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è¿›è¡Œï¼Œå‘ç”Ÿå†²çªçš„åšæ³•æ˜¯ä¸æ–­çš„è¿›è¡Œé‡è¯•ã€‚ 12345678public final int getAndAddInt(Object var1, long var2, int var4) &#123; int var5; do &#123; var5 = this.getIntVolatile(var1, var2); &#125; while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4)); return var5;&#125; ï¼ˆä¸‰ï¼‰ABA å¦‚æœä¸€ä¸ªå˜é‡åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå®ƒçš„å€¼è¢«æ”¹æˆäº† Bï¼Œåæ¥åˆè¢«æ”¹å›ä¸º Aï¼Œé‚£ CAS æ“ä½œå°±ä¼šè¯¯è®¤ä¸ºå®ƒä»æ¥æ²¡æœ‰è¢«æ”¹å˜è¿‡ã€‚ J.U.C åŒ…æä¾›äº†ä¸€ä¸ªå¸¦æœ‰æ ‡è®°çš„åŸå­å¼•ç”¨ç±» AtomicStampedReference æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¯ä»¥é€šè¿‡æ§åˆ¶å˜é‡å€¼çš„ç‰ˆæœ¬æ¥ä¿è¯ CAS çš„æ­£ç¡®æ€§ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ ABA é—®é¢˜ä¸ä¼šå½±å“ç¨‹åºå¹¶å‘çš„æ­£ç¡®æ€§ï¼Œå¦‚æœéœ€è¦è§£å†³ ABA é—®é¢˜ï¼Œæ”¹ç”¨ä¼ ç»Ÿçš„äº’æ–¥åŒæ­¥å¯èƒ½ä¼šæ¯”åŸå­ç±»æ›´é«˜æ•ˆã€‚ æ— åŒæ­¥æ–¹æ¡ˆ è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡ŒåŒæ­¥ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±æ— é¡»ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯æ­£ç¡®æ€§ã€‚ ï¼ˆä¸€ï¼‰æ ˆå°é—­ å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªæ–¹æ³•çš„å±€éƒ¨å˜é‡æ—¶ï¼Œä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºå±€éƒ¨å˜é‡å­˜å‚¨åœ¨è™šæ‹Ÿæœºæ ˆä¸­ï¼Œå±äºçº¿ç¨‹ç§æœ‰çš„ã€‚ 1234567891011121314151617public class StackClosedExample &#123; public void add100() &#123; int cnt = 0; for (int i = 0; i &lt; 100; i++) &#123; cnt++; &#125; System.out.println(cnt); &#125;&#125;public static void main(String[] args) &#123; StackClosedExample example = new StackClosedExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; example.add100()); executorService.execute(() -&gt; example.add100()); executorService.shutdown();&#125; ï¼ˆäºŒï¼‰çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread Local Storageï¼‰ å¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œã€‚å¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œè¿™æ ·ï¼Œæ— é¡»åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨çš„é—®é¢˜ã€‚ ç¬¦åˆè¿™ç§ç‰¹ç‚¹çš„åº”ç”¨å¹¶ä¸å°‘è§ï¼Œå¤§éƒ¨åˆ†ä½¿ç”¨æ¶ˆè´¹é˜Ÿåˆ—çš„æ¶æ„æ¨¡å¼ï¼ˆå¦‚â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼ï¼‰éƒ½ä¼šå°†äº§å“çš„æ¶ˆè´¹è¿‡ç¨‹å°½é‡åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ¶ˆè´¹å®Œã€‚ å…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªåº”ç”¨å®ä¾‹å°±æ˜¯ç»å…¸ Web äº¤äº’æ¨¡å‹ä¸­çš„â€œä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨çº¿ç¨‹â€ï¼ˆThread-per-Requestï¼‰çš„å¤„ç†æ–¹å¼ï¼Œè¿™ç§å¤„ç†æ–¹å¼çš„å¹¿æ³›åº”ç”¨ä½¿å¾—å¾ˆå¤š Web æœåŠ¡ç«¯åº”ç”¨éƒ½å¯ä»¥ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨æ¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ å¯ä»¥ä½¿ç”¨ java.lang.ThreadLocal ç±»æ¥å®ç°çº¿ç¨‹æœ¬åœ°å­˜å‚¨åŠŸèƒ½ã€‚ å¯¹äºä»¥ä¸‹ä»£ç ï¼Œthread1 ä¸­è®¾ç½® threadLocal ä¸º 1ï¼Œè€Œ thread2 è®¾ç½® threadLocal ä¸º 2ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œthread1 è¯»å– threadLocal ä¾ç„¶æ˜¯ 1ï¼Œä¸å— thread2 çš„å½±å“ã€‚ 1234567891011121314151617181920212223public class ThreadLocalExample &#123; public static void main(String[] args) &#123; ThreadLocal threadLocal = new ThreadLocal(); Thread thread1 = new Thread(() -&gt; &#123; threadLocal.set(1); try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(threadLocal.get()); threadLocal.remove(); &#125;); Thread thread2 = new Thread(() -&gt; &#123; threadLocal.set(2); threadLocal.remove(); &#125;); thread1.start(); thread2.start(); &#125;&#125;1 ä¸ºäº†ç†è§£ ThreadLocalï¼Œå…ˆçœ‹ä»¥ä¸‹ä»£ç ï¼š 12345678910111213141516public class ThreadLocalExample1 &#123; public static void main(String[] args) &#123; ThreadLocal threadLocal1 = new ThreadLocal(); ThreadLocal threadLocal2 = new ThreadLocal(); Thread thread1 = new Thread(() -&gt; &#123; threadLocal1.set(1); threadLocal2.set(1); &#125;); Thread thread2 = new Thread(() -&gt; &#123; threadLocal1.set(2); threadLocal2.set(2); &#125;); thread1.start(); thread2.start(); &#125;&#125; æ¯ä¸ª Thread éƒ½æœ‰ä¸€ä¸ª ThreadLocal.ThreadLocalMap å¯¹è±¡ 123/* ThreadLocal values pertaining to this thread. This map is maintained * by the ThreadLocal class. */ThreadLocal.ThreadLocalMap threadLocals = null; å½“è°ƒç”¨ä¸€ä¸ª ThreadLocal çš„ set(T value) æ–¹æ³•æ—¶ï¼Œå…ˆå¾—åˆ°å½“å‰çº¿ç¨‹çš„ ThreadLocalMap å¯¹è±¡ï¼Œç„¶åå°† ThreadLocal-&gt;value é”®å€¼å¯¹æ’å…¥åˆ°è¯¥ Map ä¸­ã€‚ 12345678public void set(T value) &#123; Thread t = Thread.currentThread(); ThreadLocalMap map = getMap(t); if (map != null) map.set(this, value); else createMap(t, value);&#125; get() æ–¹æ³•ç±»ä¼¼ã€‚ 12345678910111213public T get() &#123; Thread t = Thread.currentThread(); ThreadLocalMap map = getMap(t); if (map != null) &#123; ThreadLocalMap.Entry e = map.getEntry(this); if (e != null) &#123; @SuppressWarnings(\"unchecked\") T result = (T)e.value; return result; &#125; &#125; return setInitialValue();&#125; ThreadLocal ä»ç†è®ºä¸Šè®²å¹¶ä¸æ˜¯ç”¨æ¥è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜çš„ï¼Œå› ä¸ºæ ¹æœ¬ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ã€‚ åœ¨ä¸€äº›åœºæ™¯ (å°¤å…¶æ˜¯ä½¿ç”¨çº¿ç¨‹æ± ) ä¸‹ï¼Œç”±äº ThreadLocal.ThreadLocalMap çš„åº•å±‚æ•°æ®ç»“æ„å¯¼è‡´ ThreadLocal æœ‰å†…å­˜æ³„æ¼çš„æƒ…å†µï¼Œåº”è¯¥å°½å¯èƒ½åœ¨æ¯æ¬¡ä½¿ç”¨ ThreadLocal åæ‰‹åŠ¨è°ƒç”¨ remove()ï¼Œä»¥é¿å…å‡ºç° ThreadLocal ç»å…¸çš„å†…å­˜æ³„æ¼ç”šè‡³æ˜¯é€ æˆè‡ªèº«ä¸šåŠ¡æ··ä¹±çš„é£é™©ã€‚ ï¼ˆä¸‰ï¼‰å¯é‡å…¥ä»£ç ï¼ˆReentrant Codeï¼‰ è¿™ç§ä»£ç ä¹Ÿå«åšçº¯ä»£ç ï¼ˆPure Codeï¼‰ï¼Œå¯ä»¥åœ¨ä»£ç æ‰§è¡Œçš„ä»»ä½•æ—¶åˆ»ä¸­æ–­å®ƒï¼Œè½¬è€Œå»æ‰§è¡Œå¦å¤–ä¸€æ®µä»£ç ï¼ˆåŒ…æ‹¬é€’å½’è°ƒç”¨å®ƒæœ¬èº«ï¼‰ï¼Œè€Œåœ¨æ§åˆ¶æƒè¿”å›åï¼ŒåŸæ¥çš„ç¨‹åºä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚ å¯é‡å…¥ä»£ç æœ‰ä¸€äº›å…±åŒçš„ç‰¹å¾ï¼Œä¾‹å¦‚ä¸ä¾èµ–å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æºã€ç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°ä¸­ä¼ å…¥ã€ä¸è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³•ç­‰ã€‚ åäºŒã€é”ä¼˜åŒ–è¿™é‡Œçš„é”ä¼˜åŒ–ä¸»è¦æ˜¯æŒ‡ JVM å¯¹ synchronized çš„ä¼˜åŒ–ã€‚ è‡ªæ—‹é”äº’æ–¥åŒæ­¥è¿›å…¥é˜»å¡çŠ¶æ€çš„å¼€é”€éƒ½å¾ˆå¤§ï¼Œåº”è¯¥å°½é‡é¿å… åœ¨è®¸å¤šåº”ç”¨ä¸­ï¼Œå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ è‡ªæ—‹é”çš„æ€æƒ³æ˜¯è®©ä¸€ä¸ªçº¿ç¨‹åœ¨è¯·æ±‚ä¸€ä¸ªå…±äº«æ•°æ®çš„é”æ—¶æ‰§è¡Œå¿™å¾ªç¯ï¼ˆè‡ªæ—‹ï¼‰ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœåœ¨è¿™æ®µæ—¶é—´å†…èƒ½è·å¾—é”ï¼Œå°±å¯ä»¥é¿å…è¿›å…¥é˜»å¡çŠ¶æ€ã€‚ è‡ªæ—‹é”è™½ç„¶èƒ½é¿å…è¿›å…¥é˜»å¡çŠ¶æ€ä»è€Œå‡å°‘å¼€é”€ï¼Œä½†æ˜¯å®ƒéœ€è¦è¿›è¡Œå¿™å¾ªç¯æ“ä½œå ç”¨ CPU æ—¶é—´ï¼Œå®ƒåªé€‚ç”¨äºå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€å¾ˆçŸ­çš„åœºæ™¯ã€‚ åœ¨ JDK 1.6 ä¸­å¼•å…¥äº†è‡ªé€‚åº”çš„è‡ªæ—‹é”ã€‚è‡ªé€‚åº”æ„å‘³ç€è‡ªæ—‹çš„æ¬¡æ•°ä¸å†å›ºå®šäº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ¬¡æ•°åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šã€‚ é”æ¶ˆé™¤é”æ¶ˆé™¤æ˜¯æŒ‡å¯¹äºè¢«æ£€æµ‹å‡ºä¸å¯èƒ½å­˜åœ¨ç«äº‰çš„å…±äº«æ•°æ®çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚ é”æ¶ˆé™¤ä¸»è¦æ˜¯é€šè¿‡é€ƒé€¸åˆ†ææ¥æ”¯æŒï¼Œå¦‚æœå †ä¸Šçš„å…±äº«æ•°æ®ä¸å¯èƒ½é€ƒé€¸å‡ºå»è¢«å…¶å®ƒçº¿ç¨‹è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠå®ƒä»¬å½“æˆç§æœ‰æ•°æ®å¯¹å¾…ï¼Œä¹Ÿå°±å¯ä»¥å°†å®ƒä»¬çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚ å¯¹äºä¸€äº›çœ‹èµ·æ¥æ²¡æœ‰åŠ é”çš„ä»£ç ï¼Œå…¶å®éšå¼çš„åŠ äº†å¾ˆå¤šé”ã€‚ä¾‹å¦‚ä¸‹é¢çš„å­—ç¬¦ä¸²æ‹¼æ¥ä»£ç å°±éšå¼åŠ äº†é”ï¼š 123public static String concatString(String s1, String s2, String s3) &#123; return s1 + s2 + s3;&#125; String æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ç±»ï¼Œç¼–è¯‘å™¨ä¼šå¯¹ String çš„æ‹¼æ¥è‡ªåŠ¨ä¼˜åŒ–ã€‚åœ¨ JDK 1.5 ä¹‹å‰ï¼Œä¼šè½¬åŒ–ä¸º StringBuffer å¯¹è±¡çš„è¿ç»­ append() æ“ä½œï¼š 1234567public static String concatString(String s1, String s2, String s3) &#123; StringBuffer sb = new StringBuffer(); sb.append(s1); sb.append(s2); sb.append(s3); return sb.toString();&#125; æ¯ä¸ª append() æ–¹æ³•ä¸­éƒ½æœ‰ä¸€ä¸ªåŒæ­¥å—ã€‚è™šæ‹Ÿæœºè§‚å¯Ÿå˜é‡ sbï¼Œå¾ˆå¿«å°±ä¼šå‘ç°å®ƒçš„åŠ¨æ€ä½œç”¨åŸŸè¢«é™åˆ¶åœ¨ concatString() æ–¹æ³•å†…éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œsb çš„æ‰€æœ‰å¼•ç”¨æ°¸è¿œä¸ä¼šé€ƒé€¸åˆ° concatString() æ–¹æ³•ä¹‹å¤–ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®åˆ°å®ƒï¼Œå› æ­¤å¯ä»¥è¿›è¡Œæ¶ˆé™¤ã€‚ é”ç²—åŒ–å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”ï¼Œé¢‘ç¹çš„åŠ é”æ“ä½œå°±ä¼šå¯¼è‡´æ€§èƒ½æŸè€—ã€‚ ä¸Šä¸€èŠ‚çš„ç¤ºä¾‹ä»£ç ä¸­è¿ç»­çš„ append() æ–¹æ³•å°±å±äºè¿™ç±»æƒ…å†µã€‚å¦‚æœè™šæ‹Ÿæœºæ¢æµ‹åˆ°ç”±è¿™æ ·çš„ä¸€ä¸²é›¶ç¢çš„æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œå°†ä¼šæŠŠåŠ é”çš„èŒƒå›´æ‰©å±•ï¼ˆç²—åŒ–ï¼‰åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ã€‚å¯¹äºä¸Šä¸€èŠ‚çš„ç¤ºä¾‹ä»£ç å°±æ˜¯æ‰©å±•åˆ°ç¬¬ä¸€ä¸ª append() æ“ä½œä¹‹å‰ç›´è‡³æœ€åä¸€ä¸ª append() æ“ä½œä¹‹åï¼Œè¿™æ ·åªéœ€è¦åŠ é”ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚ è½»é‡çº§é”JDK 1.6 å¼•å…¥äº†åå‘é”å’Œè½»é‡çº§é”ï¼Œä»è€Œè®©é”æ‹¥æœ‰äº†å››ä¸ªçŠ¶æ€ï¼šæ— é”çŠ¶æ€ï¼ˆunlockedï¼‰ã€åå‘é”çŠ¶æ€ï¼ˆbiasbleï¼‰ã€è½»é‡çº§é”çŠ¶æ€ï¼ˆlightweight lockedï¼‰å’Œé‡é‡çº§é”çŠ¶æ€ï¼ˆinflatedï¼‰ã€‚ åå‘é”åå‘é”çš„æ€æƒ³æ˜¯åå‘äºè®©ç¬¬ä¸€ä¸ªè·å–é”å¯¹è±¡çš„çº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹åœ¨ä¹‹åè·å–è¯¥é”å°±ä¸å†éœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œç”šè‡³è¿ CAS æ“ä½œä¹Ÿä¸å†éœ€è¦ã€‚ å½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å¾—çš„æ—¶å€™ï¼Œè¿›å…¥åå‘çŠ¶æ€ï¼Œæ ‡è®°ä¸º 1 01ã€‚åŒæ—¶ä½¿ç”¨ CAS æ“ä½œå°†çº¿ç¨‹ ID è®°å½•åˆ° Mark Word ä¸­ï¼Œå¦‚æœ CAS æ“ä½œæˆåŠŸï¼Œè¿™ä¸ªçº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—å°±ä¸éœ€è¦å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œã€‚ å½“æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹å»å°è¯•è·å–è¿™ä¸ªé”å¯¹è±¡æ—¶ï¼Œåå‘çŠ¶æ€å°±å®£å‘Šç»“æŸï¼Œæ­¤æ—¶æ’¤é”€åå‘ï¼ˆRevoke Biasï¼‰åæ¢å¤åˆ°æœªé”å®šçŠ¶æ€æˆ–è€…è½»é‡çº§é”çŠ¶æ€ã€‚ åä¸‰ã€å¤šçº¿ç¨‹å¼€å‘è‰¯å¥½çš„å®è·µ ç»™çº¿ç¨‹èµ·ä¸ªæœ‰æ„ä¹‰çš„åå­—ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿æ‰¾ Bugã€‚ ç¼©å°åŒæ­¥èŒƒå›´ï¼Œä»è€Œå‡å°‘é”äº‰ç”¨ã€‚ä¾‹å¦‚å¯¹äº synchronizedï¼Œåº”è¯¥å°½é‡ä½¿ç”¨åŒæ­¥å—è€Œä¸æ˜¯åŒæ­¥æ–¹æ³•ã€‚ å¤šç”¨åŒæ­¥å·¥å…·å°‘ç”¨ wait() å’Œ notify()ã€‚é¦–å…ˆï¼ŒCountDownLatch, CyclicBarrier, Semaphore å’Œ Exchanger è¿™äº›åŒæ­¥ç±»ç®€åŒ–äº†ç¼–ç æ“ä½œï¼Œè€Œç”¨ wait() å’Œ notify() å¾ˆéš¾å®ç°å¤æ‚æ§åˆ¶æµï¼›å…¶æ¬¡ï¼Œè¿™äº›åŒæ­¥ç±»æ˜¯ç”±æœ€å¥½çš„ä¼ä¸šç¼–å†™å’Œç»´æŠ¤ï¼Œåœ¨åç»­çš„ JDK ä¸­è¿˜ä¼šä¸æ–­ä¼˜åŒ–å’Œå®Œå–„ã€‚ ä½¿ç”¨ BlockingQueue å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ã€‚ å¤šç”¨å¹¶å‘é›†åˆå°‘ç”¨åŒæ­¥é›†åˆï¼Œä¾‹å¦‚åº”è¯¥ä½¿ç”¨ ConcurrentHashMap è€Œä¸æ˜¯ Hashtableã€‚ ä½¿ç”¨æœ¬åœ°å˜é‡å’Œä¸å¯å˜ç±»æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚ ä½¿ç”¨çº¿ç¨‹æ± è€Œä¸æ˜¯ç›´æ¥åˆ›å»ºçº¿ç¨‹ï¼Œè¿™æ˜¯å› ä¸ºåˆ›å»ºçº¿ç¨‹ä»£ä»·å¾ˆé«˜ï¼Œçº¿ç¨‹æ± å¯ä»¥æœ‰æ•ˆåœ°åˆ©ç”¨æœ‰é™çš„çº¿ç¨‹æ¥å¯åŠ¨ä»»åŠ¡ã€‚ Java çº¿ç¨‹é¢è¯•é¢˜ Top 50çº¿ç¨‹\bé€šä¿¡","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Javaé›†åˆæ¡†æ¶æºç åˆ†æ","slug":"Javaé›†åˆæ¡†æ¶æºç åˆ†æ","date":"2017-10-04T13:04:20.000Z","updated":"2018-08-28T11:12:45.681Z","comments":true,"path":"Javaé›†åˆæ¡†æ¶æºç åˆ†æ.html","link":"","permalink":"http://xiaoqinghua.site/Javaé›†åˆæ¡†æ¶æºç åˆ†æ.html","excerpt":"","text":"å¦‚æœæ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œä»¥ä¸‹æºç åˆ†æåŸºäº JDK 1.8 ArrayList1. æ¦‚è§ˆå®ç°äº† RandomAccess æ¥å£ï¼Œå› æ­¤æ”¯æŒéšæœºè®¿é—®ã€‚è¿™æ˜¯ç†æ‰€å½“ç„¶çš„ï¼Œå› ä¸º ArrayList æ˜¯åŸºäºæ•°ç»„å®ç°çš„ã€‚ 12public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable æ•°ç»„çš„é»˜è®¤å¤§å°ä¸º 10ã€‚ 1private static final int DEFAULT_CAPACITY = 10; 2. æ‰©å®¹æ·»åŠ å…ƒç´ æ—¶ä½¿ç”¨ ensureCapacityInternal() æ–¹æ³•æ¥ä¿è¯å®¹é‡è¶³å¤Ÿï¼Œå¦‚æœä¸å¤Ÿæ—¶ï¼Œéœ€è¦ä½¿ç”¨ grow() æ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œæ–°å®¹é‡çš„å¤§å°ä¸º oldCapacity + (oldCapacity &gt;&gt; 1)ï¼Œä¹Ÿå°±æ˜¯æ—§å®¹é‡çš„ 1.5 å€ã€‚ æ‰©å®¹æ“ä½œéœ€è¦è°ƒç”¨ Arrays.copyOf() æŠŠåŸæ•°ç»„æ•´ä¸ªå¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ï¼Œè¿™ä¸ªæ“ä½œä»£ä»·å¾ˆé«˜ï¼Œå› æ­¤æœ€å¥½åœ¨åˆ›å»º ArrayList å¯¹è±¡æ—¶å°±æŒ‡å®šå¤§æ¦‚çš„å®¹é‡å¤§å°ï¼Œå‡å°‘æ‰©å®¹æ“ä½œçš„æ¬¡æ•°ã€‚ 12345678910111213141516171819202122232425262728293031public boolean add(E e) &#123; ensureCapacityInternal(size + 1); // Increments modCount!! elementData[size++] = e; return true;&#125;private void ensureCapacityInternal(int minCapacity) &#123; if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123; minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity); &#125; ensureExplicitCapacity(minCapacity);&#125;private void ensureExplicitCapacity(int minCapacity) &#123; modCount++; // overflow-conscious code if (minCapacity - elementData.length &gt; 0) grow(minCapacity);&#125;private void grow(int minCapacity) &#123; // overflow-conscious code int oldCapacity = elementData.length; int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); if (newCapacity - minCapacity &lt; 0) newCapacity = minCapacity; if (newCapacity - MAX_ARRAY_SIZE &gt; 0) newCapacity = hugeCapacity(minCapacity); // minCapacity is usually close to size, so this is a win: elementData = Arrays.copyOf(elementData, newCapacity);&#125; 3. åˆ é™¤å…ƒç´ éœ€è¦è°ƒç”¨ System.arraycopy() å°† index+1 åé¢çš„å…ƒç´ éƒ½å¤åˆ¶åˆ° index ä½ç½®ä¸Šï¼Œè¯¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(N)ï¼Œå¯ä»¥çœ‹å‡º ArrayList åˆ é™¤å…ƒç´ çš„ä»£ä»·æ˜¯éå¸¸é«˜çš„ã€‚ 12345678910public E remove(int index) &#123; rangeCheck(index); modCount++; E oldValue = elementData(index); int numMoved = size - index - 1; if (numMoved &gt; 0) System.arraycopy(elementData, index+1, elementData, index, numMoved); elementData[--size] = null; // clear to let GC do its work return oldValue;&#125; 4. Fail-FastmodCount ç”¨æ¥è®°å½• ArrayList ç»“æ„å‘ç”Ÿå˜åŒ–çš„æ¬¡æ•°ã€‚ç»“æ„å‘ç”Ÿå˜åŒ–æ˜¯æŒ‡æ·»åŠ æˆ–è€…åˆ é™¤è‡³å°‘ä¸€ä¸ªå…ƒç´ çš„æ‰€æœ‰æ“ä½œï¼Œæˆ–è€…æ˜¯è°ƒæ•´å†…éƒ¨æ•°ç»„çš„å¤§å°ï¼Œä»…ä»…åªæ˜¯è®¾ç½®å…ƒç´ çš„å€¼ä¸ç®—ç»“æ„å‘ç”Ÿå˜åŒ–ã€‚ åœ¨è¿›è¡Œåºåˆ—åŒ–æˆ–è€…è¿­ä»£ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦æ¯”è¾ƒæ“ä½œå‰å modCount æ˜¯å¦æ”¹å˜ï¼Œå¦‚æœæ”¹å˜äº†éœ€è¦æŠ›å‡º ConcurrentModificationExceptionã€‚ 123456789101112131415161718private void writeObject(java.io.ObjectOutputStream s) throws java.io.IOException&#123; // Write out element count, and any hidden stuff int expectedModCount = modCount; s.defaultWriteObject(); // Write out size as capacity for behavioural compatibility with clone() s.writeInt(size); // Write out all elements in the proper order. for (int i=0; i&lt;size; i++) &#123; s.writeObject(elementData[i]); &#125; if (modCount != expectedModCount) &#123; throw new ConcurrentModificationException(); &#125;&#125; 5. åºåˆ—åŒ–ArrayList åŸºäºæ•°ç»„å®ç°ï¼Œå¹¶ä¸”å…·æœ‰åŠ¨æ€æ‰©å®¹ç‰¹æ€§ï¼Œå› æ­¤ä¿å­˜å…ƒç´ çš„æ•°ç»„ä¸ä¸€å®šéƒ½ä¼šè¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦å…¨éƒ¨è¿›è¡Œåºåˆ—åŒ–ã€‚ ä¿å­˜å…ƒç´ çš„æ•°ç»„ elementData ä½¿ç”¨ transient ä¿®é¥°ï¼Œè¯¥å…³é”®å­—å£°æ˜æ•°ç»„é»˜è®¤ä¸ä¼šè¢«åºåˆ—åŒ–ã€‚ 1transient Object[] elementData; // non-private to simplify nested class access ArrayList å®ç°äº† writeObject() å’Œ readObject() æ¥æ§åˆ¶åªåºåˆ—åŒ–æ•°ç»„ä¸­æœ‰å…ƒç´ å¡«å……é‚£éƒ¨åˆ†å†…å®¹ã€‚ 123456789101112131415161718192021private void readObject(java.io.ObjectInputStream s) throws java.io.IOException, ClassNotFoundException &#123; elementData = EMPTY_ELEMENTDATA; // Read in size, and any hidden stuff s.defaultReadObject(); // Read in capacity s.readInt(); // ignored if (size &gt; 0) &#123; // be like clone(), allocate array based upon size not capacity ensureCapacityInternal(size); Object[] a = elementData; // Read in all elements in the proper order. for (int i=0; i&lt;size; i++) &#123; a[i] = s.readObject(); &#125; &#125;&#125; 123456789101112131415161718private void writeObject(java.io.ObjectOutputStream s) throws java.io.IOException&#123; // Write out element count, and any hidden stuff int expectedModCount = modCount; s.defaultWriteObject(); // Write out size as capacity for behavioural compatibility with clone() s.writeInt(size); // Write out all elements in the proper order. for (int i=0; i&lt;size; i++) &#123; s.writeObject(elementData[i]); &#125; if (modCount != expectedModCount) &#123; throw new ConcurrentModificationException(); &#125;&#125; åºåˆ—åŒ–æ—¶éœ€è¦ä½¿ç”¨ ObjectOutputStream çš„ writeObject() å°†å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµå¹¶è¾“å‡ºã€‚è€Œ writeObject() æ–¹æ³•åœ¨ä¼ å…¥çš„å¯¹è±¡å­˜åœ¨ writeObject() çš„æ—¶å€™ä¼šå»åå°„è°ƒç”¨è¯¥å¯¹è±¡çš„ writeObject() æ¥å®ç°åºåˆ—åŒ–ã€‚ååºåˆ—åŒ–ä½¿ç”¨çš„æ˜¯ ObjectInputStream çš„ readObject() æ–¹æ³•ï¼ŒåŸç†ç±»ä¼¼ã€‚ 123ArrayList list = new ArrayList();ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file));oos.writeObject(list); Vector1. åŒæ­¥å®ƒçš„å®ç°ä¸ ArrayList ç±»ä¼¼ï¼Œä½†æ˜¯ä½¿ç”¨äº† synchronized è¿›è¡ŒåŒæ­¥ã€‚ 123456public synchronized boolean add(E e) &#123; modCount++; ensureCapacityHelper(elementCount + 1); elementData[elementCount++] = e; return true;&#125; 123456public synchronized E get(int index) &#123; if (index &gt;= elementCount) throw new ArrayIndexOutOfBoundsException(index); return elementData(index);&#125; 2. ä¸ ArrayList çš„æ¯”è¾ƒVector æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤å¼€é”€å°±æ¯” ArrayList è¦å¤§ï¼Œè®¿é—®é€Ÿåº¦æ›´æ…¢ã€‚æœ€å¥½ä½¿ç”¨ ArrayList è€Œä¸æ˜¯ Vectorï¼Œå› ä¸ºåŒæ­¥æ“ä½œå®Œå…¨å¯ä»¥ç”±ç¨‹åºå‘˜è‡ªå·±æ¥æ§åˆ¶ï¼›Vector æ¯æ¬¡æ‰©å®¹è¯·æ±‚å…¶å¤§å°çš„ 2 å€ç©ºé—´ï¼Œè€Œ ArrayList æ˜¯ 1.5 å€ã€‚ 3. æ›¿ä»£æ–¹æ¡ˆå¯ä»¥ä½¿ç”¨ Collections.synchronizedList(); å¾—åˆ°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ ArrayListã€‚ 12List&lt;String&gt; list = new ArrayList&lt;&gt;();List&lt;String&gt; synList = Collections.synchronizedList(list); ä¹Ÿå¯ä»¥ä½¿ç”¨ concurrent å¹¶å‘åŒ…ä¸‹çš„ CopyOnWriteArrayList ç±»ã€‚ 1List&lt;String&gt; list = new CopyOnWriteArrayList&lt;&gt;(); CopyOnWriteArrayListè¯»å†™åˆ†ç¦»å†™æ“ä½œåœ¨ä¸€ä¸ªå¤åˆ¶çš„æ•°ç»„ä¸Šè¿›è¡Œï¼Œè¯»æ“ä½œè¿˜æ˜¯åœ¨åŸå§‹æ•°ç»„ä¸­è¿›è¡Œï¼Œè¯»å†™åˆ†ç¦»ï¼Œäº’ä¸å½±å“ã€‚ å†™æ“ä½œéœ€è¦åŠ é”ï¼Œé˜²æ­¢å¹¶å‘å†™å…¥æ—¶å¯¼è‡´å†™å…¥æ•°æ®ä¸¢å¤±ã€‚ å†™æ“ä½œç»“æŸä¹‹åéœ€è¦æŠŠåŸå§‹æ•°ç»„æŒ‡å‘æ–°çš„å¤åˆ¶æ•°ç»„ã€‚ 1234567891011121314public boolean add(E e) &#123; final ReentrantLock lock = this.lock; lock.lock(); try &#123; Object[] elements = getArray(); int len = elements.length; Object[] newElements = Arrays.copyOf(elements, len + 1); newElements[len] = e; setArray(newElements); return true; &#125; finally &#123; lock.unlock(); &#125;&#125; 1234567final void setArray(Object[] a) &#123; array = a;&#125;@SuppressWarnings(\"unchecked\")private E get(Object[] a, int index) &#123; return (E) a[index];&#125; é€‚ç”¨åœºæ™¯CopyOnWriteArrayList åœ¨å†™æ“ä½œçš„åŒæ—¶å…è®¸è¯»æ“ä½œï¼Œå¤§å¤§æé«˜äº†è¯»æ“ä½œçš„æ€§èƒ½ï¼Œå› æ­¤å¾ˆé€‚åˆè¯»å¤šå†™å°‘çš„åº”ç”¨åœºæ™¯ã€‚ ä½†æ˜¯ CopyOnWriteArrayList æœ‰å…¶ç¼ºé™·ï¼š å†…å­˜å ç”¨ï¼šåœ¨å†™æ“ä½œæ—¶éœ€è¦å¤åˆ¶ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œä½¿å¾—å†…å­˜å ç”¨ä¸ºåŸæ¥çš„ä¸¤å€å·¦å³ï¼› æ•°æ®ä¸ä¸€è‡´ï¼šè¯»æ“ä½œä¸èƒ½è¯»å–å®æ—¶æ€§çš„æ•°æ®ï¼Œå› ä¸ºéƒ¨åˆ†å†™æ“ä½œçš„æ•°æ®è¿˜æœªåŒæ­¥åˆ°è¯»æ•°ç»„ä¸­ã€‚ æ‰€ä»¥ CopyOnWriteArrayList ä¸é€‚åˆå†…å­˜æ•æ„Ÿä»¥åŠå¯¹å®æ—¶æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ã€‚ LinkedList1. æ¦‚è§ˆåŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œä½¿ç”¨ Node å­˜å‚¨é“¾è¡¨èŠ‚ç‚¹ä¿¡æ¯ã€‚ 12345private static class Node&lt;E&gt; &#123; E item; Node&lt;E&gt; next; Node&lt;E&gt; prev;&#125; æ¯ä¸ªé“¾è¡¨å­˜å‚¨äº† first å’Œ last æŒ‡é’ˆï¼š 12transient Node&lt;E&gt; first;transient Node&lt;E&gt; last; 2. ä¸ ArrayList çš„æ¯”è¾ƒ ArrayList åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼ŒLinkedList åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼› ArrayList æ”¯æŒéšæœºè®¿é—®ï¼ŒLinkedList ä¸æ”¯æŒï¼› LinkedList åœ¨ä»»æ„ä½ç½®æ·»åŠ åˆ é™¤å…ƒç´ æ›´å¿«ã€‚ HashMapä¸ºäº†ä¾¿äºç†è§£ï¼Œä»¥ä¸‹æºç åˆ†æä»¥ JDK 1.7 ä¸ºä¸»ã€‚ 1. å­˜å‚¨ç»“æ„å†…éƒ¨åŒ…å«äº†ä¸€ä¸ª Entry ç±»å‹çš„æ•°ç»„ tableã€‚ 1transient Entry[] table; Entry å­˜å‚¨ç€é”®å€¼å¯¹ã€‚å®ƒåŒ…å«äº†å››ä¸ªå­—æ®µï¼Œä» next å­—æ®µæˆ‘ä»¬å¯ä»¥çœ‹å‡º Entry æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚å³æ•°ç»„ä¸­çš„æ¯ä¸ªä½ç½®è¢«å½“æˆä¸€ä¸ªæ¡¶ï¼Œä¸€ä¸ªæ¡¶å­˜æ”¾ä¸€ä¸ªé“¾è¡¨ã€‚HashMap ä½¿ç”¨æ‹‰é“¾æ³•æ¥è§£å†³å†²çªï¼ŒåŒä¸€ä¸ªé“¾è¡¨ä¸­å­˜æ”¾å“ˆå¸Œå€¼ç›¸åŒçš„ Entryã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950static class Entry&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; &#123; final K key; V value; Entry&lt;K,V&gt; next; int hash; Entry(int h, K k, V v, Entry&lt;K,V&gt; n) &#123; value = v; next = n; key = k; hash = h; &#125; public final K getKey() &#123; return key; &#125; public final V getValue() &#123; return value; &#125; public final V setValue(V newValue) &#123; V oldValue = value; value = newValue; return oldValue; &#125; public final boolean equals(Object o) &#123; if (!(o instanceof Map.Entry)) return false; Map.Entry e = (Map.Entry)o; Object k1 = getKey(); Object k2 = e.getKey(); if (k1 == k2 || (k1 != null &amp;&amp; k1.equals(k2))) &#123; Object v1 = getValue(); Object v2 = e.getValue(); if (v1 == v2 || (v1 != null &amp;&amp; v1.equals(v2))) return true; &#125; return false; &#125; public final int hashCode() &#123; return Objects.hashCode(getKey()) ^ Objects.hashCode(getValue()); &#125; public final String toString() &#123; return getKey() + \"=\" + getValue(); &#125;&#125; 2. æ‹‰é“¾æ³•çš„å·¥ä½œåŸç†1234HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();map.put(\"K1\", \"V1\");map.put(\"K2\", \"V2\");map.put(\"K3\", \"V3\"); æ–°å»ºä¸€ä¸ª HashMapï¼Œé»˜è®¤å¤§å°ä¸º 16ï¼› æ’å…¥ &lt;K1,V1&gt; é”®å€¼å¯¹ï¼Œå…ˆè®¡ç®— K1 çš„ hashCode ä¸º 115ï¼Œä½¿ç”¨é™¤ç•™ä½™æ•°æ³•å¾—åˆ°æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ 115%16=3ã€‚ æ’å…¥ &lt;K2,V2&gt; é”®å€¼å¯¹ï¼Œå…ˆè®¡ç®— K2 çš„ hashCode ä¸º 118ï¼Œä½¿ç”¨é™¤ç•™ä½™æ•°æ³•å¾—åˆ°æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ 118%16=6ã€‚ æ’å…¥ &lt;K3,V3&gt; é”®å€¼å¯¹ï¼Œå…ˆè®¡ç®— K3 çš„ hashCode ä¸º 118ï¼Œä½¿ç”¨é™¤ç•™ä½™æ•°æ³•å¾—åˆ°æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ 118%16=6ï¼Œæ’åœ¨ &lt;K2,V2&gt; å‰é¢ã€‚ åº”è¯¥æ³¨æ„åˆ°é“¾è¡¨çš„æ’å…¥æ˜¯ä»¥å¤´æ’æ³•æ–¹å¼è¿›è¡Œçš„ï¼Œä¾‹å¦‚ä¸Šé¢çš„ &lt;K3,V3&gt; ä¸æ˜¯æ’åœ¨ &lt;K2,V2&gt; åé¢ï¼Œè€Œæ˜¯æ’å…¥åœ¨é“¾è¡¨å¤´éƒ¨ã€‚ æŸ¥æ‰¾éœ€è¦åˆ†æˆä¸¤æ­¥è¿›è¡Œï¼š è®¡ç®—é”®å€¼å¯¹æ‰€åœ¨çš„æ¡¶ï¼› åœ¨é“¾è¡¨ä¸Šé¡ºåºæŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¾ç„¶å’Œé“¾è¡¨çš„é•¿åº¦æˆæ­£æ¯”ã€‚ 3. put æ“ä½œ1234567891011121314151617181920212223242526public V put(K key, V value) &#123; if (table == EMPTY_TABLE) &#123; inflateTable(threshold); &#125; // é”®ä¸º null å•ç‹¬å¤„ç† if (key == null) return putForNullKey(value); int hash = hash(key); // ç¡®å®šæ¡¶ä¸‹æ ‡ int i = indexFor(hash, table.length); // å…ˆæ‰¾å‡ºæ˜¯å¦å·²ç»å­˜åœ¨é”®ä¸º key çš„é”®å€¼å¯¹ï¼Œå¦‚æœå­˜åœ¨çš„è¯å°±æ›´æ–°è¿™ä¸ªé”®å€¼å¯¹çš„å€¼ä¸º value for (Entry&lt;K,V&gt; e = table[i]; e != null; e = e.next) &#123; Object k; if (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) &#123; V oldValue = e.value; e.value = value; e.recordAccess(this); return oldValue; &#125; &#125; modCount++; // æ’å…¥æ–°é”®å€¼å¯¹ addEntry(hash, key, value, i); return null;&#125; HashMap å…è®¸æ’å…¥é”®ä¸º null çš„é”®å€¼å¯¹ã€‚ä½†æ˜¯å› ä¸ºæ— æ³•è°ƒç”¨ null çš„ hashCode() æ–¹æ³•ï¼Œä¹Ÿå°±æ— æ³•ç¡®å®šè¯¥é”®å€¼å¯¹çš„æ¡¶ä¸‹æ ‡ï¼Œåªèƒ½é€šè¿‡å¼ºåˆ¶æŒ‡å®šä¸€ä¸ªæ¡¶ä¸‹æ ‡æ¥å­˜æ”¾ã€‚HashMap ä½¿ç”¨ç¬¬ 0 ä¸ªæ¡¶å­˜æ”¾é”®ä¸º null çš„é”®å€¼å¯¹ã€‚ 12345678910111213private V putForNullKey(V value) &#123; for (Entry&lt;K,V&gt; e = table[0]; e != null; e = e.next) &#123; if (e.key == null) &#123; V oldValue = e.value; e.value = value; e.recordAccess(this); return oldValue; &#125; &#125; modCount++; addEntry(0, null, value, 0); return null;&#125; ä½¿ç”¨é“¾è¡¨çš„å¤´æ’æ³•ï¼Œä¹Ÿå°±æ˜¯æ–°çš„é”®å€¼å¯¹æ’åœ¨é“¾è¡¨çš„å¤´éƒ¨ï¼Œè€Œä¸æ˜¯é“¾è¡¨çš„å°¾éƒ¨ã€‚ 12345678910111213141516void addEntry(int hash, K key, V value, int bucketIndex) &#123; if ((size &gt;= threshold) &amp;&amp; (null != table[bucketIndex])) &#123; resize(2 * table.length); hash = (null != key) ? hash(key) : 0; bucketIndex = indexFor(hash, table.length); &#125; createEntry(hash, key, value, bucketIndex);&#125;void createEntry(int hash, K key, V value, int bucketIndex) &#123; Entry&lt;K,V&gt; e = table[bucketIndex]; // å¤´æ’æ³•ï¼Œé“¾è¡¨å¤´éƒ¨æŒ‡å‘æ–°çš„é”®å€¼å¯¹ table[bucketIndex] = new Entry&lt;&gt;(hash, key, value, e); size++;&#125; 123456Entry(int h, K k, V v, Entry&lt;K,V&gt; n) &#123; value = v; next = n; key = k; hash = h;&#125; 4. ç¡®å®šæ¡¶ä¸‹æ ‡å¾ˆå¤šæ“ä½œéƒ½éœ€è¦å…ˆç¡®å®šä¸€ä¸ªé”®å€¼å¯¹æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ã€‚ 12int hash = hash(key);int i = indexFor(hash, table.length); 1.è®¡ç®— hash å€¼ 1234567891011121314151617final int hash(Object k) &#123; int h = hashSeed; if (0 != h &amp;&amp; k instanceof String) &#123; return sun.misc.Hashing.stringHash32((String) k); &#125; h ^= k.hashCode(); // This function ensures that hashCodes that differ only by // constant multiples at each bit position have a bounded // number of collisions (approximately 8 at default load factor). h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12); return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4);&#125;public final int hashCode() &#123; return Objects.hashCode(key) ^ Objects.hashCode(value);&#125; 2.å–æ¨¡ ä»¤ x = 1&lt;&lt;4ï¼Œå³ x ä¸º 2 çš„ 4 æ¬¡æ–¹ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š 12x : 00010000x-1 : 00001111 ä»¤ä¸€ä¸ªæ•° y ä¸ x-1 åšä¸è¿ç®—ï¼Œå¯ä»¥å»é™¤ y ä½çº§è¡¨ç¤ºçš„ç¬¬ 4 ä½ä»¥ä¸Šæ•°ï¼š 123y : 10110010x-1 : 00001111y&amp;(x-1) : 00000010 è¿™ä¸ªæ€§è´¨å’Œ y å¯¹ x å–æ¨¡æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼š 123y : 10110010x : 00010000y%x : 00000010 æˆ‘ä»¬çŸ¥é“ï¼Œä½è¿ç®—çš„ä»£ä»·æ¯”æ±‚æ¨¡è¿ç®—å°çš„å¤šï¼Œå› æ­¤åœ¨è¿›è¡Œè¿™ç§è®¡ç®—æ—¶ç”¨ä½è¿ç®—çš„è¯èƒ½å¸¦æ¥æ›´é«˜çš„æ€§èƒ½ã€‚ ç¡®å®šæ¡¶ä¸‹æ ‡çš„æœ€åä¸€æ­¥æ˜¯å°† key çš„ hash å€¼å¯¹æ¡¶ä¸ªæ•°å–æ¨¡ï¼šhash%capacityï¼Œå¦‚æœèƒ½ä¿è¯ capacity ä¸º 2 çš„ n æ¬¡æ–¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†è¿™ä¸ªæ“ä½œè½¬æ¢ä¸ºä½è¿ç®—ã€‚ 123static int indexFor(int h, int length) &#123; return h &amp; (length-1);&#125; 5. æ‰©å®¹-åŸºæœ¬åŸç†è®¾ HashMap çš„ table é•¿åº¦ä¸º Mï¼Œéœ€è¦å­˜å‚¨çš„é”®å€¼å¯¹æ•°é‡ä¸º Nï¼Œå¦‚æœå“ˆå¸Œå‡½æ•°æ»¡è¶³å‡åŒ€æ€§çš„è¦æ±‚ï¼Œé‚£ä¹ˆæ¯æ¡é“¾è¡¨çš„é•¿åº¦å¤§çº¦ä¸º N/Mï¼Œå› æ­¤å¹³å‡æŸ¥æ‰¾æ¬¡æ•°çš„å¤æ‚åº¦ä¸ºO(N/M)ã€‚ ä¸ºäº†è®©æŸ¥æ‰¾çš„æˆæœ¬é™ä½ï¼Œåº”è¯¥å°½å¯èƒ½ä½¿å¾—N/M å°½å¯èƒ½å°ï¼Œå› æ­¤éœ€è¦ä¿è¯ M å°½å¯èƒ½å¤§ï¼Œä¹Ÿå°±æ˜¯è¯´ table è¦å°½å¯èƒ½å¤§ã€‚HashMap é‡‡ç”¨åŠ¨æ€æ‰©å®¹æ¥æ ¹æ®å½“å‰çš„N å€¼æ¥è°ƒæ•´ M å€¼ï¼Œä½¿å¾—ç©ºé—´æ•ˆç‡å’Œæ—¶é—´æ•ˆç‡éƒ½èƒ½å¾—åˆ°ä¿è¯ã€‚ å’Œæ‰©å®¹ç›¸å…³çš„å‚æ•°ä¸»è¦æœ‰ï¼šcapacityã€sizeã€threshold å’Œ load_factorã€‚ capacityï¼štable çš„å®¹é‡å¤§å°ï¼Œé»˜è®¤ä¸º 16ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ capacity å¿…é¡»ä¿è¯ä¸º 2 çš„ n æ¬¡æ–¹ã€‚ sizeï¼štable çš„å®é™…ä½¿ç”¨é‡ã€‚ thresholdï¼šsize çš„ä¸´ç•Œå€¼ï¼Œsize å¿…é¡»å°äº thresholdï¼Œå¦‚æœå¤§äºç­‰äºï¼Œå°±å¿…é¡»è¿›è¡Œæ‰©å®¹æ“ä½œã€‚ loadFactorï¼šè£…è½½å› å­ï¼Œtable èƒ½å¤Ÿä½¿ç”¨çš„æ¯”ä¾‹ï¼Œthreshold = capacity * loadFactorã€‚ 123456789101112131415static final int DEFAULT_INITIAL_CAPACITY = 16;static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;static final float DEFAULT_LOAD_FACTOR = 0.75f;transient Entry[] table;transient int size;int threshold;final float loadFactor;transient int modCount; ä»ä¸‹é¢çš„æ·»åŠ å…ƒç´ ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“éœ€è¦æ‰©å®¹æ—¶ï¼Œä»¤ capacity ä¸ºåŸæ¥çš„ä¸¤å€ã€‚ 123456void addEntry(int hash, K key, V value, int bucketIndex) &#123; Entry&lt;K,V&gt; e = table[bucketIndex]; table[bucketIndex] = new Entry&lt;&gt;(hash, key, value, e); if (size++ &gt;= threshold) resize(2 * table.length);&#125; 123456789101112131415161718192021222324252627282930void resize(int newCapacity) &#123; Entry[] oldTable = table; int oldCapacity = oldTable.length; if (oldCapacity == MAXIMUM_CAPACITY) &#123; threshold = Integer.MAX_VALUE; return; &#125; Entry[] newTable = new Entry[newCapacity]; transfer(newTable); table = newTable; threshold = (int)(newCapacity * loadFactor);&#125;void transfer(Entry[] newTable) &#123; Entry[] src = table; int newCapacity = newTable.length; for (int j = 0; j &lt; src.length; j++) &#123; Entry&lt;K,V&gt; e = src[j]; if (e != null) &#123; src[j] = null; do &#123; Entry&lt;K,V&gt; next = e.next; int i = indexFor(e.hash, newCapacity); e.next = newTable[i]; newTable[i] = e; e = next; &#125; while (e != null); &#125; &#125;&#125; 6. æ‰©å®¹-é‡æ–°è®¡ç®—æ¡¶ä¸‹æ ‡åœ¨è¿›è¡Œæ‰©å®¹æ—¶ï¼Œéœ€è¦æŠŠé”®å€¼å¯¹é‡æ–°æ”¾åˆ°å¯¹åº”çš„æ¡¶ä¸Šã€‚HashMap ä½¿ç”¨äº†ä¸€ä¸ªç‰¹æ®Šçš„æœºåˆ¶ï¼Œå¯ä»¥é™ä½é‡æ–°è®¡ç®—æ¡¶ä¸‹æ ‡çš„æ“ä½œã€‚ å‡è®¾åŸæ•°ç»„é•¿åº¦ capacity ä¸º 16ï¼Œæ‰©å®¹ä¹‹å new capacity ä¸º 32ï¼š 12capacity : 00010000new capacity : 00100000 å¯¹äºä¸€ä¸ª Keyï¼Œ å®ƒçš„å“ˆå¸Œå€¼å¦‚æœåœ¨ç¬¬ 5 ä½ä¸Šä¸º 0ï¼Œé‚£ä¹ˆå–æ¨¡å¾—åˆ°çš„ç»“æœå’Œä¹‹å‰ä¸€æ ·ï¼› å¦‚æœä¸º 1ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç»“æœä¸ºåŸæ¥çš„ç»“æœ+16ã€‚ 7. æ‰©å®¹-è®¡ç®—æ•°ç»„å®¹é‡HashMap æ„é€ å‡½æ•°å…è®¸ç”¨æˆ·ä¼ å…¥çš„å®¹é‡ä¸æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼Œå› ä¸ºå®ƒå¯ä»¥è‡ªåŠ¨åœ°å°†ä¼ å…¥çš„å®¹é‡è½¬æ¢ä¸º 2 çš„ n æ¬¡æ–¹ã€‚ å…ˆè€ƒè™‘å¦‚ä½•æ±‚ä¸€ä¸ªæ•°çš„æ©ç ï¼Œå¯¹äº 10010000ï¼Œå®ƒçš„æ©ç ä¸º 11111111ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å¾—åˆ°ï¼š 123mask |= mask &gt;&gt; 1 11011000mask |= mask &gt;&gt; 2 11111100mask |= mask &gt;&gt; 4 11111111 mask+1 æ˜¯å¤§äºåŸå§‹æ•°å­—çš„æœ€å°çš„ 2 çš„ n æ¬¡æ–¹ã€‚ 12num 10010000mask+1 100000000 ä»¥ä¸‹æ˜¯ HashMap ä¸­è®¡ç®—æ•°ç»„å®¹é‡çš„ä»£ç ï¼š 123456789static final int tableSizeFor(int cap) &#123; int n = cap - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;&#125; 8. é“¾è¡¨è½¬çº¢é»‘æ ‘ä» JDK 1.8 å¼€å§‹ï¼Œä¸€ä¸ªæ¡¶å­˜å‚¨çš„é“¾è¡¨é•¿åº¦å¤§äº 8 æ—¶ä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚ 9. ä¸ HashTable çš„æ¯”è¾ƒ HashTable ä½¿ç”¨ synchronized æ¥è¿›è¡ŒåŒæ­¥ã€‚ HashMap å¯ä»¥æ’å…¥é”®ä¸º null çš„ Entryã€‚ HashMap çš„è¿­ä»£å™¨æ˜¯ fail-fast è¿­ä»£å™¨ã€‚ HashMap ä¸èƒ½ä¿è¯éšç€æ—¶é—´çš„æ¨ç§» Map ä¸­çš„å…ƒç´ æ¬¡åºæ˜¯ä¸å˜çš„ã€‚ ConcurrentHashMap å­˜å‚¨ç»“æ„ 123456static final class HashEntry&lt;K,V&gt; &#123; final int hash; final K key; volatile V value; volatile HashEntry&lt;K,V&gt; next;&#125; ConcurrentHashMap å’Œ HashMap å®ç°ä¸Šç±»ä¼¼ï¼Œæœ€ä¸»è¦çš„å·®åˆ«æ˜¯ ConcurrentHashMap é‡‡ç”¨äº†åˆ†æ®µé”ï¼ˆSegmentï¼‰ï¼Œæ¯ä¸ªåˆ†æ®µé”ç»´æŠ¤ç€å‡ ä¸ªæ¡¶ï¼ˆHashEntryï¼‰ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®ä¸åŒåˆ†æ®µé”ä¸Šçš„æ¡¶ï¼Œä»è€Œä½¿å…¶å¹¶å‘åº¦æ›´é«˜ï¼ˆå¹¶å‘åº¦å°±æ˜¯ Segment çš„ä¸ªæ•°ï¼‰ã€‚ Segment ç»§æ‰¿è‡ª ReentrantLockã€‚ 1234567891011121314151617static final class Segment&lt;K,V&gt; extends ReentrantLock implements Serializable &#123; private static final long serialVersionUID = 2249069246763182397L; static final int MAX_SCAN_RETRIES = Runtime.getRuntime().availableProcessors() &gt; 1 ? 64 : 1; transient volatile HashEntry&lt;K,V&gt;[] table; transient int count; transient int modCount; transient int threshold; final float loadFactor;&#125; 1final Segment&lt;K,V&gt;[] segments; é»˜è®¤çš„å¹¶å‘çº§åˆ«ä¸º 16ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤åˆ›å»º 16 ä¸ª Segmentã€‚ 1static final int DEFAULT_CONCURRENCY_LEVEL = 16; 2. size æ“ä½œæ¯ä¸ª Segment ç»´æŠ¤äº†ä¸€ä¸ª count å˜é‡æ¥ç»Ÿè®¡è¯¥ Segment ä¸­çš„é”®å€¼å¯¹ä¸ªæ•°ã€‚ 12345/** * The number of elements. Accessed only either within locks * or among other volatile reads that maintain visibility. */transient int count; åœ¨æ‰§è¡Œ size æ“ä½œæ—¶ï¼Œéœ€è¦éå†æ‰€æœ‰ Segment ç„¶åæŠŠ count ç´¯è®¡èµ·æ¥ã€‚ ConcurrentHashMap åœ¨æ‰§è¡Œ size æ“ä½œæ—¶å…ˆå°è¯•ä¸åŠ é”ï¼Œå¦‚æœè¿ç»­ä¸¤æ¬¡ä¸åŠ é”æ“ä½œå¾—åˆ°çš„ç»“æœä¸€è‡´ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„ã€‚ å°è¯•æ¬¡æ•°ä½¿ç”¨ RETRIES_BEFORE_LOCK å®šä¹‰ï¼Œè¯¥å€¼ä¸º 2ï¼Œretries åˆå§‹å€¼ä¸º -1ï¼Œå› æ­¤å°è¯•æ¬¡æ•°ä¸º 3ã€‚ å¦‚æœå°è¯•çš„æ¬¡æ•°è¶…è¿‡ 3 æ¬¡ï¼Œå°±éœ€è¦å¯¹æ¯ä¸ª Segment åŠ é”ã€‚ 1234567/** * Number of unsynchronized retries in size and containsValue * methods before resorting to locking. This is used to avoid * unbounded retries if tables undergo continuous modification * which would make it impossible to obtain an accurate result. */static final int RETRIES_BEFORE_LOCK = 2; 1234567891011121314151617181920212223242526272829303132333435363738394041public int size() &#123; // Try a few times to get accurate count. On failure due to // continuous async changes in table, resort to locking. final Segment&lt;K,V&gt;[] segments = this.segments; int size; boolean overflow; // true if size overflows 32 bits long sum; // sum of modCounts long last = 0L; // previous sum int retries = -1; // first iteration isn't retry try &#123; for (;;) &#123; // è¶…è¿‡å°è¯•æ¬¡æ•°ï¼Œåˆ™å¯¹æ¯ä¸ª Segment åŠ é” if (retries++ == RETRIES_BEFORE_LOCK) &#123; for (int j = 0; j &lt; segments.length; ++j) ensureSegment(j).lock(); // force creation &#125; sum = 0L; size = 0; overflow = false; for (int j = 0; j &lt; segments.length; ++j) &#123; Segment&lt;K,V&gt; seg = segmentAt(segments, j); if (seg != null) &#123; sum += seg.modCount; int c = seg.count; if (c &lt; 0 || (size += c) &lt; 0) overflow = true; &#125; &#125; // è¿ç»­ä¸¤æ¬¡å¾—åˆ°çš„ç»“æœä¸€è‡´ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„ if (sum == last) break; last = sum; &#125; &#125; finally &#123; if (retries &gt; RETRIES_BEFORE_LOCK) &#123; for (int j = 0; j &lt; segments.length; ++j) segmentAt(segments, j).unlock(); &#125; &#125; return overflow ? Integer.MAX_VALUE : size;&#125; 3. JDK 1.8 çš„æ”¹åŠ¨JDK 1.7 ä½¿ç”¨åˆ†æ®µé”æœºåˆ¶æ¥å®ç°å¹¶å‘æ›´æ–°æ“ä½œï¼Œæ ¸å¿ƒç±»ä¸º Segmentï¼Œå®ƒç»§æ‰¿è‡ªé‡å…¥é” ReentrantLockï¼Œå¹¶å‘åº¦ä¸ Segment æ•°é‡ç›¸ç­‰ã€‚ JDK 1.8 ä½¿ç”¨äº† CASæ“ä½œæ¥æ”¯æŒæ›´é«˜çš„å¹¶å‘åº¦ï¼Œåœ¨CAS æ“ä½œå¤±è´¥æ—¶ä½¿ç”¨å†…ç½®é” synchronizedã€‚ å¹¶ä¸” JDK 1.8 çš„å®ç°ä¹Ÿåœ¨é“¾è¡¨è¿‡é•¿æ—¶ä¼šè½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚ LinkedHashMapå­˜å‚¨ç»“æ„ç»§æ‰¿è‡ª HashMapï¼Œå› æ­¤å…·æœ‰å’Œ HashMap ä¸€æ ·çš„å¿«é€ŸæŸ¥æ‰¾ç‰¹æ€§ã€‚ 1public class LinkedHashMap&lt;K,V&gt; extends HashMap&lt;K,V&gt; implements Map&lt;K,V&gt; å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œç”¨æ¥ç»´æŠ¤æ’å…¥é¡ºåºæˆ–è€… LRU é¡ºåºã€‚ 123456789/** * The head (eldest) of the doubly linked list. */transient LinkedHashMap.Entry&lt;K,V&gt; head;/** * The tail (youngest) of the doubly linked list. */transient LinkedHashMap.Entry&lt;K,V&gt; tail; accessOrder å†³å®šäº†é¡ºåºï¼Œé»˜è®¤ä¸º falseï¼Œæ­¤æ—¶ç»´æŠ¤çš„æ˜¯æ’å…¥é¡ºåºã€‚ 1final boolean accessOrder; LinkedHashMap æœ€é‡è¦çš„æ˜¯ä»¥ä¸‹ç”¨äºç»´æŠ¤é¡ºåºçš„å‡½æ•°ï¼Œå®ƒä»¬ä¼šåœ¨ putã€get ç­‰æ–¹æ³•ä¸­è°ƒç”¨ã€‚ 12void afterNodeAccess(Node&lt;K,V&gt; p) &#123; &#125;void afterNodeInsertion(boolean evict) &#123; &#125; afterNodeAccess()å½“ä¸€ä¸ªèŠ‚ç‚¹è¢«è®¿é—®æ—¶ï¼Œå¦‚æœ accessOrder ä¸º trueï¼Œåˆ™ä¼šå°†è¯¥èŠ‚ç‚¹ç§»åˆ°é“¾è¡¨å°¾éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´æŒ‡å®šä¸º LRU é¡ºåºä¹‹åï¼Œåœ¨æ¯æ¬¡è®¿é—®ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œä¼šå°†è¿™ä¸ªèŠ‚ç‚¹ç§»åˆ°é“¾è¡¨å°¾éƒ¨ï¼Œä¿è¯é“¾è¡¨å°¾éƒ¨æ˜¯æœ€è¿‘è®¿é—®çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆé“¾è¡¨é¦–éƒ¨å°±æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ã€‚ 123456789101112131415161718192021222324void afterNodeAccess(Node&lt;K,V&gt; e) &#123; // move node to last LinkedHashMap.Entry&lt;K,V&gt; last; if (accessOrder &amp;&amp; (last = tail) != e) &#123; LinkedHashMap.Entry&lt;K,V&gt; p = (LinkedHashMap.Entry&lt;K,V&gt;)e, b = p.before, a = p.after; p.after = null; if (b == null) head = a; else b.after = a; if (a != null) a.before = b; else last = b; if (last == null) head = p; else &#123; p.before = last; last.after = p; &#125; tail = p; ++modCount; &#125;&#125; afterNodeInsertion()åœ¨ put ç­‰æ“ä½œä¹‹åæ‰§è¡Œï¼Œå½“ removeEldestEntry() æ–¹æ³•è¿”å› ture æ—¶ä¼šç§»é™¤æœ€æ™šçš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨é¦–éƒ¨èŠ‚ç‚¹ firstã€‚ evict åªæœ‰åœ¨æ„å»º Map çš„æ—¶å€™æ‰ä¸º falseï¼Œåœ¨è¿™é‡Œä¸º trueã€‚ 1234567void afterNodeInsertion(boolean evict) &#123; // possibly remove eldest LinkedHashMap.Entry&lt;K,V&gt; first; if (evict &amp;&amp; (first = head) != null &amp;&amp; removeEldestEntry(first)) &#123; K key = first.key; removeNode(hash(key), key, null, false, true); &#125;&#125; removeEldestEntry() é»˜è®¤ä¸º falseï¼Œå¦‚æœéœ€è¦è®©å®ƒä¸º trueï¼Œéœ€è¦ç»§æ‰¿ LinkedHashMap å¹¶ä¸”è¦†ç›–è¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼Œè¿™åœ¨å®ç° LRU çš„ç¼“å­˜ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œé€šè¿‡ç§»é™¤æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯ç¼“å­˜ç©ºé—´è¶³å¤Ÿï¼Œå¹¶ä¸”ç¼“å­˜çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ã€‚ 123protected boolean removeEldestEntry(Map.Entry&lt;K,V&gt; eldest) &#123; return false;&#125; LRU ç¼“å­˜ä»¥ä¸‹æ˜¯ä½¿ç”¨ LinkedHashMap å®ç°çš„ä¸€ä¸ª LRU ç¼“å­˜ï¼š è®¾å®šæœ€å¤§ç¼“å­˜ç©ºé—´ MAX_ENTRIES ä¸º 3ï¼› ä½¿ç”¨ LinkedHashMap çš„æ„é€ å‡½æ•°å°† accessOrder è®¾ç½®ä¸º trueï¼Œå¼€å¯ LRU é¡ºåºï¼› è¦†ç›– removeEldestEntry() æ–¹æ³•å®ç°ï¼Œåœ¨èŠ‚ç‚¹å¤šäº MAX_ENTRIES å°±ä¼šå°†æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ç§»é™¤ã€‚ 12345678910111213141516171819202122class LRUCache&lt;K, V&gt; extends LinkedHashMap&lt;K, V&gt; &#123; private static final int MAX_ENTRIES = 3; protected boolean removeEldestEntry(Map.Entry eldest) &#123; return size() &gt; MAX_ENTRIES; &#125; LRUCache() &#123; super(MAX_ENTRIES, 0.75f, true); &#125;&#125;public static void main(String[] args) &#123; LRUCache&lt;Integer, String&gt; cache = new LRUCache&lt;&gt;(); cache.put(1, \"a\"); cache.put(2, \"b\"); cache.put(3, \"c\"); cache.get(1); cache.put(4, \"d\"); System.out.println(cache.keySet());&#125;[3, 1, 4] WeekHashMapå­˜å‚¨ç»“æ„ WeakHashMap çš„ Entry ç»§æ‰¿è‡ª WeakReferenceï¼Œè¢« WeakReference å…³è”çš„å¯¹è±¡åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶ä¼šè¢«å›æ”¶ã€‚ WeakHashMap ä¸»è¦ç”¨æ¥å®ç°ç¼“å­˜ï¼Œé€šè¿‡ä½¿ç”¨ WeakHashMap æ¥å¼•ç”¨ç¼“å­˜å¯¹è±¡ï¼Œç”± JVM å¯¹è¿™éƒ¨åˆ†ç¼“å­˜è¿›è¡Œå›æ”¶ã€‚ 1private static class Entry&lt;K,V&gt; extends WeakReference&lt;Object&gt; implements Map.Entry&lt;K,V&gt; ConcurrentCacheTomcat ä¸­çš„ ConcurrentCache ä½¿ç”¨äº† WeakHashMap æ¥å®ç°ç¼“å­˜åŠŸèƒ½ã€‚ ConcurrentCache é‡‡å–çš„æ˜¯åˆ†ä»£ç¼“å­˜ï¼š ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡æ”¾å…¥ eden ä¸­ï¼Œeden ä½¿ç”¨ ConcurrentHashMap å®ç°ï¼Œä¸ç”¨æ‹…å¿ƒä¼šè¢«å›æ”¶ï¼ˆä¼Šç”¸å›­ï¼‰ï¼› ä¸å¸¸ç”¨çš„å¯¹è±¡æ”¾å…¥ longtermï¼Œlongterm ä½¿ç”¨ WeakHashMap å®ç°ï¼Œè¿™äº›è€å¯¹è±¡ä¼šè¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶ã€‚ å½“è°ƒç”¨ get() æ–¹æ³•æ—¶ï¼Œä¼šå…ˆä» eden åŒºè·å–ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯å†åˆ° longterm è·å–ï¼Œå½“ä» longterm è·å–åˆ°å°±æŠŠå¯¹è±¡æ”¾å…¥ eden ä¸­ï¼Œä»è€Œä¿è¯ç»å¸¸è¢«è®¿é—®çš„èŠ‚ç‚¹ä¸å®¹æ˜“è¢«å›æ”¶ã€‚ å½“è°ƒç”¨ put() æ–¹æ³•æ—¶ï¼Œå¦‚æœ eden çš„å¤§å°è¶…è¿‡äº† sizeï¼Œé‚£ä¹ˆå°±å°† eden ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æ”¾å…¥ longterm ä¸­ï¼Œåˆ©ç”¨è™šæ‹Ÿæœºå›æ”¶æ‰ä¸€éƒ¨åˆ†ä¸ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡ã€‚ 1234567891011121314151617181920212223242526272829303132public final class ConcurrentCache&lt;K, V&gt; &#123; private final int size; private final Map&lt;K, V&gt; eden; private final Map&lt;K, V&gt; longterm; public ConcurrentCache(int size) &#123; this.size = size; this.eden = new ConcurrentHashMap&lt;&gt;(size); this.longterm = new WeakHashMap&lt;&gt;(size); &#125; public V get(K k) &#123; V v = this.eden.get(k); if (v == null) &#123; v = this.longterm.get(k); if (v != null) this.eden.put(k, v); &#125; return v; &#125; public void put(K k, V v) &#123; if (this.eden.size() &gt;= size) &#123; this.longterm.putAll(this.eden); this.eden.clear(); &#125; this.eden.put(k, v); &#125;&#125; å‚è€ƒæ–‡æ¡£ï¼š Java8 HashMap å®ç°æ¢ç´¢ ConcurrentHashMap é«˜å¹¶å‘æ€§çš„å®ç°æœºåˆ¶HashMapé¢è¯•é¢˜","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Javaé›†åˆæ¡†æ¶","slug":"Code/Javaé›†åˆæ¡†æ¶","permalink":"http://xiaoqinghua.site/categories/Code/Javaé›†åˆæ¡†æ¶/"}],"tags":[{"name":"Javaé›†åˆæ¡†æ¶","slug":"Javaé›†åˆæ¡†æ¶","permalink":"http://xiaoqinghua.site/tags/Javaé›†åˆæ¡†æ¶/"}]},{"title":"Javaé›†åˆæ¡†æ¶æ€»ç»“","slug":"Javaé›†åˆæ¡†æ¶æ€»ç»“","date":"2017-10-03T06:49:27.000Z","updated":"2018-08-27T11:11:23.208Z","comments":true,"path":"Javaé›†åˆæ¡†æ¶æ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Javaé›†åˆæ¡†æ¶æ€»ç»“.html","excerpt":"","text":"æ¦‚è§ˆå®¹å™¨ä¸»è¦åŒ…æ‹¬ Collection å’Œ Map ä¸¤ç§ï¼ŒCollection å­˜å‚¨ç€å¯¹è±¡çš„é›†åˆï¼Œè€Œ Map å­˜å‚¨ç€é”®å€¼å¯¹ï¼ˆä¸¤ä¸ªå¯¹è±¡ï¼‰çš„æ˜ å°„è¡¨ã€‚ Collection Set TreeSetï¼šåŸºäºçº¢é»‘æ ‘å®ç°ï¼Œæ”¯æŒæœ‰åºæ€§æ“ä½œï¼Œä¾‹å¦‚æ ¹æ®ä¸€ä¸ªèŒƒå›´æŸ¥æ‰¾å…ƒç´ çš„æ“ä½œã€‚ä½†æ˜¯æŸ¥æ‰¾æ•ˆç‡ä¸å¦‚HashSetï¼ŒHashSet æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼ŒTreeSet åˆ™ä¸º O(logN)ã€‚ HashSetï¼šåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œæ”¯æŒå¿«é€ŸæŸ¥æ‰¾ï¼Œä½†ä¸æ”¯æŒæœ‰åºæ€§æ“ä½œã€‚å¹¶ä¸”å¤±å»äº†å…ƒç´ çš„æ’å…¥é¡ºåºä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨ Iterator éå† HashSet å¾—åˆ°çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„ã€‚ LinkedHashSetï¼šå…·æœ‰ HashSet çš„æŸ¥æ‰¾æ•ˆç‡ï¼Œä¸”å†…éƒ¨ä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤å…ƒç´ çš„æ’å…¥é¡ºåºã€‚ List ArrayListï¼šåŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œæ”¯æŒéšæœºè®¿é—®ã€‚ Vectorï¼šå’Œ ArrayList ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ LinkedListï¼šåŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œåªèƒ½é¡ºåºè®¿é—®ï¼Œä½†æ˜¯å¯ä»¥å¿«é€Ÿåœ°åœ¨é“¾è¡¨ä¸­é—´æ’å…¥å’Œåˆ é™¤å…ƒç´ ã€‚ä¸ä»…å¦‚æ­¤ï¼ŒLinkedList è¿˜å¯ä»¥ç”¨ä½œæ ˆã€é˜Ÿåˆ—å’ŒåŒå‘é˜Ÿåˆ—ã€‚ Queue LinkedListï¼šå¯ä»¥ç”¨å®ƒæ¥å®ç°åŒå‘é˜Ÿåˆ—ã€‚ PriorityQueueï¼šåŸºäºå †ç»“æ„å®ç°ï¼Œå¯ä»¥ç”¨å®ƒæ¥å®ç°ä¼˜å…ˆé˜Ÿåˆ—ã€‚ Map TreeMapï¼šåŸºäºçº¢é»‘æ ‘å®ç°ã€‚ HashMapï¼šåŸºäºå“ˆå¸Œè¡¨å®ç°ã€‚ HashTableï¼šå’Œ HashMap ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å†™å…¥ HashTable å¹¶ä¸”ä¸ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚å®ƒæ˜¯é—ç•™ç±»ï¼Œä¸åº”è¯¥å»ä½¿ç”¨å®ƒã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨ ConcurrentHashMap æ¥æ”¯æŒçº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸” ConcurrentHashMap çš„æ•ˆç‡ä¼šæ›´é«˜ï¼Œå› ä¸º ConcurrentHashMap å¼•å…¥äº†åˆ†æ®µé”ã€‚ LinkedHashMapï¼šä½¿ç”¨åŒå‘é“¾è¡¨æ¥ç»´æŠ¤å…ƒç´ çš„é¡ºåºï¼Œé¡ºåºä¸ºæ’å…¥é¡ºåºæˆ–è€…æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰é¡ºåºã€‚ å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼è¿­ä»£å™¨æ¨¡å¼ Collection å®ç°äº† Iterable æ¥å£ï¼Œå…¶ä¸­çš„ iterator() æ–¹æ³•èƒ½å¤Ÿäº§ç”Ÿä¸€ä¸ª Iterator å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è¿­ä»£éå† Collection ä¸­çš„å…ƒç´ ã€‚ ä» JDK 1.5 ä¹‹åå¯ä»¥ä½¿ç”¨ foreach æ–¹æ³•æ¥éå†å®ç°äº† Iterable æ¥å£çš„èšåˆå¯¹è±¡ã€‚ 123456List&lt;String&gt; list = new ArrayList&lt;&gt;();list.add(\"a\");list.add(\"b\");for (String item : list) &#123; System.out.println(item);&#125; é€‚é…å™¨æ¨¡å¼java.util.Arrays#asList() å¯ä»¥æŠŠæ•°ç»„ç±»å‹è½¬æ¢ä¸º List ç±»å‹ã€‚ 12@SafeVarargspublic static &lt;T&gt; List&lt;T&gt; asList(T... a) åº”è¯¥æ³¨æ„çš„æ˜¯ asList() çš„å‚æ•°ä¸ºæ³›å‹çš„å˜é•¿å‚æ•°ï¼Œä¸èƒ½ä½¿ç”¨åŸºæœ¬ç±»å‹æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œåªèƒ½ä½¿ç”¨ç›¸åº”çš„åŒ…è£…ç±»å‹æ•°ç»„ã€‚ 12Integer[] arr = &#123;1, 2, 3&#125;;List list = Arrays.asList(arr); ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è°ƒç”¨ asList()ï¼š 1List list = Arrays.asList(1,2,3); æ€»ç»“Collection: æ˜¯ä¸€ä¸ªæ¥å£ List ï¼šå…ƒç´ æœ‰åºï¼Œå¯é‡å¤ ï¼Œå¹¶å¼•å…¥ä½ç½®ä¸‹æ ‡ï¼› LinkedList ï¼šåº•å±‚æ˜¯åŒå‘å¾ªç¯é“¾è¡¨ã€‚å¢åˆ å¿«ï¼ŒæŸ¥è¯¢æ…¢ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜ï¼› ArrayList ï¼šåº•å±‚æ•°æ®ç»“æ„æ˜¯æ•°ç»„ ã€‚æŸ¥è¯¢å¿«ï¼Œå¢åˆ æ…¢ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜ï¼› Vector ï¼šåº•å±‚æ•°æ®ç»“æ„æ˜¯æ•°ç»„ï¼ŒæŸ¥è¯¢å¿«ï¼Œå¢åˆ æ…¢ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡ä½ï¼› Stack Set ï¼šå…ƒç´ æ— åºï¼Œä¸å¯é‡å¤ HashSet ï¼šæ— åºçš„ï¼Œåº•å±‚æ•°æ®ç»“æ„æ˜¯å“ˆå¸Œè¡¨ï¼Œå‚¨å­˜å¯¹è±¡çš„æ—¶å€™ä¾èµ–ä¸¤ä¸ªæ–¹æ³•ï¼šhashcode()å’Œequals()ï¼Œé‡å†™hashcode() å’Œequals()å³å¯ï¼› TreesSetï¼šæŒ‰ç…§è‡ªç„¶é¡ºåºè¿›è¡Œæ’åˆ—ï¼Œå¦‚æœæ˜¯æ±‰å­—ä¼šæŒ‰ç…§a-zæ’åºï¼Œåº•å±‚æ•°æ®ç»“æ„æ˜¯çº¢é»‘æ ‘ã€‚ å¯¹é›†åˆä¸­çš„å…ƒç´ æ’åºä¸¤ç§æ–¹å¼ï¼š 1.è‡ªç„¶æ’åºï¼ˆå…ƒç´ å…·æœ‰æ¯”è¾ƒæ€§ï¼‰ è®©å…ƒç´ æ‰€å±çš„ç±»å®ç°Comparableæ¥å£ 2.æ¯”è¾ƒå™¨æ’åºï¼ˆé›†åˆå…·æœ‰æ¯”è¾ƒæ€§ï¼‰ è®©é›†åˆæ¥æ”¶ä¸€ä¸ªComparatorçš„å®ç°ç±»å¯¹è±¡ LinkedHashSet: åº•å±‚æ•°æ®ç»“æ„æ˜¯å“ˆå¸Œè¡¨å’Œé“¾è¡¨ç»„æˆï¼Œé“¾è¡¨ä¿è¯æœ‰åºï¼Œå“ˆå¸Œè¡¨ä¿è¯å”¯ä¸€ Quene ï¼š é˜Ÿåˆ— Map ï¼š Hashtable ï¼šä¸å¯ä»¥æ·»åŠ ä¸ºç©ºï¼Œåº•å±‚æ•°æ®ç»“æ„æ˜¯å“ˆå¸Œè¡¨ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡ä½ HashMap ï¼šå¯ä»¥æ·»åŠ ä¸ºç©ºï¼Œåº•å±‚æ•°æ®ç»“æ„æ˜¯å“ˆå¸Œè¡¨ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜ WeakHashMap ï¼šä»¥å¼±é”®å®ç°çš„åŸºäºå“ˆå¸Œè¡¨çš„ Mapã€‚ TreeMapï¼šåº•å±‚æ•°æ®ç»“æ„æ˜¯çº¢é»‘æ ‘ï¼Œæœ‰åºçš„ï¼Œæ•ˆç‡æ¯”HashMap ä½ LinkedHashMapï¼šåº•å±‚æ•°æ®ç»“æ„æ˜¯å“ˆå¸Œè¡¨å’Œé“¾è¡¨ç»„æˆï¼Œé“¾è¡¨ä¿è¯æœ‰åºï¼Œå“ˆå¸Œè¡¨ä¿è¯å”¯ä¸€ï¼Œä»…æ¯”HashMapæ…¢ä¸€ç‚¹","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Javaé›†åˆæ¡†æ¶","slug":"Code/Javaé›†åˆæ¡†æ¶","permalink":"http://xiaoqinghua.site/categories/Code/Javaé›†åˆæ¡†æ¶/"}],"tags":[{"name":"Javaé›†åˆæ¡†æ¶","slug":"Javaé›†åˆæ¡†æ¶","permalink":"http://xiaoqinghua.site/tags/Javaé›†åˆæ¡†æ¶/"}]},{"title":"Javaå¼‚å¸¸æ€»ç»“","slug":"Javaå¼‚å¸¸æ€»ç»“","date":"2017-09-23T14:20:13.000Z","updated":"2018-08-24T15:17:06.291Z","comments":true,"path":"Javaå¼‚å¸¸æ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Javaå¼‚å¸¸æ€»ç»“.html","excerpt":"","text":"å¼‚å¸¸æ¦‚è¿°å¼‚å¸¸å¼‚å¸¸å°±æ˜¯åœ¨ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­æ‰€å‘ç”Ÿçš„ä¸æ­£å¸¸çš„äº‹ä»¶ï¼Œå®ƒä¼šä¸­æ–­æ­£åœ¨è¿è¡Œçš„ç¨‹åº å¼‚å¸¸å¤„ç†Java ç¼–ç¨‹è¯­è¨€ä½¿ç”¨å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸ºç¨‹åºæä¾›äº†é”™è¯¯å¤„ç†çš„èƒ½åŠ›ï¼Œå¥½å¤„å°±æ˜¯ï¼šå¦‚æœä»£ç ä¸­å­˜åœ¨äº†å¼‚å¸¸ï¼Œä½†æ˜¯è¿›è¡Œäº†æ•è·å¤„ç†ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šç»§ç»­è¿è¡Œä¸‹å»ï¼Œä¸ä¼šå› ä¸ºä¸€ä¸ªå¼‚å¸¸å¯¼è‡´ç¨‹åºä¸­æ–­è¿è¡Œ ğŸŒ°1ï¼šå¦‚æœç¨‹åºå¯èƒ½å­˜åœ¨å¼‚å¸¸ä½†æ˜¯æ²¡æœ‰åšå¼‚å¸¸å¤„ç†ï¼Œé‚£ä¹ˆå°†å¯¼è‡´ç¨‹åºä¸èƒ½æ­£å¸¸çš„è¿è¡Œä¸‹å» 12345678910111213public class ExceptionTest &#123; public static void main(String[] args) &#123; int a = 10; int b = 0; int c = a / b; System.out.println(c); System.out.println(\"ä¸ä¼šè¾“å‡ºçš„è¯­å¥ï¼Œå› ä¸ºä¸ä¼šæ‰§è¡Œåˆ°è¿™é‡Œ\"); &#125;&#125;è¾“å‡ºç»“æœæ˜¯ï¼šException in thread \"main\" java.lang.ArithmeticException: / by zeroat cn.caijiajia.cn.caijiajia.exception.ExceptionTest.main(ExceptionTest.java:12) ğŸŒ°2ï¼šå¦‚æœç¨‹åºå¯èƒ½å­˜åœ¨å¼‚å¸¸å¹¶åšäº†å¼‚å¸¸å¤„ç†ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šæ­£å¸¸çš„è¿è¡Œä¸‹å» 1234567891011121314151617181920public class ExceptionTest &#123; public static void main(String[] args) &#123; try &#123; int a = 10; int b = 0; int c = a / b; System.out.println(c); System.out.println(\"å¼‚å¸¸ä»£ç ä¸‹é¢çš„ä»£ç å°†éƒ½ä¸ä¼šæ‰§è¡Œ\"); &#125; catch (ArithmeticException e) &#123; System.out.println(\"å¤„ç†å¼‚å¸¸çš„ä»£ç \"); &#125; System.out.println(\"å¼‚å¸¸å¤„ç†ä»£ç ä¸‹é¢çš„ç¨‹åºå°†ä¼šç»§ç»­æ‰§è¡Œè€Œä¸ä¼šç¨‹åºä¸­æ–­\"); &#125;&#125;è¾“å‡ºç»“æœæ˜¯ï¼šException in thread \"main\" java.lang.ArithmeticException: / by zeroat cn.caijiajia.cn.caijiajia.exception.ExceptionTest.main(ExceptionTest.java:12)å¤„ç†å¼‚å¸¸çš„ä»£ç å¼‚å¸¸å¤„ç†ä»£ç ä¸‹é¢çš„ç¨‹åºå°†ä¼šç»§ç»­æ‰§è¡Œè€Œä¸ä¼šç¨‹åºä¸­æ–­ Java ä¸­å¦‚ä½•å¤„ç†å¼‚å¸¸å¼‚å¸¸å¤„ç†çš„ 5 ä¸ªå…³é”®å­—12345tryï¼šæ‰§è¡Œå¯èƒ½äº§ç”Ÿå¼‚å¸¸çš„ä»£ç catchï¼šæ•è·å¼‚å¸¸å¹¶å¯¹å¼‚å¸¸æƒ…å†µåšç›¸åº”å¤„ç†finallyï¼šæ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼Œä»£ç æ€»èƒ½æ‰§è¡Œã€‚ï¼ˆé‡Šæ”¾èµ„æºï¼Œå…³é—­æ•°æ®åº“è¿æ¥ï¼‰throwsï¼šå£°æ˜å¯èƒ½æŠ›å‡ºçš„å„ç§å¼‚å¸¸ï¼ˆå—æ£€å¼‚å¸¸è¾ƒå¤šï¼‰ç”¨äºæ–¹æ³•åthrowï¼šæ‰‹åŠ¨çš„æŠ›å‡ºå¼‚å¸¸ï¼ˆæ‰‹åŠ¨æŠ›å‡ºæˆ‘ä»¬è‡ªå®šä¹‰çš„å¼‚å¸¸è¾ƒå¤šï¼‰ç”¨äºæ–¹æ³•ä½“ä¸­ å¼‚å¸¸å¤„ç†åç¨‹åºè¿è¡Œæƒ…å†µ æƒ…å†µä¸€ï¼šæ²¡äº§ç”Ÿå¼‚å¸¸ 123456789101112public void method() &#123; try &#123; // ä»£ç æ®µâ‘  [æ­£å¸¸ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œæ­¤å¤„ä¸ä¼šäº§ç”Ÿå¼‚å¸¸] &#125; catch (Exception e) &#123; // ä»£ç æ®µâ‘¡ [å¯¹å¼‚å¸¸å¤„ç†çš„ä»£ç æ®µ] &#125; // ä»£ç æ®µâ‘¢ [æ­£å¸¸ä¸šåŠ¡é€»è¾‘ä»£ç ]&#125;è¿è¡Œç»“æœï¼š ä»£ç æ®µâ‘  ä»£ç æ®µâ‘¢ æƒ…å†µäºŒï¼šäº§ç”Ÿå¼‚å¸¸å¹¶æ•è·å¼‚å¸¸ 12345678910111213141516public void method() &#123; try &#123; // å¼‚å¸¸ä»£ç æ®µâ‘  [æ­£å¸¸ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œæ­¤å¤„ä¼šäº§ç”Ÿå¼‚å¸¸] // ä»£ç æ®µâ‘¡ [æ­£å¸¸ä¸šåŠ¡é€»è¾‘ä»£ç ] &#125; catch (Exception e) &#123; // ä»£ç æ®µâ‘¢ [å¯¹å¼‚å¸¸å¤„ç†çš„ä»£ç æ®µ] &#125; // ä»£ç æ®µâ‘£ [æ­£å¸¸ä¸šåŠ¡é€»è¾‘ä»£ç ]&#125;è¿è¡Œç»“æœï¼š ä»£ç æ®µâ‘  ä»£ç æ®µâ‘¢ ä»£ç æ®µâ‘£æ³¨æ„ï¼šå¦‚æœæƒ³è¦æ­£å¸¸çš„ ä»£ç æ®µâ‘¡ æ‰§è¡Œï¼Œé‚£ä¹ˆå¯ä»¥æŠŠä»£ç æ®µä» try catch é‡Œé¢æå‡ºæ¥ï¼Œå’Œ ä»£ç æ®µâ‘£ æ”¾åœ¨ä¸€èµ·ï¼Œå½“å¼‚å¸¸å¤„ç†å®Œä¹‹åï¼Œå°±å¯ä»¥åŒæ—¶å»æ‰§è¡Œ ä»£ç æ®µâ‘¡ å’Œ ä»£ç æ®µâ‘£ äº†ã€‚ æƒ…å†µä¸‰ï¼šäº§ç”Ÿå¼‚å¸¸å¹¶æ•è·å¼‚å¸¸ï¼Œä½†æ˜¯æ•è·å¼‚å¸¸ç±»å‹ä¸åŒ¹é…äº§ç”Ÿå¼‚å¸¸ç±»å‹ 1234567891011121314public void method() &#123; try &#123; // å¼‚å¸¸ä»£ç æ®µâ‘  [æ­£å¸¸ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œæ­¤å¤„ä¼šäº§ç”Ÿè§’æ ‡è¶Šç•Œå¼‚å¸¸] // ä»£ç æ®µâ‘¡ [æ­£å¸¸ä¸šåŠ¡é€»è¾‘ä»£ç ] &#125; catch (IOException e) &#123; // ä»£ç æ®µâ‘¢ [å¯¹å¼‚å¸¸å¤„ç†çš„ä»£ç æ®µ] &#125; // ä»£ç æ®µâ‘£ [æ­£å¸¸ä¸šåŠ¡é€»è¾‘ä»£ç ]&#125;è¿è¡Œç»“æœï¼š ä»£ç æ®µâ‘  æ³¨æ„ï¼šå¦‚æœæ•è·å¼‚å¸¸ç±»å‹å’Œäº§ç”Ÿçš„å¼‚å¸¸ç±»å‹ä¸åŒ¹é…ï¼Œé‚£ä¹ˆå°±å’Œæ²¡æœ‰å¤„ç†å¼‚å¸¸æƒ…å†µä¸€æ ·äº†ï¼Œtry catch åé¢çš„ä»£ç æ®µå°†éƒ½ä¸ä¼šæ‰§è¡Œï¼Œå‘ç”Ÿå¼‚å¸¸å°±ä¼šå¯¼è‡´ç¨‹åºä¸­æ–­è¿è¡Œ å¼‚å¸¸ä½“ç³»å¼‚å¸¸ç±»å±‚æ¬¡å›¾ Error å’Œ ExceptionError ç±»å’Œ Exception ç±»çš„çˆ¶ç±»éƒ½æ˜¯ Throwable ç±» Error ç±»ä¸€èˆ¬æ˜¯æŒ‡ä¸è™šæ‹Ÿæœºç›¸å…³çš„é—®é¢˜ï¼Œå¦‚ç³»ç»Ÿå´©æºƒï¼Œè™šæ‹Ÿæœºé”™è¯¯ï¼Œå†…å­˜ç©ºé—´ä¸è¶³ï¼Œæ–¹æ³•è°ƒç”¨æ ˆæº¢å‡ºç­‰ã€‚å¯¹äºè¿™ç±»é”™è¯¯çš„å¯¼è‡´çš„åº”ç”¨ç¨‹åºä¸­æ–­ï¼Œä»…é ç¨‹åºæœ¬èº«æ— æ³•æ¢å¤å’Œå’Œé¢„é˜²ï¼Œé‡åˆ°è¿™æ ·çš„é”™è¯¯ï¼Œå»ºè®®è®©ç¨‹åºç»ˆæ­¢ã€‚å› æ­¤æˆ‘ä»¬åœ¨å­¦ä¹ çš„æ—¶å€™ä¸»è¦æ˜¯å­¦ä¼šExceptionã€‚ Exception ç±»è¡¨ç¤ºç¨‹åºå¯ä»¥å¤„ç†çš„å¼‚å¸¸ï¼Œå¯ä»¥æ•è·ä¸”å¯èƒ½æ¢å¤ã€‚é‡åˆ°è¿™ç±»å¼‚å¸¸ï¼Œåº”è¯¥å°½å¯èƒ½å¤„ç†å¼‚å¸¸ï¼Œä½¿ç¨‹åºæ¢å¤è¿è¡Œï¼Œè€Œä¸åº”è¯¥éšæ„ç»ˆæ­¢å¼‚å¸¸ã€‚ Exception å¼‚å¸¸åˆ†ç±»åŠå¤„ç†Exception å¼‚å¸¸ä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼šChecked Exceptionï¼ŒUnchecked Exceptionï¼›å³å—æ£€å¼‚å¸¸å’Œéå—æ£€å¼‚å¸¸ï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ï¼‰ Checked Exceptionï¼šå—æ£€å¼‚å¸¸ï¼Œå³ Java ç¨‹åºå¿…é¡»æ˜¾å¼å¤„ç†çš„å¼‚å¸¸ï¼Œå¦‚æœç¨‹åºæ²¡æœ‰å¤„ç† Checked å¼‚å¸¸ï¼Œè¯¥ç¨‹åºåœ¨ç¼–è¯‘æ—¶å°±ä¼šå‘ç”Ÿé”™è¯¯æ— æ³•ç¼–è¯‘ã€‚ä¾‹å¦‚å›¾ä¸­æ‰€ç¤ºçš„ IOException å¤„ç†å—æ£€å¼‚å¸¸é€šè¿‡æœ‰å¦‚ä¸‹ä¸¤ç§æ–¹å¼ï¼š æ–¹å¼ä¸€ï¼šé€šè¿‡ trycatch æ˜¾å¼å¤„ç†å¼‚å¸¸ï¼Œå¦åˆ™ç¼–è¯‘ä¸é€šè¿‡ 12345678910public class ExceptionTest &#123; public static void main(String[] args) &#123; try &#123; // é€šè¿‡ try catch æ˜¾ç¤ºå¤„ç†å¼‚å¸¸ FileInputStream fis = new FileInputStream(new File(\"\")); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; æ–¹å¼äºŒï¼šé€šè¿‡ throws æŠ›å‡ºå¼‚å¸¸ï¼Œè®©ä¸Šå±‚æ¥å¤„ç†å¼‚å¸¸ï¼Œå¦åˆ™ç¼–è¯‘ä¸é€šè¿‡ 12345public class ExceptionTest &#123; public static void main(String[] args) throws IOException &#123; FileInputStream fis = new FileInputStream(new File(\"\")); &#125;&#125; Unchecked Exceptionï¼šéå—æ£€å¼‚å¸¸ï¼Œå³ RuntimeException è¿è¡Œæ—¶å¼‚å¸¸ã€‚è¿™äº›å¼‚å¸¸ç¨‹åºå¯ä»¥é€‰æ‹©æ•è·å¤„ç†ï¼Œä¹Ÿå¯ä»¥ä¸å¤„ç†ã€‚è¿™äº›å¼‚å¸¸ä¸€èˆ¬æ˜¯ç”±ç¨‹åºé€»è¾‘é”™è¯¯å¼•èµ·çš„ï¼Œç¨‹åºåº”è¯¥ä»é€»è¾‘è§’åº¦å°½å¯èƒ½é¿å…è¿™ç±»å¼‚å¸¸çš„å‘ç”Ÿã€‚æ¯”å¦‚å¸¸è§çš„ NullPointerExceptionã€IndexOutOfBoundsException å°±æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ã€‚ä¸è¿‡æŒ‰ç…§ç»éªŒæ¥è¯´ï¼Œè¿™ç±»å¼‚å¸¸è¦ä¹ˆå°½é‡é¿å…ï¼Œè¦ä¹ˆå‡ºç°äº†å°±è¦åšå¼‚å¸¸å¤„ç†ï¼Œä»è€Œä¿è¯ç¨‹åºçš„å¥å£®æ€§ã€‚ å¤„ç†è¿è¡Œæ—¶å¼‚å¸¸é€šè¿‡æœ‰å¦‚ä¸‹ä¸¤ç§æ–¹å¼ï¼š æ–¹å¼ä¸€ï¼šå¸¸è§çš„ç©ºæŒ‡é’ˆå¤„ç† 123456// é€šè¿‡å†™ä¼ªä»£ç æ¥æ¼”ç¤ºå…¶å¤„ç†æµç¨‹if (å¯¹è±¡ == null) &#123; // å¤„ç†å¯¹è±¡ä¸º null çš„é€»è¾‘&#125; else &#123; // å¤„ç†å¯¹è±¡ä¸ä¸º null çš„é€»è¾‘&#125; æ–¹å¼äºŒï¼šè·Ÿä¸šåŠ¡ç›¸å…³å¼‚å¸¸ï¼ŒæŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ 1234567// é€šè¿‡æ‰‹æœºå·æ³¨å†Œä¸šåŠ¡é€»è¾‘User user = dao.getByPhone(phone);if (user != null) &#123; // è¯´æ˜æ­¤æ‰‹æœºå·ç å·²ç»è¢«æ³¨å†Œï¼Œé‚£ä¹ˆå°±æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸ï¼ˆå³è‡ªå®šä¹‰å¼‚å¸¸ï¼‰ throw new MyRuntimeException(\"è¯¥ç”¨æˆ·å·²æ³¨å†Œ\");&#125;// å¦‚æœæ²¡æœ‰æ³¨å†Œï¼Œç»§ç»­èµ°æ³¨å†Œæµç¨‹ä»£ç  æ€»ç»“ï¼š å—æ£€å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰å¤„ç†èµ·æ¥å¾ˆç®€å•ï¼Œå› ä¸ºç¨‹åºå¦‚æœä¸åšæ˜¾å¼å¤„ç†ï¼Œé‚£ä¹ˆå°±ä¼šç¼–è¯‘ä¸é€šè¿‡ï¼Œå¼ºåˆ¶è¦æ±‚å¤„ç† è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆUnchecked exceptionï¼‰åˆ™æ˜¯çœ‹å¿ƒæƒ…å¤„ç†çš„ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦å…¬å¸ä»£ç æ›´åŠ å¥å£®ï¼Œæ›´å°‘çš„å‡ºç°é—®é¢˜ï¼Œæœ€å¥½è¦åšä¸€ä¸‹å¼‚å¸¸å¤„ç†ã€‚ä½†æ˜¯å¦‚æœåšè¿™ä¸ªå¤„ç†å‘¢ï¼Ÿå¯¹äºè¿™ç§è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å’Œä¸šåŠ¡ç›¸å…³çš„ï¼Œæ¯”å¦‚æ‰‹æœºå·æ³¨å†Œä¾‹å­ï¼›è¿™ç§æƒ…å†µä¸‹åœ¨ Java çš„å¼‚å¸¸ä½“ç³»ä¸­å¹¶æ²¡æœ‰ç›¸å…³å¼‚å¸¸ç±»åšå¤„ç†ï¼Œå› ä¸º Java ä¸ç®¡å†æ™ºèƒ½ï¼Œä¹Ÿä¸å¯èƒ½çŸ¥é“æˆ‘ä»¬çš„ä¸šåŠ¡æƒ…å†µï¼Œå½“ç„¶å°±ä¸ä¼šé’ˆå¯¹ä¸šåŠ¡æä¾›ä¸€äº›å¼‚å¸¸ç±»ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œå› æ­¤ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè‡ªå®šä¹‰å¼‚å¸¸å°±å‡ºç°äº†ï¼Œå®ƒå¯¹äºæˆ‘ä»¬å¤„ç†ä¸šåŠ¡ä¸­äº§ç”Ÿçš„è¿è¡Œæ—¶å¼‚å¸¸éå¸¸`éå¸¸é‡è¦ï¼Œæ¥ä¸‹æ¥å°±æ¥çœ‹çœ‹è‡ªå®šä¹‰å¼‚å¸¸`ã€‚ è‡ªå®šä¹‰å¼‚å¸¸äº§ç”ŸåŸå› Java ç°æœ‰çš„å¼‚å¸¸ç±»ä¸èƒ½æ»¡è¶³æ›´å¤šçš„ä¸šåŠ¡å¼‚å¸¸å¤„ç†ï¼Œå› æ­¤æˆ‘ä»¬è¦è‡ªå®šä¹‰åˆé€‚çš„å¼‚å¸¸ç±»æ¥å¤„ç†ä¸šåŠ¡å¼‚å¸¸ å¦‚ä½•è‡ªå®šä¹‰å¼‚å¸¸ç±»ç¬¬ä¸€æ­¥ï¼šå£°æ˜ä¸€ä¸ªç±»ç»§æ‰¿ Exception æˆ–å…¶å­ç±» é‚£ä¹ˆæˆ‘ä»¬å£°æ˜çš„è¿™ä¸ªç±»åˆ°åº•ç»§æ‰¿è°å‘¢ï¼ŸExceptionï¼ŸRuntimeExceptionï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šRuntimeException åŸå› æ˜¯ï¼šçœ‹äº†ä¸Šé¢çš„å¼‚å¸¸ç±»å±‚æ¬¡å›¾ï¼Œåº”è¯¥ä¹Ÿèƒ½å‘ç°ï¼ŒException ä¸‹é¢æœ‰ä¸¤å¤§ç±»å­ç±»ï¼Œå—æ£€å¼‚å¸¸å’Œè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»ç»§æ‰¿äº† Exceptionï¼Œåˆ™å°±ä¼šå› ä¸ºå—æ£€å¼‚å¸¸çš„å­˜åœ¨è€Œå˜æˆäº†å—æ£€å¼‚å¸¸ç±»ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è‡ªå®šä¹‰çš„å¼‚å¸¸ç±»ï¼Œå¦‚æœåœ¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±å¿…é¡»æ˜¾å¼å¤„ç†å¼‚å¸¸ï¼Œè¦ä¹ˆ try catchï¼Œè¦ä¹ˆæŠ›å‡ºç»™ä¸Šå±‚ï¼›è¿™æ ·ä¸€æ¥ï¼Œä½¿å¾—æˆ‘ä»¬çš„ç¨‹åºå¾ˆæ··ä¹±ï¼Œè€Œä¸”å¹¶æ²¡æœ‰è¾¾åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚ç„¶åå½“æˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»ç»§æ‰¿äº† RuntimeException ä¹‹åï¼Œå½“æˆ‘ä»¬ç¨‹åºä¸­æƒ³è¦ä½¿ç”¨çš„æ—¶å€™ï¼Œç›´æ¥ new ä¸€ä¸ªå³å¯ï¼Œè€Œä¸å†éœ€è¦æ˜¾å¼å»å†å¤šåšå¤„ç†äº†ã€‚ ç¬¬äºŒæ­¥ï¼šè‡ªå®šä¹‰å¼‚å¸¸ç±»åº”è‡³å°‘åŒ…å«å››ä¸ªæ„é€ æ–¹æ³• 123456789101112131415public class MyException extends RuntimeException &#123; public MyException() &#123;&#125; public MyException(String msg) &#123; super(msg); &#125; public MyException(Throwable throwable) &#123; super(throwable); &#125; public MyException(String msg, Throwable throwable) &#123; super(msg, throwable); &#125;&#125; catchä½äº†å¼‚å¸¸ä¸€å®šè¦è®°ä½å¤„ç†ï¼š 12345678910111213public static void main(String[] args) &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; throw new Myexception(\"æˆ‘æ˜¯ä¸€ä¸ªå¼‚å¸¸\"); &#125; catch (Exception e) &#123; e.printStackTrace(); return; &#125; &#125; &#125;æ­¤æ—¶ `retrun` å°±æ˜¯å¤„ç†ï¼Œé€€å‡ºå¾ªç¯å¦‚æœä¸å¤„ç†ï¼Œå¾ªç¯ä¸€ç›´è¿›è¡Œ ç¬¬ä¸‰æ­¥ï¼šåœ¨ç¨‹åºä¸­ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰å¼‚å¸¸ 12345678910public void testException() &#123; User user = dao.getByPhone(phone); if (user != null) &#123; // å› ä¸º MyException æ˜¯ç»§æ‰¿ RuntimeExceptionï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æŠ›å‡ºå¼‚å¸¸è€Œä¸ç”¨åšå…¶å®ƒå¤„ç† throw new MyException(\"è¯¥æ‰‹æœºå·å·²è¢«æ³¨å†Œ\"); &#125; // ...&#125; æ³¨ï¼šæ²¡é”™ï¼Œè¿™é‡Œåˆä½¿ç”¨äº†è¿™ä¸ªæ‰‹æœºå·æ³¨å†Œçš„ä¾‹å­ï¼Œå› ä¸ºè¿™ä¸ªå°±æ˜¯å®å®åœ¨åœ¨çš„åœ¨ä¸šåŠ¡ä¸­çš„å¼‚å¸¸å¤„ç†ã€‚ä¸šåŠ¡æ˜¯åƒå˜ä¸‡åŒ–ï¼Œä½†æ˜¯å®ƒä»¬å¯èƒ½äº§ç”Ÿçš„å¼‚å¸¸å¤„ç†æ–¹å¼æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼ŒæŒ‰ç…§è¿™ä¸ªæ€è·¯å»åšå¼‚å¸¸å¤„ç†å³å¯ã€‚ tipsï¼š å¦‚ä¸Šè‡ªå®šä¹‰çš„å¼‚å¸¸ç±»ä¸­çš„æ„é€ æ–¹æ³•æ˜¯æœ€åŸºæœ¬çš„å‡ ä¸ªã€‚æ¯å®¶å…¬å¸çš„è‡ªå®šä¹‰å¼‚å¸¸å¯èƒ½éƒ½ä¼šæœ‰åŒºåˆ«; æ¯”å¦‚å®šä¹‰ä¸€ä¸ª SuperException ç±»å®ç°äº† RuntimeExceptionï¼Œç„¶ååœ¨è‡ªå®šä¹‰ ClientExceptionï¼ŒServerException å†å»ç»§æ‰¿ SuperExceptionï¼›é‚£ä¹ˆè¿™å°±æ˜¯ä¸€å¥—è‡ªå®šä¹‰ä½“ç³»äº†ï¼Œåˆ†ä¸ºå®¢æˆ·ç«¯å¼‚å¸¸å’ŒæœåŠ¡ç«¯å¼‚å¸¸ï¼Œåœ¨éœ€è¦åšå¼‚å¸¸å¤„ç†çš„åœ°æ–¹ä½¿ç”¨å¯¹åº”çš„å¼‚å¸¸ç±»å¹¶æŠ›å‡ºå¼‚å¸¸é”™è¯¯ä¿¡æ¯å³å¯äº†ã€‚ æ¯”å¦‚å¯èƒ½æœ‰çš„å…¬å¸ä¼šåœ¨è‡ªå®šä¹‰å¼‚å¸¸ç±»ä¸­åœ¨å®šä¹‰ä¸€äº›å­—æ®µï¼ŒerrorCodeï¼ŒerrorMessage ç­‰ï¼Œæ¥ä»£è¡¨æŸäº›ä¸šåŠ¡é”™è¯¯ç å’ŒÂ·å¯¹åº”çš„é”™è¯¯ä¿¡æ¯Â·ç­‰ã€‚ä¸ç®¡æ€ä¹ˆæ ·ï¼Œæˆ‘ä»¬åªè¦äº†è§£è‡ªå®šä¹‰å¼‚å¸¸çš„åŸç†åï¼Œé¢å¯¹å“ªä¸ªå…¬å¸çš„è‡ªå®šä¹‰å¼‚å¸¸ä½“ç³»æˆ‘ä»¬éƒ½èƒ½å¤Ÿè½»æ¾åº”å¯¹ã€‚ æ€»ç»“ ä¸€ä¸ªæ˜¯å¼‚å¸¸ä½“ç³»ï¼Œè¦åˆ†æ¸…å—æ£€å¼‚å¸¸å’Œè¿è¡Œæ—¶å¼‚å¸¸ï¼› ä¸€ä¸ªå°±æ˜¯è‡ªå®šä¹‰å¼‚å¸¸ï¼ŒçŸ¥é“å¦‚ä½•è‡ªå®šä¹‰å¼‚å¸¸å’Œå¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ã€‚ å‚è€ƒèµ„æ–™Java å…¥é—¨ä¹‹å¼‚å¸¸å¤„ç†Java å¼‚å¸¸çš„é¢è¯•é—®é¢˜åŠç­”æ¡ˆ -Part 1Java å¼‚å¸¸çš„é¢è¯•é—®é¢˜åŠç­”æ¡ˆ -Part 2Java å¼‚å¸¸çš„é¢è¯•é—®é¢˜åŠç­”æ¡ˆ -Part 3","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Javaåå°„","slug":"Javaåå°„","date":"2017-09-10T09:06:08.000Z","updated":"2018-08-25T06:50:11.281Z","comments":true,"path":"Javaåå°„.html","link":"","permalink":"http://xiaoqinghua.site/Javaåå°„.html","excerpt":"","text":"åå°„æ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ª Class å¯¹è±¡ï¼ŒåŒ…å«äº†ä¸ç±»æœ‰å…³çš„ä¿¡æ¯ã€‚å½“ç¼–è¯‘ä¸€ä¸ªæ–°ç±»æ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªåŒåçš„ .class æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å†…å®¹ä¿å­˜ç€ Class å¯¹è±¡ã€‚ ç±»åŠ è½½ç›¸å½“äº Class å¯¹è±¡çš„åŠ è½½ã€‚ç±»åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰åŠ¨æ€åŠ è½½åˆ° JVM ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Class.forName(&quot;com.mysql.jdbc.Driver&quot;) è¿™ç§æ–¹å¼æ¥æ§åˆ¶ç±»çš„åŠ è½½ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª Class å¯¹è±¡ã€‚ åå°„å¯ä»¥æä¾›è¿è¡Œæ—¶çš„ç±»ä¿¡æ¯ï¼Œå¹¶ä¸”è¿™ä¸ªç±»å¯ä»¥åœ¨è¿è¡Œæ—¶æ‰åŠ è½½è¿›æ¥ï¼Œç”šè‡³åœ¨ç¼–è¯‘æ—¶æœŸè¯¥ç±»çš„ .class ä¸å­˜åœ¨ä¹Ÿå¯ä»¥åŠ è½½è¿›æ¥ã€‚ Class å’Œ java.lang.reflect ä¸€èµ·å¯¹åå°„æä¾›äº†æ”¯æŒï¼Œjava.lang.reflect ç±»åº“ä¸»è¦åŒ…å«äº†ä»¥ä¸‹ä¸‰ä¸ªç±»ï¼š Field ï¼šå¯ä»¥ä½¿ç”¨ get() å’Œ set() æ–¹æ³•è¯»å–å’Œä¿®æ”¹ Field å¯¹è±¡å…³è”çš„å­—æ®µï¼› Method ï¼šå¯ä»¥ä½¿ç”¨ invoke() æ–¹æ³•è°ƒç”¨ä¸ Method å¯¹è±¡å…³è”çš„æ–¹æ³•ï¼› Constructor ï¼šå¯ä»¥ç”¨ Constructor åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ Advantages of Using Reflection: Extensibility Features :An application may make use of external, user-defined classes by creating instances of extensibility objects using their fully-qualified names.Class Browsers and Visual Development Environments : A class browser needs to be able to enumerate the members of classes. Visual development environments can benefit from making use of type information available in reflection to aid the developer in writing correct code.Debuggers and Test Tools : Debuggers need to be able to examine private members on classes. Test harnesses can make use of reflection to systematically call a discoverable set APIs defined on a class, to insure a high level of code coverage in a test suite. Drawbacks of Reflection:Reflection is powerful, but should not be used indiscriminately. If it is possible to perform an operation without using reflection, then it is preferable to avoid using it. The following concerns should be kept in mind when accessing code via reflection. Performance Overhead : Because reflection involves types that are dynamically resolved, certain Java virtual machine optimizations can not be performed. Consequently, reflective operations have slower performance than their non-reflective counterparts, and should be avoided in sections of code which are called frequently in performance-sensitive applications. Security Restrictions : Reflection requires a runtime permission which may not be present when running under a security manager. This is in an important consideration for code which has to run in a restricted security context, such as in an Applet. Exposure of Internals :Since reflection allows code to perform operations that would be illegal in non-reflective code, such as accessing private fields and methods, the use of reflection can result in unexpected side-effects, which may render code dysfunctional and may destroy portability. Reflective code breaks abstractions and therefore may change behavior with upgrades of the platform. Trail: The Reflection API Java åå°„ä½¿ç”¨æ€»ç»“ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/Javaåå°„.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Objectç±»æ€»ç»“","slug":"Objectæ€»ç»“","date":"2017-09-03T09:06:13.000Z","updated":"2018-08-24T07:42:55.771Z","comments":true,"path":"Objectæ€»ç»“.html","link":"","permalink":"http://xiaoqinghua.site/Objectæ€»ç»“.html","excerpt":"","text":"Object ä¸Šå¸ç±»Objectç±»æ˜¯Javaä¸­å…¶ä»–æ‰€æœ‰ç±»çš„ç¥–å…ˆï¼Œæ²¡æœ‰Objectç±»Javaé¢å‘å¯¹è±¡æ— ä»è°ˆèµ·ã€‚ä½œä¸ºå…¶ä»–æ‰€æœ‰ç±»çš„åŸºç±»ï¼ŒObjectå…·æœ‰å“ªäº›å±æ€§å’Œè¡Œä¸ºï¼Œæ˜¯Javaè¯­è¨€è®¾è®¡èƒŒåçš„æ€ç»´ä½“ç°ã€‚ Objectç±»ä½äºjava.langåŒ…ä¸­ï¼Œjava.langåŒ…åŒ…å«ç€Javaæœ€åŸºç¡€å’Œæ ¸å¿ƒçš„ç±»ï¼Œåœ¨ç¼–è¯‘æ—¶ä¼šè‡ªåŠ¨å¯¼å…¥ã€‚Objectç±»æ²¡æœ‰å®šä¹‰å±æ€§ï¼Œä¸€å…±æœ‰13ä¸ªæ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233// éšå¼æ„é€ æ–¹æ³•public Object();// è°ƒç”¨æœ¬åœ°C/C++å®ç°çš„æ–¹æ³•private static native void registerNatives();// åˆå§‹åŒ–è°ƒç”¨static &#123; registerNatives();&#125;protected native Object clone() throws CloneNotSupportedExceptionpublic final native Class&lt;?&gt; getClass()public boolean equals(Object obj)public native int hashCode()public String toString()public final void wait() throws InterruptedExceptionpublic final void wait(long timeout, int nanos) throws InterruptedExceptionpublic final native void notify()public final native void notifyAll()public final native void wait(long timeout) throws InterruptedExceptionprotected void finalize() throws Throwable &#123;&#125; 1ã€ç±»æ„é€ å™¨public Object();å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒJavaä¸­é€šè¿‡å½¢å¦‚ new A(args..)å½¢å¼åˆ›å»ºä¸€ä¸ªå±äºè¯¥ç±»å‹çš„å¯¹è±¡ã€‚å…¶ä¸­ A å³æ˜¯ç±»åï¼ŒA(args..)å³æ­¤ç±»å®šä¹‰ä¸­ç›¸å¯¹åº”çš„æ„é€ å‡½æ•°ã€‚é€šè¿‡æ­¤ç§å½¢å¼åˆ›å»ºçš„å¯¹è±¡éƒ½æ˜¯é€šè¿‡ç±»ä¸­çš„æ„é€ å‡½æ•°å®Œæˆã€‚ä¸ºä½“ç°æ­¤ç‰¹æ€§ï¼ŒJavaä¸­è§„å®šï¼šåœ¨ç±»å®šä¹‰è¿‡ç¨‹ä¸­ï¼Œå¯¹äºæœªå®šä¹‰æ„é€ å‡½æ•°çš„ç±»ï¼Œé»˜è®¤ä¼šæœ‰ä¸€ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ä½œä¸ºæ‰€æœ‰ç±»çš„åŸºç±»ï¼ŒObjectç±»è‡ªç„¶è¦åæ˜ å‡ºæ­¤ç‰¹æ€§ï¼Œåœ¨æºç ä¸­ï¼Œæœªç»™å‡ºObjectç±»æ„é€ å‡½æ•°å®šä¹‰ï¼Œä½†å®é™…ä¸Šï¼Œæ­¤æ„é€ å‡½æ•°æ˜¯å­˜åœ¨çš„ã€‚ å½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç±»éƒ½æ˜¯é€šè¿‡æ­¤ç§æ–¹å¼å»æ„å»ºï¼Œä¹Ÿè‡ªç„¶çš„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç±»æ„é€ å‡½æ•°éƒ½æ˜¯publicã€‚ 2ã€private static native void registerNatives();registerNativeså‡½æ•°å‰é¢æœ‰nativeå…³é”®å­—ä¿®é¥°ï¼ŒJavaä¸­ï¼Œç”¨nativeå…³é”®å­—ä¿®é¥°çš„å‡½æ•°è¡¨æ˜è¯¥æ–¹æ³•çš„å®ç°å¹¶ä¸æ˜¯åœ¨Javaä¸­å»å®Œæˆï¼Œè€Œæ˜¯ç”±C/C++å»å®Œæˆï¼Œå¹¶è¢«ç¼–è¯‘æˆäº†.dllï¼Œç”±Javaå»è°ƒç”¨ã€‚æ–¹æ³•çš„å…·ä½“å®ç°ä½“åœ¨dllæ–‡ä»¶ä¸­ï¼Œå¯¹äºä¸åŒå¹³å°ï¼Œå…¶å…·ä½“å®ç°åº”è¯¥æœ‰æ‰€ä¸åŒã€‚ç”¨nativeä¿®é¥°ï¼Œå³è¡¨ç¤ºæ“ä½œç³»ç»Ÿï¼Œéœ€è¦æä¾›æ­¤æ–¹æ³•ï¼ŒJavaæœ¬èº«éœ€è¦ä½¿ç”¨ã€‚å…·ä½“åˆ°registerNatives()æ–¹æ³•æœ¬èº«ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯å°†C/C++ä¸­çš„æ–¹æ³•æ˜ å°„åˆ°Javaä¸­çš„nativeæ–¹æ³•ï¼Œå®ç°æ–¹æ³•å‘½åçš„è§£è€¦ã€‚ æ—¢ç„¶å¦‚æ­¤ï¼Œå¯èƒ½æœ‰äººä¼šé—®ï¼ŒregisterNatives()ä¿®é¥°ç¬¦ä¸ºprivateï¼Œä¸”å¹¶æ²¡æœ‰æ‰§è¡Œï¼Œä½œç”¨ä½•ä»¥è¾¾åˆ°ï¼Ÿå…¶å®ï¼Œåœ¨Javaæºç ä¸­ï¼Œæ­¤æ–¹æ³•çš„å£°æ˜åæœ‰ç´§æ¥ç€ä¸€æ®µé™æ€ä»£ç å—ï¼š 12341 private static native void registerNatives();2 static &#123;3 registerNatives();4 &#125; 3ã€protected native Object clone() throws CloneNotSupportedException;clone()æ–¹æ³•åˆæ˜¯ä¸€ä¸ªè¢«å£°æ˜ä¸ºnativeçš„æ–¹æ³•ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬çŸ¥é“äº†clone()æ–¹æ³•å¹¶ä¸æ˜¯Javaçš„åŸç”Ÿæ–¹æ³•ï¼Œå…·ä½“çš„å®ç°æ˜¯æœ‰C/C++å®Œæˆçš„ã€‚cloneè‹±æ–‡ç¿»è¯‘ä¸º&quot;å…‹éš†&quot;ï¼Œå…¶ç›®çš„æ˜¯åˆ›å»ºå¹¶è¿”å›æ­¤å¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚å½¢è±¡ç‚¹ç†è§£ï¼Œè¿™æœ‰ä¸€è¾†ç§‘é²å…¹ï¼Œä½ çœ‹ç€ä¸é”™ï¼Œæƒ³è¦ä¸ªä¸€æ¨¡ä¸€æ ·çš„ã€‚ä½ è°ƒç”¨æ­¤æ–¹æ³•å³å¯åƒå˜é­”æœ¯ä¸€æ ·å˜å‡ºä¸€è¾†ä¸€æ¨¡ä¸€æ ·çš„ç§‘é²å…¹å‡ºæ¥ã€‚é…ç½®ä¸€æ ·ï¼Œé•¿ç›¸ä¸€æ ·ã€‚ä½†ä»æ­¤åˆ»èµ·ï¼ŒåŸæ¥çš„é‚£è¾†ç§‘é²å…¹å¦‚æœè¿›è¡Œäº†æ–°çš„è£…é¥°ï¼Œä¸ä½ å…‹éš†å‡ºæ¥çš„è¿™è¾†ç§‘é²å…¹æ²¡æœ‰ä»»ä½•å…³ç³»äº†ã€‚ä½ å…‹éš†å‡ºæ¥çš„å¯¹è±¡å˜ä¸å˜å®Œå…¨åœ¨äºä½ å¯¹å…‹éš†å‡ºæ¥çš„ç§‘é²å…¹æœ‰æ²¡æœ‰è¿›è¡Œè¿‡ä»€ä¹ˆæ“ä½œäº†ã€‚Javaæœ¯è¯­è¡¨è¿°ä¸ºï¼šcloneå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼ŒæŒ‡å‘çš„æ˜¯æ–°çš„cloneå‡ºæ¥çš„å¯¹è±¡ï¼Œæ­¤å¯¹è±¡ä¸åŸå¯¹è±¡åˆ†åˆ«å ç”¨ä¸åŒçš„å †ç©ºé—´ã€‚ æ˜ç™½äº†cloneçš„å«ä¹‰åï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å¦‚æœè°ƒç”¨clone()å‡½æ•°å¯¹è±¡è¿›è¡Œæ­¤å…‹éš†æ“ä½œã€‚ é¦–å…ˆçœ‹ä¸€ä¸‹ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ï¼š 123456789public class ObjectTest &#123; public static void main(String[] args) &#123; Object o1 = new Object(); // The method clone() from the type Object is not visible Object clone = o1.clone(); &#125;&#125; ä¾‹å­å¾ˆç®€å•ï¼Œåœ¨main()æ–¹æ³•ä¸­ï¼Œnewä¸€ä¸ªObjectå¯¹è±¡åï¼Œæƒ³ç›´æ¥è°ƒç”¨æ­¤å¯¹è±¡çš„cloneæ–¹æ³•å…‹éš†ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å‡ºç°é”™è¯¯æç¤ºï¼š&quot;The method clone() from the type Object is not visible&quot; why? æ ¹æ®æç¤ºï¼Œç¬¬ä¸€ååº”æ˜¯ObjectTestç±»ä¸­å®šä¹‰çš„Objectå¯¹è±¡æ— æ³•è®¿é—®å…¶clone()æ–¹æ³•ã€‚å›åˆ°Objectç±»ä¸­clone()æ–¹æ³•çš„å®šä¹‰ï¼Œå¯ä»¥çœ‹åˆ°å…¶è¢«å£°æ˜ä¸ºprotectedï¼Œä¼°è®¡é—®é¢˜å°±åœ¨è¿™ä¸Šé¢äº†ï¼Œprotectedä¿®é¥°çš„å±æ€§æˆ–æ–¹æ³•è¡¨ç¤ºï¼šåœ¨åŒä¸€ä¸ªåŒ…å†…æˆ–è€…ä¸åŒåŒ…çš„å­ç±»å¯ä»¥è®¿é—®ã€‚æ˜¾ç„¶ï¼ŒObjectç±»ä¸ObjectTestç±»åœ¨ä¸åŒçš„åŒ…ä¸­ï¼Œä½†æ˜¯ObjectTestç»§æ‰¿è‡ªObjectï¼Œæ˜¯Objectç±»çš„å­ç±»ï¼Œäºæ˜¯ï¼Œç°åœ¨å´å‡ºç°å­ç±»ä¸­é€šè¿‡Objectå¼•ç”¨ä¸èƒ½è®¿é—®protectedæ–¹æ³•ï¼ŒåŸå› åœ¨äºå¯¹&quot;ä¸åŒåŒ…ä¸­çš„å­ç±»å¯ä»¥è®¿é—®&quot;æ²¡æœ‰æ­£ç¡®ç†è§£ã€‚ &quot;ä¸åŒåŒ…ä¸­çš„å­ç±»å¯ä»¥è®¿é—®&quot;ï¼Œæ˜¯æŒ‡å½“ä¸¤ä¸ªç±»ä¸åœ¨åŒä¸€ä¸ªåŒ…ä¸­çš„æ—¶å€™ï¼Œç»§æ‰¿è‡ªçˆ¶ç±»çš„å­ç±»å†…éƒ¨ä¸”ä¸»è°ƒï¼ˆè°ƒç”¨è€…ï¼‰ä¸ºå­ç±»çš„å¼•ç”¨æ—¶æ‰èƒ½è®¿é—®çˆ¶ç±»ç”¨protectedä¿®é¥°çš„æˆå‘˜ï¼ˆå±æ€§/æ–¹æ³•ï¼‰ã€‚ åœ¨å­ç±»å†…éƒ¨ï¼Œä¸»è°ƒä¸ºçˆ¶ç±»çš„å¼•ç”¨æ—¶å¹¶ä¸èƒ½è®¿é—®æ­¤protectedä¿®é¥°çš„æˆå‘˜ã€‚ï¼ï¼ˆsuperå…³é”®å­—é™¤å¤–ï¼‰ äºæ˜¯ï¼Œä¸Šä¾‹æ”¹æˆå¦‚ä¸‹å½¢å¼ï¼Œå¯ä»¥æ­£å¸¸ç¼–è¯‘ï¼š 12345678910111213public class ObjectTest &#123; public static void main(String[] args) &#123; ObjectTest ot1 = new ObjectTest(); try &#123; ObjectTest ot2 = (ObjectTest) ot1.clone(); &#125; catch (CloneNotSupportedException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; &#125;&#125; æ˜¯çš„ï¼Œå› ä¸ºæ­¤æ—¶çš„ä¸»è°ƒå·²ç»æ˜¯å­ç±»çš„å¼•ç”¨äº†ã€‚ ä¸Šè¿°ä»£ç åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šæŠ›å‡º&quot;java.lang.CloneNotSupportedException&quot;,è¡¨æ˜clone()æ–¹æ³•å¹¶æœªæ­£ç¡®æ‰§è¡Œå®Œæ¯•ï¼Œé—®é¢˜çš„åŸå› åœ¨ä¸Javaä¸­çš„è¯­æ³•è§„å®šï¼š clone()çš„æ­£ç¡®è°ƒç”¨æ˜¯éœ€è¦å®ç°Cloneableæ¥å£ï¼Œå¦‚æœæ²¡æœ‰å®ç°Cloneableæ¥å£ï¼Œå¹¶ä¸”å­ç±»ç›´æ¥è°ƒç”¨Objectç±»çš„clone()æ–¹æ³•ï¼Œåˆ™ä¼šæŠ›å‡ºCloneNotSupportedExceptionå¼‚å¸¸ã€‚ Cloneableæ¥å£ä»…æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ¥å£ï¼Œæ¥å£æœ¬èº«ä¸åŒ…å«ä»»ä½•æ–¹æ³•ï¼Œç”¨æ¥æŒ‡ç¤ºObject.clone()å¯ä»¥åˆæ³•çš„è¢«å­ç±»å¼•ç”¨æ‰€è°ƒç”¨ã€‚ äºæ˜¯ï¼Œä¸Šè¿°ä»£ç æ”¹æˆå¦‚ä¸‹å½¢å¼ï¼Œå³å¯æ­£ç¡®æŒ‡å®šclone()æ–¹æ³•ä»¥å®ç°å…‹éš†ã€‚ 12345678910111213141516 3 public class ObjectTest implements Cloneable &#123; 4 5 public static void main(String[] args) &#123; 6 7 ObjectTest ot1 = new ObjectTest(); 8 9 try &#123;10 ObjectTest ot2 = (ObjectTest) ot1.clone();11 System.out.println(\"ot2:\" + ot2);12 &#125; catch (CloneNotSupportedException e) &#123;13 // TODO Auto-generated catch block14 e.printStackTrace();15 &#125;16 &#125;17 18 &#125; 4ã€public final native Class&lt;?&gt; getClass();getClass()ä¹Ÿæ˜¯ä¸€ä¸ªnativeæ–¹æ³•ï¼Œè¿”å›çš„æ˜¯æ­¤Objectå¯¹è±¡çš„ç±»å¯¹è±¡/è¿è¡Œæ—¶ç±»å¯¹è±¡Class&lt;?&gt;ã€‚æ•ˆæœä¸Object.classç›¸åŒã€‚ é¦–å…ˆè§£é‡Šä¸‹&quot;ç±»å¯¹è±¡&quot;çš„æ¦‚å¿µï¼šåœ¨Javaä¸­ï¼Œç±»æ˜¯å¯¹å…·æœ‰ä¸€ç»„ç›¸åŒç‰¹å¾æˆ–è¡Œä¸ºçš„å®ä¾‹çš„æŠ½è±¡å¹¶è¿›è¡Œæè¿°ï¼Œå¯¹è±¡åˆ™æ˜¯æ­¤ç±»æ‰€æè¿°çš„ç‰¹å¾æˆ–è¡Œä¸ºçš„å…·ä½“å®ä¾‹ã€‚ä½œä¸ºæ¦‚å¿µå±‚æ¬¡çš„ç±»ï¼Œå…¶æœ¬èº«ä¹Ÿå…·æœ‰æŸäº›å…±åŒçš„ç‰¹æ€§ï¼Œå¦‚éƒ½å…·æœ‰ç±»åç§°ã€ç”±ç±»åŠ è½½å™¨å»åŠ è½½ï¼Œéƒ½å…·æœ‰åŒ…ï¼Œå…·æœ‰çˆ¶ç±»ï¼Œå±æ€§å’Œæ–¹æ³•ç­‰ã€‚äºæ˜¯ï¼ŒJavaä¸­æœ‰ä¸“é—¨å®šä¹‰äº†ä¸€ä¸ªç±»ï¼ŒClassï¼Œå»æè¿°å…¶ä»–ç±»æ‰€å…·æœ‰çš„è¿™äº›ç‰¹æ€§ï¼Œå› æ­¤ï¼Œä»æ­¤è§’åº¦å»çœ‹ï¼Œç±»æœ¬èº«ä¹Ÿéƒ½æ˜¯å±äºClassç±»çš„å¯¹è±¡ã€‚ä¸ºä¸ç»å¸¸æ„ä¹‰ä¸Šçš„å¯¹è±¡ç›¸åŒºåˆ†ï¼Œåœ¨æ­¤ç§°ä¹‹ä¸º&quot;ç±»å¯¹è±¡&quot;ã€‚ 5ã€public boolean equals(Object obj);==ä¸equalsåœ¨ Java ä¸­ç»å¸¸è¢«ä½¿ç”¨ï¼Œå¤§å®¶ä¹Ÿéƒ½çŸ¥é“==ä¸equalsçš„åŒºåˆ«ï¼š ==è¡¨ç¤ºçš„æ˜¯å˜é‡å€¼å®Œæˆç›¸åŒï¼ˆå¯¹äºåŸºç¡€ç±»å‹ï¼Œåœ°å€ä¸­å­˜å‚¨çš„æ˜¯å€¼ï¼Œå¼•ç”¨ç±»å‹åˆ™å­˜å‚¨æŒ‡å‘å®é™…å¯¹è±¡çš„åœ°å€ï¼‰ equalsè¡¨ç¤ºçš„æ˜¯å¯¹è±¡çš„å†…å®¹å®Œå…¨ç›¸åŒï¼Œæ­¤å¤„çš„å†…å®¹å¤šæŒ‡å¯¹è±¡çš„ç‰¹å¾/å±æ€§ã€‚ å®é™…ä¸Šï¼Œä¸Šé¢è¯´æ³•æ˜¯ä¸ä¸¥è°¨çš„ï¼Œæ›´å¤šçš„åªæ˜¯å¸¸è§äºStringç±»ä¸­ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹Objectç±»ä¸­å…³äºequals()æ–¹æ³•çš„å®šä¹‰ï¼š 123public boolean equals(Object obj) &#123; return (this == obj);&#125; ç”±æ­¤å¯è§ï¼ŒObjectåŸç”Ÿçš„equals()æ–¹æ³•å†…éƒ¨è°ƒç”¨çš„æ­£æ˜¯==ï¼Œä¸==å…·æœ‰ç›¸åŒçš„å«ä¹‰ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å®šä¹‰æ­¤equals()æ–¹æ³•ï¼Ÿ equlas()æ–¹æ³•çš„æ­£ç¡®ç†è§£åº”è¯¥æ˜¯ï¼šåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚é‚£ä¹ˆåˆ¤æ–­å¯¹è±¡ç›¸ç­‰çš„æ ‡å°ºåˆæ˜¯ä»€ä¹ˆï¼Ÿ å¦‚ä¸Šï¼Œåœ¨Objectç±»ä¸­ï¼Œæ­¤æ ‡å°ºå³ä¸º==ã€‚å½“ç„¶ï¼Œè¿™ä¸ªæ ‡å°ºä¸æ˜¯å›ºå®šçš„ï¼Œå…¶ä»–ç±»ä¸­å¯ä»¥æŒ‰ç…§å®é™…çš„éœ€è¦å¯¹æ­¤æ ‡å°ºå«ä¹‰è¿›è¡Œé‡å®šä¹‰ã€‚å¦‚Stringç±»ä¸­åˆ™æ˜¯ä¾æ®å­—ç¬¦ä¸²å†…å®¹æ˜¯å¦ç›¸ç­‰æ¥é‡å®šä¹‰äº†æ­¤æ ‡å°ºå«ä¹‰ã€‚å¦‚æ­¤å¯ä»¥å¢åŠ ç±»çš„åŠŸèƒ½å‹å’Œå®é™…ç¼–ç çš„çµæ´»æ€§ã€‚å½“ç„¶äº†ï¼Œå¦‚æœè‡ªå®šä¹‰çš„ç±»æ²¡æœ‰é‡å†™equals()æ–¹æ³•æ¥é‡æ–°å®šä¹‰æ­¤æ ‡å°ºï¼Œé‚£ä¹ˆé»˜è®¤çš„å°†æ˜¯å…¶çˆ¶ç±»çš„equals()ï¼Œç›´åˆ°ObjectåŸºç±»ã€‚ String ç±»çš„ equals(): 123456789101112131415161718192021public boolean equals(Object anObject) &#123; if (this == anObject) &#123; return true; &#125; if (anObject instanceof String) &#123; String anotherString = (String)anObject; int n = value.length; if (n == anotherString.value.length) &#123; char v1[] = value; char v2[] = anotherString.value; int i = 0; while (n-- != 0) &#123; if (v1[i] != v2[i]) return false; i++; &#125; return true; &#125; &#125; return false; &#125; å¦‚ä¸‹åœºæ™¯çš„å®é™…ä¸šåŠ¡éœ€æ±‚ï¼Œå¯¹äºUser beanï¼Œç”±å®é™…çš„ä¸šåŠ¡éœ€æ±‚å¯çŸ¥å½“å±æ€§uidç›¸åŒæ—¶ï¼Œè¡¨ç¤ºçš„æ˜¯åŒä¸€ä¸ªUserï¼Œå³ä¸¤ä¸ªUserå¯¹è±¡ç›¸ç­‰ã€‚åˆ™å¯ä»¥é‡å†™equalsä»¥é‡å®šä¹‰Userå¯¹è±¡ç›¸ç­‰çš„æ ‡å°ºã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041public class User &#123; private int uid; private String name; private int age; public int getUid() &#123; return uid; &#125; public void setUid(int uid) &#123; this.uid = uid; &#125; protected String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public int getAge() &#123; return age; &#125; public void setAge(int age) &#123; this.age = age; &#125; @Override public boolean equals(Object obj) &#123; if (obj == null || !(obj instanceof User)) &#123; return false; &#125; if (((User) obj).getUid() == this.getUid()) &#123; return true; &#125; return false; &#125;&#125; 123456789101112131415public class ObjectTest implements Cloneable &#123; public static void main(String[] args) &#123; User u1 = new User(); u1.setUid(111); u1.setName(\"å¼ ä¸‰\"); User u2 = new User(); u2.setUid(111); u2.setName(\"å¼ ä¸‰ä¸°\"); System.out.println(u1.equals(u2)); //è¿”å›true &#125;&#125; ObjectTestä¸­æ‰“å°å‡ºtrueï¼Œå› ä¸ºUserç±»å®šä¹‰ä¸­é‡å†™äº†equals()æ–¹æ³•ï¼Œè¿™å¾ˆå¥½ç†è§£ï¼Œå¾ˆå¯èƒ½å¼ ä¸‰æ˜¯ä¸€ä¸ªäººå°åï¼Œå¼ ä¸‰ä¸°æ‰æ˜¯å…¶å¤§åï¼Œåˆ¤æ–­è¿™ä¸¤ä¸ªäººæ˜¯ä¸æ˜¯åŒä¸€ä¸ªäººï¼Œè¿™æ—¶åªç”¨åˆ¤æ–­uidæ˜¯å¦ç›¸åŒå³å¯ã€‚ å¦‚ä¸Šé‡å†™equalsæ–¹æ³•è¡¨é¢ä¸Šçœ‹ä¸Šå»æ˜¯å¯ä»¥äº†ï¼Œå®åˆ™ä¸ç„¶ã€‚å› ä¸ºå®ƒç ´åäº†Javaä¸­çš„çº¦å®šï¼šé‡å†™equals()æ–¹æ³•å¿…é¡»é‡å†™hasCode()æ–¹æ³• è¡¥å…… ç­‰ä»·å…³ç³» è‡ªåæ€§ 1x.equals(x); // true å¯¹ç§°æ€§ 1x.equals(y) == y.equals(x); // true ä¼ é€’æ€§ 12if (x.equals(y) &amp;&amp; y.equals(z)) x.equals(z); // true; ä¸€è‡´æ€§ 12å¤šæ¬¡è°ƒç”¨ equals() æ–¹æ³•ç»“æœä¸å˜x.equals(y) == x.equals(y); // true ä¸ null çš„æ¯”è¾ƒ 12å¯¹ä»»ä½•ä¸æ˜¯ null çš„å¯¹è±¡ x è°ƒç”¨ x.equals(null) ç»“æœéƒ½ä¸º falsex.equals(null); // false; equals() ä¸ == å¯¹äºåŸºæœ¬ç±»å‹ï¼Œ== åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼ŒåŸºæœ¬ç±»å‹æ²¡æœ‰ equals() æ–¹æ³•ã€‚ å¯¹äºå¼•ç”¨ç±»å‹ï¼Œ== åˆ¤æ–­ä¸¤ä¸ªå˜é‡æ˜¯å¦å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ï¼Œè€Œ equals() åˆ¤æ–­å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦ç­‰ä»·ã€‚ 1234Integer x = new Integer(1);Integer y = new Integer(1);System.out.println(x.equals(y)); // trueSystem.out.println(x == y); // false 6ã€public native int hashCode();hashCode()æ–¹æ³•è¿”å›ä¸€ä¸ªæ•´å½¢æ•°å€¼ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡çš„å“ˆå¸Œç å€¼ã€‚ hashCode()å…·æœ‰å¦‚ä¸‹çº¦å®šï¼š åœ¨Javaåº”ç”¨ç¨‹åºç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œå¯¹äºåŒä¸€å¯¹è±¡å¤šæ¬¡è°ƒç”¨hashCode()æ–¹æ³•æ—¶ï¼Œå…¶è¿”å›çš„å“ˆå¸Œç æ˜¯ç›¸åŒçš„ï¼Œå‰ææ˜¯å°†å¯¹è±¡è¿›è¡Œequalsæ¯”è¾ƒæ—¶æ‰€ç”¨çš„æ ‡å°ºä¿¡æ¯æœªåšä¿®æ”¹ã€‚åœ¨Javaåº”ç”¨ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œåˆ°å¦å¤–ä¸€æ¬¡æ‰§è¡Œï¼ŒåŒä¸€å¯¹è±¡çš„hashCode()è¿”å›çš„å“ˆå¸Œç æ— é¡»ä¿æŒä¸€è‡´ï¼› å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼ˆä¾æ®ï¼šè°ƒç”¨equals()æ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡è°ƒç”¨hashCode()è¿”å›çš„å“ˆå¸Œç ä¹Ÿå¿…é¡»ç›¸ç­‰ï¼› åä¹‹ï¼Œä¸¤ä¸ªå¯¹è±¡è°ƒç”¨hasCode()è¿”å›çš„å“ˆå¸Œç ç›¸ç­‰ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ã€‚ ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæ–°å»ºäº†ä¸¤ä¸ªç­‰ä»·çš„å¯¹è±¡ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ° HashSet ä¸­ã€‚æˆ‘ä»¬å¸Œæœ›å°†è¿™ä¸¤ä¸ªå¯¹è±¡å½“æˆä¸€æ ·çš„ï¼Œåªåœ¨é›†åˆä¸­æ·»åŠ ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å› ä¸º EqualExample æ²¡æœ‰å®ç° hasCode() æ–¹æ³•ï¼Œå› æ­¤è¿™ä¸¤ä¸ªå¯¹è±¡çš„æ•£åˆ—å€¼æ˜¯ä¸åŒçš„ï¼Œæœ€ç»ˆå¯¼è‡´é›†åˆæ·»åŠ äº†ä¸¤ä¸ªç­‰ä»·çš„å¯¹è±¡ã€‚ 1234567EqualExample e1 = new EqualExample(1, 1, 1);EqualExample e2 = new EqualExample(1, 1, 1);System.out.println(e1.equals(e2)); // trueHashSet&lt;EqualExample&gt; set = new HashSet&lt;&gt;();set.add(e1);set.add(e2);System.out.println(set.size()); // 2 ç†æƒ³çš„æ•£åˆ—å‡½æ•°åº”å½“å…·æœ‰å‡åŒ€æ€§ï¼Œå³ä¸ç›¸ç­‰çš„å¯¹è±¡åº”å½“å‡åŒ€åˆ†å¸ƒåˆ°æ‰€æœ‰å¯èƒ½çš„æ•£åˆ—å€¼ä¸Šã€‚è¿™å°±è¦æ±‚äº†æ•£åˆ—å‡½æ•°è¦æŠŠæ‰€æœ‰åŸŸçš„å€¼éƒ½è€ƒè™‘è¿›æ¥ï¼Œå¯ä»¥å°†æ¯ä¸ªåŸŸéƒ½å½“æˆ R è¿›åˆ¶çš„æŸä¸€ä½ï¼Œç„¶åç»„æˆä¸€ä¸ª R è¿›åˆ¶çš„æ•´æ•°ã€‚R ä¸€èˆ¬å– 31ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¥‡ç´ æ•°ï¼Œå¦‚æœæ˜¯å¶æ•°çš„è¯ï¼Œå½“å‡ºç°ä¹˜æ³•æº¢å‡ºï¼Œä¿¡æ¯å°±ä¼šä¸¢å¤±ï¼Œå› ä¸ºä¸ 2 ç›¸ä¹˜ç›¸å½“äºå‘å·¦ç§»ä¸€ä½ã€‚ ä¸€ä¸ªæ•°ä¸ 31 ç›¸ä¹˜å¯ä»¥è½¬æ¢æˆç§»ä½å’Œå‡æ³•ï¼š31*x == (x&lt;&lt;5)-xï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œè¿™ä¸ªä¼˜åŒ–ã€‚ 12345678@Overridepublic int hashCode() &#123; int result = 17; result = 31 * result + x; result = 31 * result + y; result = 31 * result + z; return result;&#125; 7ã€public String toString();toString()æ–¹æ³•è¿”å›è¯¥å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚å…ˆçœ‹ä¸€ä¸‹Objectä¸­çš„å…·ä½“æ–¹æ³•ä½“ï¼š 123public String toString() &#123; return getClass().getName() + \"@\" + Integer.toHexString(hashCode());&#125; toString()æ–¹æ³•ç›¸ä¿¡å¤§å®¶éƒ½ç»å¸¸ç”¨åˆ°ï¼Œå³ä½¿æ²¡æœ‰æ˜¾å¼è°ƒç”¨ï¼Œä½†å½“æˆ‘ä»¬ä½¿ç”¨System.out.println(obj)æ—¶ï¼Œå…¶å†…éƒ¨ä¹Ÿæ˜¯é€šè¿‡toString()æ¥å®ç°çš„ã€‚ getClass()è¿”å›å¯¹è±¡çš„ç±»å¯¹è±¡ï¼ŒgetClassName()ä»¥Stringå½¢å¼è¿”å›ç±»å¯¹è±¡çš„åç§°ï¼ˆå«åŒ…åï¼‰ã€‚Integer.toHexString(hashCode())åˆ™æ˜¯ä»¥å¯¹è±¡çš„å“ˆå¸Œç ä¸ºå®å‚ï¼Œä»¥16è¿›åˆ¶æ— ç¬¦å·æ•´æ•°å½¢å¼è¿”å›æ­¤å“ˆå¸Œç çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚ å› æ­¤ï¼štoString()æ˜¯ç”±å¯¹è±¡çš„ç±»å‹å’Œå…¶å“ˆå¸Œç å”¯ä¸€ç¡®å®šï¼ŒåŒä¸€ç±»å‹ä½†ä¸ç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡åˆ†åˆ«è°ƒç”¨toString()æ–¹æ³•è¿”å›çš„ç»“æœå¯èƒ½ç›¸åŒã€‚ 8~12ã€wait(â€¦) / notify() / notifyAll()ä¸€è¯´åˆ°wait(...) / notify() | notifyAll()å‡ ä¸ªæ–¹æ³•ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯çº¿ç¨‹ã€‚ç¡®å®ï¼Œè¿™å‡ ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºjavaå¤šçº¿ç¨‹ä¹‹é—´çš„åä½œã€‚å…ˆå…·ä½“çœ‹ä¸‹è¿™å‡ ä¸ªæ–¹æ³•çš„ä¸»è¦å«ä¹‰ï¼š wait()ï¼šè°ƒç”¨æ­¤æ–¹æ³•æ‰€åœ¨çš„å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°åœ¨å…¶ä»–çº¿ç¨‹ä¸Šè°ƒç”¨æ­¤æ–¹æ³•çš„ä¸»è°ƒï¼ˆæŸä¸€å¯¹è±¡ï¼‰çš„notify()/notifyAll()æ–¹æ³•ã€‚ wait(long timeout)/wait(long timeout, int nanos)ï¼šè°ƒç”¨æ­¤æ–¹æ³•æ‰€åœ¨çš„å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°åœ¨å…¶ä»–çº¿ç¨‹ä¸Šè°ƒç”¨æ­¤æ–¹æ³•çš„ä¸»è°ƒï¼ˆæŸä¸€å¯¹è±¡ï¼‰çš„notify()/notifyAll()æ–¹æ³•ï¼Œæˆ–è¶…è¿‡æŒ‡å®šçš„è¶…æ—¶æ—¶é—´é‡ã€‚ notify()/notifyAll()ï¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹/æ‰€æœ‰çº¿ç¨‹ã€‚ wait(...) / notify() | notifyAll()ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯é…å¥—ä½¿ç”¨ã€‚ä¸‹é¢æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546public class ThreadTest &#123; /** * @param args */ public static void main(String[] args) &#123; // TODO Auto-generated method stub MyRunnable r = new MyRunnable(); Thread t = new Thread(r); t.start(); synchronized (r) &#123; try &#123; System.out.println(\"main thread ç­‰å¾…tçº¿ç¨‹æ‰§è¡Œå®Œ\"); r.wait(); System.out.println(\"è¢«notityå”¤é†’ï¼Œå¾—ä»¥ç»§ç»­æ‰§è¡Œ\"); &#125; catch (InterruptedException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); System.out.println(\"main thread æœ¬æƒ³ç­‰å¾…ï¼Œä½†è¢«æ„å¤–æ‰“æ–­äº†\"); &#125; System.out.println(\"çº¿ç¨‹tæ‰§è¡Œç›¸åŠ ç»“æœ\" + r.getTotal()); &#125; &#125;&#125;class MyRunnable implements Runnable &#123; private int total; @Override public void run() &#123; // TODO Auto-generated method stub synchronized (this) &#123; System.out.println(\"Thread name is:\" + Thread.currentThread().getName()); for (int i = 0; i &lt; 10; i++) &#123; total += i; &#125; notify(); System.out.println(\"æ‰§è¡ŒnotifååŒæ­¥ä»£ç å—ä¸­ä¾ç„¶å¯ä»¥ç»§ç»­æ‰§è¡Œç›´è‡³å®Œæ¯•\"); &#125; System.out.println(\"æ‰§è¡Œnotifåä¸”åŒæ­¥ä»£ç å—å¤–çš„ä»£ç æ‰§è¡Œæ—¶æœºå–å†³äºçº¿ç¨‹è°ƒåº¦\"); &#125; public int getTotal() &#123; return total; &#125;&#125; è¿è¡Œç»“æœï¼š 123456main thread ç­‰å¾…tçº¿ç¨‹æ‰§è¡Œå®ŒThread name is:Thread-0æ‰§è¡ŒnotifååŒæ­¥ä»£ç å—ä¸­ä¾ç„¶å¯ä»¥ç»§ç»­æ‰§è¡Œç›´è‡³å®Œæ¯•æ‰§è¡Œnotifåä¸”åŒæ­¥ä»£ç å—å¤–çš„ä»£ç æ‰§è¡Œæ—¶æœºå–å†³äºçº¿ç¨‹è°ƒåº¦ //æ­¤è¡Œè¾“å‡ºä½ç½®æœ‰å…·ä½“çš„JVMçº¿ç¨‹è°ƒåº¦å†³å®šï¼Œæœ‰å¯èƒ½æœ€åæ‰§è¡Œè¢«notityå”¤é†’ï¼Œå¾—ä»¥ç»§ç»­æ‰§è¡Œçº¿ç¨‹tæ‰§è¡Œç›¸åŠ ç»“æœ45 æ—¢ç„¶æ˜¯ä½œç”¨äºå¤šçº¿ç¨‹ä¸­ï¼Œä¸ºä»€ä¹ˆå´æ˜¯Objectè¿™ä¸ªåŸºç±»æ‰€å…·æœ‰çš„æ–¹æ³•ï¼ŸåŸå› åœ¨äºç†è®ºä¸Šä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è§†ä¸ºçº¿ç¨‹åŒæ­¥ä¸­çš„ç›‘å¬å™¨ï¼Œä¸”wait(...)/notify()|notifyAll()æ–¹æ³•åªèƒ½åœ¨åŒæ­¥ä»£ç å—ä¸­æ‰èƒ½ä½¿ç”¨ã€‚ ä»ä¸Šè¿°ä¾‹å­çš„è¾“å‡ºç»“æœä¸­å¯ä»¥å¾—å‡ºå¦‚ä¸‹ç»“è®ºï¼š wait(...)æ–¹æ³•è°ƒç”¨åå½“å‰çº¿ç¨‹å°†ç«‹å³é˜»å¡ï¼Œä¸”é‡Šæ”¾å…¶æ‰€æŒæœ‰çš„åŒæ­¥ä»£ç å—ä¸­çš„é”ï¼Œç›´åˆ°è¢«å”¤é†’æˆ–è¶…æ—¶æˆ–æ‰“æ–­åä¸”é‡æ–°è·å–åˆ°é”åæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼› notify()/notifyAll()æ–¹æ³•è°ƒç”¨åï¼Œå…¶æ‰€åœ¨çº¿ç¨‹ä¸ä¼šç«‹å³é‡Šæ”¾æ‰€æŒæœ‰çš„é”ï¼Œç›´åˆ°å…¶æ‰€åœ¨åŒæ­¥ä»£ç å—ä¸­çš„ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œæ­¤æ—¶é‡Šæ”¾é”ï¼Œå› æ­¤ï¼Œå¦‚æœå…¶åŒæ­¥ä»£ç å—åè¿˜æœ‰ä»£ç ï¼Œå…¶æ‰§è¡Œåˆ™ä¾èµ–äºJVMçš„çº¿ç¨‹è°ƒåº¦ã€‚ åœ¨Javaæºç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°wait()å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š 123public final void wait() throws InterruptedException &#123; wait(0);&#125; ä¸”wait(long timeout, int nanos)æ–¹æ³•å®šä¹‰å†…éƒ¨å®è´¨ä¸Šä¹Ÿæ˜¯é€šè¿‡è°ƒç”¨wait(long timeout)å®Œæˆã€‚è€Œwait(long timeout)æ˜¯ä¸€ä¸ªnativeæ–¹æ³•ã€‚å› æ­¤ï¼Œwait(...)æ–¹æ³•æœ¬è´¨ä¸Šéƒ½æ˜¯nativeæ–¹å¼å®ç°ã€‚ notify()/notifyAll()æ–¹æ³•ä¹Ÿéƒ½æ˜¯nativeæ–¹æ³•ã€‚ 13ã€protected void finalize();finalizeæ–¹æ³•ä¸»è¦ä¸Javaåƒåœ¾å›æ”¶æœºåˆ¶æœ‰å…³ã€‚é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹finalizedæ–¹æ³•åœ¨Objectä¸­çš„å…·ä½“å®šä¹‰ï¼š 1protected void finalize() throws Throwable &#123; &#125; æˆ‘ä»¬å‘ç°Objectç±»ä¸­finalizeæ–¹æ³•è¢«å®šä¹‰æˆä¸€ä¸ªç©ºæ–¹æ³•ï¼Œä¸ºä»€ä¹ˆè¦å¦‚æ­¤å®šä¹‰å‘¢ï¼Ÿfinalizeæ–¹æ³•çš„è°ƒç”¨æ—¶æœºæ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ é¦–å…ˆï¼ŒObjectä¸­å®šä¹‰finalizeæ–¹æ³•è¡¨æ˜Javaä¸­æ¯ä¸€ä¸ªå¯¹è±¡éƒ½å°†å…·æœ‰finalizeè¿™ç§è¡Œä¸ºï¼Œå…¶å…·ä½“è°ƒç”¨æ—¶æœºåœ¨ï¼šJVMå‡†å¤‡å¯¹æ­¤å¯¹å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´è¿›è¡Œåƒåœ¾å›æ”¶å‰ï¼Œå°†è¢«è°ƒç”¨ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ–¹æ³•å¹¶ä¸æ˜¯ç”±æˆ‘ä»¬ä¸»åŠ¨å»è°ƒç”¨çš„ï¼ˆè™½ç„¶å¯ä»¥ä¸»åŠ¨å»è°ƒç”¨ï¼Œæ­¤æ—¶ä¸å…¶ä»–è‡ªå®šä¹‰æ–¹æ³•æ— å¼‚ï¼‰ã€‚","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Javaå…³é”®å­—finalå’Œstatic","slug":"Javaå…³é”®å­—finalå’Œstatic","date":"2017-09-02T07:31:51.000Z","updated":"2018-08-25T06:49:34.881Z","comments":true,"path":"Javaå…³é”®å­—finalå’Œstatic.html","link":"","permalink":"http://xiaoqinghua.site/Javaå…³é”®å­—finalå’Œstatic.html","excerpt":"","text":"å…³é”®å­—final1ã€æ•°æ®ï¼š å£°æ˜æ•°æ®ä¸ºå¸¸é‡ï¼Œå¯ä»¥æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨è¿è¡Œæ—¶è¢«åˆå§‹åŒ–åä¸èƒ½è¢«æ”¹å˜çš„å¸¸é‡ã€‚ å¯¹äºåŸºæœ¬ç±»å‹ï¼Œfinal ä½¿æ•°å€¼ä¸å˜ï¼› å¯¹äºå¼•ç”¨ç±»å‹ï¼Œfinal ä½¿å¼•ç”¨ä¸å˜ï¼Œä¹Ÿå°±ä¸èƒ½å¼•ç”¨å…¶å®ƒå¯¹è±¡ï¼Œä½†æ˜¯è¢«å¼•ç”¨çš„å¯¹è±¡æœ¬èº«æ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚ 1234final int x = 1;// x = 2; // cannot assign value to final variable 'x'final A y = new A();y.a = 1; 2ã€æ–¹æ³•ï¼š å£°æ˜æ–¹æ³•ä¸èƒ½è¢«å­ç±»é‡å†™ã€‚ private æ–¹æ³•éšå¼åœ°è¢«æŒ‡å®šä¸º finalï¼Œå¦‚æœåœ¨å­ç±»ä¸­å®šä¹‰çš„æ–¹æ³•å’ŒåŸºç±»ä¸­çš„ä¸€ä¸ª private æ–¹æ³•ç­¾åç›¸åŒï¼Œæ­¤æ—¶å­ç±»çš„æ–¹æ³•ä¸æ˜¯é‡å†™åŸºç±»æ–¹æ³•ï¼Œè€Œæ˜¯åœ¨å­ç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•ã€‚ 3ã€ç±»ï¼š å£°æ˜ç±»ä¸å…è®¸è¢«ç»§æ‰¿ã€‚ static1ã€é™æ€å˜é‡ï¼š é™æ€å˜é‡ï¼šåˆç§°ä¸ºç±»å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå˜é‡å±äºç±»çš„ï¼Œç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å…±äº«é™æ€å˜é‡ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åæ¥è®¿é—®å®ƒï¼›é™æ€å˜é‡åœ¨å†…å­˜ä¸­åªå­˜åœ¨ä¸€ä»½ã€‚ å®ä¾‹å˜é‡ï¼šæ¯åˆ›å»ºä¸€ä¸ªå®ä¾‹å°±ä¼šäº§ç”Ÿä¸€ä¸ªå®ä¾‹å˜é‡ï¼Œå®ƒä¸è¯¥å®ä¾‹åŒç”Ÿå…±æ­»ã€‚ 1234567891011public class A &#123; private int x; // å®ä¾‹å˜é‡ private static int y; // é™æ€å˜é‡ public static void main(String[] args) &#123; // int x = A.x; // Non-static field 'x' cannot be referenced from a static context A a = new A(); int x = a.x; int y = A.y; &#125;&#125; 2ã€é™æ€æ–¹æ³•ï¼š é™æ€æ–¹æ³•åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±å­˜åœ¨äº†ï¼Œå®ƒä¸ä¾èµ–äºä»»ä½•å®ä¾‹ã€‚æ‰€ä»¥é™æ€æ–¹æ³•å¿…é¡»æœ‰å®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸èƒ½æ˜¯æŠ½è±¡æ–¹æ³•ï¼ˆabstractï¼‰ã€‚ 12345public abstract class A &#123; public static void func1()&#123; &#125; // public abstract static void func2(); // Illegal combination of modifiers: 'abstract' and 'static'&#125; åªèƒ½è®¿é—®æ‰€å±ç±»çš„é™æ€å­—æ®µå’Œé™æ€æ–¹æ³•ï¼Œæ–¹æ³•ä¸­ä¸èƒ½æœ‰ this å’Œ super å…³é”®å­—ã€‚ 12345678910public class A &#123; private static int x; private int y; public static void func1()&#123; int a = x; // int b = y; // Non-static field 'y' cannot be referenced from a static context // int b = this.y; // 'A.this' cannot be referenced from a static context &#125;&#125; 3ã€é™æ€è¯­å¥å—ï¼š é™æ€è¯­å¥å—åœ¨ç±»åˆå§‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡ã€‚ 1234567891011public class A &#123; static &#123; System.out.println(\"123\"); &#125; public static void main(String[] args) &#123; A a1 = new A(); A a2 = new A(); &#125;&#125;123 4ã€é™æ€å†…éƒ¨ç±»ï¼š éé™æ€å†…éƒ¨ç±»ä¾èµ–äºå¤–éƒ¨ç±»çš„å®ä¾‹ï¼Œè€Œé™æ€å†…éƒ¨ç±»ä¸éœ€è¦ã€‚ 1234567891011121314public class OuterClass &#123; class InnerClass &#123; &#125; static class StaticInnerClass &#123; &#125; public static void main(String[] args) &#123; // InnerClass innerClass = new InnerClass(); // 'OuterClass.this' cannot be referenced from a static context OuterClass outerClass = new OuterClass(); InnerClass innerClass = outerClass.new InnerClass(); StaticInnerClass staticInnerClass = new StaticInnerClass(); &#125;&#125; é™æ€å†…éƒ¨ç±»ä¸èƒ½è®¿é—®å¤–éƒ¨ç±»çš„éé™æ€çš„å˜é‡å’Œæ–¹æ³•ã€‚ 5ã€é™æ€å¯¼åŒ…ï¼š åœ¨ä½¿ç”¨é™æ€å˜é‡å’Œæ–¹æ³•æ—¶ä¸ç”¨å†æŒ‡æ˜ ClassNameï¼Œä»è€Œç®€åŒ–ä»£ç ï¼Œä½†å¯è¯»æ€§å¤§å¤§é™ä½ã€‚ 1import static com.xxx.ClassName.* 6ã€åˆå§‹åŒ–é¡ºåºï¼š é™æ€å˜é‡å’Œé™æ€è¯­å¥å—ä¼˜å…ˆäºå®ä¾‹å˜é‡å’Œæ™®é€šè¯­å¥å—ï¼Œé™æ€å˜é‡å’Œé™æ€è¯­å¥å—çš„åˆå§‹åŒ–é¡ºåºå–å†³äºå®ƒä»¬åœ¨ä»£ç ä¸­çš„é¡ºåºã€‚ 12345678public static String staticField = \"é™æ€å˜é‡\";static &#123; System.out.println(\"é™æ€è¯­å¥å—\");&#125;public String field = \"å®ä¾‹å˜é‡\";&#123; System.out.println(\"æ™®é€šè¯­å¥å—\");&#125; æœ€åæ‰æ˜¯æ„é€ å‡½æ•°çš„åˆå§‹åŒ–ã€‚ 123public InitialOrderTest() &#123; System.out.println(\"æ„é€ å‡½æ•°\");&#125; å­˜åœ¨ç»§æ‰¿çš„æƒ…å†µä¸‹ï¼Œåˆå§‹åŒ–é¡ºåºä¸ºï¼š 1234561 çˆ¶ç±»ï¼ˆé™æ€å˜é‡ã€é™æ€è¯­å¥å—ï¼‰2 å­ç±»ï¼ˆé™æ€å˜é‡ã€é™æ€è¯­å¥å—ï¼‰3 çˆ¶ç±»ï¼ˆå®ä¾‹å˜é‡ã€æ™®é€šè¯­å¥å—ï¼‰4 çˆ¶ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰5 å­ç±»ï¼ˆå®ä¾‹å˜é‡ã€æ™®é€šè¯­å¥å—ï¼‰6 å­ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/Javaå…³é”®å­—finalå’Œstatic.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Java æŠ½è±¡ç±»å’Œæ¥å£","slug":"JavaæŠ½è±¡ç±»æ¥å£","date":"2017-08-27T11:56:48.000Z","updated":"2018-08-24T14:20:25.347Z","comments":true,"path":"JavaæŠ½è±¡ç±»æ¥å£.html","link":"","permalink":"http://xiaoqinghua.site/JavaæŠ½è±¡ç±»æ¥å£.html","excerpt":"","text":"æŠ½è±¡ç±» å½“ç¼–å†™ä¸€ä¸ªç±»æ—¶ï¼Œå¸¸å¸¸ä¼šä¸ºè¯¥ç±»å®šä¹‰ä¸€äº›æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ç”¨ä»¥æè¿°è¯¥ç±»çš„è¡Œä¸ºæ–¹å¼ï¼Œé‚£ä¹ˆè¿™äº›æ–¹æ³•éƒ½æœ‰å…·ä½“çš„æ–¹æ³•ä½“ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒæŸä¸ªçˆ¶ç±»åªæ˜¯çŸ¥é“å…¶å­ç±»åº”è¯¥åŒ…å«æ€æ ·çš„æ–¹æ³•ï¼Œä½†æ— æ³•å‡†ç¡®åœ°çŸ¥é“è¿™äº›å­ç±»å¦‚ä½•å®ç°è¿™äº›æ–¹æ³•ã€‚ä½¿ç”¨æŠ½è±¡æ–¹æ³•å³å¯æ»¡è¶³è¯¥è¦æ±‚ï¼šæŠ½è±¡æ–¹æ³•æ˜¯åªæœ‰æ–¹æ³•ç­¾åï¼ˆæ–¹æ³•å+å½¢å‚åˆ—è¡¨ï¼‰ï¼Œæ²¡æœ‰æ–¹æ³•å®ç°çš„æ–¹æ³• æŠ½è±¡æ–¹æ³•å’ŒæŠ½è±¡ç±»æŠ½è±¡æ–¹æ³•å’ŒæŠ½è±¡ç±»å¿…é¡»ä½¿ç”¨abstractä¿®é¥°ç¬¦æ¥å®šä¹‰ï¼Œæœ‰æŠ½è±¡æ–¹æ³•çš„ç±»åªèƒ½è¢«å®šä¹‰æˆæŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»é‡Œå¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³• æŠ½è±¡æ–¹æ³•å’ŒæŠ½è±¡ç±»çš„è§„åˆ™å¦‚ä¸‹ï¼š æŠ½è±¡ç±»å¿…é¡»ä½¿ç”¨abstractä¿®é¥°ç¬¦æ¥ä¿®é¥°ï¼ŒæŠ½è±¡æ–¹æ³•ä¹Ÿå¿…é¡»ä½¿ç”¨abstractä¿®é¥°ç¬¦æ¥ä¿®é¥°ï¼ŒæŠ½è±¡æ–¹æ³•ä¸èƒ½æœ‰æ–¹æ³•ä½“ æŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œæ— æ³•ä½¿ç”¨newå…³é”®å­—æ¥è°ƒç”¨æŠ½è±¡ç±»çš„æ„é€ å™¨åˆ›å»ºæŠ½è±¡ç±»çš„å®ä¾‹ã€‚å³ä½¿æŠ½è±¡ç±»é‡Œä¸åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªæŠ½è±¡ç±»ä¹Ÿä¸èƒ½åˆ›å»ºå®ä¾‹ æŠ½è±¡ç±»å¯ä»¥åŒ…å«æˆå‘˜å˜é‡ã€æ–¹æ³•ï¼ˆæ™®é€šæ–¹æ³•å’ŒæŠ½è±¡æ–¹æ³•ï¼‰ã€æ„é€ å™¨ã€åˆå§‹åŒ–å—ã€å†…éƒ¨ç±»ï¼ˆæ¥å£ã€æšä¸¾ï¼‰5ç§æˆåˆ†ã€‚æŠ½è±¡ç±»çš„æ„é€ å™¨ä¸èƒ½ç”¨äºåˆ›å»ºå®ä¾‹ï¼Œä¸»è¦æ˜¯ç”¨äºè¢«å…¶å­ç±»è°ƒç”¨ å«æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»ï¼ˆåŒ…æ‹¬ç›´æ¥å®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼›æˆ–ç»§æ‰¿äº†ä¸€ä¸ªæŠ½è±¡çˆ¶ç±»ï¼Œä½†æ²¡æœ‰å®Œå…¨å®ç°çˆ¶ç±»åŒ…å«çš„æŠ½è±¡æ–¹æ³•ï¼›æˆ–å®ç°äº†ä¸€ä¸ªæ¥å£ï¼Œä½†æ²¡æœ‰å®Œå…¨å®ç°æ¥å£åŒ…å«çš„æŠ½è±¡æ–¹æ³•ä¸‰ç§æƒ…å†µï¼‰åªèƒ½è¢«å®šä¹‰æˆæŠ½è±¡ç±» æŠ½è±¡ç±»ä¸ç©ºæ–¹æ³•ä½“çš„æ–¹æ³•ï¼špublic abstract void test(); public void test(){}; æŠ½è±¡ç±»ä¸èƒ½ç”¨äºåˆ›å»ºå®ä¾‹ï¼Œåªèƒ½å½“ä½œçˆ¶ç±»è¢«å…¶ä»–å­ç±»ç»§æ‰¿ å½“ä½¿ç”¨abstractä¿®é¥°ç±»æ—¶ï¼Œè¡¨æ˜è¿™ä¸ªç±»åªèƒ½è¢«ç»§æ‰¿ï¼›å½“ä½¿ç”¨abstractä¿®é¥°æ–¹æ³•æ—¶ï¼Œè¡¨æ˜è¿™ä¸ªæ–¹æ³•å¿…é¡»ç”±å­ç±»æä¾›å®ç°ï¼ˆå³é‡å†™ï¼‰ã€‚è€Œfinalä¿®é¥°çš„ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œfinalä¿®é¥°çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™ã€‚å› æ­¤finalå’Œabstractæ°¸è¿œä¸èƒ½åŒæ—¶ä½¿ç”¨ abstractä¸èƒ½ç”¨äºä¿®é¥°æˆå‘˜å˜é‡ï¼Œä¸èƒ½ç”¨äºä¿®é¥°å±€éƒ¨å˜é‡ï¼Œå³æ²¡æœ‰æŠ½è±¡å˜é‡ã€æ²¡æœ‰æŠ½è±¡æˆå‘˜å˜é‡ç­‰è¯´æ³•ï¼›abstractä¹Ÿä¸èƒ½ç”¨äºä¿®é¥°æ„é€ å™¨ï¼Œæ²¡æœ‰æŠ½è±¡æ„é€ å™¨ï¼ŒæŠ½è±¡ç±»é‡Œå®šä¹‰çš„æ„é€ å™¨åªèƒ½æ˜¯æ™®é€šæ„é€ å™¨ å½“ä½¿ç”¨staticä¿®é¥°ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè¡¨æ˜è¿™ä¸ªæ–¹æ³•å±äºè¯¥ç±»æœ¬èº«ï¼Œå³é€šè¿‡ç±»å°±å¯è°ƒç”¨è¯¥æ–¹æ³•ï¼Œä½†å¦‚æœè¯¥æ–¹æ³•è¢«å®šä¹‰æˆæŠ½è±¡æ–¹æ³•ï¼Œåˆ™å°†å¯¼è‡´é€šè¿‡è¯¥ç±»æ¥è°ƒç”¨è¯¥æ–¹æ³•æ—¶å‡ºç°é”™è¯¯ï¼ˆè°ƒç”¨äº†ä¸€ä¸ªæ²¡æœ‰æ–¹æ³•ä½“çš„æ–¹æ³•è‚¯å®šä¼šå¼•èµ·é”™è¯¯ï¼‰ã€‚å› æ­¤staticå’Œabstractä¸èƒ½åŒæ—¶ä¿®é¥°æŸä¸ªæ–¹æ³•ï¼Œå³æ²¡æœ‰æ‰€è°“çš„ç±»æŠ½è±¡æ–¹æ³•ã€‚ä½†staticå’Œabstractå¯ä»¥åŒæ—¶ä¿®é¥°å†…éƒ¨ç±» abstractå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•å¿…é¡»è¢«å…¶å­ç±»é‡å†™æ‰æœ‰æ„ä¹‰ï¼Œå¦åˆ™è¿™ä¸ªæ–¹æ³•å°†æ°¸è¿œä¸ä¼šæœ‰æ–¹æ³•ä½“ï¼Œå› æ­¤abstractæ–¹æ³•ä¸èƒ½å®šä¹‰ä¸ºprivateè®¿é—®æƒé™ï¼Œå³privateå’Œabstractä¸èƒ½åŒæ—¶ä¿®é¥°æ–¹æ³• æŠ½è±¡ç±»çš„æ–¹æ³•æŠ½è±¡ç±»ä½“ç°çš„å°±æ˜¯ä¸€ç§æ¨¡æ¿æ¨¡å¼çš„è®¾è®¡ï¼ŒæŠ½è±¡ç±»ä½œä¸ºå¤šä¸ªå­ç±»çš„é€šç”¨æ¨¡æ¿ï¼Œå­ç±»åœ¨æŠ½è±¡ç±»çš„åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ã€æ”¹é€ ï¼Œä½†å­ç±»æ€»ä½“ä¸Šä¼šå¤§è‡´ä¿ç•™æŠ½è±¡ç±»çš„è¡Œä¸ºæ–¹å¼ã€‚ æ¨¡æ¿æ¨¡å¼åœ¨é¢å‘å¯¹è±¡çš„è½¯ä»¶ä¸­å¾ˆå¸¸ç”¨ï¼Œå…¶åŸç†ç®€å•ï¼Œå®ç°ä¹Ÿå¾ˆç®€å•ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨æ¨¡æ¿æ¨¡å¼çš„ä¸€äº›ç®€å•è§„åˆ™ï¼š æŠ½è±¡çˆ¶ç±»å¯ä»¥åªå®šä¹‰éœ€è¦ä½¿ç”¨çš„æŸäº›æ–¹æ³•ï¼ŒæŠŠä¸èƒ½å®ç°çš„éƒ¨åˆ†æŠ½è±¡æˆæŠ½è±¡æ–¹æ³•ï¼Œç•™ç»™å…¶å­ç±»å»å®ç° çˆ¶ç±»ä¸­å¯èƒ½åŒ…å«éœ€è¦è°ƒç”¨å…¶ä»–ç³»åˆ—æ–¹æ³•çš„æ–¹æ³•ï¼Œè¿™äº›è¢«è°ƒç”¨æ–¹æ³•æ—¢å¯ä»¥ç”±çˆ¶ç±»å®ç°ï¼Œä¹Ÿå¯ä»¥ç”±å…¶å­ç±»å®ç°ã€‚çˆ¶ç±»é‡Œæä¾›çš„æ–¹æ³•åªæ˜¯å®šä¹‰äº†ä¸€ä¸ªé€šç”¨ç®—æ³•ï¼Œå…¶å®ç°ä¹Ÿè®¸å¹¶ä¸å®Œå…¨ç”±è‡ªèº«å®ç°ï¼Œè€Œå¿…é¡»ä¾èµ–äºå…¶å­ç±»çš„è¾…åŠ© Java8æ”¹è¿›çš„æ¥å£æŠ½è±¡ç±»æ˜¯ä»å¤šä¸ªç±»ä¸­æŠ½è±¡å‡ºæ¥çš„æ¨¡æ¿ï¼Œå¦‚æœå°†è¿™ç§æŠ½è±¡è¿›è¡Œå¾—æ›´å½»åº•ï¼Œåˆ™å¯ä»¥æç‚¼å‡ºä¸€ç§æ›´åŠ ç‰¹æ®Šçš„â€œæŠ½è±¡ç±»â€â€”â€”æ¥å£ï¼ˆinterfaceï¼‰ï¼Œæ¥å£é‡Œä¸èƒ½åŒ…å«æ™®é€šæ–¹æ³•ï¼Œæ¥å£é‡Œçš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ã€‚Java8å¯¹æ¥å£è¿›è¡Œäº†æ”¹è¿›ï¼Œå…è®¸åœ¨æ¥å£ä¸­å®šä¹‰é»˜è®¤æ–¹æ³•ï¼Œé»˜è®¤æ–¹æ³•å¯ä»¥æä¾›æ–¹æ³•å®ç° æ¥å£çš„æ¦‚å¿µæ¥å£å®šä¹‰çš„æ˜¯å¤šä¸ªç±»å…±åŒçš„å…¬å…±è¡Œä¸ºè§„èŒƒï¼Œè¿™äº›è¡Œä¸ºæ˜¯ä¸å¤–éƒ¨äº¤æµçš„é€šé“ï¼Œè¿™æ„å‘³ç€æ¥å£é‡Œé€šå¸¸æ˜¯å®šä¹‰ä¸€ç»„å…¬ç”¨æ–¹æ³•ã€‚ Java8ä¸­æ¥å£çš„å®šä¹‰123456[ä¿®é¥°ç¬¦] interface æ¥å£å extends çˆ¶æ¥å£1,çˆ¶æ¥å£2...&#123; é›¶ä¸ªåˆ°å¤šä¸ªå¸¸é‡å®šä¹‰... é›¶ä¸ªåˆ°å¤šä¸ªæŠ½è±¡æ–¹æ³•å®šä¹‰... é›¶ä¸ªåˆ°å¤šä¸ªå†…éƒ¨ç±»ã€æ¥å£ã€æšä¸¾å®šä¹‰... é›¶ä¸ªåˆ°å¤šä¸ªé»˜è®¤æ–¹æ³•æˆ–ç±»æ–¹æ³•å®šä¹‰...&#125; ä¿®é¥°ç¬¦å¯ä»¥æ˜¯publicæˆ–è€…çœç•¥ï¼Œå¦‚æœçœç•¥äº†publicè®¿é—®æ§åˆ¶ç¬¦ï¼Œåˆ™é»˜è®¤é‡‡ç”¨åŒ…æƒé™è®¿é—®æ§åˆ¶ç¬¦ï¼Œå³åªæœ‰åœ¨ç›¸åŒåŒ…ç»“æ„ä¸‹æ‰å¯ä»¥è®¿é—®è¯¥æ¥å£ æ¥å£ååº”ä¸ç±»åé‡‡ç”¨ç›¸åŒçš„å‘½åè§„åˆ™ï¼Œå³å¦‚æœä»…ä»è¯­æ³•è§’åº¦æ¥çœ‹ï¼Œæ¥å£ååªè¦æ˜¯åˆæ³•çš„æ ‡è¯†ç¬¦å³å¯ï¼›å¦‚æœè¦éµå®ˆJavaå¯è¯»æ€§è§„èŒƒï¼Œåˆ™æ¥å£ååº”ç”±å¤šä¸ªæœ‰æ„ä¹‰çš„å•è¯è¿ç¼€è€Œæˆï¼Œæ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™ï¼Œå•è¯ä¸å•è¯ä¹‹é—´æ— é¡»ä»»ä½•åˆ†éš”ç¬¦ã€‚æ¥å£åé€šå¸¸èƒ½å¤Ÿä½¿ç”¨å½¢å®¹è¯ã€‚ ä¸€ä¸ªæ¥å£å¯ä»¥æœ‰å¤šä¸ªç›´æ¥çˆ¶æ¥å£ï¼Œä½†æ¥å£åªèƒ½ç»§æ‰¿æ¥å£ï¼Œä¸èƒ½ç»§æ‰¿ç±»ã€‚ ç”±äºæ¥å£å®šä¹‰çš„æ˜¯ä¸€ç§è§„èŒƒï¼Œå› æ­¤æ¥å£é‡Œä¸èƒ½åŒ…å«æ„é€ å™¨å’Œåˆå§‹åŒ–å—å®šä¹‰ã€‚æ¥å£é‡Œå¯ä»¥åŒ…å«æˆå‘˜å˜é‡ï¼ˆåªèƒ½æ˜¯é™æ€å¸¸é‡ï¼‰ã€æ–¹æ³•ï¼ˆåªèƒ½æ˜¯æŠ½è±¡å®ä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•æˆ–é»˜è®¤æ–¹æ³•ï¼‰ã€å†…éƒ¨ç±»ï¼ˆåŒ…æ‹¬å†…éƒ¨æ¥å£ã€æšä¸¾ï¼‰å®šä¹‰ æ¥å£é‡Œå®šä¹‰çš„æ˜¯å¤šä¸ªç±»å…±åŒçš„å…¬å…±è¡Œä¸ºè§„èŒƒï¼Œå› æ­¤æ¥å£é‡Œçš„æ‰€æœ‰æˆå‘˜ï¼ŒåŒ…æ‹¬å¸¸é‡ã€æ–¹æ³•ã€å†…éƒ¨ç±»å’Œå†…éƒ¨æšä¸¾éƒ½æ˜¯publicè®¿é—®æƒé™ã€‚å®šä¹‰æ¥å£æˆå‘˜æ—¶ï¼Œå¯ä»¥çœç•¥è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼Œå¦‚æœæŒ‡å®šè®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼Œåˆ™åªèƒ½ä½¿ç”¨publicè®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ã€‚ å¯¹äºæ¥å£é‡Œå®šä¹‰çš„é™æ€å¸¸é‡è€Œè¨€ï¼Œå®ƒä»¬æ˜¯æ¥å£ç›¸å…³çš„ï¼Œå› æ­¤ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºè¿™äº›æˆå‘˜å˜é‡å¢åŠ staticå’Œfinalä¸¤ä¸ªä¿®é¥°ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ¥å£ä¸­å®šä¹‰æˆå‘˜å˜é‡æ—¶ï¼Œä¸ç®¡æ˜¯å¦ä½¿ç”¨public static finalä¿®é¥°ç¬¦ï¼Œæ¥å£é‡Œçš„æˆå‘˜å˜é‡æ€»æ˜¯ä½¿ç”¨è¿™ä¸‰ä¸ªä¿®é¥°ç¬¦æ¥ä¿®é¥°ã€‚è€Œä¸”æ¥å£é‡Œæ²¡æœ‰æ„é€ å™¨å’Œåˆå§‹åŒ–å—ï¼Œå› æ­¤æ¥å£é‡Œå®šä¹‰çš„æˆå‘˜å˜é‡åªèƒ½åœ¨å®šä¹‰æ—¶æŒ‡å®šé»˜è®¤å€¼ æ¥å£é‡Œå®šä¹‰çš„å†…éƒ¨ç±»ã€å†…éƒ¨æ¥å£ã€å†…éƒ¨æšä¸¾é»˜è®¤éƒ½é‡‡ç”¨public staticä¸¤ä¸ªä¿®é¥°ç¬¦ï¼Œä¸ç®¡å®šä¹‰æ—¶æ˜¯å¦æŒ‡å®šè¿™ä¸¤ä¸ªä¿®é¥°ç¬¦ï¼Œç³»ç»Ÿéƒ½ä¼šè‡ªåŠ¨ä½¿ç”¨public staticå¯¹å®ƒä»¬è¿›è¡Œä¿®é¥° æ¥å£é‡Œå®šä¹‰çš„æ–¹æ³•åªèƒ½æ˜¯æŠ½è±¡æ–¹æ³•ã€ç±»æ–¹æ³•æˆ–é»˜è®¤æ–¹æ³•ï¼Œå› æ­¤å¦‚æœä¸æ˜¯å®šä¹‰é»˜è®¤æ–¹æ³•ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨ä¸ºæ™®é€šæ–¹æ³•å¢åŠ abstractä¿®é¥°ç¬¦ï¼›å®šä¹‰æ¥å£é‡Œçš„æ™®é€šæ–¹æ³•æ—¶ä¸ç®¡æ˜¯å¦ä½¿ç”¨public abstractä¿®é¥°ç¬¦ï¼Œæ¥å£é‡Œçš„æ™®é€šæ–¹æ³•æ€»æ˜¯public abstractæ¥ä¿®é¥°ã€‚æ¥å£é‡Œçš„æ™®é€šæ–¹æ³•ä¸èƒ½æœ‰æ–¹æ³•å®ç°ï¼ˆæ–¹æ³•ä½“ï¼‰ï¼›ä½†ç±»æ–¹æ³•ã€é»˜è®¤ï¼ˆdefaultï¼‰æ–¹æ³•éƒ½å¿…é¡»æœ‰æ–¹æ³•å®ç°ï¼ˆæ–¹æ³•ä½“ Java8å…è®¸åœ¨æ¥å£ä¸­å®šä¹‰ç±»æ–¹æ³•ï¼Œç±»æ–¹æ³•å¿…é¡»ä½¿ç”¨staticä¿®é¥°ï¼Œè¯¥æ–¹æ³•ä¸èƒ½ä½¿ç”¨defaultä¿®é¥°ï¼Œæ— è®ºç¨‹åºæ˜¯å¦æŒ‡å®šï¼Œç±»æ–¹æ³•æ€»æ˜¯ä½¿ç”¨publicä¿®é¥°â€”â€”å¦‚æœå¼€å‘è€…æ²¡æœ‰æŒ‡å®špublicï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºç±»æ–¹æ³•æ·»åŠ publicä¿®é¥°ç¬¦ã€‚ç±»æ–¹æ³•å¯ä»¥ç›´æ¥ä½¿ç”¨æ¥å£æ¥è°ƒç”¨ã€‚ æ¥å£çš„ç»§æ‰¿æ¥å£çš„ç»§æ‰¿å’Œç±»ç»§æ‰¿ä¸ä¸€æ ·ï¼Œæ¥å£å®Œå…¨æ”¯æŒå¤šç»§æ‰¿ï¼Œå³ä¸€ä¸ªæ¥å£å¯ä»¥æœ‰å¤šä¸ªç›´æ¥çˆ¶æ¥å£ã€‚å’Œç±»ç»§æ‰¿ç›¸ä¼¼ï¼Œå­æ¥å£æ‰©å±•æŸä¸ªçˆ¶æ¥å£ï¼Œå°†ä¼šè·å¾—çˆ¶æ¥å£é‡Œå®šä¹‰çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ã€å¸¸é‡ã€‚ä¸€ä¸ªæ¥å£ç»§æ‰¿å¤šä¸ªçˆ¶æ¥å£æ—¶ï¼Œå¤šä¸ªçˆ¶æ¥å£æ’åœ¨extendså…³é”®å­—ä¹‹åï¼Œå¤šä¸ªçˆ¶æ¥å£ä¹‹é—´ä»¥è‹±æ–‡é€—å·ï¼ˆ,ï¼‰éš”å¼€ã€‚ ä½¿ç”¨æ¥å£æ¥å£ä¸èƒ½ç”¨äºåˆ›å»ºå®ä¾‹ï¼Œä½†æ¥å£å¯ä»¥ç”¨äºå£°æ˜å¼•ç”¨ç±»å‹å˜é‡ã€‚å½“ä½¿ç”¨æ¥å£æ¥å£°æ˜å¼•ç”¨ç±»å‹å˜é‡æ—¶ï¼Œè¿™ä¸ªå¼•ç”¨ç±»å‹å˜é‡å¿…é¡»å¼•ç”¨åˆ°å…¶å®ç°ç±»çš„å¯¹è±¡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ¥å£çš„ä¸»è¦ç”¨é€”å°±æ˜¯è¢«å®ç°ç±»å®ç°ã€‚ å®šä¹‰å˜é‡ï¼Œä¹Ÿå¯ç”¨äºè¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ è°ƒç”¨æ¥å£ä¸­å®šä¹‰çš„å¸¸é‡ è¢«å…¶ä»–ç±»å®ç°ä¸€ä¸ªç±»å¯ä»¥å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ï¼Œç»§æ‰¿ä½¿ç”¨extendså…³é”®å­—ï¼Œå®ç°åˆ™ä½¿ç”¨implementså…³é”®å­— 123[ä¿®é¥°ç¬¦] class ç±»å extends çˆ¶ç±» implements æ¥å£1ï¼Œæ¥å£2&#123; ç±»ä½“éƒ¨åˆ†&#125; ä¸€ä¸ªç±»å®ç°äº†ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ä¹‹åï¼Œè¿™ä¸ªç±»å¿…é¡»å®Œå…¨å®ç°è¿™äº›æ¥å£é‡Œæ‰€å®šä¹‰çš„å…¨éƒ¨æŠ½è±¡æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯é‡å†™è¿™äº›æŠ½è±¡æ–¹æ³•ï¼‰ï¼›å¦åˆ™ï¼Œè¯¥ç±»å°†ä¿ç•™ä»çˆ¶æ¥å£é‚£é‡Œç»§æ‰¿åˆ°çš„æŠ½è±¡æ–¹æ³•ï¼Œè¯¥ç±»ä¹Ÿå¿…é¡»å®šä¹‰æˆæŠ½è±¡ç±»ã€‚ ä¸€ä¸ªç±»å®ç°æŸä¸ªæ¥å£æ—¶ï¼Œè¯¥ç±»å°†ä¼šè·å¾—æ¥å£ä¸­å®šä¹‰çš„å¸¸é‡ï¼ˆæˆå‘˜å˜é‡ï¼‰ã€æ–¹æ³•ç­‰ï¼Œå› æ­¤å¯ä»¥æŠŠå®ç°æ¥å£ç†è§£ä¸ºä¸€ç§ç‰¹æ®Šçš„ç»§æ‰¿ï¼Œç›¸å½“äºå®ç°ç±»ç»§æ‰¿äº†ä¸€ä¸ªå½»åº•æŠ½è±¡çš„ç±»ï¼ˆç›¸å½“äºé™¤äº†é»˜è®¤æ–¹æ³•å¤–ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æŠ½è±¡æ–¹æ³•çš„ç±»ï¼‰ã€‚ å®ç°æ¥å£æ–¹æ³•æ—¶ï¼Œå¿…é¡»ä½¿ç”¨publicè®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼Œå› ä¸ºæ¥å£é‡Œçš„æ–¹æ³•éƒ½æ˜¯publicçš„ï¼Œè€Œå­ç±»ï¼ˆç›¸å½“äºå®ç°ç±»ï¼‰é‡å†™çˆ¶ç±»æ–¹æ³•æ—¶è®¿é—®æƒé™åªèƒ½æ›´å¤§æˆ–è€…ç›¸ç­‰ï¼Œæ‰€ä»¥å®ç°ç±»å®ç°æ¥å£é‡Œçš„æ–¹æ³•æ—¶åªèƒ½ä½¿ç”¨publicè®¿é—®æƒé™ æ¥å£å’ŒæŠ½è±¡ç±»æ¥å£å’ŒæŠ½è±¡ç±»å¾ˆåƒï¼Œå®ƒä»¬éƒ½å…·æœ‰å¦‚ä¸‹ç‰¹å¾: æ¥å£å’ŒæŠ½è±¡ç±»éƒ½ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œå®ƒä»¬éƒ½ä½äºç»§æ‰¿æ ‘çš„é¡¶ç«¯ï¼Œç”¨äºè¢«å…¶ä»–ç±»å®ç°å’Œç»§æ‰¿ã€‚ æ¥å£å’ŒæŠ½è±¡ç±»éƒ½å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œå®ç°æ¥å£æˆ–ç»§æ‰¿æŠ½è±¡ç±»çš„æ™®é€šå­ç±»éƒ½å¿…é¡»å®ç°è¿™äº›æŠ½è±¡æ–¹æ³•ã€‚ æ¥å£ä½œä¸ºç³»ç»Ÿä¸å¤–ç•Œäº¤äº’çš„çª—å£ï¼Œæ¥å£ä½“ç°çš„æ˜¯ä¸€ç§è§„èŒƒæŠ½è±¡ç±»ä½œä¸ºç³»ç»Ÿä¸­å¤šä¸ªå­ç±»çš„å…±åŒçˆ¶ç±»ï¼Œå®ƒæ‰€ä½“ç°çš„æ˜¯ä¸€ç§æ¨¡æ¿å¼è®¾è®¡ æ¥å£å’ŒæŠ½è±¡ç±»åœ¨ç”¨æ³•ä¸Šçš„å·®åˆ«ï¼š æ¥å£é‡Œåªèƒ½åŒ…å«æŠ½è±¡æ–¹æ³•å’Œé»˜è®¤æ–¹æ³•ï¼Œä¸èƒ½ä¸ºæ™®é€šæ–¹æ³•æä¾›æ–¹æ³•å®ç°ï¼›æŠ½è±¡ç±»åˆ™å®Œå…¨å¯ä»¥åŒ…å«æ™®é€šæ–¹æ³• æ¥å£é‡Œä¸èƒ½å®šä¹‰é™æ€æ–¹æ³•ï¼›æŠ½è±¡ç±»é‡Œå¯ä»¥å®šä¹‰é™æ€æ–¹æ³• æ¥å£é‡Œåªèƒ½å®šä¹‰é™æ€å¸¸é‡ï¼Œä¸èƒ½å®šä¹‰æ™®é€šæˆå‘˜å˜é‡ï¼›æŠ½è±¡ç±»é‡Œåˆ™æ—¢å¯ä»¥å®šä¹‰æ™®é€šæˆå‘˜å˜é‡ï¼Œä¹Ÿå¯ä»¥å®šä¹‰é™æ€å¸¸é‡ æ¥å£é‡Œä¸åŒ…å«æ„é€ å™¨ï¼›æŠ½è±¡ç±»é‡Œå¯ä»¥åŒ…å«æ„é€ å™¨ï¼ŒæŠ½è±¡ç±»é‡Œçš„æ„é€ å™¨å¹¶ä¸æ˜¯ç”¨äºåˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯è®©å…¶å­ç±»è°ƒç”¨è¿™äº›æ„é€ å™¨æ¥å®Œæˆå±äºæŠ½è±¡ç±»çš„åˆå§‹åŒ–æ“ä½œ æ¥å£é‡Œä¸èƒ½åŒ…å«åˆå§‹åŒ–å—ï¼Œä½†æŠ½è±¡ç±»åˆ™å®Œå…¨åŒ…å«åˆå§‹åŒ–å— ä¸€ä¸ªç±»æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªç›´æ¥çˆ¶ç±»ï¼ŒåŒ…æ‹¬æŠ½è±¡ç±»ï¼›ä½†ä¸€ä¸ªç±»å¯ä»¥ç›´æ¥å®ç°å¤šä¸ªæ¥å£ï¼Œé€šè¿‡å®ç°å¤šä¸ªæ¥å£å¯ä»¥å¼¥è¡¥Javaå•ç»§æ‰¿çš„ä¸è¶³ã€‚","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Java å‚æ•°ä¼ é€’","slug":"Javaå‚æ•°ä¼ é€’","date":"2017-08-27T10:48:08.000Z","updated":"2018-08-24T07:42:27.841Z","comments":true,"path":"Javaå‚æ•°ä¼ é€’.html","link":"","permalink":"http://xiaoqinghua.site/Javaå‚æ•°ä¼ é€’.html","excerpt":"","text":"æ¦‚è¿°1.ä»€ä¹ˆæ˜¯å‚æ•°ä¼ é€’ï¼Ÿ 123è°ƒç”¨æ–¹æ³•æ—¶å‘å½¢å‚ä¼ é€’æ•°æ®çš„è¿‡ç¨‹å«åšå‚æ•°ä¼ é€’ã€‚åœ¨ç¼–ç¨‹è¯­è¨€ä¸­æœ‰ä¸¤ç§ä¼ é€’æ–¹å¼ï¼šå€¼ä¼ é€’ä¸å¼•ç”¨ä¼ é€’ã€‚å¿…é¡»å¼ºè°ƒçš„æ˜¯ï¼Œè¿™é‡Œæåˆ°çš„ä¸¤ç§ä¼ é€’æ–¹å¼ä¸æ˜¯ä»…é™äºJavaä½¿ç”¨åˆ°çš„ä¼ é€’æ–¹å¼ï¼Œè€Œæ˜¯å‡ºç°åœ¨åŒ…æ‹¬Javaåœ¨å†…çš„å¤šç§ç¼–ç¨‹è¯­è¨€ä¸­çš„ä¼ é€’æ–¹å¼ã€‚ 2.å˜é‡ç±»å‹ 1åœ¨Javaä¸­ï¼Œæˆ‘ä»¬å°†æŒ‡å‘åŸºæœ¬ç±»å‹æ•°æ®çš„å˜é‡ç§°ä¸ºåŸå§‹å˜é‡ï¼Œå°†æŒ‡å‘å¯¹è±¡çš„å˜é‡ç§°ä¸ºå¼•ç”¨å˜é‡ã€‚ å€¼ä¼ é€’1.ä»€ä¹ˆæ˜¯å€¼ä¼ é€’ï¼Ÿ 1å°†å˜é‡çš„å‰¯æœ¬ä¼ å…¥æ–¹æ³•ï¼Œæ–¹æ³•å†…å¤–æ“ä½œéš”ç¦»ï¼Œåœ¨æ–¹æ³•å†…å¯¹å˜é‡çš„æ“ä½œä¸ä¼šåæ˜ åˆ°æ–¹æ³•å¤–çš„å˜é‡ä¸­ã€‚ 2.åŸå§‹å˜é‡ 12345678910public void change(int b) &#123; b = 7;&#125;@Testpublic void testBasic() &#123; int a = 9; change(a); System.out.println(a);&#125; å®é™…è¾“å‡ºï¼š9 åœ¨å‚æ•°ä¼ é€’æ—¶ï¼ŒæŒ‰ç…§å€¼ä¼ é€’çš„è§„åˆ™ï¼Œå˜é‡bæ¥æ”¶ä¸€ä¸ªaçš„å‰¯æœ¬ï¼ŒåŒæ ·æŒ‡å‘å­—é¢å€¼â€œ9â€ï¼š æ¥ä¸‹æ¥ï¼Œåœ¨æ–¹æ³•å†…éƒ¨ï¼Œä¸ºbèµ‹å€¼7ï¼Œè¿™æ ·bæŒ‡å‘7ï¼Œç”±äºaä¸bæ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„å˜é‡ï¼Œä¸¤è€…ä¹‹é—´æ²¡æœ‰å¼•ç”¨ä¸è¢«å¼•ç”¨çš„å…³ç³»ï¼Œaä¾ç„¶æŒ‡å‘9ï¼š 3.String 12345678910public void change(String str01) &#123; str01 = \"baidu\";&#125;@Testpublic void testString() &#123; String str = new String(\"www.baidu.com\"); change(str); System.out.println(str);&#125; å®é™…è¾“å‡ºï¼šwww.baidu.com åœ¨å‚æ•°ä¼ é€’æ—¶ï¼Œstrå°†è‡ªèº«çš„ä¸€ä¸ªå‰¯æœ¬ä¼ é€’ç»™str01ï¼Œè¿™æ ·str01ä¹ŸæŒ‡å‘å †ä¸­å­˜æ”¾â€œwww.baidu.comâ€çš„å¯¹è±¡ï¼š åœ¨æ–¹æ³•å†…éƒ¨ä¸ºstr01èµ‹å€¼ï¼Œè¿™æ ·str01å°±æŒ‡å‘æ–¹æ³•åŒºå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„â€baiduâ€ï¼Œsträ¾ç„¶æŒ‡å‘å †ä¸­çš„â€œwww.baidu.comâ€ï¼Œsträ¸str01æŒ‡å‘ä¸åŒçš„å¯¹è±¡ï¼Œç›¸äº’ä¹‹é—´ä¸å½±å“ï¼š è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šjavaå°†Stringè®¾è®¡æˆä¸å¯æ”¹å˜çš„å¯¹è±¡ï¼Œå³ä¸€æ—¦Stringå¯¹è±¡åŒ…å«çš„å­—é¢å€¼å‘ç”Ÿæ”¹å˜ï¼Œjavaå°±ä¼šæ–°å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å˜é‡æŒ‡å‘æ–°çš„å¯¹è±¡ã€‚ 4.StringBuilder 12345678910public void change(StringBuilder builder01) &#123; builder01.append(\" World!\");&#125;@Testpublic void testStringBuilder() &#123; StringBuilder builder = new StringBuilder(\"Hello\"); change(builder); System.out.println(builder);&#125; å®é™…è¾“å‡ºï¼šHello World! åœ¨å‚æ•°ä¼ é€’å®Œæˆä»¥åï¼Œbuilder01å˜é‡è·å¾—builderå˜é‡çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå‰¯æœ¬ä¸åŸå§‹å˜é‡æŒ‡å‘å †ä¸­åŒä¸€ä¸ªå¯¹è±¡ï¼š åœ¨æ–¹æ³•å†…éƒ¨ï¼Œå˜é‡builderæ²¡æœ‰æŒ‡å‘æ–°çš„å¯¹è±¡ï¼Œä¾ç„¶ä¸builderæŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œæ‰€ä»¥å½“builderè®¿é—®å †ä¸­åŒä¸€å¯¹è±¡æ—¶ï¼Œæ•°æ®å‘ç”Ÿæ”¹å˜ï¼š 5.è‡ªå®šä¹‰ç±»å‹ 123456789101112131415161718public class MyInner &#123; public int a;&#125;public class Test&#123; public void change(MyInner in01) &#123; in01.a = 1; &#125; @Test public void testDemain() &#123; MyInner in = new MyInner(); in.a = 9; change(in); System.out.println(in.a); &#125;&#125; å®é™…è¾“å‡ºï¼š1 æ‰§è¡Œè¿‡ç¨‹åŒStringBuilderæ‰§è¡Œè¿‡ç¨‹ç›¸åŒï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ä¸‹é¢å¯¹ä¸Šé¢çš„ä»£ç åšä¸€ç‚¹æ”¹åŠ¨ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516171819public class MyInner &#123; public int a;&#125;public class Test&#123; public void change(MyInner in01) &#123; in01=new MyInner();//ä½¿in01æŒ‡å‘ä¸€ä¸ªæ–°çš„å¯¹è±¡ in01.a = 1; &#125; @Test public void testDemain() &#123; MyInner in = new MyInner(); in.a = 9; change(in); System.out.println(in.a); &#125;&#125; å®é™…è¾“å‡ºï¼š9 å‚æ•°ä¼ é€’å®Œæˆæ—¶ï¼Œin01ä¸inæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œin01å¯¹å¯¹è±¡çš„æ“ä½œç­‰åŒäºinå¯¹å¯¹è±¡çš„æ“ä½œï¼Œæ¥ç€åœ¨æ–¹æ³•å†…éƒ¨æ‰§è¡Œâ€in01=new MyInner();â€ï¼Œè¿™æ ·in01 å°±æŒ‡å‘äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œin01æ‰€æœ‰çš„æ“ä½œéƒ½ä¸inæ— å…³äº†ï¼š ç»¼åˆä»¥ä¸Šçš„è¿è¡Œç»“æœä¸åˆ†æï¼Œå¯çŸ¥javaå‚æ•°ä¼ é€’æ–¹å¼ç¬¦åˆå€¼ä¼ é€’ã€‚ å¼•ç”¨ä¼ é€’ä»€ä¹ˆæ˜¯å¼•ç”¨ä¼ é€’ï¼Ÿ 12345å°†å˜é‡è‡ªèº«çš„å†…å­˜åœ°å€ä¼ å…¥æ–¹æ³•ä¸­ï¼Œæ–¹æ³•ä¸­çš„å˜é‡æŒ‡å‘æ–¹æ³•å¤–çš„å˜é‡ï¼Œåœ¨æ–¹æ³•ä¸­å¯¹å˜é‡çš„æ“ä½œå°±æ˜¯å¯¹æ–¹æ³•å¤–å˜é‡çš„æ“ä½œ ã€‚ä¸å†ä¸€ä¸€åˆ†æå…¶ä»–å˜é‡ç±»å‹ï¼Œåˆ†æåå¯ä»¥å‘ç°ï¼Œjavaåœ¨ä¼ é€’å‚æ•°æ—¶é‡‡ç”¨çš„ ä¸æ˜¯å¼•ç”¨ä¼ é€’ï¼Œè€Œæ˜¯å€¼ä¼ é€’ã€‚ç®€å•è®²ï¼Œå€¼ä¼ é€’æ—¶æ–¹æ³•å†…å¤–æ˜¯ä¸¤ä¸ªæ‹¥æœ‰åŒä¸€æŒ‡å‘çš„å˜é‡ï¼Œå¼•ç”¨ä¼ é€’æ—¶æ–¹æ³•å†…å¤–æ˜¯åŒä¸€ä¸ªå˜é‡ã€‚ æœ¬æ–‡è½¬è‡ª:http://www.tuicool.com/articles/niUfuqN","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Javaæ³›å‹","slug":"Javaæ³›å‹","date":"2017-08-27T03:21:51.000Z","updated":"2018-08-27T05:24:24.627Z","comments":true,"path":"Javaæ³›å‹.html","link":"","permalink":"http://xiaoqinghua.site/Javaæ³›å‹.html","excerpt":"","text":"æ³›å‹åŸºç¡€æ³›å‹ç±»æˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªç®€å•çš„Boxç±»ï¼š 1234567891011public class Box &#123; private String object; public void set(String object) &#123; this.object = object; &#125; public String get() &#123; return object; &#125;&#125; è¿™æ˜¯æœ€å¸¸è§çš„åšæ³•ï¼Œè¿™æ ·åšçš„ä¸€ä¸ªåå¤„æ˜¯Boxé‡Œé¢ç°åœ¨åªèƒ½è£…å…¥Stringç±»å‹çš„å…ƒç´ ï¼Œä»Šåå¦‚æœæˆ‘ä»¬éœ€è¦è£…å…¥Integerç­‰å…¶ä»–ç±»å‹çš„å…ƒç´ ï¼Œè¿˜å¿…é¡»è¦å¦å¤–é‡å†™ä¸€ä¸ªBoxï¼Œä»£ç å¾—ä¸åˆ°å¤ç”¨ï¼Œä½¿ç”¨æ³›å‹å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ 123456789101112public class Box&lt;T&gt; &#123; // T stands for \"Type\" private T t; public void set(T t) &#123; this.t = t; &#125; public T get() &#123; return t; &#125;&#125; è¿™æ ·æˆ‘ä»¬çš„Boxç±»ä¾¿å¯ä»¥å¾—åˆ°å¤ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†Tæ›¿æ¢æˆä»»ä½•æˆ‘ä»¬æƒ³è¦çš„ç±»å‹ï¼š 123Box&lt;Integer&gt; integerBox = new Box&lt;Integer&gt;();Box&lt;Double&gt; doubleBox = new Box&lt;Double&gt;();Box&lt;String&gt; stringBox = new Box&lt;String&gt;(); æ³›å‹æ–¹æ³•çœ‹å®Œäº†æ³›å‹ç±»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹æ³›å‹æ–¹æ³•ã€‚å£°æ˜ä¸€ä¸ªæ³›å‹æ–¹æ³•å¾ˆç®€å•ï¼Œåªè¦åœ¨è¿”å›ç±»å‹å‰é¢åŠ ä¸Šä¸€ä¸ªç±»ä¼¼&lt;K, V&gt;çš„å½¢å¼å°±è¡Œäº†ï¼š 12345678910111213141516171819public class Util &#123; public static &lt;K, V&gt; boolean compare(Pair&lt;K, V&gt; p1, Pair&lt;K, V&gt; p2) &#123; return p1.getKey().equals(p2.getKey()) &amp;&amp; p1.getValue().equals(p2.getValue()); &#125;&#125;public class Pair&lt;K, V&gt; &#123; private K key; private V value; public Pair(K key, V value) &#123; this.key = key; this.value = value; &#125; public void setKey(K key) &#123; this.key = key; &#125; public void setValue(V value) &#123; this.value = value; &#125; public K getKey() &#123; return key; &#125; public V getValue() &#123; return value; &#125;&#125; æˆ–è€…åœ¨Java1.7/1.8åˆ©ç”¨type inferenceï¼Œè®©Javaè‡ªåŠ¨æ¨å¯¼å‡ºç›¸åº”çš„ç±»å‹å‚æ•°ï¼š 123Pair&lt;Integer, String&gt; p1 = new Pair&lt;&gt;(1, \"apple\");Pair&lt;Integer, String&gt; p2 = new Pair&lt;&gt;(2, \"pear\");boolean same = Util.compare(p1, p2); è¾¹ç•Œç¬¦ç°åœ¨æˆ‘ä»¬è¦å®ç°è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªæ³›å‹æ•°ç»„ä¸­å¤§äºæŸä¸ªç‰¹å®šå…ƒç´ çš„ä¸ªæ•°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š 1234567public static &lt;T&gt; int countGreaterThan(T[] anArray, T elem) &#123; int count = 0; for (T e : anArray) if (e &gt; elem) // compiler error ++count; return count;&#125; ä½†æ˜¯è¿™æ ·å¾ˆæ˜æ˜¾æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºé™¤äº†short, int, double, long, float, byte, charç­‰åŸå§‹ç±»å‹ï¼Œå…¶ä»–çš„ç±»å¹¶ä¸ä¸€å®šèƒ½ä½¿ç”¨æ“ä½œç¬¦&gt;ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨æŠ¥é”™ï¼Œé‚£æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨è¾¹ç•Œç¬¦: 123public interface Comparable&lt;T&gt; &#123; public int compareTo(T o);&#125; åšä¸€ä¸ªç±»ä¼¼äºä¸‹é¢è¿™æ ·çš„å£°æ˜ï¼Œè¿™æ ·å°±ç­‰äºå‘Šè¯‰ç¼–è¯‘å™¨ç±»å‹å‚æ•°Tä»£è¡¨çš„éƒ½æ˜¯å®ç°äº†Comparableæ¥å£çš„ç±»ï¼Œè¿™æ ·ç­‰äºå‘Šè¯‰ç¼–è¯‘å™¨å®ƒä»¬éƒ½è‡³å°‘å®ç°äº†compareToæ–¹æ³• 1234567public static &lt;T extends Comparable&lt;T&gt;&gt; int countGreaterThan(T[] anArray, T elem) &#123; int count = 0; for (T e : anArray) if (e.compareTo(elem) &gt; 0) ++count; return count;&#125; é€šé…ç¬¦åœ¨äº†è§£é€šé…ç¬¦ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆå¿…é¡»è¦æ¾„æ¸…ä¸€ä¸ªæ¦‚å¿µï¼Œè¿˜æ˜¯å€Ÿç”¨æˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„Boxç±»ï¼Œå‡è®¾æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªè¿™æ ·çš„æ–¹æ³•ï¼š 1public void boxTest (Box&lt;Number&gt; n) &#123; /*...*/ &#125; é‚£ä¹ˆç°åœ¨Box&lt;Number&gt; nå…è®¸æ¥å—ä»€ä¹ˆç±»å‹çš„å‚æ•°ï¼Ÿæˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿä¼ å…¥Box&lt;Integer&gt;æˆ–è€…Box&lt;Double&gt;å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œè™½ç„¶Integerå’ŒDoubleæ˜¯Numberçš„å­ç±»ï¼Œä½†æ˜¯åœ¨æ³›å‹ä¸­Box&lt;Integer&gt;æˆ–è€…Box&lt;Double&gt;ä¸Box&lt;Number&gt;ä¹‹é—´å¹¶æ²¡æœ‰ä»»ä½•çš„å…³ç³»ã€‚è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­æ¥åŠ æ·±ä¸€ä¸‹ç†è§£: é¦–å…ˆæˆ‘ä»¬å…ˆå®šä¹‰å‡ ä¸ªç®€å•çš„ç±»ï¼Œä¸‹é¢æˆ‘ä»¬å°†ç”¨åˆ°å®ƒï¼š 123class Fruit &#123;&#125;class Apple extends Fruit &#123;&#125;class Orange extends Fruit &#123;&#125; ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ³›å‹ç±»Readerï¼Œç„¶ååœ¨f1()ä¸­å½“æˆ‘ä»¬å°è¯•Fruit f = fruitReader.readExact(apples);ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºList&lt;Fruit&gt;ä¸List&lt;Apple&gt;ä¹‹é—´å¹¶æ²¡æœ‰ä»»ä½•çš„å…³ç³»ã€‚ 1234567891011121314151617public class GenericReading &#123; static List&lt;Apple&gt; apples = Arrays.asList(new Apple()); static List&lt;Fruit&gt; fruit = Arrays.asList(new Fruit()); static class Reader&lt;T&gt; &#123; T readExact(List&lt;T&gt; list) &#123; return list.get(0); &#125; &#125; static void f1() &#123; Reader&lt;Fruit&gt; fruitReader = new Reader&lt;Fruit&gt;(); // Errors: List&lt;Fruit&gt; cannot be applied to List&lt;Apple&gt;. // Fruit f = fruitReader.readExact(apples); &#125; public static void main(String[] args) &#123; f1(); &#125;&#125; ä½†æ˜¯æŒ‰ç…§æˆ‘ä»¬é€šå¸¸çš„æ€ç»´ä¹ æƒ¯ï¼ŒAppleå’ŒFruitä¹‹é—´è‚¯å®šæ˜¯å­˜åœ¨è”ç³»ï¼Œç„¶è€Œç¼–è¯‘å™¨å´æ— æ³•è¯†åˆ«ï¼Œé‚£æ€ä¹ˆåœ¨æ³›å‹ä»£ç ä¸­è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨é€šé…ç¬¦æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 12345678910111213static class CovariantReader&lt;T&gt; &#123; T readCovariant(List&lt;? extends T&gt; list) &#123; return list.get(0); &#125;&#125;static void f2() &#123; CovariantReader&lt;Fruit&gt; fruitReader = new CovariantReader&lt;Fruit&gt;(); Fruit f = fruitReader.readCovariant(fruit); Fruit a = fruitReader.readCovariant(apples);&#125;public static void main(String[] args) &#123; f2();&#125; è¿™æ ·å°±ç›¸å½“ä¸å‘Šè¯‰ç¼–è¯‘å™¨ï¼ŒfruitReaderçš„readCovariantæ–¹æ³•æ¥å—çš„å‚æ•°åªè¦æ˜¯æ»¡è¶³Fruitçš„å­ç±»å°±è¡Œ(åŒ…æ‹¬Fruitè‡ªèº«)ï¼Œè¿™æ ·å­ç±»å’Œçˆ¶ç±»ä¹‹é—´çš„å…³ç³»ä¹Ÿå°±å…³è”ä¸Šäº†ã€‚ PECSåŸåˆ™ä¸Šé¢æˆ‘ä»¬çœ‹åˆ°äº†ç±»ä¼¼&lt;? extends T&gt;çš„ç”¨æ³•ï¼Œåˆ©ç”¨å®ƒæˆ‘ä»¬å¯ä»¥ä»listé‡Œé¢getå…ƒç´ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä¸å¯ä»¥å¾€listé‡Œé¢addå…ƒç´ å‘¢ï¼Ÿæˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹ï¼š 1234567891011121314public class GenericsAndCovariance &#123; public static void main(String[] args) &#123; // Wildcards allow covariance: List&lt;? extends Fruit&gt; flist = new ArrayList&lt;Apple&gt;(); // Compile Error: can't add any type of object: // flist.add(new Apple()) // flist.add(new Orange()) // flist.add(new Fruit()) // flist.add(new Object()) flist.add(null); // Legal but uninteresting // We Know that it returns at least Fruit: Fruit f = flist.get(0); &#125;&#125; ç­”æ¡ˆæ˜¯å¦å®šï¼ŒJavaç¼–è¯‘å™¨ä¸å…è®¸æˆ‘ä»¬è¿™æ ·åšï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¯¹äºè¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä¸å¦¨ä»ç¼–è¯‘å™¨çš„è§’åº¦å»è€ƒè™‘ã€‚å› ä¸ºList&lt;? extends Fruit&gt; flistå®ƒè‡ªèº«å¯ä»¥æœ‰å¤šç§å«ä¹‰ï¼š 123List&lt;? extends Fruit&gt; flist = new ArrayList&lt;Fruit&gt;();List&lt;? extends Fruit&gt; flist = new ArrayList&lt;Apple&gt;();List&lt;? extends Fruit&gt; flist = new ArrayList&lt;Orange&gt;(); å½“æˆ‘ä»¬å°è¯•addä¸€ä¸ªAppleçš„æ—¶å€™ï¼Œflistå¯èƒ½æŒ‡å‘new ArrayList&lt;Orange&gt;(); å½“æˆ‘ä»¬å°è¯•addä¸€ä¸ªOrangeçš„æ—¶å€™ï¼Œflistå¯èƒ½æŒ‡å‘new ArrayList&lt;Apple&gt;(); å½“æˆ‘ä»¬å°è¯•addä¸€ä¸ªFruitçš„æ—¶å€™ï¼Œè¿™ä¸ªFruitå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„Fruitï¼Œè€Œflistå¯èƒ½åªæƒ³æŸç§ç‰¹å®šç±»å‹çš„Fruitï¼Œç¼–è¯‘å™¨æ— æ³•è¯†åˆ«æ‰€ä»¥ä¼šæŠ¥é”™ã€‚ æ‰€ä»¥å¯¹äºå®ç°äº†&lt;? extends T&gt;çš„é›†åˆç±»åªèƒ½å°†å®ƒè§†ä¸ºProducerå‘å¤–æä¾›(get)å…ƒç´ ï¼Œè€Œä¸èƒ½ä½œä¸ºConsumeræ¥å¯¹å¤–è·å–(add)å…ƒç´ ã€‚ å¦‚æœæˆ‘ä»¬è¦addå…ƒç´ åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨&lt;? super T&gt;ï¼š 123456789101112131415161718192021public class GenericWriting &#123; static List&lt;Apple&gt; apples = new ArrayList&lt;Apple&gt;(); static List&lt;Fruit&gt; fruit = new ArrayList&lt;Fruit&gt;(); static &lt;T&gt; void writeExact(List&lt;T&gt; list, T item) &#123; list.add(item); &#125; static void f1() &#123; writeExact(apples, new Apple()); writeExact(fruit, new Apple()); &#125; static &lt;T&gt; void writeWithWildcard(List&lt;? super T&gt; list, T item) &#123; list.add(item) &#125; static void f2() &#123; writeWithWildcard(apples, new Apple()); writeWithWildcard(fruit, new Apple()); &#125; public static void main(String[] args) &#123; f1(); f2(); &#125;&#125; è¿™æ ·æˆ‘ä»¬å¯ä»¥å¾€å®¹å™¨é‡Œé¢æ·»åŠ å…ƒç´ äº†ï¼Œä½†æ˜¯ä½¿ç”¨superçš„åå¤„æ˜¯ä»¥åä¸èƒ½getå®¹å™¨é‡Œé¢çš„å…ƒç´ äº†ï¼ŒåŸå› å¾ˆç®€å•ï¼Œæˆ‘ä»¬ç»§ç»­ä»ç¼–è¯‘å™¨çš„è§’åº¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œå¯¹äºList&lt;? super Apple&gt; listï¼Œå®ƒå¯ä»¥æœ‰ä¸‹é¢å‡ ç§å«ä¹‰ï¼š 123List&lt;? super Apple&gt; list = new ArrayList&lt;Apple&gt;();List&lt;? super Apple&gt; list = new ArrayList&lt;Fruit&gt;();List&lt;? super Apple&gt; list = new ArrayList&lt;Object&gt;(); å½“æˆ‘ä»¬å°è¯•é€šè¿‡listæ¥getä¸€ä¸ªAppleçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šgetå¾—åˆ°ä¸€ä¸ªFruitï¼Œè¿™ä¸ªFruitå¯ä»¥æ˜¯Orangeç­‰å…¶ä»–ç±»å‹çš„Fruitã€‚ æ ¹æ®ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºä¸€æ¡è§„å¾‹ï¼Œâ€Producer Extends, Consumer Superâ€`ï¼š â€œProducer Extendsâ€ : å¦‚æœä½ éœ€è¦ä¸€ä¸ªåªè¯»Listï¼Œç”¨å®ƒæ¥produce Tï¼Œé‚£ä¹ˆä½¿ç”¨? extends Tã€‚ â€œConsumer Superâ€ : å¦‚æœä½ éœ€è¦ä¸€ä¸ªåªå†™Listï¼Œç”¨å®ƒæ¥consume Tï¼Œé‚£ä¹ˆä½¿ç”¨? super Tã€‚ å¦‚æœéœ€è¦åŒæ—¶è¯»å–ä»¥åŠå†™å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨é€šé…ç¬¦äº†ã€‚ å¦‚æœé˜…è¯»è¿‡ä¸€äº›Javaé›†åˆç±»çš„æºç ï¼Œå¯ä»¥å‘ç°é€šå¸¸æˆ‘ä»¬ä¼šå°†ä¸¤è€…ç»“åˆèµ·æ¥ä¸€èµ·ç”¨ï¼Œæ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼š 123456public class Collections &#123; public static &lt;T&gt; void copy(List&lt;? super T&gt; dest, List&lt;? extends T&gt; src) &#123; for (int i=0; i&lt;src.size(); i++) dest.set(i, src.get(i)); &#125;&#125;","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Javaæ•°æ®ç±»å‹ç¼“å­˜æ± ","slug":"æ•°æ®ç±»å‹ç¼“å­˜æ± ","date":"2017-08-27T02:28:23.000Z","updated":"2018-08-25T06:53:10.199Z","comments":true,"path":"æ•°æ®ç±»å‹ç¼“å­˜æ± .html","link":"","permalink":"http://xiaoqinghua.site/æ•°æ®ç±»å‹ç¼“å­˜æ± .html","excerpt":"","text":"new Integer(123) ä¸ Integer.valueOf(123) çš„åŒºåˆ«åœ¨äºï¼š new Integer(123) æ¯æ¬¡éƒ½ä¼šæ–°å»ºä¸€ä¸ªå¯¹è±¡Integer.valueOf(123) ä¼šä½¿ç”¨ç¼“å­˜æ± ä¸­çš„å¯¹è±¡ï¼Œå¤šæ¬¡è°ƒç”¨ä¼šå–å¾—åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚ 123456Integer x = new Integer(123);Integer y = new Integer(123);System.out.println(x == y); // falseInteger z = Integer.valueOf(123);Integer k = Integer.valueOf(123);System.out.println(z == k); // true valueOf() æ–¹æ³•çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å…ˆåˆ¤æ–­å€¼æ˜¯å¦åœ¨ç¼“å­˜æ± ä¸­ï¼Œå¦‚æœåœ¨çš„è¯å°±ç›´æ¥è¿”å›ç¼“å­˜æ± çš„å†…å®¹ã€‚ 12345public static Integer valueOf(int i) &#123; if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high) return IntegerCache.cache[i + (-IntegerCache.low)]; return new Integer(i);&#125; åœ¨ Java 8 ä¸­ï¼ŒInteger ç¼“å­˜æ± çš„å¤§å°é»˜è®¤ä¸º -128~127ã€‚ 1234567891011121314151617181920212223242526272829static final int low = -128;static final int high;static final Integer cache[];static &#123; // high value may be configured by property int h = 127; String integerCacheHighPropValue = sun.misc.VM.getSavedProperty(\"java.lang.Integer.IntegerCache.high\"); if (integerCacheHighPropValue != null) &#123; try &#123; int i = parseInt(integerCacheHighPropValue); i = Math.max(i, 127); // Maximum array size is Integer.MAX_VALUE h = Math.min(i, Integer.MAX_VALUE - (-low) -1); &#125; catch( NumberFormatException nfe) &#123; // If the property cannot be parsed into an int, ignore it. &#125; &#125; high = h; cache = new Integer[(high - low) + 1]; int j = low; for(int k = 0; k &lt; cache.length; k++) cache[k] = new Integer(j++); // range [-128, 127] must be interned (JLS7 5.1.7) assert IntegerCache.high &gt;= 127;&#125; ç¼–è¯‘å™¨ä¼šåœ¨è‡ªåŠ¨è£…ç®±è¿‡ç¨‹è°ƒç”¨ valueOf() æ–¹æ³•ï¼Œå› æ­¤å¤šä¸ª Integer å®ä¾‹ä½¿ç”¨è‡ªåŠ¨è£…ç®±æ¥åˆ›å»ºå¹¶ä¸”å€¼ç›¸åŒï¼Œé‚£ä¹ˆå°±ä¼šå¼•ç”¨ç›¸åŒçš„å¯¹è±¡ã€‚ 123Integer m = 123;Integer n = 123;System.out.println(m == n); // true åŸºæœ¬ç±»å‹å¯¹åº”çš„ç¼“å­˜æ± å¦‚ä¸‹ï¼š 12345boolean values true and falseall byte valuesshort values between -128 and 127int values between -128 and 127char in the range \\u0000 to \\u007F åœ¨ä½¿ç”¨è¿™äº›åŸºæœ¬ç±»å‹å¯¹åº”çš„åŒ…è£…ç±»å‹æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜æ± ä¸­çš„å¯¹è±¡ã€‚ StackOverflow : Differences between new Integer(123), Integer.valueOf(123) and just 123 ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/æ•°æ®ç±»å‹ç¼“å­˜æ± .htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Java å†…éƒ¨ç±»","slug":"Javaå†…éƒ¨ç±»","date":"2017-08-26T07:01:58.000Z","updated":"2018-08-24T07:42:24.335Z","comments":true,"path":"Javaå†…éƒ¨ç±».html","link":"","permalink":"http://xiaoqinghua.site/Javaå†…éƒ¨ç±».html","excerpt":"","text":"å°‘å•°å—¦ï¼Œå…ˆä¸Šä»£ç 123456789101112131415161718192021222324252627public class OuterClass &#123; private String name ; private int age; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public int getAge() &#123; return age; &#125; public void setAge(int age) &#123; this.age = age; &#125; class InnerClass&#123; public InnerClass()&#123; name = \"chenssy\"; age = 23; &#125; &#125;&#125; åœ¨è¿™é‡ŒInnerClasså°±æ˜¯å†…éƒ¨ç±»ï¼Œè™½ç„¶æ²¡æœ‰æ€ä¹ˆä½¿ç”¨è¿‡(è²Œä¼¼ä»…ä»…åªåœ¨åšswing æ³¨å†Œäº‹ä»¶ä¸­ä½¿ç”¨è¿‡)ï¼Œä½†æ˜¯éšç€ç¼–ç¨‹èƒ½åŠ›çš„æé«˜ï¼Œæˆ‘ä»¬ä¼šé¢†æ‚Ÿåˆ°å®ƒçš„é­…åŠ›æ‰€åœ¨ï¼Œå®ƒå¯ä»¥ä½¿ç”¨èƒ½å¤Ÿæ›´åŠ ä¼˜é›…çš„è®¾è®¡æˆ‘ä»¬çš„ç¨‹åºç»“æ„ã€‚åœ¨ä½¿ç”¨å†…éƒ¨ç±»ä¹‹é—´æˆ‘ä»¬éœ€è¦æ˜ç™½ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å†…éƒ¨ç±»ï¼Œå†…éƒ¨ç±»èƒ½å¤Ÿä¸ºæˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆæ ·çš„å¥½å¤„ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å†…éƒ¨ç±» ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å†…éƒ¨ç±»ï¼Ÿåœ¨ã€ŠThink in javaã€‹ä¸­æœ‰è¿™æ ·ä¸€å¥è¯ï¼šä½¿ç”¨å†…éƒ¨ç±»æœ€å¸å¼•äººçš„åŸå› æ˜¯ï¼šæ¯ä¸ªå†…éƒ¨ç±»éƒ½èƒ½ç‹¬ç«‹åœ°ç»§æ‰¿ä¸€ä¸ªï¼ˆæ¥å£çš„ï¼‰å®ç°ï¼Œæ‰€ä»¥æ— è®ºå¤–å›´ç±»æ˜¯å¦å·²ç»ç»§æ‰¿äº†æŸä¸ªï¼ˆæ¥å£çš„ï¼‰å®ç°ï¼Œå¯¹äºå†…éƒ¨ç±»éƒ½æ²¡æœ‰å½±å“ã€‚ åœ¨æˆ‘ä»¬ç¨‹åºè®¾è®¡ä¸­æœ‰æ—¶å€™ä¼šå­˜åœ¨ä¸€äº›ä½¿ç”¨æ¥å£å¾ˆéš¾è§£å†³çš„é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å†…éƒ¨ç±»æä¾›çš„ã€å¯ä»¥ç»§æ‰¿å¤šä¸ªå…·ä½“çš„æˆ–è€…æŠ½è±¡çš„ç±»çš„èƒ½åŠ›æ¥è§£å†³è¿™äº›ç¨‹åºè®¾è®¡é—®é¢˜ã€‚å¯ä»¥è¿™æ ·è¯´ï¼Œæ¥å£åªæ˜¯è§£å†³äº†éƒ¨åˆ†é—®é¢˜ï¼Œè€Œå†…éƒ¨ç±»ä½¿å¾—å¤šé‡ç»§æ‰¿(äºŒä¹‰æ€§)çš„è§£å†³æ–¹æ¡ˆå˜å¾—æ›´åŠ å®Œæ•´ã€‚ å…¶å®ä½¿ç”¨å†…éƒ¨ç±»æœ€å¤§çš„ä¼˜ç‚¹å°±åœ¨äºå®ƒèƒ½å¤Ÿéå¸¸å¥½çš„è§£å†³å¤šé‡ç»§æ‰¿çš„é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸éœ€è¦è§£å†³å¤šé‡ç»§æ‰¿é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶å¯ä»¥ä½¿ç”¨å…¶ä»–çš„ç¼–ç æ–¹å¼ï¼Œä½†æ˜¯ä½¿ç”¨å†…éƒ¨ç±»è¿˜èƒ½å¤Ÿä¸ºæˆ‘ä»¬å¸¦æ¥å¦‚ä¸‹ç‰¹æ€§ï¼ˆæ‘˜è‡ªã€ŠThink in javaã€‹ï¼‰ï¼š 1234567891ã€å†…éƒ¨ç±»å¯ä»¥ç”¨å¤šä¸ªå®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹éƒ½æœ‰è‡ªå·±çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸å…¶ä»–å¤–å›´å¯¹è±¡çš„ä¿¡æ¯ç›¸äº’ç‹¬ç«‹ã€‚2ã€åœ¨å•ä¸ªå¤–å›´ç±»ä¸­ï¼Œå¯ä»¥è®©å¤šä¸ªå†…éƒ¨ç±»ä»¥ä¸åŒçš„æ–¹å¼å®ç°åŒä¸€ä¸ªæ¥å£ï¼Œæˆ–è€…ç»§æ‰¿åŒä¸€ä¸ªç±»ã€‚3ã€åˆ›å»ºå†…éƒ¨ç±»å¯¹è±¡çš„æ—¶åˆ»å¹¶ä¸ä¾èµ–äºå¤–å›´ç±»å¯¹è±¡çš„åˆ›å»ºã€‚4ã€å†…éƒ¨ç±»å¹¶æ²¡æœ‰ä»¤äººè¿·æƒ‘çš„â€œis-aâ€å…³ç³»ï¼Œä»–å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å®ä½“ã€‚5ã€å†…éƒ¨ç±»æä¾›äº†æ›´å¥½çš„å°è£…ï¼Œé™¤äº†è¯¥å¤–å›´ç±»ï¼Œå…¶ä»–ç±»éƒ½ä¸èƒ½è®¿é—®ã€‚ å†…éƒ¨ç±»åŸºç¡€ åœ¨è¿™ä¸ªéƒ¨åˆ†ä¸»è¦ä»‹ç»å†…éƒ¨ç±»å¦‚ä½•ä½¿ç”¨å¤–éƒ¨ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»¥åŠä½¿ç”¨.thisä¸.newã€‚ å½“æˆ‘ä»¬åœ¨åˆ›å»ºä¸€ä¸ªå†…éƒ¨ç±»çš„æ—¶å€™ï¼Œå®ƒæ— å½¢ä¸­å°±ä¸å¤–å›´ç±»æœ‰äº†ä¸€ç§è”ç³»ï¼Œä¾èµ–äºè¿™ç§è”ç³»ï¼Œå®ƒå¯ä»¥æ— é™åˆ¶åœ°è®¿é—®å¤–å›´ç±»çš„å…ƒç´ ã€‚ 1234567891011121314151617181920212223242526public class OuterClass &#123; private String name ; private int age; /**çœç•¥getterå’Œsetteræ–¹æ³•**/ public class InnerClass&#123; public InnerClass()&#123; name = \"xiaoqinghua\"; age = 25; &#125; public void display()&#123; System.out.println(\"nameï¼š\" + getName() +\" ;ageï¼š\" + getAge()); &#125; &#125; public static void main(String[] args) &#123; OuterClass outerClass = new OuterClass(); OuterClass.InnerClass innerClass = outerClass.new InnerClass(); innerClass.display(); &#125;&#125;--------------Outputï¼šnameï¼šxiaoqinghua ;ageï¼š25 åœ¨è¿™ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å†…éƒ¨äº†InnerClasså¯ä»¥å¯¹å¤–å›´ç±»OuterClassçš„å±æ€§è¿›è¡Œæ— ç¼çš„è®¿é—®ï¼Œå°½ç®¡å®ƒæ˜¯privateä¿®é¥°çš„ã€‚è¿™æ˜¯å› ä¸ºå½“æˆ‘ä»¬åœ¨åˆ›å»ºæŸä¸ªå¤–å›´ç±»çš„å†…éƒ¨ç±»å¯¹è±¡æ—¶ï¼Œæ­¤æ—¶å†…éƒ¨ç±»å¯¹è±¡å¿…å®šä¼šæ•è·ä¸€ä¸ªæŒ‡å‘é‚£ä¸ªå¤–å›´ç±»å¯¹è±¡çš„å¼•ç”¨ï¼Œåªè¦æˆ‘ä»¬åœ¨è®¿é—®å¤–å›´ç±»çš„æˆå‘˜æ—¶ï¼Œå°±ä¼šç”¨è¿™ä¸ªå¼•ç”¨æ¥é€‰æ‹©å¤–å›´ç±»çš„æˆå‘˜ã€‚ å…¶å®åœ¨è¿™ä¸ªåº”ç”¨ç¨‹åºä¸­æˆ‘ä»¬è¿˜çœ‹åˆ°äº†å¦‚ä½•æ¥å¼•ç”¨å†…éƒ¨ç±»ï¼šå¼•ç”¨å†…éƒ¨ç±»æˆ‘ä»¬éœ€è¦æŒ‡æ˜è¿™ä¸ªå¯¹è±¡çš„ç±»å‹ï¼šOuterClasName.InnerClassNameã€‚åŒæ—¶å¦‚æœæˆ‘ä»¬éœ€è¦åˆ›å»ºæŸä¸ªå†…éƒ¨ç±»å¯¹è±¡ï¼Œå¿…é¡»è¦åˆ©ç”¨å¤–éƒ¨ç±»çš„å¯¹è±¡é€šè¿‡.newæ¥åˆ›å»ºå†…éƒ¨ç±»ï¼š OuterClass.InnerClass innerClass = outerClass.new InnerClass();ã€‚ åŒæ—¶å¦‚æœæˆ‘ä»¬éœ€è¦ç”Ÿæˆå¯¹å¤–éƒ¨ç±»å¯¹è±¡çš„å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨OuterClassName.thisï¼Œè¿™æ ·å°±èƒ½å¤Ÿäº§ç”Ÿä¸€ä¸ªæ­£ç¡®å¼•ç”¨å¤–éƒ¨ç±»çš„å¼•ç”¨äº†ã€‚å½“ç„¶è¿™ç‚¹å®åœ¨ç¼–è¯‘æœŸå°±çŸ¥æ™“äº†ï¼Œæ²¡æœ‰ä»»ä½•è¿è¡Œæ—¶çš„æˆæœ¬ã€‚ 1234567891011121314151617181920public class OuterClass &#123; public void display()&#123; System.out.println(\"OuterClass...\"); &#125; public class InnerClass&#123; public OuterClass getOuterClass()&#123; return OuterClass.this; &#125; &#125; public static void main(String[] args) &#123; OuterClass outerClass = new OuterClass(); OuterClass.InnerClass innerClass = outerClass.new InnerClass(); innerClass.getOuterClass().display(); &#125;&#125;-------------Output:OuterClass... åˆ°è¿™é‡Œäº†æˆ‘ä»¬éœ€è¦æ˜ç¡®ä¸€ç‚¹ï¼Œå†…éƒ¨ç±»æ˜¯ä¸ªç¼–è¯‘æ—¶çš„æ¦‚å¿µï¼Œä¸€æ—¦ç¼–è¯‘æˆåŠŸåï¼Œå®ƒå°±ä¸å¤–å›´ç±»å±äºä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ç±»ï¼ˆå½“ç„¶ä»–ä»¬ä¹‹é—´è¿˜æ˜¯æœ‰è”ç³»çš„ï¼‰ã€‚å¯¹äºä¸€ä¸ªåä¸ºOuterClassçš„å¤–å›´ç±»å’Œä¸€ä¸ªåä¸ºInnerClassçš„å†…éƒ¨ç±»ï¼Œåœ¨ç¼–è¯‘æˆåŠŸåï¼Œä¼šå‡ºç°è¿™æ ·ä¸¤ä¸ªclassæ–‡ä»¶ï¼šOuterClass.classå’ŒOuterClass$InnerClass.classã€‚ åœ¨Javaä¸­å†…éƒ¨ç±»ä¸»è¦åˆ†ä¸ºæˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»ã€é™æ€å†…éƒ¨ç±»ã€‚ æˆå‘˜å†…éƒ¨ç±»æˆå‘˜å†…éƒ¨ç±»ä¹Ÿæ˜¯æœ€æ™®é€šçš„å†…éƒ¨ç±»ï¼Œå®ƒæ˜¯å¤–å›´ç±»çš„ä¸€ä¸ªæˆå‘˜ï¼Œæ‰€ä»¥ä»–æ˜¯å¯ä»¥æ— é™åˆ¶çš„è®¿é—®å¤–å›´ç±»çš„æ‰€æœ‰ æˆå‘˜å±æ€§å’Œæ–¹æ³•ï¼Œå°½ç®¡æ˜¯privateçš„ï¼Œä½†æ˜¯å¤–å›´ç±»è¦è®¿é—®å†…éƒ¨ç±»çš„æˆå‘˜å±æ€§å’Œæ–¹æ³•åˆ™éœ€è¦é€šè¿‡å†…éƒ¨ç±»å®ä¾‹æ¥è®¿é—®ã€‚ åœ¨æˆå‘˜å†…éƒ¨ç±»ä¸­è¦æ³¨æ„ä¸¤ç‚¹: æˆå‘˜å†…éƒ¨ç±»ä¸­ä¸èƒ½å­˜åœ¨ä»»ä½•staticçš„å˜é‡å’Œæ–¹æ³• æˆå‘˜å†…éƒ¨ç±»æ˜¯ä¾é™„äºå¤–å›´ç±»çš„ï¼Œæ‰€ä»¥åªæœ‰å…ˆåˆ›å»ºäº†å¤–å›´ç±»æ‰èƒ½å¤Ÿåˆ›å»ºå†…éƒ¨ç±» 12345678910111213141516171819202122232425262728293031public class OuterClass &#123; private String str; public void outerDisplay()&#123; System.out.println(\"outerClass...\"); &#125; public class InnerClass&#123; public void innerDisplay()&#123; //ä½¿ç”¨å¤–å›´å†…çš„å±æ€§ str = \"xiaoqinghua...\"; System.out.println(str); //ä½¿ç”¨å¤–å›´å†…çš„æ–¹æ³• outerDisplay(); &#125; &#125; /*æ¨èä½¿ç”¨getxxx()æ¥è·å–æˆå‘˜å†…éƒ¨ç±»ï¼Œå°¤å…¶æ˜¯è¯¥å†…éƒ¨ç±»çš„æ„é€ å‡½æ•°æ— å‚æ•°æ—¶ */ public InnerClass getInnerClass()&#123; return new InnerClass(); &#125; public static void main(String[] args) &#123; OuterClass outer = new OuterClass(); OuterClass.InnerClass inner = outer.getInnerClass(); inner.innerDisplay(); &#125;&#125;--------------------xiaoqinghua...outerClass... å±€éƒ¨å†…éƒ¨ç±»æœ‰è¿™æ ·ä¸€ç§å†…éƒ¨ç±»ï¼Œå®ƒæ˜¯åµŒå¥—åœ¨æ–¹æ³•å’Œä½œç”¨äºå†…çš„ï¼Œå¯¹äºè¿™ä¸ªç±»çš„ä½¿ç”¨ä¸»è¦æ˜¯åº”ç”¨ä¸è§£å†³æ¯”è¾ƒå¤æ‚çš„é—®é¢˜ï¼Œæƒ³åˆ›å»ºä¸€ä¸ªç±»æ¥è¾…åŠ©æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆï¼Œåˆ°é‚£æ—¶åˆä¸å¸Œæœ›è¿™ä¸ªç±»æ˜¯å…¬å…±å¯ç”¨çš„ï¼Œæ‰€ä»¥å°±äº§ç”Ÿäº†å±€éƒ¨å†…éƒ¨ç±»ï¼Œå±€éƒ¨å†…éƒ¨ç±»å’Œæˆå‘˜å†…éƒ¨ç±»ä¸€æ ·è¢«ç¼–è¯‘ï¼Œåªæ˜¯å®ƒçš„ä½œç”¨åŸŸå‘ç”Ÿäº†æ”¹å˜ï¼Œå®ƒåªèƒ½åœ¨è¯¥æ–¹æ³•å’Œå±æ€§ä¸­è¢«ä½¿ç”¨ï¼Œå‡ºäº†è¯¥æ–¹æ³•å’Œå±æ€§å°±ä¼šå¤±æ•ˆã€‚ å¯¹äºå±€éƒ¨å†…éƒ¨ç±»å®åœ¨æ˜¯æƒ³ä¸å‡ºä»€ä¹ˆå¥½ä¾‹å­ï¼Œæ‰€ä»¥å°±å¼•ç”¨ã€ŠThink in javaã€‹ä¸­çš„ç»å…¸ä¾‹å­äº†ã€‚ å®šä¹‰åœ¨æ–¹æ³•é‡Œï¼š 12345678910111213141516171819public class Parcel5 &#123; public Destionation destionation(String str)&#123; class PDestionation implements Destionation&#123; private String label; private PDestionation(String whereTo)&#123; label = whereTo; &#125; public String readLabel()&#123; return label; &#125; &#125; return new PDestionation(str); &#125; public static void main(String[] args) &#123; Parcel5 parcel5 = new Parcel5(); Destionation d = parcel5.destionation(\"xiaoqinghua\"); &#125;&#125; å®šä¹‰åœ¨ä½œç”¨åŸŸå†…: 1234567891011121314151617181920212223242526public class Parcel6 &#123; private void internalTracking(boolean b)&#123; if(b)&#123; class TrackingSlip&#123; private String id; TrackingSlip(String s) &#123; id = s; &#125; String getSlip()&#123; return id; &#125; &#125; TrackingSlip ts = new TrackingSlip(\"xiaoqinghua\"); String string = ts.getSlip(); &#125; &#125; public void track()&#123; internalTracking(true); &#125; public static void main(String[] args) &#123; Parcel6 parcel6 = new Parcel6(); parcel6.track(); &#125;&#125; åŒ¿åå†…éƒ¨ç±»åœ¨åšSwingç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨è¿™ç§æ–¹å¼æ¥ç»‘å®šäº‹ä»¶ 123456button2.addActionListener( new ActionListener()&#123; public void actionPerformed(ActionEvent e) &#123; System.out.println(\"ç‚¹å‡»äº†æŒ‰é’®\"); &#125; &#125;); æˆ‘ä»¬å’‹ä¸€çœ‹å¯èƒ½è§‰å¾—éå¸¸å¥‡æ€ªï¼Œå› ä¸ºè¿™ä¸ªå†…éƒ¨ç±»æ˜¯æ²¡æœ‰åå­—çš„ï¼Œåœ¨çœ‹å¦‚ä¸‹è¿™ä¸ªä¾‹å­ï¼š 123456789101112131415161718192021222324public class OuterClass &#123; public InnerClass getInnerClass(final int num,String str2)&#123; return new InnerClass()&#123; int number = num + 3; public int getNumber()&#123; return number; &#125; &#125;; /* æ³¨æ„ï¼šåˆ†å·ä¸èƒ½çœ */ &#125; public static void main(String[] args) &#123; OuterClass out = new OuterClass(); InnerClass inner = out.getInnerClass(2, \"xiaoqinghua\"); System.out.println(inner.getNumber()); &#125;&#125;interface InnerClass &#123; int getNumber();&#125;----------------Output:5 è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦çœ‹æ¸…å‡ ä¸ªåœ°æ–¹ 123456781ã€ åŒ¿åå†…éƒ¨ç±»æ˜¯æ²¡æœ‰è®¿é—®ä¿®é¥°ç¬¦çš„ã€‚2ã€ new åŒ¿åå†…éƒ¨ç±»ï¼Œè¿™ä¸ªç±»é¦–å…ˆæ˜¯è¦å­˜åœ¨çš„ã€‚å¦‚æœæˆ‘ä»¬å°†é‚£ä¸ªInnerClassæ¥å£æ³¨é‡Šæ‰ï¼Œå°±ä¼šå‡ºç°ç¼–è¯‘å‡ºé”™ã€‚3ã€ æ³¨æ„getInnerClass()æ–¹æ³•çš„å½¢å‚ï¼Œç¬¬ä¸€ä¸ªå½¢å‚æ˜¯ç”¨finalä¿®é¥°çš„ï¼Œè€Œç¬¬äºŒä¸ªå´æ²¡æœ‰ã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿå‘ç°ç¬¬äºŒä¸ªå½¢å‚åœ¨åŒ¿åå†…éƒ¨ç±»ä¸­æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œæ‰€ä»¥å½“æ‰€åœ¨æ–¹æ³•çš„å½¢å‚éœ€è¦è¢«åŒ¿åå†…éƒ¨ç±»ä½¿ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå½¢å‚å°±å¿…é¡»ä¸ºfinalã€‚4ã€ åŒ¿åå†…éƒ¨ç±»æ˜¯æ²¡æœ‰æ„é€ æ–¹æ³•çš„ã€‚å› ä¸ºå®ƒè¿åå­—éƒ½æ²¡æœ‰ä½•æ¥æ„é€ æ–¹æ³•ã€‚ é™æ€å†…éƒ¨ç±»staticå¯ä»¥ä¿®é¥°æˆå‘˜å˜é‡ã€æ–¹æ³•ã€ä»£ç å—ï¼Œå…¶ä»–å®ƒè¿˜å¯ä»¥ä¿®é¥°å†…éƒ¨ç±»ï¼Œä½¿ç”¨staticä¿®é¥°çš„å†…éƒ¨ç±»æˆ‘ä»¬ç§°ä¹‹ä¸ºé™æ€å†…éƒ¨ç±»ï¼Œä¸è¿‡æˆ‘ä»¬æ›´å–œæ¬¢ç§°ä¹‹ä¸ºåµŒå¥—å†…éƒ¨ç±»ã€‚é™æ€å†…éƒ¨ç±»ä¸éé™æ€å†…éƒ¨ç±»ä¹‹é—´å­˜åœ¨ä¸€ä¸ªæœ€å¤§çš„åŒºåˆ«ï¼Œæˆ‘ä»¬çŸ¥é“éé™æ€å†…éƒ¨ç±»åœ¨ç¼–è¯‘å®Œæˆä¹‹åä¼šéšå«åœ°ä¿å­˜ç€ä¸€ä¸ªå¼•ç”¨ï¼Œè¯¥å¼•ç”¨æ˜¯æŒ‡å‘åˆ›å»ºå®ƒçš„å¤–å›´å†…ï¼Œä½†æ˜¯é™æ€å†…éƒ¨ç±»å´æ²¡æœ‰ã€‚æ²¡æœ‰è¿™ä¸ªå¼•ç”¨å°±æ„å‘³ç€ï¼š å®ƒçš„åˆ›å»ºæ˜¯ä¸éœ€è¦ä¾èµ–äºå¤–å›´ç±»çš„ã€‚ å®ƒä¸èƒ½ä½¿ç”¨ä»»ä½•å¤–å›´ç±»çš„éstaticæˆå‘˜å˜é‡å’Œæ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162public class OuterClass &#123; private String sex; public static String name = \"chenssy\"; /** *é™æ€å†…éƒ¨ç±» */ static class InnerClass1&#123; /* åœ¨é™æ€å†…éƒ¨ç±»ä¸­å¯ä»¥å­˜åœ¨é™æ€æˆå‘˜ */ public static String _name1 = \"chenssy_static\"; public void display()&#123; /* * é™æ€å†…éƒ¨ç±»åªèƒ½è®¿é—®å¤–å›´ç±»çš„é™æ€æˆå‘˜å˜é‡å’Œæ–¹æ³• * ä¸èƒ½è®¿é—®å¤–å›´ç±»çš„éé™æ€æˆå‘˜å˜é‡å’Œæ–¹æ³• */ System.out.println(\"OutClass name :\" + name); &#125; &#125; /** * éé™æ€å†…éƒ¨ç±» */ class InnerClass2&#123; /* éé™æ€å†…éƒ¨ç±»ä¸­ä¸èƒ½å­˜åœ¨é™æ€æˆå‘˜ */ public String _name2 = \"chenssy_inner\"; /* éé™æ€å†…éƒ¨ç±»ä¸­å¯ä»¥è°ƒç”¨å¤–å›´ç±»çš„ä»»ä½•æˆå‘˜,ä¸ç®¡æ˜¯é™æ€çš„è¿˜æ˜¯éé™æ€çš„ */ public void display()&#123; System.out.println(\"OuterClass nameï¼š\" + name); &#125; &#125; /** * @desc å¤–å›´ç±»æ–¹æ³• * @author chenssy * @data 2013-10-25 * @return void */ public void display()&#123; /* å¤–å›´ç±»è®¿é—®é™æ€å†…éƒ¨ç±»ï¼šå†…éƒ¨ç±». */ System.out.println(InnerClass1._name1); /* é™æ€å†…éƒ¨ç±» å¯ä»¥ç›´æ¥åˆ›å»ºå®ä¾‹ä¸éœ€è¦ä¾èµ–äºå¤–å›´ç±» */ new InnerClass1().display(); /* éé™æ€å†…éƒ¨çš„åˆ›å»ºéœ€è¦ä¾èµ–äºå¤–å›´ç±» */ OuterClass.InnerClass2 inner2 = new OuterClass().new InnerClass2(); /* æ–¹ä½éé™æ€å†…éƒ¨ç±»çš„æˆå‘˜éœ€è¦ä½¿ç”¨éé™æ€å†…éƒ¨ç±»çš„å®ä¾‹ */ System.out.println(inner2._name2); inner2.display(); &#125; public static void main(String[] args) &#123; OuterClass outer = new OuterClass(); outer.display(); &#125;&#125;----------------Output:chenssy_staticOutClass name :chenssychenssy_innerOuterClass nameï¼šchenssy ä»¥ä¸Šå†…å®¹è½¬è½½è‡³ï¼šhttp://www.cnblogs.com/chenssy/ chenssy å¤§ä½¬çš„åšå®¢ åŠ ä¸€ä¸‹æ–™ï¼šé‡å†™å’Œé‡è½½ é‡å†™ï¼ˆOverrideï¼‰ å­˜åœ¨äºç»§æ‰¿ä½“ç³»ä¸­ï¼ŒæŒ‡å­ç±»å®ç°äº†ä¸€ä¸ªä¸çˆ¶ç±»åœ¨æ–¹æ³•å£°æ˜ä¸Šå®Œå…¨ç›¸åŒçš„ä¸€ä¸ªæ–¹æ³•ã€‚ ä¸ºäº†æ»¡è¶³é‡Œå¼æ›¿æ¢åŸåˆ™ï¼Œé‡å†™æœ‰æœ‰ä»¥ä¸‹ä¸¤ä¸ªé™åˆ¶ï¼š å­ç±»æ–¹æ³•çš„è®¿é—®æƒé™å¿…é¡»å¤§äºç­‰äºçˆ¶ç±»æ–¹æ³•ï¼› å­ç±»æ–¹æ³•çš„è¿”å›ç±»å‹å¿…é¡»æ˜¯çˆ¶ç±»æ–¹æ³•è¿”å›ç±»å‹æˆ–ä¸ºå…¶å­ç±»å‹ã€‚ ä½¿ç”¨ @Override æ³¨è§£ï¼Œå¯ä»¥è®©ç¼–è¯‘å™¨å¸®å¿™æ£€æŸ¥æ˜¯å¦æ»¡è¶³ä¸Šé¢çš„ä¸¤ä¸ªé™åˆ¶æ¡ä»¶ã€‚ é‡è½½ï¼ˆOverloadï¼‰ å­˜åœ¨äºåŒä¸€ä¸ªç±»ä¸­ï¼ŒæŒ‡ä¸€ä¸ªæ–¹æ³•ä¸å·²ç»å­˜åœ¨çš„æ–¹æ³•åç§°ä¸Šç›¸åŒï¼Œä½†æ˜¯å‚æ•°ç±»å‹ã€ä¸ªæ•°ã€é¡ºåºè‡³å°‘æœ‰ä¸€ä¸ªä¸åŒã€‚ åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œè¿”å›å€¼ä¸åŒï¼Œå…¶å®ƒéƒ½ç›¸åŒä¸ç®—æ˜¯é‡è½½ã€‚","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Stringçš„é‚£äº›äº‹","slug":"å†è®°String","date":"2017-08-25T02:28:23.000Z","updated":"2018-08-25T06:52:17.457Z","comments":true,"path":"å†è®°String.html","link":"","permalink":"http://xiaoqinghua.site/å†è®°String.html","excerpt":"","text":"String çš„ç”¨æ³•Stringç±»åœ¨ java.lang åŒ…ä¸­ï¼Œjava ä½¿ç”¨Stringç±»åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ï¼Œå­—ç¬¦ä¸²å˜é‡å±äºå¯¹è±¡ã€‚java æŠŠStringç±»å£°æ˜çš„finalç±»ï¼Œä¸èƒ½æœ‰å­ç±»ã€‚Stringç±»å¯¹è±¡åˆ›å»ºåä¸èƒ½ä¿®æ”¹ï¼Œç”± 0 æˆ–å¤šä¸ªå­—ç¬¦ç»„æˆï¼ŒåŒ…å«åœ¨ä¸€å¯¹åŒå¼•å·ä¹‹é—´ï¼Œä¸‹é¢ç®€å•çš„ç†Ÿæ‚‰ä¸€ä¸‹å…¶å¸¸ç”¨çš„ APIï¼š 1234567891011121314151617char charAt (int index) è¿”å›indexæ‰€æŒ‡å®šçš„å­—ç¬¦ String concat(String str) å°†ä¸¤å­—ç¬¦ä¸²è¿æ¥ boolean endsWith(String str) æµ‹è¯•å­—ç¬¦ä¸²æ˜¯å¦ä»¥strç»“å°¾ boolean equals(Object obj) æ¯”è¾ƒä¸¤å¯¹è±¡ char[] getBytes å°†å­—ç¬¦ä¸²è½¬æ¢æˆå­—ç¬¦æ•°ç»„è¿”å› char[] getBytes(String str) å°†æŒ‡å®šçš„å­—ç¬¦ä¸²è½¬æˆåˆ¶æœæ•°ç»„è¿”å› boolean startsWith(String str) æµ‹è¯•å­—ç¬¦ä¸²æ˜¯å¦ä»¥strå¼€å§‹ int length() è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ String replace(char old ,char new) å°†oldç”¨newæ›¿ä»£ char[] toCharArray å°†å­—ç¬¦ä¸²è½¬æ¢æˆå­—ç¬¦æ•°ç»„ String toLowerCase() å°†å­—ç¬¦ä¸²å†…çš„å­—ç¬¦æ”¹å†™æˆå°å†™ String toUpperCase() å°†å­—ç¬¦ä¸²å†…çš„å­—ç¬¦æ”¹å†™æˆå¤§å†™ String valueOf(Boolean b) å°†å¸ƒå°”æ–¹æ³•bçš„å†…å®¹ç”¨å­—ç¬¦ä¸²è¡¨ç¤º String valueOf(char ch) å°†å­—ç¬¦chçš„å†…å®¹ç”¨å­—ç¬¦ä¸²è¡¨ç¤º String valueOf(int index) å°†æ•°å­—indexçš„å†…å®¹ç”¨å­—ç¬¦ä¸²è¡¨ç¤º String valueOf(long l) å°†é•¿æ•´æ•°å­—lçš„å†…å®¹ç”¨å­—ç¬¦ä¸²è¡¨ç¤º String substring(int1,int2) å–å‡ºå­—ç¬¦ä¸²å†…ç¬¬int1ä½ç½®åˆ°int2çš„å­—ç¬¦ä¸² 1.æ„é€ æ–¹æ³• 123456//ç›´æ¥åˆå§‹åŒ–String str = \"abc\";//ä½¿ç”¨å¸¦å‚æ„é€ æ–¹æ³•åˆå§‹åŒ–char[] char = &#123;'a','b','c'&#125;;String str1 = new String(\"abc\");String str2 = new String(str);String str3 = new String(char); 2.æ±‚å­—ç¬¦ä¸²é•¿åº¦å’ŒæŸä¸€ä½ç½®å­—ç¬¦ 123String str = new String(\"abcdef\");int strlength = str.length();//strlength = 7char ch = str.charAt(4);//ch = e 3.æå–å­ä¸² ç”¨Stringç±»çš„substringæ–¹æ³•å¯ä»¥æå–å­—ç¬¦ä¸²ä¸­çš„å­ä¸²ï¼Œè¯¥æ–¹æ³•æœ‰ä¸¤ç§å¸¸ç”¨å‚æ•°:1)public String substring(int beginIndex)//è¯¥æ–¹æ³•ä»beginIndexä½ç½®èµ·ï¼Œä»å½“å‰å­—ç¬¦ä¸²ä¸­å–å‡ºå‰©ä½™çš„å­—ç¬¦ä½œä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿”å›ã€‚ 2)public String substring(int beginIndex, int endIndex)//è¯¥æ–¹æ³•ä»beginIndexä½ç½®èµ·ï¼Œä»å½“å‰å­—ç¬¦ä¸²ä¸­å–å‡ºåˆ°endIndex-1ä½ç½®çš„å­—ç¬¦ä½œä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿”å›ã€‚ 123String str1 = new String(\"abcdef\");String str2 = str1.substring(2);//str2 = \"cdef\"String str3 = str1.substring(2,5);//str3 = \"cde\" 4.å­—ç¬¦ä¸²æ¯”è¾ƒ 1)public int compareTo(String anotherString)//è¯¥æ–¹æ³•æ˜¯å¯¹å­—ç¬¦ä¸²å†…å®¹æŒ‰å­—å…¸é¡ºåºè¿›è¡Œå¤§å°æ¯”è¾ƒï¼Œé€šè¿‡è¿”å›çš„æ•´æ•°å€¼æŒ‡æ˜å½“å‰å­—ç¬¦ä¸²ä¸å‚æ•°å­—ç¬¦ä¸²çš„å¤§å°å…³ç³»ã€‚è‹¥å½“å‰å¯¹è±¡æ¯”å‚æ•°å¤§åˆ™è¿”å›æ­£æ•´æ•°ï¼Œåä¹‹è¿”å›è´Ÿæ•´æ•°ï¼Œç›¸ç­‰è¿”å›0ã€‚ 2)public int compareToIgnoreCase(String anotherString)//ä¸compareToæ–¹æ³•ç›¸ä¼¼ï¼Œä½†å¿½ç•¥å¤§å°å†™ã€‚ 3)public boolean equals(Object anotherObject)//æ¯”è¾ƒå½“å‰å­—ç¬¦ä¸²å’Œå‚æ•°å­—ç¬¦ä¸²ï¼Œåœ¨ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰çš„æ—¶å€™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚ 4)public boolean equalsIgnoreCase(String anotherString)//ä¸equalsæ–¹æ³•ç›¸ä¼¼ï¼Œä½†å¿½ç•¥å¤§å°å†™ã€‚ 123456String str1 = new String(\"abc\");String str2 = new String(\"ABC\");int a = str1.compareTo(str2);//a&gt;0int b = str1.compareToIgnoreCase(str2);//b=0boolean c = str1.equals(str2);//c=falseboolean d = str1.equalsIgnoreCase(str2);//d=true 5.å­—ç¬¦ä¸²é“¾æ¥ public String concat(String str)//å°†å‚æ•°ä¸­çš„å­—ç¬¦ä¸²strè¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²çš„åé¢ï¼Œæ•ˆæœç­‰ä»·äºâ€+â€ 12String str = \"aa\".concat(\"bb\").concat(\"cc\");//ç›¸å½“äºString str = \"aa\"+\"bb\"+\"cc\"; 6.å­—ç¬¦ä¸²ä¸­å•ä¸ªå­—ç¬¦æŸ¥æ‰¾ 1)public int indexOf(int ch/String str)//ç”¨äºæŸ¥æ‰¾å½“å‰å­—ç¬¦ä¸²ä¸­å­—ç¬¦æˆ–å­ä¸²ï¼Œè¿”å›å­—ç¬¦æˆ–å­ä¸²åœ¨å½“å‰å­—ç¬¦ä¸²ä¸­ä»å·¦è¾¹èµ·é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè‹¥æ²¡æœ‰å‡ºç°åˆ™è¿”å›-1ã€‚ 2)public int indexOf(int ch/String str, int fromIndex)//æ”¹æ–¹æ³•ä¸ç¬¬ä¸€ç§ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºè¯¥æ–¹æ³•ä»fromIndexä½ç½®å‘åæŸ¥æ‰¾ã€‚ 3)public int lastIndexOf(int ch/String str)//è¯¥æ–¹æ³•ä¸ç¬¬ä¸€ç§ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºè¯¥æ–¹æ³•ä»å­—ç¬¦ä¸²çš„æœ«å°¾ä½ç½®å‘å‰æŸ¥æ‰¾ã€‚ 4)public int lastIndexOf(int ch/String str, int fromIndex)//è¯¥æ–¹æ³•ä¸ç¬¬äºŒç§æ–¹æ³•ç±»ä¼¼ï¼ŒåŒºåˆ«äºè¯¥æ–¹æ³•ä»fromIndexä½ç½®å‘å‰æŸ¥æ‰¾ã€‚ 123456String str = \"I really miss you !\";int a = str.indexOf('a');//a = 4int b = str.indexOf(\"really\");//b = 2int c = str.indexOf(\"gg\",2);//c = -1int d = str.lastIndexOf('s');//d = 6int e = str.lastIndexOf('s',7);//e = 7 7.å¤§å°å†™è½¬æ¢ 1)public String toLowerCase()//è¿”å›å°†å½“å‰å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—ç¬¦è½¬æ¢æˆå°å†™åçš„æ–°ä¸² 2)public String toUpperCase()//è¿”å›å°†å½“å‰å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—ç¬¦è½¬æ¢æˆå¤§å†™åçš„æ–°ä¸² 123String str = new String(\"abCD\");String str1 = str.toLowerCase();//str1 = \"abcd\"String str2 = str.toUpperCase();//str2 = \"ABCD\" 8.å­—ç¬¦ä¸²ä¸­å­—ç¬¦çš„æ›¿æ¢ 1)public String replace(char oldChar, char newChar)//ç”¨å­—ç¬¦newCharæ›¿æ¢å½“å‰å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„oldCharå­—ç¬¦ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚ 2)public String replaceFirst(String regex, String replacement)//è¯¥æ–¹æ³•ç”¨å­—ç¬¦replacementçš„å†…å®¹æ›¿æ¢å½“å‰å­—ç¬¦ä¸²ä¸­é‡åˆ°çš„ç¬¬ä¸€ä¸ªå’Œå­—ç¬¦ä¸²regexç›¸åŒ¹é…çš„å­ä¸²ï¼Œåº”å°†æ–°çš„å­—ç¬¦ä¸²è¿”å›ã€‚ 3)public String replaceAll(String regex, String replacement)//è¯¥æ–¹æ³•ç”¨å­—ç¬¦replacementçš„å†…å®¹æ›¿æ¢å½“å‰å­—ç¬¦ä¸²ä¸­é‡åˆ°çš„æ‰€æœ‰å’Œå­—ç¬¦ä¸²regexç›¸åŒ¹é…çš„å­ä¸²ï¼Œåº”å°†æ–°çš„å­—ç¬¦ä¸²è¿”å›ã€‚ 12345String str = \"asdzxcasd\";String str1 = str.replace('a','g');//str1 = \"gsdzxcgsd\"String str2 = str.replace(\"asd\",\"fgh\");//str2 = \"fghzxcfgh\"String str3 = str.replaceFirst(\"asd\",\"fgh\");//str3 = \"fghzxcasd\"String str4 = str.replaceAll(\"asd\",\"fgh\");//str4 = \"fghzxcfgh\" 9.å…¶ä»–æ–¹æ³• 1)String trim()//æˆªå»å­—ç¬¦ä¸²ä¸¤ç«¯çš„ç©ºæ ¼ï¼Œä½†å¯¹äºä¸­é—´çš„ç©ºæ ¼ä¸å¤„ç†ã€‚ 1234String str = \" a bc \";String str1 = str.trim();int a = str.length();//a = 6int b = str1.length();//b = 4 2)boolean statWith(String prefix)æˆ–boolean endWith(String suffix)//ç”¨æ¥æ¯”è¾ƒå½“å‰å­—ç¬¦ä¸²çš„èµ·å§‹å­—ç¬¦æˆ–å­å­—ç¬¦ä¸²prefixå’Œç»ˆæ­¢å­—ç¬¦æˆ–å­å­—ç¬¦ä¸²suffixæ˜¯å¦å’Œå½“å‰å­—ç¬¦ä¸²ç›¸åŒï¼Œé‡è½½æ–¹æ³•ä¸­åŒæ—¶è¿˜å¯ä»¥æŒ‡å®šæ¯”è¾ƒçš„å¼€å§‹ä½ç½®offsetã€‚ 123String str = \"abcdef\";boolean a = str.statWith(\"ab\");//a = trueboolean b = str.endWith(\"ef\");//b = true 3)contains(String str)//åˆ¤æ–­å‚æ•°sæ˜¯å¦è¢«åŒ…å«åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å€¼ã€‚ 123String str = \"abcdef\";str.contains(\"ab\");//truestr.contains(\"gh\");//false 4)String[] split(String str)//å°†strä½œä¸ºåˆ†éš”ç¬¦è¿›è¡Œå­—ç¬¦ä¸²åˆ†è§£ï¼Œåˆ†è§£åçš„å­—å­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²æ•°ç»„ä¸­è¿”å›ã€‚ 12String str = \"abc def ghi\";String[] str1 = str.split(\" \");//str1[0] = \"abc\";str1[1] = \"def\";str1[2] = \"ghi\"; 10.ç±»å‹è½¬æ¢ å­—ç¬¦ä¸²è½¬åŸºæœ¬ç±»å‹:java.langåŒ…ä¸­æœ‰Byteã€Shortã€Integerã€Floatã€Doubleç±»çš„è°ƒç”¨æ–¹æ³•ï¼š 123456789public static byte parseByte(String s)public static short parseShort(String s)public static short parseInt(String s)public static long parseLong(String s)public static float parseFloat(String s)public static double parseDouble(String s)int n = Integer.parseInt(\"12\");float f = Float.parseFloat(\"12.34\");double d = Double.parseDouble(\"1.124\"); åŸºæœ¬ç±»å‹è½¬å­—ç¬¦ä¸²:Stringç±»ä¸­æä¾›äº†String valueOf()æ”¾æ³•ï¼Œç”¨ä½œåŸºæœ¬ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ 1234567891011static String valueOf(char data[])static String valueOf(char data[], int offset, int count)static String valueOf(boolean b)static String valueOf(char c)static String valueOf(int i)static String valueOf(long l)static String valueOf(float f)static String valueOf(double d)//å°†char '8' è½¬æ¢ä¸ºint 8String str = String.valueOf('8');int num = Integer.parseInt(str); è¿›åˆ¶è½¬æ¢:ä½¿ç”¨Longç±»ä¸­çš„æ–¹æ³•å¾—åˆ°æ•´æ•°ä¹‹é—´çš„å„ç§è¿›åˆ¶è½¬æ¢çš„æ–¹æ³•ï¼š 1234Long.toBinaryString(long l)//äºŒè¿›åˆ¶Long.toOctalString(long l)//å…«è¿›åˆ¶Long.toHexString(long l)//åå…­è¿›åˆ¶Long.toString(long l, int p)//pä½œä¸ºä»»æ„è¿›åˆ¶ String çš„ç‰¹æ€§1ã€Stringæ˜¯ä¸å¯å˜ç±» è¿™å¥è¯å…¶å®å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œé‚£ä¹ˆå…·ä½“ä»€ä¹ˆæ˜¯ä¸å¯å˜ç±»å‘¢ï¼Ÿä¸€èˆ¬è®¤ä¸ºï¼šå½“å¯¹è±¡ä¸€æ—¦åˆ›å»ºå®Œæˆåï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¯¹è±¡çš„çŠ¶æ€ä¸ä¼šå› å¤–ç•Œçš„æ”¹å˜è€Œæ”¹å˜ï¼ˆå¯¹è±¡çš„çŠ¶æ€æ˜¯æŒ‡å¯¹è±¡çš„å±æ€§ï¼ŒåŒ…æ‹¬å±æ€§çš„ç±»å‹åŠå±æ€§å€¼ï¼‰ é¦–å…ˆçœ‹ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼š 12341 String s = \"abc\";2 System.out.println(\"s:\" + s); // è¾“å‡ºs:abc3 s = \"def\";4 System.out.println(\"s:\" + s); // è¾“å‡ºs:def æ­¤æ—¶ï¼Œåˆçœ‹ä¸Šå»ï¼Œè¾“å‡ºçš„ç»“æœå˜äº†ï¼Œå‘ç°sçš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆè¿™ä¸ä¸Šé¢çš„è¯´æ³•â€”â€”Stringç±»æ˜¯ä¸å¯å˜ç±»æ˜¯å¦çŸ›ç›¾å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºsåªæ˜¯æŒ‡å‘å †å†…å­˜ä¸­çš„å¼•ç”¨ï¼Œå­˜å‚¨çš„æ˜¯å¯¹è±¡åœ¨å †ä¸­çš„åœ°å€ï¼Œè€Œéå¯¹è±¡æœ¬èº«ï¼Œsæœ¬èº«å­˜å‚¨åœ¨æ ˆå†…å­˜ä¸­ã€‚ å®é™…ä¸Šï¼Œæ­¤æ—¶å †å†…å­˜ä¸­ä¾ç„¶å­˜åœ¨ç€&quot;abc&quot;å’Œ&quot;def&quot;å¯¹è±¡ã€‚å¯¹äº&quot;abc&quot;å¯¹è±¡æœ¬èº«è€Œè¨€ï¼Œå¯¹è±¡çš„çŠ¶æ€æ˜¯æ²¡æœ‰å‘ç”Ÿä»»ä½•å˜åŒ–çš„ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆStringç±»å…·æœ‰ä¸å¯å˜æ€§å‘¢ï¼Œæ˜¾ç„¶ï¼Œæ—¢ç„¶ä¸å¯å˜è¯´æ˜Stringç±»ä¸­è‚¯å®šæ²¡æœ‰æä¾›å¯¹å¤–å¯settersæ–¹æ³•ã€‚æ¥ä¸‹æ¥æ¥å…·ä½“çœ‹ä¸€ä¸‹Stringç±»çš„å®šä¹‰ã€‚ ä¸‹é¢æ˜¯Stringç±»ä¸­ä¸»è¦å±æ€§çš„å®šä¹‰ï¼ˆJava 1.7æºç ï¼‰ï¼š 1234567891 public final class String implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence&#123;2 3 /** The value is used for character storage. */4 private final char value[];5 6 /** Cache the hash code for the string */7 private int hash; // Default to 08 9 &#125; ä¸å¯å˜çš„å¥½å¤„ï¼š 123456789101112131415161. å¯ä»¥ç¼“å­˜ hash å€¼å› ä¸º String çš„ hash å€¼ç»å¸¸è¢«ä½¿ç”¨ï¼Œä¾‹å¦‚ String ç”¨åš HashMap çš„ keyã€‚ä¸å¯å˜çš„ç‰¹æ€§å¯ä»¥ä½¿å¾— hash å€¼ä¹Ÿä¸å¯å˜ï¼Œå› æ­¤åªéœ€è¦è¿›è¡Œä¸€æ¬¡è®¡ç®—2. String Pool çš„éœ€è¦å¦‚æœä¸€ä¸ª String å¯¹è±¡å·²ç»è¢«åˆ›å»ºè¿‡äº†ï¼Œé‚£ä¹ˆå°±ä¼šä» String Pool ä¸­å–å¾—å¼•ç”¨ã€‚åªæœ‰ String æ˜¯ä¸å¯å˜çš„ï¼Œæ‰å¯èƒ½ä½¿ç”¨ String Pool3. å®‰å…¨æ€§String ç»å¸¸ä½œä¸ºå‚æ•°ï¼ŒString ä¸å¯å˜æ€§å¯ä»¥ä¿è¯å‚æ•°ä¸å¯å˜ã€‚ä¾‹å¦‚åœ¨ä½œä¸ºç½‘ç»œè¿æ¥å‚æ•°çš„æƒ…å†µä¸‹å¦‚æœ String æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆåœ¨ç½‘ç»œè¿æ¥è¿‡ç¨‹ä¸­ï¼ŒString è¢«æ”¹å˜ï¼Œæ”¹å˜ String å¯¹è±¡çš„é‚£ä¸€æ–¹ä»¥ä¸ºç°åœ¨è¿æ¥çš„æ˜¯å…¶å®ƒä¸»æœºï¼Œè€Œå®é™…æƒ…å†µå´ä¸ä¸€å®šæ˜¯4. çº¿ç¨‹å®‰å…¨String ä¸å¯å˜æ€§å¤©ç”Ÿå…·å¤‡çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å®‰å…¨åœ°ä½¿ç”¨ Program Creek : Why String is immutable in Java? 2ã€String, StringBuffer and StringBuilder 12345678910å¯å˜æ€§String ä¸å¯å˜StringBuffer å’Œ StringBuilder å¯å˜çº¿ç¨‹å®‰å…¨String ä¸å¯å˜ï¼Œå› æ­¤æ˜¯çº¿ç¨‹å®‰å…¨çš„StringBuilder ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„StringBuffer æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå†…éƒ¨ä½¿ç”¨ synchronized è¿›è¡ŒåŒæ­¥ StackOverflow : String, StringBuffer, and StringBuilder \bä¸¾å‡ ä¸ªğŸŒ°ğŸŒ°1: 1234567String a = \"Hello World!\"; String b = \"Hello World!\"; String c = new String(\"Hello World!\"); String d = \"Hello\"+\" \"+\"World!\";System.out.println(a == b);//trueSystem.out.println(a == c);//falseSystem.out.println(a == d);//true æˆ‘ä»¬åº”è¯¥æ˜ç™½ï¼š é¦–å…ˆStringä¸å±äº8ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼ŒStringæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ å› ä¸ºå¯¹è±¡çš„é»˜è®¤å€¼æ˜¯nullï¼Œæ‰€ä»¥ String çš„é»˜è®¤å€¼ä¹Ÿæ˜¯nullï¼›ä½†å®ƒåˆæ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ï¼Œæœ‰å…¶å®ƒå¯¹è±¡æ²¡æœ‰çš„ä¸€äº›ç‰¹æ€§ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆä¸è°ˆå †ï¼Œä¹Ÿä¸è°ˆæ ˆï¼Œåªå…ˆç®€å•å¼•å…¥å¸¸é‡æ± è¿™ä¸ªç®€å•çš„æ¦‚å¿µã€‚ å¸¸é‡æ± (constant pool)æŒ‡çš„æ˜¯åœ¨ç¼–è¯‘æœŸè¢«ç¡®å®šï¼Œå¹¶è¢«ä¿å­˜åœ¨å·²ç¼–è¯‘çš„.classæ–‡ä»¶ä¸­çš„ä¸€äº›æ•°æ®ã€‚å®ƒåŒ…æ‹¬äº†å…³äºç±»ã€æ–¹æ³•ã€æ¥å£ç­‰ä¸­çš„å¸¸é‡ï¼Œä¹ŸåŒ…æ‹¬å­—ç¬¦ä¸²å¸¸é‡ã€‚ Javaä¼šç¡®ä¿ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡åªæœ‰ä¸€ä¸ªæ‹·è´ã€‚ å› ä¸ºä¾‹å­ä¸­çš„aå’Œbéƒ½æ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼Œå®ƒä»¬åœ¨ç¼–è¯‘æœŸå°±è¢«ç¡®å®šäº†ï¼Œæ‰€ä»¥a==bä¸ºtrueï¼›è€Œ&quot;Hello&quot;å’Œ&quot; &quot;ä»¥åŠ&quot;World!&quot;ä¹Ÿéƒ½æ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼Œå½“ä¸€ä¸ªå­—ç¬¦ä¸²ç”±å¤šä¸ªå­—ç¬¦ä¸²å¸¸é‡è¿æ¥è€Œæˆæ—¶ï¼Œå®ƒè‡ªå·±è‚¯å®šä¹Ÿæ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼Œæ‰€ä»¥dä¹ŸåŒæ ·åœ¨ç¼–è¯‘æœŸå°±è¢«è§£æä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œæ‰€ä»¥dä¹Ÿæ˜¯å¸¸é‡æ± ä¸­&quot;Hello World!&quot;çš„ä¸€ä¸ªå¼•ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—å‡ºa==b==d ç”¨new String()åˆ›å»ºçš„å­—ç¬¦ä¸²ä¸æ˜¯å¸¸é‡,ä¸èƒ½åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šï¼Œæ‰€ä»¥new String()åˆ›å»ºçš„å­—ç¬¦ä¸²ä¸æ”¾å…¥å¸¸é‡æ± ä¸­ï¼Œå®ƒä»¬æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ ğŸŒ°2: 123456String a = \"HelloWorld\"; String b = new String(\"HelloWorld\"); String c = \"Hello\"+ new String(\"World\"); System.out.println( a == b );//falseSystem.out.println( a == c );//falseSystem.out.println( b == c );//false aè¿˜æ˜¯å¸¸é‡æ± ä¸­â€HelloWorldâ€çš„å¼•ç”¨ï¼Œbå› ä¸ºæ— æ³•åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œæ‰€ä»¥æ˜¯è¿è¡Œæ—¶åˆ›å»ºçš„æ–°å¯¹è±¡â€HelloWorldâ€çš„å¼•ç”¨ï¼Œcå› ä¸ºæœ‰ååŠéƒ¨åˆ†new String(â€œWorldâ€)æ‰€ä»¥ä¹Ÿæ— æ³•åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ä¸€ä¸ªæ–°åˆ›å»ºå¯¹è±¡â€HelloWorldâ€çš„å¼•ç”¨ï¼Œæ˜ç™½äº†è¿™äº›ä¹Ÿå°±çŸ¥é“ä¸ºä½•å¾—å‡ºæ­¤ç»“æœäº†ã€‚ 12String.intern()ï¼šå†è¡¥å……ä»‹ç»ä¸€ç‚¹ï¼šå­˜åœ¨äº.classæ–‡ä»¶ä¸­çš„å¸¸é‡æ± ï¼Œåœ¨è¿è¡ŒæœŸè¢«JVMè£…è½½ï¼Œå¹¶ä¸”å¯ä»¥æ‰©å……ã€‚Stringçš„intern()æ–¹æ³•å°±æ˜¯æ‰©å……å¸¸é‡æ± çš„ä¸€ä¸ªæ–¹æ³•ï¼›å½“ä¸€ä¸ªStringå®ä¾‹strè°ƒç”¨intern()æ–¹æ³•æ—¶ï¼ŒJavaæŸ¥æ‰¾å¸¸é‡æ± ä¸­æ˜¯å¦æœ‰ç›¸åŒUnicodeçš„å­—ç¬¦ä¸²å¸¸é‡ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¿”å›å…¶çš„å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™åœ¨å¸¸é‡æ± ä¸­å¢åŠ ä¸€ä¸ªUnicodeç­‰äºstrçš„å­—ç¬¦ä¸²å¹¶è¿”å›å®ƒçš„å¼•ç”¨ï¼Œçœ‹ä¾‹3å°±æ¸…æ¥šäº†ã€‚ ğŸŒ°3: 12345678910String a = \"Hello\"; String b = new String(\"Hello\"); String c = new String(\"Hello\"); System.out.println( a == b );//falseSystem.out.println( â€œ**********â€ ); b.intern(); c = c.intern(); //æŠŠå¸¸é‡æ± ä¸­\"Hello\"çš„å¼•ç”¨èµ‹ç»™c System.out.println( a == b);//falseè™½ç„¶æ‰§è¡Œäº†b.intern()ä½†æ²¡æœ‰èµ‹å€¼ç»™bSystem.out.println( a == b.intern() );//true System.out.println( a == c ); //true ğŸŒ°4: å…³äºequals()å’Œ==:equals() æ˜¯æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè¿™ä¸ªå¯¹äº String ç®€å•æ¥è¯´å°±æ˜¯æ¯”è¾ƒä¸¤å­—ç¬¦ä¸²çš„ Unicode åºåˆ—æ˜¯å¦ç›¸å½“ï¼Œå¦‚æœç›¸ç­‰è¿”å› true;è€Œ == æ˜¯æ¯”è¾ƒä¸¤å­—ç¬¦ä¸²çš„åœ°å€æ˜¯å¦ç›¸åŒï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦æ˜¯åŒä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼•ç”¨ã€‚ ğŸŒ°5: Stringæ˜¯ä¸å¯å˜çš„:è¿™ä¸€è¯´åˆè¦è¯´å¾ˆå¤šï¼Œå¤§å®¶åªè¦çŸ¥é“Stringçš„å®ä¾‹ä¸€æ—¦ç”Ÿæˆå°±ä¸ä¼šå†æ”¹å˜äº†ï¼Œæ¯”å¦‚è¯´ï¼š 1String str = â€aaâ€+â€bbâ€+â€ â€œ+â€ccâ€; å°±æ˜¯æœ‰4ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œé¦–å…ˆâ€aaâ€å’Œâ€bbâ€ç”Ÿæˆäº†â€aabbâ€å­˜åœ¨å†…å­˜ä¸­ï¼Œåâ€aabbâ€åˆå’Œâ€ â€œ ç”Ÿæˆ â€aabb â€œå­˜åœ¨å†…å­˜ä¸­ï¼Œæœ€ååˆå’Œç”Ÿæˆäº†â€aabb ccâ€ï¼Œå¹¶æŠŠè¿™ä¸ªå­—ç¬¦ä¸²çš„åœ°å€èµ‹ç»™äº†str,å°±æ˜¯å› ä¸ºStringçš„â€œä¸å¯å˜â€äº§ç”Ÿäº†å¾ˆå¤šä¸´æ—¶å˜é‡ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå»ºè®®ç”¨StringBufferçš„åŸå› äº†ã€‚ æ¥ä¸€ä¸ªåå°„æ”¹å˜Stringçš„ğŸŒ°12345678910111213141516171819 1 public static void stringReflection() throws Exception &#123; 2 3 String s = \"Hello World\"; 4 5 System.out.println(\"s = \" + s); //Hello World 6 7 //è·å–Stringç±»ä¸­çš„valueå­—æ®µ 8 Field valueField = String.class.getDeclaredField(\"value\"); 9 10 //æ”¹å˜valueå±æ€§çš„è®¿é—®æƒé™11 valueField.setAccessible(true);12 13 char[] value = (char[]) valueField.get(s);14 15 //æ”¹å˜valueæ‰€å¼•ç”¨çš„æ•°ç»„ä¸­çš„ç¬¬5ä¸ªå­—ç¬¦16 value[5] = '_';17 18 System.out.println(\"s = \" + s); //Hello_World19 &#125; ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/å†è®°String.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Java ç±»å‹è½¬æ¢","slug":"Javaç±»å‹è½¬æ¢","date":"2017-08-20T12:28:23.000Z","updated":"2018-08-24T07:42:07.654Z","comments":true,"path":"Javaç±»å‹è½¬æ¢.html","link":"","permalink":"http://xiaoqinghua.site/Javaç±»å‹è½¬æ¢.html","excerpt":"","text":"ç±»å‹è½¬æ¢Java è¯­è¨€æ˜¯ä¸€ç§å¼ºç±»å‹çš„è¯­è¨€ã€‚å¼ºç±»å‹çš„è¯­è¨€æœ‰ä»¥ä¸‹å‡ ä¸ªè¦æ±‚ï¼š å˜é‡æˆ–å¸¸é‡å¿…é¡»æœ‰ç±»å‹:è¦æ±‚å£°æ˜å˜é‡æˆ–å¸¸é‡æ—¶å¿…é¡»å£°æ˜ç±»å‹ï¼Œè€Œä¸”åªèƒ½åœ¨å£°æ˜ä»¥åæ‰èƒ½ä½¿ç”¨ã€‚ èµ‹å€¼æ—¶ç±»å‹å¿…é¡»ä¸€è‡´:å€¼çš„ç±»å‹å¿…é¡»å’Œå˜é‡æˆ–å¸¸é‡çš„ç±»å‹å®Œå…¨ä¸€è‡´ã€‚ è¿ç®—æ—¶ç±»å‹å¿…é¡»ä¸€è‡´:å‚ä¸è¿ç®—çš„æ•°æ®ç±»å‹å¿…é¡»ä¸€è‡´æ‰èƒ½è¿ç®—ã€‚ ä½†æ˜¯åœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œç»å¸¸éœ€è¦åœ¨ä¸åŒç±»å‹çš„å€¼ä¹‹é—´è¿›è¡Œæ“ä½œï¼Œè¿™å°±éœ€è¦ä¸€ç§æ–°çš„è¯­æ³•æ¥é€‚åº”è¿™ç§éœ€è¦ï¼Œè¿™ä¸ªè¯­æ³•å°±æ˜¯æ•°æ®ç±»å‹è½¬æ¢ã€‚ åœ¨æ•°å€¼å¤„ç†è¿™éƒ¨åˆ†ï¼Œè®¡ç®—æœºå’Œç°å®çš„é€»è¾‘ä¸å¤ªä¸€æ ·ï¼Œå¯¹äºç°å®æ¥è¯´ï¼Œ1å’Œ 1.0 æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä½†æ˜¯å¯¹äºè®¡ç®—æœºæ¥è¯´ï¼Œ1 æ˜¯æ•´æ•°ç±»å‹ï¼Œè€Œ 1.0 æ˜¯å°æ•°ç±»å‹ï¼Œå…¶åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼ä»¥åŠå ç”¨çš„ç©ºé—´éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ç±»å‹è½¬æ¢åœ¨è®¡ç®—æœºå†…éƒ¨æ˜¯å¿…é¡»çš„ã€‚ Java è¯­è¨€ä¸­çš„æ•°æ®ç±»å‹è½¬æ¢æœ‰ä¸¤ç§ï¼š è‡ªåŠ¨ç±»å‹è½¬æ¢:ç¼–è¯‘å™¨è‡ªåŠ¨å®Œæˆç±»å‹è½¬æ¢ï¼Œä¸éœ€è¦åœ¨ç¨‹åºä¸­ç¼–å†™ä»£ç ã€‚ å¼ºåˆ¶ç±»å‹è½¬æ¢:å¼ºåˆ¶ç¼–è¯‘å™¨è¿›è¡Œç±»å‹è½¬æ¢ï¼Œå¿…é¡»åœ¨ç¨‹åºä¸­ç¼–å†™ä»£ç ã€‚ ç”±äºåŸºæœ¬æ•°æ®ç±»å‹ä¸­ boolean ç±»å‹ä¸æ˜¯æ•°å­—å‹ï¼Œæ‰€ä»¥åŸºæœ¬æ•°æ®ç±»å‹çš„è½¬æ¢æ˜¯å‡ºäº† boolean ç±»å‹ä»¥å¤–çš„å…¶å®ƒ 7 ç§ç±»å‹ä¹‹é—´çš„è½¬æ¢ã€‚ä¸‹é¢æ¥å…·ä½“ä»‹ç»ä¸¤ç§ç±»å‹è½¬æ¢çš„è§„åˆ™ã€é€‚ç”¨åœºåˆä»¥åŠä½¿ç”¨æ—¶éœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚ è‡ªåŠ¨ç±»å‹è½¬æ¢è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼Œä¹Ÿç§°éšå¼ç±»å‹è½¬æ¢ï¼Œæ˜¯æŒ‡ä¸éœ€è¦ä¹¦å†™ä»£ç ï¼Œç”±ç³»ç»Ÿè‡ªåŠ¨å®Œæˆçš„ç±»å‹è½¬æ¢ã€‚ç”±äºå®é™…å¼€å‘ä¸­è¿™æ ·çš„ç±»å‹è½¬æ¢å¾ˆå¤šï¼Œæ‰€ä»¥ Java è¯­è¨€åœ¨è®¾è®¡æ—¶ï¼Œæ²¡æœ‰ä¸ºè¯¥æ“ä½œè®¾è®¡è¯­æ³•ï¼Œè€Œæ˜¯ç”± JVM è‡ªåŠ¨å®Œæˆã€‚ è½¬æ¢è§„åˆ™ï¼šä»å­˜å‚¨èŒƒå›´å°çš„ç±»å‹åˆ°å­˜å‚¨èŒƒå›´å¤§çš„ç±»å‹ã€‚å…·ä½“è§„åˆ™ä¸ºï¼šbyteâ†’short(char)â†’intâ†’longâ†’floatâ†’double ä¹Ÿå°±æ˜¯è¯´ byte ç±»å‹çš„å˜é‡å¯ä»¥è‡ªåŠ¨è½¬æ¢ä¸º short ç±»å‹ï¼Œç¤ºä¾‹ä»£ç ï¼š 12byte b = 10;short sh = b;è¿™é‡Œåœ¨èµ‹å€¼æ—¶ï¼ŒJVM é¦–å…ˆå°† b çš„å€¼è½¬æ¢ä¸º short ç±»å‹ï¼Œç„¶åå†èµ‹å€¼ç»™ shã€‚ åœ¨ç±»å‹è½¬æ¢æ—¶å¯ä»¥è·³è·ƒã€‚ç¤ºä¾‹ä»£ç ï¼š 12byte b1 = 100;int n = b1; æ³¨æ„é—®é¢˜:åœ¨æ•´æ•°ä¹‹é—´è¿›è¡Œç±»å‹è½¬æ¢æ—¶ï¼Œæ•°å€¼ä¸å‘ç”Ÿæ”¹å˜ï¼Œè€Œå°†æ•´æ•°ç±»å‹ï¼Œç‰¹åˆ«æ˜¯æ¯”è¾ƒå¤§çš„æ•´æ•°ç±»å‹è½¬æ¢æˆå°æ•°ç±»å‹æ—¶ï¼Œç”±äºå­˜å‚¨æ–¹å¼ä¸åŒï¼Œæœ‰å¯èƒ½å­˜åœ¨æ•°æ®ç²¾åº¦çš„æŸå¤±ã€‚ å¼ºåˆ¶ç±»å‹è½¬æ¢å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä¹Ÿç§°æ˜¾å¼ç±»å‹è½¬æ¢ï¼Œæ˜¯æŒ‡å¿…é¡»ä¹¦å†™ä»£ç æ‰èƒ½å®Œæˆçš„ç±»å‹è½¬æ¢ã€‚è¯¥ç±»ç±»å‹è½¬æ¢å¾ˆå¯èƒ½å­˜åœ¨ç²¾åº¦çš„æŸå¤±ï¼Œæ‰€ä»¥å¿…é¡»ä¹¦å†™ç›¸åº”çš„ä»£ç ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¿å—è¯¥ç§æŸå¤±æ—¶æ‰è¿›è¡Œè¯¥ç±»å‹çš„è½¬æ¢ã€‚ è½¬æ¢è§„åˆ™:ä»å­˜å‚¨èŒƒå›´å¤§çš„ç±»å‹åˆ°å­˜å‚¨èŒƒå›´å°çš„ç±»å‹ã€‚ å…·ä½“è§„åˆ™ä¸ºï¼šdoubleâ†’floatâ†’longâ†’intâ†’short(char)â†’byte è¯­æ³•æ ¼å¼ä¸ºï¼š(è½¬æ¢åˆ°çš„ç±»å‹)éœ€è¦è½¬æ¢çš„å€¼ ç¤ºä¾‹ä»£ç ï¼š 12double d = 3.10;int n = (int)d; è¿™é‡Œå°† double ç±»å‹çš„å˜é‡ d å¼ºåˆ¶è½¬æ¢æˆ int ç±»å‹ï¼Œç„¶åèµ‹å€¼ç»™å˜é‡ nã€‚éœ€è¦è¯´æ˜çš„æ˜¯å°æ•°å¼ºåˆ¶è½¬æ¢ä¸ºæ•´æ•°ï¼Œé‡‡ç”¨çš„æ˜¯å» 1 æ³•ï¼Œä¹Ÿå°±æ˜¯æ— æ¡ä»¶çš„èˆå¼ƒå°æ•°ç‚¹çš„æ‰€æœ‰æ•°å­—ï¼Œåˆ™ä»¥ä¸Šè½¬æ¢å‡ºçš„ç»“æœæ˜¯ 3ã€‚æ•´æ•°å¼ºåˆ¶è½¬æ¢ä¸ºæ•´æ•°æ—¶å–æ•°å­—çš„ä½ä½ï¼Œä¾‹å¦‚ int ç±»å‹çš„å˜é‡è½¬æ¢ä¸º byte ç±»å‹æ—¶ï¼Œåˆ™åªå» int ç±»å‹çš„ä½ 8 ä½(ä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªå­—èŠ‚)çš„å€¼ã€‚ç¤ºä¾‹ä»£ç ï¼š 1234int n = 123;byte b = (byte)n;int m = 1234;byte b1 = (byte)m; åˆ™ b çš„å€¼è¿˜æ˜¯ 123ï¼Œè€Œ b1 çš„å€¼ä¸º-46ã€‚b1 çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼šm çš„å€¼è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ˜¯10011010010ï¼Œå–è¯¥æ•°å­—ä½8ä½çš„å€¼ä½œä¸ºb1çš„å€¼ï¼Œåˆ™b1çš„äºŒè¿›åˆ¶å€¼æ˜¯11010010ï¼ŒæŒ‰ç…§æœºå™¨æ•°çš„è§„å®šï¼Œæœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œ1ä»£è¡¨è´Ÿæ•°ï¼Œåœ¨è®¡ç®—æœºä¸­è´Ÿæ•°å­˜å‚¨çš„æ˜¯è¡¥ç ï¼Œåˆ™è¯¥è´Ÿæ•°çš„åŸç æ˜¯ 10101110ï¼Œè¯¥å€¼å°±æ˜¯åè¿›åˆ¶çš„-46ã€‚æ³¨æ„é—®é¢˜:å¼ºåˆ¶ç±»å‹è½¬æ¢é€šå¸¸éƒ½ä¼šå­˜å‚¨ç²¾åº¦çš„æŸå¤±ï¼Œæ‰€ä»¥ä½¿ç”¨æ—¶éœ€è¦è°¨æ…ã€‚","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"Java æ•°æ®ç±»å‹","slug":"JavaåŸºæœ¬æ•°æ®ç±»å‹","date":"2017-08-19T03:58:52.000Z","updated":"2018-08-25T06:50:28.811Z","comments":true,"path":"JavaåŸºæœ¬æ•°æ®ç±»å‹.html","link":"","permalink":"http://xiaoqinghua.site/JavaåŸºæœ¬æ•°æ®ç±»å‹.html","excerpt":"","text":"åŸºæœ¬ç±»å‹ï¼Œæˆ–è€…å«åšå†…ç½®ç±»å‹ï¼Œæ˜¯JAVAä¸­ä¸åŒäºç±»çš„ç‰¹æ®Šç±»å‹ã€‚å®ƒä»¬æ˜¯æˆ‘ä»¬ç¼–ç¨‹ä¸­ä½¿ç”¨æœ€é¢‘ç¹çš„ç±»å‹ã€‚javaæ˜¯ä¸€ç§å¼ºç±»å‹è¯­è¨€ï¼Œç¬¬ä¸€æ¬¡ç”³æ˜å˜é‡å¿…é¡»è¯´æ˜æ•°æ®ç±»å‹ï¼ˆJava 9 ä¹‹åçš„ varç±»å‹æ¨æ–­ï¼Œäº†è§£ä¸€ä¸‹ï¼‰ï¼Œç¬¬ä¸€æ¬¡å˜é‡èµ‹å€¼ç§°ä¸ºå˜é‡çš„åˆå§‹åŒ–ã€‚ 1. Javaçš„ç®€å•ç±»å‹åŠå…¶å°è£…å™¨ç±»JavaåŸºæœ¬ç±»å‹å…±æœ‰å…«ç§ï¼ŒåŸºæœ¬ç±»å‹å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼Œå­—ç¬¦ç±»å‹charï¼Œå¸ƒå°”ç±»å‹booleanä»¥åŠæ•°å€¼ç±»å‹byteã€shortã€intã€longã€floatã€doubleã€‚æ•°å€¼ç±»å‹åˆå¯ä»¥åˆ†ä¸ºæ•´æ•°ç±»å‹byteã€shortã€intã€longå’Œæµ®ç‚¹æ•°ç±»å‹floatã€doubleã€‚JAVAä¸­çš„æ•°å€¼ç±»å‹ä¸å­˜åœ¨æ— ç¬¦å·çš„ï¼Œå®ƒä»¬çš„å–å€¼èŒƒå›´æ˜¯å›ºå®šçš„ï¼Œä¸ä¼šéšç€æœºå™¨ç¡¬ä»¶ç¯å¢ƒæˆ–è€…æ“ä½œç³»ç»Ÿçš„æ”¹å˜è€Œæ”¹å˜ã€‚å®é™…ä¸Šï¼ŒJAVAä¸­è¿˜å­˜åœ¨å¦å¤–ä¸€ç§åŸºæœ¬ç±»å‹voidï¼Œå®ƒä¹Ÿæœ‰å¯¹åº”çš„åŒ…è£…ç±» java.lang.Voidï¼Œä¸è¿‡æˆ‘ä»¬æ— æ³•ç›´æ¥å¯¹å®ƒä»¬è¿›è¡Œæ“ä½œã€‚8 ä¸­ç±»å‹è¡¨ç¤ºèŒƒå›´å¦‚ä¸‹ï¼š 123456789101112131415byteï¼š8ä½ï¼Œæœ€å¤§å­˜å‚¨æ•°æ®é‡æ˜¯255ï¼Œå­˜æ”¾çš„æ•°æ®èŒƒå›´æ˜¯-128~127ä¹‹é—´ã€‚charï¼š16ä½ï¼Œå­˜å‚¨Unicodeç ï¼Œç”¨å•å¼•å·èµ‹å€¼ã€‚shortï¼š16ä½ï¼Œæœ€å¤§æ•°æ®å­˜å‚¨é‡æ˜¯65536ï¼Œæ•°æ®èŒƒå›´æ˜¯-32768~32767ä¹‹é—´ã€‚intï¼š32ä½ï¼Œæœ€å¤§æ•°æ®å­˜å‚¨å®¹é‡æ˜¯2çš„32æ¬¡æ–¹å‡1ï¼Œæ•°æ®èŒƒå›´æ˜¯è´Ÿçš„2çš„31æ¬¡æ–¹åˆ°æ­£çš„2çš„31æ¬¡æ–¹å‡1ã€‚longï¼š64ä½ï¼Œæœ€å¤§æ•°æ®å­˜å‚¨å®¹é‡æ˜¯2çš„64æ¬¡æ–¹å‡1ï¼Œæ•°æ®èŒƒå›´ä¸ºè´Ÿçš„2çš„63æ¬¡æ–¹åˆ°æ­£çš„2çš„63æ¬¡æ–¹å‡1ã€‚floatï¼š32ä½ï¼Œæ•°æ®èŒƒå›´åœ¨3.4e-45~1.4e38ï¼Œç›´æ¥èµ‹å€¼æ—¶å¿…é¡»åœ¨æ•°å­—ååŠ ä¸Šfæˆ–Fã€‚doubleï¼š64ä½ï¼Œæ•°æ®èŒƒå›´åœ¨4.9e-324~1.8e308ï¼Œèµ‹å€¼æ—¶å¯ä»¥åŠ dæˆ–Dä¹Ÿå¯ä»¥ä¸åŠ ã€‚booleanï¼šåªæœ‰trueå’Œfalseä¸¤ä¸ªå–å€¼ã€‚ å¯¹äºæ•°å€¼ç±»å‹çš„åŸºæœ¬ç±»å‹çš„å–å€¼èŒƒå›´ï¼Œæˆ‘ä»¬æ— éœ€å¼ºåˆ¶å»è®°å¿†ï¼Œå› ä¸ºå®ƒä»¬çš„å€¼éƒ½å·²ç»ä»¥å¸¸é‡çš„å½¢å¼å®šä¹‰åœ¨å¯¹åº”çš„åŒ…è£…ç±»ä¸­äº†ã€‚å¦‚ï¼š 12345678910111213141516171819åŸºæœ¬ç±»å‹byte äºŒè¿›åˆ¶ä½æ•°ï¼šByte.SIZEæœ€å°å€¼ï¼šByte.MIN_VALUEæœ€å¤§å€¼ï¼šByte.MAX_VALUEåŸºæœ¬ç±»å‹shortäºŒè¿›åˆ¶ä½æ•°ï¼šShort.SIZEæœ€å°å€¼ï¼šShort.MIN_VALUEæœ€å¤§å€¼ï¼šShort.MAX_VALUEåŸºæœ¬ç±»å‹charäºŒè¿›åˆ¶ä½æ•°ï¼šCharacter.SIZEæœ€å°å€¼ï¼šCharacter.MIN_VALUEæœ€å¤§å€¼ï¼šCharacter.MAX_VALUEåŸºæœ¬ç±»å‹double äºŒè¿›åˆ¶ä½æ•°ï¼šDouble.SIZEæœ€å°å€¼ï¼šDouble.MIN_VALUEæœ€å¤§å€¼ï¼šDouble.MAX_VALUE æ³¨æ„ï¼šfloatã€double ä¸¤ç§ç±»å‹çš„æœ€å°å€¼ä¸ Float.MIN_VALUEã€ Double.MIN_VALUE çš„å€¼å¹¶ä¸ç›¸åŒï¼Œå®é™…ä¸Š Float.MIN_VALUE å’Œ Double.MIN_VALUE åˆ†åˆ«æŒ‡çš„æ˜¯ float å’Œ double ç±»å‹æ‰€èƒ½è¡¨ç¤ºçš„æœ€å°æ­£æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´å­˜åœ¨è¿™æ ·ä¸€ç§æƒ…å†µï¼Œ0 åˆ° Â±Float.MIN_VALUE ä¹‹é—´çš„å€¼ float ç±»å‹æ— æ³•è¡¨ç¤ºï¼Œ0 åˆ° Â±Double.MIN_VALUE ä¹‹é—´çš„å€¼ double ç±»å‹æ— æ³•è¡¨ç¤ºã€‚è¿™å¹¶æ²¡æœ‰ä»€ä¹ˆå¥½å¥‡æ€ªçš„ï¼Œå› ä¸ºè¿™äº›èŒƒå›´å†…çš„æ•°å€¼è¶…å‡ºäº†å®ƒä»¬çš„ç²¾åº¦èŒƒå›´ã€‚ Floatå’ŒDoubleçš„æœ€å°å€¼å’Œæœ€å¤§å€¼éƒ½æ˜¯ä»¥ç§‘å­¦è®°æ•°æ³•çš„å½¢å¼è¾“å‡ºçš„ï¼Œç»“å°¾çš„â€E+æ•°å­—â€è¡¨ç¤ºEä¹‹å‰çš„æ•°å­—è¦ä¹˜ä»¥10çš„å¤šå°‘å€ã€‚æ¯”å¦‚3.14E3å°±æ˜¯3.14Ã—1000=3140ï¼Œ3.14E-3å°±æ˜¯3.14/1000=0.00314ã€‚ JavaåŸºæœ¬ç±»å‹å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå› æ­¤å®ƒä»¬çš„å­˜å–é€Ÿåº¦è¦å¿«äºå­˜å‚¨åœ¨å †ä¸­çš„å¯¹åº”åŒ…è£…ç±»çš„å®ä¾‹å¯¹è±¡ã€‚ä»Java5.0ï¼ˆ1.5ï¼‰å¼€å§‹ï¼ŒJAVAè™šæ‹Ÿæœºï¼ˆJava Virtual Machineï¼‰å¯ä»¥å®ŒæˆåŸºæœ¬ç±»å‹å’Œå®ƒä»¬å¯¹åº”åŒ…è£…ç±»ä¹‹é—´çš„è‡ªåŠ¨è½¬æ¢ã€‚å› æ­¤æˆ‘ä»¬åœ¨èµ‹å€¼ã€å‚æ•°ä¼ é€’ä»¥åŠæ•°å­¦è¿ç®—çš„æ—¶å€™åƒä½¿ç”¨åŸºæœ¬ç±»å‹ä¸€æ ·ä½¿ç”¨å®ƒä»¬çš„åŒ…è£…ç±»ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ä½ å¯ä»¥é€šè¿‡åŸºæœ¬ç±»å‹è°ƒç”¨å®ƒä»¬çš„åŒ…è£…ç±»æ‰å…·æœ‰çš„æ–¹æ³•ã€‚å¦å¤–ï¼Œæ‰€æœ‰åŸºæœ¬ç±»å‹ï¼ˆåŒ…æ‹¬voidï¼‰çš„åŒ…è£…ç±»éƒ½ä½¿ç”¨äº†finalä¿®é¥°ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ç»§æ‰¿å®ƒä»¬æ‰©å±•æ–°çš„ç±»ï¼Œä¹Ÿæ— æ³•é‡å†™å®ƒä»¬çš„ä»»ä½•æ–¹æ³•ã€‚ åŸºæœ¬ç±»å‹çš„ä¼˜åŠ¿ï¼šæ•°æ®å­˜å‚¨ç›¸å¯¹ç®€å•ï¼Œè¿ç®—æ•ˆç‡æ¯”è¾ƒé«˜åŒ…è£…ç±»çš„ä¼˜åŠ¿ï¼šæœ‰çš„å®¹æ˜“ï¼Œæ¯”å¦‚é›†åˆçš„å…ƒç´ å¿…é¡»æ˜¯å¯¹è±¡ç±»å‹ï¼Œæ»¡è¶³äº†javaä¸€åˆ‡çš†æ˜¯å¯¹è±¡çš„æ€æƒ³ 2.Javaä¸­çš„å¸¸é‡åå…­è¿›åˆ¶æ•´å‹å¸¸é‡ï¼šä»¥åå…­è¿›åˆ¶è¡¨ç¤ºæ—¶ï¼Œéœ€ä»¥0xæˆ–0Xå¼€å¤´ï¼Œå¦‚0xff,0X9Aã€‚ å…«è¿›åˆ¶æ•´å‹å¸¸é‡ï¼šå…«è¿›åˆ¶å¿…é¡»ä»¥0å¼€å¤´ï¼Œå¦‚0123ï¼Œ034ã€‚ é•¿æ•´å‹ï¼šé•¿æ•´å‹å¿…é¡»ä»¥Lä½œç»“å°¾ï¼Œå¦‚9L,342Lã€‚ æµ®ç‚¹æ•°å¸¸é‡ï¼šç”±äºå°æ•°å¸¸é‡çš„é»˜è®¤ç±»å‹æ˜¯doubleå‹ï¼Œæ‰€ä»¥floatç±»å‹çš„åé¢ä¸€å®šè¦åŠ f(F)ã€‚åŒæ ·å¸¦å°æ•°çš„å˜é‡é»˜è®¤ä¸ºdoubleç±»å‹ã€‚ å¦‚ï¼šfloat f; 12//å¿…é¡»å£°æ˜ff = 1.3f; å­—ç¬¦å¸¸é‡ï¼šå­—ç¬¦å‹å¸¸é‡éœ€ç”¨ä¸¤ä¸ªå•å¼•å·æ‹¬èµ·æ¥ï¼ˆæ³¨æ„å­—ç¬¦ä¸²å¸¸é‡æ˜¯ç”¨ä¸¤ä¸ªåŒå¼•å·æ‹¬èµ·æ¥ï¼‰ã€‚Javaä¸­çš„å­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚(å› ä¸ºå­—ç¬¦æ˜¯charï¼Œä¸€ä¸ª\b char å ä¸¤ä¸ªå­—èŠ‚ï¼Œ16ä½)ã€‚ä¸€äº›å¸¸ç”¨çš„è½¬ä¹‰å­—ç¬¦ï¼š 12345678910111213\\rè¡¨ç¤ºæ¥å—é”®ç›˜è¾“å…¥ï¼Œç›¸å½“äºæŒ‰ä¸‹äº†å›è½¦é”®ï¼›\\nè¡¨ç¤ºæ¢è¡Œï¼›\\tè¡¨ç¤ºåˆ¶è¡¨ç¬¦ï¼Œç›¸å½“äºTableé”®ï¼›\\bè¡¨ç¤ºé€€æ ¼é”®ï¼Œç›¸å½“äºBack Spaceé”®ï¼›\\&apos;è¡¨ç¤ºå•å¼•å·ï¼›\\&apos;&apos;è¡¨ç¤ºåŒå¼•å·ï¼›\\\\è¡¨ç¤ºä¸€ä¸ªæ–œæ \\ã€‚ 3. æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢1ã€ç®€å•ç±»å‹æ•°æ®é—´çš„è½¬æ¢,æœ‰ä¸¤ç§æ–¹å¼:è‡ªåŠ¨è½¬æ¢å’Œå¼ºåˆ¶è½¬æ¢,é€šå¸¸å‘ç”Ÿåœ¨è¡¨è¾¾å¼ä¸­æˆ–æ–¹æ³•çš„å‚æ•°ä¼ é€’æ—¶ã€‚ è‡ªåŠ¨è½¬æ¢: å…·ä½“åœ°è®²,å½“ä¸€ä¸ªè¾ƒâ€å°â€æ•°æ®ä¸ä¸€ä¸ªè¾ƒâ€å¤§â€çš„æ•°æ®ä¸€èµ·è¿ç®—æ—¶,ç³»ç»Ÿå°†è‡ªåŠ¨å°†â€å°â€æ•°æ®è½¬æ¢æˆâ€å¤§â€æ•°æ®,å†è¿›è¡Œè¿ç®—ã€‚è€Œåœ¨æ–¹æ³•è°ƒç”¨æ—¶,å®é™…å‚æ•°è¾ƒâ€å°â€,è€Œè¢«è°ƒç”¨çš„æ–¹æ³•çš„å½¢å¼å‚æ•°æ•°æ®åˆè¾ƒâ€å¤§â€æ—¶(è‹¥æœ‰åŒ¹é…çš„,å½“ç„¶ä¼šç›´æ¥è°ƒç”¨åŒ¹é…çš„æ–¹æ³•),ç³»ç»Ÿä¹Ÿå°†è‡ªåŠ¨å°†â€å°â€æ•°æ®è½¬æ¢æˆâ€å¤§â€æ•°æ®,å†è¿›è¡Œæ–¹æ³•çš„è°ƒç”¨,è‡ªç„¶,å¯¹äºå¤šä¸ªåŒåçš„é‡è½½æ–¹æ³•,ä¼šè½¬æ¢æˆæœ€â€æ¥è¿‘â€çš„â€å¤§â€æ•°æ®å¹¶è¿›è¡Œè°ƒç”¨ã€‚è¿™äº›ç±»å‹ç”±â€å°â€åˆ°â€å¤§â€åˆ†åˆ«ä¸º (byteï¼Œshortï¼Œchar)--int--long--floatâ€”doubleã€‚è¿™é‡Œæˆ‘ä»¬æ‰€è¯´çš„â€å¤§â€ä¸â€å°â€,å¹¶ä¸æ˜¯æŒ‡å ç”¨å­—èŠ‚çš„å¤šå°‘,è€Œæ˜¯æŒ‡è¡¨ç¤ºå€¼çš„èŒƒå›´çš„å¤§å°ã€‚ 12345678910111213â‘ ä¸‹é¢çš„è¯­å¥å¯ä»¥åœ¨Javaä¸­ç›´æ¥é€šè¿‡ï¼šbyte b;int i=b; long l=b; float f=b; double d=b;â‘¡å¦‚æœä½çº§ç±»å‹ä¸ºcharå‹ï¼Œå‘é«˜çº§ç±»å‹ï¼ˆæ•´å‹ï¼‰è½¬æ¢æ—¶ï¼Œä¼šè½¬æ¢ä¸ºå¯¹åº”ASCIIç å€¼ï¼Œä¾‹å¦‚char c=&apos;c&apos;; int i=c;System.out.println(&quot;output:&quot;+i);è¾“å‡ºï¼šoutput:99;â‘¢å¯¹äºbyte,short,charä¸‰ç§ç±»å‹è€Œè¨€ï¼Œä»–ä»¬æ˜¯å¹³çº§çš„ï¼Œå› æ­¤ä¸èƒ½ç›¸äº’è‡ªåŠ¨è½¬æ¢ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹è¿°çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚short i=99 ; char c=(char)i; System.out.println(&quot;output:&quot;+c);è¾“å‡ºï¼šoutput:c; å¼ºåˆ¶è½¬æ¢: å°†â€å¤§â€æ•°æ®è½¬æ¢ä¸ºâ€å°â€æ•°æ®æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚å³ä½ å¿…é¡»é‡‡ç”¨ä¸‹é¢è¿™ç§è¯­å¥æ ¼å¼ï¼š int n=(int)3.14159/2;å¯ä»¥æƒ³è±¡ï¼Œè¿™ç§è½¬æ¢è‚¯å®šå¯èƒ½ä¼šå¯¼è‡´æº¢å‡ºæˆ–ç²¾åº¦çš„ä¸‹é™ã€‚ 2ã€è¡¨è¾¾å¼çš„æ•°æ®ç±»å‹è‡ªåŠ¨æå‡, å…³äºç±»å‹çš„è‡ªåŠ¨æå‡ï¼Œæ³¨æ„ä¸‹é¢çš„è§„åˆ™ã€‚ 1234567â‘ æ‰€æœ‰çš„byte,short,charå‹çš„å€¼å°†è¢«æå‡ä¸ºintå‹ï¼›â‘¡å¦‚æœæœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯longå‹ï¼Œè®¡ç®—ç»“æœæ˜¯longå‹ï¼›â‘¢å¦‚æœæœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯floatå‹ï¼Œè®¡ç®—ç»“æœæ˜¯floatå‹ï¼›â‘£å¦‚æœæœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯doubleå‹ï¼Œè®¡ç®—ç»“æœæ˜¯doubleå‹ï¼› ä¾‹ï¼Œ byte b; b=3; b=(byte)(b*3);//å¿…é¡»å£°æ˜byteã€‚ps: è¿ç®—æ‰ä¼šæå‡ç±»å‹ï¼Œb=3ä¸ä¼šæŠŠ byte b å˜æˆ int b,è€Œb=b*3ä¼šæå‡ï¼› 3ã€åŒ…è£…ç±»è¿‡æ¸¡ç±»å‹è½¬æ¢ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é¦–å…ˆå£°æ˜ä¸€ä¸ªå˜é‡ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„åŒ…è£…ç±»ï¼Œå°±å¯ä»¥åˆ©ç”¨åŒ…è£…ç±»çš„å„ç§æ–¹æ³•è¿›è¡Œç±»å‹è½¬æ¢äº†ã€‚ä¾‹å¦‚ï¼š 123456789101112131415â‘ å½“å¸Œæœ›æŠŠfloatå‹è½¬æ¢ä¸ºdoubleå‹æ—¶ï¼šfloat f1 = 100.00f;Float F1 = new Float(f1);double d1 = F1.doubleValue(); //F1.doubleValue()ä¸ºFloatç±»çš„è¿”å›doubleå€¼å‹çš„æ–¹æ³•â‘¡å½“å¸Œæœ›æŠŠdoubleå‹è½¬æ¢ä¸ºintå‹æ—¶ï¼šdouble d1 = 100.00;Double D1 = new Double(d1);int i1 = D1.intValue(); ç®€å•ç±»å‹çš„å˜é‡è½¬æ¢ä¸ºç›¸åº”çš„åŒ…è£…ç±»ï¼Œå¯ä»¥åˆ©ç”¨åŒ…è£…ç±»çš„æ„é€ å‡½æ•°ã€‚å³ï¼šBoolean(boolean value)ã€Character(char value)ã€Integer(int value)ã€Long(long value)ã€Float(float value)ã€Double(double value) è€Œåœ¨å„ä¸ªåŒ…è£…ç±»ä¸­ï¼Œæ€»æœ‰å½¢ä¸ºÃ—Ã—Value()çš„æ–¹æ³•ï¼Œæ¥å¾—åˆ°å…¶å¯¹åº”çš„ç®€å•ç±»å‹æ•°æ®ã€‚åˆ©ç”¨è¿™ç§æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥å®ç°ä¸åŒæ•°å€¼å‹å˜é‡é—´çš„è½¬æ¢ï¼Œä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªåŒç²¾åº¦å®å‹ç±»ï¼ŒintValue()å¯ä»¥å¾—åˆ°å…¶å¯¹åº”çš„æ•´å‹å˜é‡ï¼Œè€ŒdoubleValue()å¯ä»¥å¾—åˆ°å…¶å¯¹åº”çš„åŒç²¾åº¦å®å‹å˜é‡ã€‚ 4ã€å­—ç¬¦ä¸²ä¸å…¶å®ƒç±»å‹é—´çš„è½¬æ¢ å…¶å®ƒç±»å‹å‘å­—ç¬¦ä¸²çš„è½¬æ¢ 12345â‘ è°ƒç”¨ç±»çš„ä¸²è½¬æ¢æ–¹æ³•: X.toString();â‘¡è‡ªåŠ¨è½¬æ¢: X + &quot;&quot;;â‘¢ä½¿ç”¨ String çš„æ–¹æ³•: String.volueOf(X); å­—ç¬¦ä¸²ä½œä¸ºå€¼,å‘å…¶å®ƒç±»å‹çš„è½¬æ¢ 123456789101112131415161718192021â‘ å…ˆè½¬æ¢æˆç›¸åº”çš„å°è£…å™¨å®ä¾‹,å†è°ƒç”¨å¯¹åº”çš„æ–¹æ³•è½¬æ¢æˆå…¶å®ƒç±»å‹ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸­&quot;32.1&quot;è½¬æ¢`double`å‹çš„å€¼çš„æ ¼å¼ä¸º:`new Float(&quot;32.1&quot;).doubleValue()`ã€‚ä¹Ÿå¯ä»¥ç”¨:`Double.valueOf(&quot;32.1&quot;).doubleValue()`â‘¡é™æ€ parseXXX æ–¹æ³•String s = &quot;1&quot;;byte b = Byte.parseByte( s );short t = Short.parseShort( s );int i = Integer.parseInt( s );long l = Long.parseLong( s );Float f = Float.parseFloat( s );Double d = Double.parseDouble( s );â‘¢Character çš„ getNumericValue(char ch)æ–¹æ³• 5ã€Dateç±»ä¸å…¶å®ƒæ•°æ®ç±»å‹çš„ç›¸äº’è½¬æ¢ æ•´å‹å’ŒDateç±»ä¹‹é—´å¹¶ä¸å­˜åœ¨ç›´æ¥çš„å¯¹åº”å…³ç³»ï¼Œåªæ˜¯ä½ å¯ä»¥ä½¿ç”¨intå‹ä¸ºåˆ†åˆ«è¡¨ç¤ºå¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†ã€ç§’ï¼Œè¿™æ ·å°±åœ¨ä¸¤è€…ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªå¯¹åº”å…³ç³»ï¼Œåœ¨ä½œè¿™ç§è½¬æ¢æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨Dateç±»æ„é€ å‡½æ•°çš„ä¸‰ç§å½¢å¼ï¼š 12345â‘ Date(int year, int month, int date)ï¼šä»¥intå‹è¡¨ç¤ºå¹´ã€æœˆã€æ—¥â‘¡Date(int year, int month, int date, int hrs, int min)ï¼šä»¥intå‹è¡¨ç¤ºå¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†â‘¢Date(int year, int month, int date, int hrs, int min, int sec)ï¼šä»¥intå‹è¡¨ç¤ºå¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†ã€ç§’ åœ¨é•¿æ•´å‹å’ŒDateç±»ä¹‹é—´æœ‰ä¸€ä¸ªå¾ˆæœ‰è¶£çš„å¯¹åº”å…³ç³»ï¼Œå°±æ˜¯å°†ä¸€ä¸ªæ—¶é—´è¡¨ç¤ºä¸ºè·ç¦»æ ¼æ—å°¼æ²»æ ‡å‡†æ—¶é—´1970å¹´1æœˆ1æ—¥0æ—¶0åˆ†0ç§’çš„æ¯«ç§’æ•°ã€‚å¯¹äºè¿™ç§å¯¹åº”å…³ç³»ï¼ŒDateç±»ä¹Ÿæœ‰å…¶ç›¸åº”çš„æ„é€ å‡½æ•°ï¼šDate(long date)ã€‚ è·å–Dateç±»ä¸­çš„å¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†ã€ç§’ä»¥åŠæ˜ŸæœŸä½ å¯ä»¥ä½¿ç”¨Dateç±»çš„getYear()ã€getMonth()ã€getDate()ã€getHours()ã€getMinutes()ã€getSeconds()ã€getDay()æ–¹æ³•ï¼Œä½ ä¹Ÿå¯ä»¥å°†å…¶ç†è§£ä¸ºå°†Dateç±»è½¬æ¢æˆintã€‚ è€ŒDateç±»çš„getTime()æ–¹æ³•å¯ä»¥å¾—åˆ°æˆ‘ä»¬å‰é¢æ‰€è¯´çš„ä¸€ä¸ªæ—¶é—´å¯¹åº”çš„é•¿æ•´å‹æ•°ï¼Œä¸åŒ…è£…ç±»ä¸€æ ·ï¼ŒDateç±»ä¹Ÿæœ‰ä¸€ä¸ªtoString()æ–¹æ³•å¯ä»¥å°†å…¶è½¬æ¢ä¸ºStringç±»ã€‚ æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›å¾—åˆ°Dateçš„ç‰¹å®šæ ¼å¼ï¼Œä¾‹å¦‚20020324ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•: 1234567891011121314151617181920212223242526272829import java.text.SimpleDateFormat;import java.util.*;java.util.Date date = new java.util.Date(); //å¦‚æœå¸Œæœ›å¾—åˆ°YYYYMMDDçš„æ ¼å¼SimpleDateFormat sy1 = new SimpleDateFormat(&quot;yyyyMMDD&quot;);String dateFormat = sy1.format(date);//å¦‚æœå¸Œæœ›åˆ†å¼€å¾—åˆ°å¹´ï¼Œæœˆï¼Œæ—¥SimpleDateFormat sy = new SimpleDateFormat(&quot;yyyy&quot;);SimpleDateFormat sm = new SimpleDateFormat(&quot;MM&quot;);SimpleDateFormat sd = new SimpleDateFormat(&quot;dd&quot;);String syear = sy.format(date);String smon = sm.format(date);String sday = sd.format(date); æ€»ç»“ï¼šåªæœ‰booleanä¸å‚ä¸æ•°æ®ç±»å‹çš„è½¬æ¢ 123456789101112131.è‡ªåŠ¨ç±»å‹çš„è½¬æ¢ï¼ša.å¸¸æ•°åœ¨è¡¨æ•°èŒƒå›´å†…æ˜¯èƒ½å¤Ÿè‡ªåŠ¨ç±»å‹è½¬æ¢çš„b.æ•°æ®èŒƒå›´å°çš„èƒ½å¤Ÿè‡ªåŠ¨å‘æ•°æ®ç±»å‹å¤§çš„è½¬æ¢ï¼ˆæ³¨æ„ç‰¹ä¾‹ï¼‰int åˆ° floatï¼Œlong åˆ° floatï¼Œlong åˆ° double åŒæ ·å¯ä»¥è‡ªåŠ¨è½¬æ¢çš„ï¼Œåªä¸è¿‡ä¼šä¸¢å¤±ç²¾åº¦ï¼Œå› ä¸ºå­˜å‚¨ç»“æ„ä¸åŒc.å¼•ç”¨ç±»å‹èƒ½å¤Ÿè‡ªåŠ¨è½¬æ¢ä¸ºçˆ¶ç±»d.åŸºæœ¬ç±»å‹å’Œå®ƒä»¬åŒ…è£…ç±»å‹æ˜¯èƒ½å¤Ÿäº’ç›¸è½¬æ¢çš„2.å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šç”¨åœ†æ‹¬å·æ‹¬èµ·æ¥ç›®æ ‡ç±»å‹ï¼Œç½®äºå˜é‡å‰ 4.Javaå¼•ç”¨ç±»å‹Javaæœ‰ 5 ç§å¼•ç”¨ç±»å‹ï¼ˆå¯¹è±¡ç±»å‹ï¼‰ï¼šç±» æ¥å£ æ•°ç»„ æšä¸¾ æ ‡æ³¨ å¼•ç”¨ç±»å‹ï¼šåº•å±‚ç»“æ„å’ŒåŸºæœ¬ç±»å‹å·®åˆ«è¾ƒå¤§ JVMçš„å†…å­˜ç©ºé—´ï¼š 1234567891011121314151617ï¼ˆ1ï¼‰Heap å †ç©ºé—´ï¼šåˆ†é…å¯¹è±¡ `new Studentï¼ˆï¼‰`ï¼ˆ2ï¼‰Stack æ ˆç©ºé—´ï¼šä¸´æ—¶å˜é‡ `Student stu`ï¼ˆ3ï¼‰Code ä»£ç åŒº ï¼šç±»çš„å®šä¹‰ï¼Œé™æ€èµ„æº `Student.class`egï¼šStudent stu = new Studentï¼ˆï¼‰ï¼› //new åœ¨å†…å­˜çš„å †ç©ºé—´åˆ›å»ºå¯¹è±¡stu.study(); //æŠŠå¯¹è±¡çš„åœ°å€èµ‹ç»™stuå¼•ç”¨å˜é‡ä¸Šä¾‹å®ç°æ­¥éª¤ï¼ša.JVM åŠ è½½ `Student.class` åˆ°CodeåŒºb.`new Student()`åœ¨å †ç©ºé—´åˆ†é…ç©ºé—´å¹¶åˆ›å»ºä¸€ä¸ªStudentå®ä¾‹c.å°†æ­¤å®ä¾‹çš„åœ°å€èµ‹å€¼ç»™å¼•ç”¨`stu`æ ˆç©ºé—´ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/JavaåŸºæœ¬æ•°æ®ç±»å‹.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Java-Fundamental","slug":"Code/Java-Fundamental","permalink":"http://xiaoqinghua.site/categories/Code/Java-Fundamental/"}],"tags":[{"name":"Java-Fundamental","slug":"Java-Fundamental","permalink":"http://xiaoqinghua.site/tags/Java-Fundamental/"}]},{"title":"RedisåŸºç¡€åŠé«˜çº§ç‰¹æ€§ä¸æ€§èƒ½è°ƒä¼˜","slug":"RedisåŸºç¡€åŠé«˜çº§ç‰¹æ€§ä¸æ€§èƒ½è°ƒä¼˜","date":"2017-07-23T14:35:52.000Z","updated":"2018-08-24T07:45:04.148Z","comments":true,"path":"RedisåŸºç¡€åŠé«˜çº§ç‰¹æ€§ä¸æ€§èƒ½è°ƒä¼˜.html","link":"","permalink":"http://xiaoqinghua.site/RedisåŸºç¡€åŠé«˜çº§ç‰¹æ€§ä¸æ€§èƒ½è°ƒä¼˜.html","excerpt":"","text":"æœ¬æ–‡å°†ä» Redis çš„åŸºæœ¬ç‰¹æ€§å…¥æ‰‹ï¼Œé€šè¿‡è®²è¿° Redis çš„æ•°æ®ç»“æ„å’Œä¸»è¦å‘½ä»¤å¯¹ Redis çš„åŸºæœ¬æ€§èƒ½è¿›è¡Œç›´è§‚çš„ä»‹ç»ã€‚ä¹‹åæ¦‚è§ˆ Redis æä¾›çš„é«˜çº§èƒ½åŠ›ï¼Œå¹¶åœ¨éƒ¨ç½²ã€ç»´æŠ¤ã€æ€§èƒ½è°ƒä¼˜ç­‰å¤šä¸ªæ–¹é¢è¿›è¡Œæ›´æ·±å…¥çš„ä»‹ç»å’ŒæŒ‡å¯¼ã€‚ æœ¬æ–‡é€‚åˆä½¿ç”¨ Redis çš„æ™®é€šå¼€å‘äººå‘˜ï¼Œä»¥åŠå¯¹ Redis è¿›è¡Œé€‰å‹ã€æ¶æ„è®¾è®¡å’Œæ€§èƒ½è°ƒä¼˜çš„æ¶æ„è®¾è®¡äººå‘˜ã€‚ ç›®å½• æ¦‚è¿° Redis çš„æ•°æ®ç»“æ„å’Œç›¸å…³å¸¸ç”¨å‘½ä»¤ æ•°æ®æŒä¹…åŒ– å†…å­˜ç®¡ç†å’Œæ•°æ®æ·˜æ±°æœºåˆ¶ Pipelining äº‹åŠ¡ä¸ Scripting Redis æ€§èƒ½è°ƒä¼˜ ä¸»ä»å¤åˆ¶ä¸é›†ç¾¤åˆ†ç‰‡ Redis Java å®¢æˆ·ç«¯çš„é€‰æ‹© æ¦‚è¿°Redis æ˜¯ä¸€ä¸ªå¼€æºçš„ï¼ŒåŸºäºå†…å­˜çš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨åª’ä»‹ï¼Œå¯ä»¥ä½œä¸ºæ•°æ®åº“ã€ç¼“å­˜æœåŠ¡æˆ–æ¶ˆæ¯æœåŠ¡ä½¿ç”¨ã€‚Redis æ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ã€å“ˆå¸Œè¡¨ã€é“¾è¡¨ã€é›†åˆã€æœ‰åºé›†åˆã€ä½å›¾(Bitmap)ã€HyperLogLogsç­‰ã€‚Redis å…·å¤‡ LRU(Least Recently Use)æ·˜æ±°ã€äº‹åŠ¡å®ç°ã€ä»¥åŠä¸åŒçº§åˆ«çš„ç¡¬ç›˜æŒä¹…åŒ–ç­‰èƒ½åŠ›ï¼Œå¹¶ä¸”æ”¯æŒå‰¯æœ¬é›†å’Œé€šè¿‡ Redis Sentinel å®ç°çš„é«˜å¯ç”¨æ–¹æ¡ˆï¼ŒåŒæ—¶è¿˜æ”¯æŒé€šè¿‡ Redis Cluster å®ç°çš„æ•°æ®è‡ªåŠ¨åˆ†ç‰‡èƒ½åŠ›ã€‚ Redis çš„ä¸»è¦åŠŸèƒ½éƒ½æ˜¯åŸºäº\bå•çº¿ç¨‹æ¨¡å‹\bå®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´ Redis ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹æ¥æœåŠ¡æ‰€æœ‰çš„å®¢æˆ·ç«¯è¯·æ±‚ï¼ŒåŒæ—¶ Redis é‡‡ç”¨äº†\béé˜»å¡å¼IOï¼Œå¹¶ç²¾ç»†åœ°ä¼˜åŒ–å„ç§å‘½ä»¤\bçš„ç®—æ³•æ—¶é—´å¤æ‚åº¦ï¼Œè¿™äº›ä¿¡æ¯æ„å‘³ç€ï¼š Redis æ˜¯çº¿ç¨‹å®‰å…¨çš„ (å› ä¸ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹)ï¼Œå…¶æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯åŸå­çš„ï¼Œä¸ä¼šå› ä¸º\bå¹¶å‘äº§ç”Ÿæ•°æ®å¼‚å¸¸ Redis çš„é€Ÿåº¦éå¸¸å¿«ï¼ˆå› ä¸ºä½¿ç”¨çš„æ˜¯éé˜»å¡å¼IOï¼Œä¸”å¤§éƒ¨åˆ†å‘½ä»¤çš„ç®—æ³•æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ï¼‰ ä½¿ç”¨é«˜\bè€—æ—¶çš„ \bRedis å‘½ä»¤æ˜¯å¾ˆå±é™©çš„ï¼Œä¼šå ç”¨å”¯ä¸€çš„çº¿ç¨‹çš„å¤§é‡å¤„ç†æ—¶é—´ï¼Œå¯¼è‡´æ‰€æœ‰è¯·æ±‚éƒ½è¢«æ‹–æ…¢ã€‚ï¼ˆä¾‹å¦‚æ—¶é—´å¤æ‚åº¦ä¸ºO(N)çš„KEYSå‘½ä»¤ï¼Œä¸¥æ ¼ç¦æ­¢åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼‰ Redis çš„æ•°æ®ç»“æ„å’Œç›¸å…³å¸¸ç”¨å‘½ä»¤KeyRedis é‡‡ç”¨Key-Valueå‹çš„åŸºæœ¬æ•°æ®ç»“æ„ï¼Œä»»ä½•äºŒè¿›åˆ¶åºåˆ—éƒ½å¯ä»¥ä½œä¸º Redis çš„ Key ä½¿ç”¨ï¼ˆä¾‹å¦‚æ™®é€šçš„å­—ç¬¦ä¸²æˆ–ä¸€å¼ \b JPEG å›¾ç‰‡ï¼‰å…³äº Key çš„ä¸€äº›æ³¨æ„äº‹é¡¹\b: ä¸è¦ä½¿ç”¨è¿‡é•¿çš„ Keyã€‚\bä¾‹å¦‚ä½¿ç”¨ä¸€ä¸ª1024å­—èŠ‚çš„ key \bå°±ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œä¸ä»…ä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜ï¼Œè¿˜ä¼šå¯¼è‡´æŸ¥è¯¢çš„æ•ˆç‡é™ä½ Key çŸ­åˆ°ç¼ºå¤±äº†å¯è¯»æ€§ä¹Ÿæ˜¯ä¸å¥½çš„ï¼Œä¾‹å¦‚&quot;u1000flw&quot;æ¯”èµ·&quot;user:1000:followers&quot;æ¥è¯´ï¼ŒèŠ‚çœäº†å¯¥å¯¥çš„å­˜å‚¨ç©ºé—´ï¼Œå´å¼•å‘äº†å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ä¸Šçš„éº»çƒ¦ æœ€å¥½ä½¿ç”¨ç»Ÿä¸€è§„èŒƒæ¥è®¾è®¡ Key ï¼Œæ¯”å¦‚&quot;object-type:id:attr&quot;ï¼Œä»¥\bè¿™ä¸€è§„èŒƒè®¾è®¡å‡ºçš„ Key å¯èƒ½æ˜¯&quot;user:1000&quot;æˆ–è€…&quot;comment:1234:reply-to&quot; Redis å…è®¸çš„æœ€å¤§ Key é•¿åº¦æ˜¯ 512MB (å¯¹ Value çš„é•¿åº¦é™åˆ¶ä¹Ÿæ˜¯ 512MB) StringString æ˜¯ Redis çš„åŸºç¡€æ•°æ®ç±»å‹ï¼ŒRedis æ²¡æœ‰ Intã€Floatã€Booleanç­‰æ•°æ®ç±»å‹çš„æ¦‚å¿µï¼Œæ‰€æœ‰çš„åŸºæœ¬ç±»å‹åœ¨ Redis ä¸­éƒ½ä»¥ \bString ä½“ç° ä¸\b String ç›¸å…³çš„å¸¸ç”¨å‘½ä»¤ï¼š \bSETï¼š ä¸ºä¸€ä¸ª key è®¾ç½® \bvalueï¼Œå¯ä»¥é…åˆEX/PXå‚æ•°æŒ‡å®š key çš„æœ‰æ•ˆæœŸï¼Œ\bé€šè¿‡NX/XXå‚æ•°é’ˆå¯¹ key æ˜¯å¦å­˜åœ¨çš„æƒ…å†µè¿›è¡Œåˆ†åŒºæ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦O(1) GETï¼š è·å–æŸä¸ª key å¯¹ç”¨çš„ valueï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1) GETSETï¼š ä¸ºä¸€ä¸ª key è®¾ç½® valueï¼Œå¹¶è¿”å›è¯¥ key çš„åŸ valueï¼Œæ—¶é—´å¤æ‚åº¦O(1) MSETï¼š ä¸ºå¤šä¸ª key è®¾ç½® valueï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N) MSETNXï¼š åŒ MSETï¼Œ\b\bå¦‚æœæŒ‡å®šçš„ key ä¸­æœ‰ä»»æ„ä¸€ä¸ªå·²å­˜åœ¨ï¼Œåˆ™ä¸è¿›è¡Œä»»ä½•æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦O(N) MGETï¼š è·å–\b\b\bå¤šä¸ª key å¯¹åº”çš„ value ï¼Œæ—¶é—´å¤æ‚åº¦O(N) ä¸Šæ–‡æåˆ°è¿‡ï¼ŒRedis çš„åŸºæœ¬æ•°æ®ç±»å‹åªæœ‰ Stringï¼Œä½† Rediså¯ä»¥æŠŠ String ä½œä¸ºæ•´å½¢æˆ–è€…æµ®ç‚¹å‹æ•°å­—æ¥ä½¿ç”¨ï¼Œä¸»è¦ä½“ç°åœ¨INCRã€DECRç±»çš„å‘½ä»¤ä¸Šï¼š INCRï¼šå°† key å¯¹åº”çš„ value å€¼è‡ªå¢1ï¼Œå¹¶è¿”å›è‡ªå¢åçš„å€¼ã€‚åªå¯¹å¯ä»¥è½¬æ¢ä¸ºæ•´å½¢çš„ String æ•°æ®èµ·ä½œç”¨ã€‚æ—¶é—´å¤æ‚åº¦O(1) INCRBYï¼š \bå°† key å¯¹åº”çš„ value å€¼è‡ªå¢æŒ‡å®šçš„æ•´å½¢æ•°å€¼ï¼Œå¹¶è¿”å›è‡ªå¢ä¹‹åçš„å€¼ã€‚åªå¯¹å¯ä»¥è½¬æ¢ä¸ºæ•´å½¢çš„ String æ•°æ®èµ·ä½œç”¨ã€‚æ—¶é—´å¤æ‚åº¦ä¸ºO(1) DECR/DECRBYï¼šåŒINCR/INCRBYï¼Œè‡ªå¢æ”¹ä¸ºè‡ªå‡ INCR/DECRç³»åˆ—å‘½ä»¤è¦æ±‚æ“ä½œçš„ value ç±»å‹ä¸º Stringï¼Œå¹¶å¯ä»¥è½¬æ¢ä¸º64ä½å¸¦ç¬¦å·çš„æ•´å½¢æ•°å­—ï¼Œå¦åˆ™ä¼šè¿”å›é”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿›è¡ŒINCR/DECRç³»åˆ—å‘½ä»¤çš„ valueï¼Œ\bå¿…é¡»åœ¨[-2^63~2^63-1]èŒƒå›´å†… å‰æ–‡æåˆ°è¿‡ï¼ŒRedis é‡‡ç”¨å•çº¿ç¨‹æ¨¡å‹ï¼Œå¤©ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™ä½¿å¾—INCR/DECRå‘½ä»¤å¯ä»¥éå¸¸ä¾¿åˆ©çš„å®ç°é«˜å¹¶å‘åœºæ™¯\bä¸‹çš„ç²¾ç¡®æ§åˆ¶ã€‚ ä¾‹1ï¼šåº“å­˜æ§åˆ¶åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹å®ç°\båº“å­˜ä½™é‡çš„ç²¾å‡†æ ¡éªŒï¼Œç¡®ä¿ä¸å‡ºç°è¶…å–çš„æƒ…å†µ\bè®¾ç½®åº“å­˜æ€»é‡ï¼š 1SET inv:remain &quot;100&quot; åº“å­˜æ‰£å‡ + ä½™é‡æ ¡éªŒ 1DECR inv:remain å½“DECR\bå‘½ä»¤è¿”å›å€¼å¤§äºç­‰äº0æ—¶ï¼Œè¯´æ˜åº“å­˜ä½™é‡é€šè¿‡æ ¡éªŒï¼Œå¦‚æœè¿”å›å°äº0çš„å€¼ï¼Œåˆ™è¯´æ˜åº“å­˜å·²ç»è€—å°½ã€‚ å‡è®¾åŒæ—¶æœ‰300ä¸ªå¹¶å‘è¯·æ±‚è¿›è¡Œåº“å­˜æ‰£å‡ï¼ŒRedis èƒ½å¤Ÿç¡®ä¿è¿™300ä¸ªè¯·æ±‚åˆ†åˆ«å¾—åˆ°99 ~ -200çš„è¿”å›å€¼ï¼Œæ¯ä¸ªè¯·æ±‚å¾—åˆ°çš„è¿”å›å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œç»å¯¹ä¸ä¼šå‡ºç°ä¸¤ä¸ªè¯·æ±‚å¾—åˆ°ä¸€æ ·çš„è¿”å›çš„æƒ…å†µã€‚ ä¾‹2ï¼šè‡ªå¢åºåˆ—ç”Ÿæˆå®ç°ç±»ä¼¼äºRDBMSçš„SequenceåŠŸèƒ½ï¼Œç”Ÿæˆä¸€ç³»åˆ—å”¯ä¸€åºåˆ—å· è®¾ç½®åºåˆ—èµ·å§‹å€¼ï¼š 1SET sequence &quot;10000&quot; è·å–ä¸€ä¸ªåºåˆ—å€¼ï¼š 1INCR sequence ç›´æ¥å°†è¿”å›å€¼ä½œä¸ºåºåˆ—ä½¿ç”¨å³å¯ã€‚ è·å–ä¸€æ‰¹ï¼ˆå¦‚100ä¸ªï¼‰åºåˆ—å€¼ï¼š 1INCRBY sequence 100 å‡è®¾è¿”å›å€¼ä¸ºNï¼Œé‚£ä¹ˆ[N - 99 ~ N]çš„æ•°å€¼éƒ½æ˜¯å¯ä»¥ç”¨çš„åºåˆ—å€¼ã€‚ å½“å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å‘ Redis ç”³è¯·è‡ªå¢åºåˆ—æ—¶ï¼ŒRedis èƒ½å¤Ÿç¡®ä¿æ¯ä¸ªå®¢æˆ·ç«¯å¾—åˆ°çš„åºåˆ—å€¼æˆ–åºåˆ—èŒƒå›´éƒ½æ˜¯å…¨å±€å”¯ä¸€çš„ã€‚ç»å¯¹ä¸ä¼šå‡ºç°ä¸åŒå®¢æˆ·ç«¯å¾—åˆ°äº†é‡å¤çš„åºåˆ—å€¼çš„æƒ…å†µã€‚ ListRedis çš„ list æ˜¯é“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ä½¿ç”¨LPUSH/RPUSH/LPOP/RPOPç­‰å‘½ä»¤åœ¨ List çš„è¿æ®µæ‰§è¡Œæ’å…¥å…ƒç´ å’Œå¼¹å‡ºå…ƒç´ çš„æ“ä½œã€‚è™½ç„¶ List ä¹Ÿæ”¯æŒåœ¨ç‰¹å®šindexä¸Šæ’å…¥å’Œè¯»å–å…ƒç´ çš„åŠŸèƒ½ï¼Œä½†å…¶æ—¶é—´å¤æ‚åº¦è¾ƒé«˜(O(N))ï¼Œåº”å°å¿ƒä½¿ç”¨ã€‚ ä¸ List ç›¸å…³çš„å¸¸ç”¨å‘½ä»¤ï¼š LPUSHï¼š å‘æŒ‡å®šçš„ List çš„å·¦ä¾§ï¼ˆå³å¤´éƒ¨ï¼‰æ’å…¥1ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œè¿”å›æ’å…¥åçš„ List é•¿åº¦ã€‚æ—¶é—´å¤æ‚åº¦O(N), N ä¸ºæ’å…¥å…ƒç´ çš„æ•°é‡ RPUSHï¼šåŒ LPUSHï¼Œå‘ List çš„å³ä¾§ï¼ˆå³å°¾éƒ¨ï¼‰æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  LPOPï¼šä»æŒ‡å®šçš„ List çš„å·¦ä¾§ï¼ˆå³å¤´éƒ¨ï¼‰ç§»é™¤ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›ï¼Œæ—¶é—´å¤æ‚åº¦O(1) RPOPï¼šåŒ LPOP ï¼Œä»æŒ‡å®šçš„ List çš„å³ä¾§ï¼ˆå³å°¾éƒ¨ï¼‰ç§»é™¤ä¸€ä¸ªå…ƒç´ å¹¶è¿”å› LPUSHX/RPUSHXï¼šä¸ LPUSH/RPUSH ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºï¼ŒLPUSHX/RPUSHX æ“ä½œçš„ key å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œ LLENï¼šè¿”å›æŒ‡å®šçš„ List é•¿åº¦ï¼Œæ—¶é—´å¤æ‚åº¦O(1) LRANGEï¼šè¿”å›æŒ‡å®š List ä¸­æŒ‡å®šèŒƒå›´çš„å…ƒç´  ï¼ˆåŒç«¯åŒ…å«ï¼Œå³ LRANGE key 0 10 ä¼šè¿”å›10ä¸ªå…ƒç´ ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ã€‚åº”å°½å¯èƒ½æ§åˆ¶ä»¥æ­¤è·å–çš„å…ƒç´ æ•°é‡ï¼Œä¸€æ¬¡è·å–è¿‡å¤§èŒƒå›´çš„ List å…ƒç´ ä¼šå¯¼è‡´å»¶è¿Ÿï¼ŒåŒæ—¶å¯¹é•¿åº¦ä¸å¯é¢„çŸ¥çš„ List ï¼Œé¿å…ä½¿ç”¨ LRANGE key 0 -1è¿™æ ·çš„å®Œæ•´ä¾¿åˆ©æ“ä½œ åº”è°¨æ…ä½¿ç”¨çš„ List ç›¸å…³å‘½ä»¤ï¼š LINDEXï¼šè¿”å›æŒ‡å®š List æŒ‡å®š index ä¸Šçš„å…ƒç´ ï¼Œå¦‚æœ index è¶Šç•Œï¼Œè¿”å› nilã€‚index æ•°å€¼æ˜¯å›ç¯çš„ï¼Œå³ -1 ä»£è¡¨ List æœ€åä¸€ä¸ªä½ç½®ï¼Œ-2 ä»£è¡¨ List å€’æ•°ç¬¬äºŒä¸ªä½ç½®ã€‚æ—¶é—´å¤æ‚åº¦O(N) LSETï¼šå°†æŒ‡å®š List æŒ‡å®š index ä¸Šçš„å…ƒç´ è®¾ç½®ä¸º valueï¼Œå¦‚æœ index è¶Šç•Œåˆ™è¿”å›é”™è¯¯ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼Œå¦‚æœæ“ä½œçš„æ˜¯å¤´/å°¾éƒ¨çš„å…ƒç´ ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸ºO(1) LINSERTï¼šå‘æŒ‡å®š List ä¸­æŒ‡å®šå…ƒç´ ä¹‹å‰/ä¹‹åæ’å…¥ä¸€ä¸ªæ–°å…ƒç´ ï¼Œå¹¶è¿”å›æ“ä½œåçš„ List é•¿åº¦ã€‚å¦‚æœæŒ‡å®šçš„å…ƒç´ ä¸å­˜åœ¨ï¼Œè¿”å› -1ã€‚å¦‚æœæŒ‡å®š key ä¸å­˜åœ¨ï¼Œä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦O(N) ç”±äº Redis çš„ List æ˜¯é“¾è¡¨ç»“æ„çš„ï¼Œä¸Šè¿°çš„ä¸‰ä¸ªå‘½ä»¤çš„ç®—æ³•æ•ˆç‡è¾ƒä½ï¼Œéœ€è¦å¯¹Listè¿›è¡Œéå†ï¼Œå‘½ä»¤çš„è€—æ—¶æ— æ³•é¢„ä¼°ï¼Œåœ¨Listé•¿åº¦å¤§çš„æƒ…å†µä¸‹è€—æ—¶ä¼šæ˜æ˜¾å¢åŠ ï¼Œåº”è°¨æ…ä½¿ç”¨ã€‚ æ¢å¥è¯è¯´ï¼ŒRedis çš„ List å®é™…æ˜¯è®¾è®¡æ¥ç”¨äºå®ç°é˜Ÿåˆ—ï¼Œè€Œä¸æ˜¯ç”¨äºå®ç°ç±»ä¼¼ArrayListè¿™æ ·çš„åˆ—è¡¨çš„ã€‚å¦‚æœä½ ä¸æ˜¯æƒ³è¦å®ç°ä¸€ä¸ªåŒç«¯å‡ºå…¥çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆè¯·å°½é‡ä¸è¦ä½¿ç”¨ Redis çš„ List æ•°æ®ç»“æ„ã€‚ ä¸ºäº†æ›´å¥½æ”¯æŒé˜Ÿåˆ—çš„ç‰¹æ€§ï¼ŒRedis è¿˜æä¾›äº†ä¸€ç³»åˆ—é˜»å¡å¼çš„æ“ä½œå‘½ä»¤ï¼Œå¦‚BLPOP/BRPOPç­‰ï¼Œèƒ½å¤Ÿå®ç°ç±»ä¼¼äºBlockingQueueçš„èƒ½åŠ›ï¼Œå³åœ¨ List ä¸ºç©ºæ—¶ï¼Œé˜»å¡è¯¥è¿æ¥ï¼Œç›´åˆ° List ä¸­æœ‰å¯¹è±¡å¯ä»¥å‡ºé˜Ÿæ—¶å†è¿”å›ã€‚ HashHashå³å“ˆå¸Œè¡¨ï¼ŒRedisçš„Hashå’Œä¼ ç»Ÿçš„å“ˆå¸Œè¡¨ä¸€æ ·ï¼Œæ˜¯ä¸€ç§field-valueå‹çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç†è§£æˆå°†HashMapæ¬å…¥Redisã€‚Hashéå¸¸é€‚åˆç”¨äºè¡¨ç°å¯¹è±¡ç±»å‹çš„æ•°æ®ï¼Œç”¨Hashä¸­çš„fieldå¯¹åº”å¯¹è±¡çš„fieldå³å¯ã€‚Hashçš„ä¼˜ç‚¹åŒ…æ‹¬ï¼š å¯ä»¥å®ç°äºŒå…ƒæŸ¥æ‰¾ï¼Œå¦‚â€æŸ¥æ‰¾IDä¸º1000çš„ç”¨æˆ·çš„å¹´é¾„â€ æ¯”èµ·å°†æ•´ä¸ªå¯¹è±¡åºåˆ—åŒ–åä½œä¸ºStringå­˜å‚¨çš„æ–¹æ³•ï¼ŒHashèƒ½å¤Ÿæœ‰æ•ˆåœ°å‡å°‘ç½‘ç»œä¼ è¾“çš„æ¶ˆè€— å½“ä½¿ç”¨Hashç»´æŠ¤ä¸€ä¸ªé›†åˆæ—¶ï¼Œæä¾›äº†æ¯”Listæ•ˆç‡é«˜å¾—å¤šçš„éšæœºè®¿é—®å‘½ä»¤ ä¸Hashç›¸å…³çš„å¸¸ç”¨å‘½ä»¤ï¼š HSETï¼šå°†keyå¯¹åº”çš„Hashä¸­çš„fieldè®¾ç½®ä¸ºvalueã€‚å¦‚æœè¯¥Hashä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªã€‚æ—¶é—´å¤æ‚åº¦O(1) HGETï¼šè¿”å›æŒ‡å®šHashä¸­fieldå­—æ®µçš„å€¼ï¼Œæ—¶é—´å¤æ‚åº¦O(1) HMSET/HMGETï¼šåŒHSETå’ŒHGETï¼Œå¯ä»¥æ‰¹é‡æ“ä½œåŒä¸€ä¸ªkeyä¸‹çš„å¤šä¸ªfieldï¼Œæ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼ŒNä¸ºä¸€æ¬¡æ“ä½œçš„fieldæ•°é‡ HSETNXï¼šåŒHSETï¼Œä½†å¦‚fieldå·²ç»å­˜åœ¨ï¼ŒHSETNXä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦O(1) HEXISTSï¼šåˆ¤æ–­æŒ‡å®šHashä¸­fieldæ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨è¿”å›1ï¼Œä¸å­˜åœ¨è¿”å›0ï¼Œæ—¶é—´å¤æ‚åº¦O(1) HDELï¼šåˆ é™¤æŒ‡å®šHashä¸­çš„fieldï¼ˆ1ä¸ªæˆ–å¤šä¸ªï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼ŒNä¸ºæ“ä½œçš„fieldæ•°é‡ HINCRBYï¼šåŒINCRBYå‘½ä»¤ï¼Œå¯¹æŒ‡å®šHashä¸­çš„ä¸€ä¸ªfieldè¿›è¡ŒINCRBYï¼Œæ—¶é—´å¤æ‚åº¦O(1) åº”è°¨æ…ä½¿ç”¨çš„Hashç›¸å…³å‘½ä»¤ï¼š HGETALLï¼šè¿”å›æŒ‡å®šHashä¸­æ‰€æœ‰çš„field-valueå¯¹ã€‚è¿”å›ç»“æœä¸ºæ•°ç»„ï¼Œæ•°ç»„ä¸­fieldå’Œvalueäº¤æ›¿å‡ºç°ã€‚æ—¶é—´å¤æ‚åº¦O(N) HKEYS/HVALSï¼šè¿”å›æŒ‡å®šHashä¸­æ‰€æœ‰çš„field/valueï¼Œæ—¶é—´å¤æ‚åº¦O(N) ä¸Šè¿°ä¸‰ä¸ªå‘½ä»¤éƒ½ä¼šå¯¹Hashè¿›è¡Œå®Œæ•´éå†ï¼ŒHashä¸­çš„fieldæ•°é‡ä¸å‘½ä»¤çš„è€—æ—¶çº¿æ€§ç›¸å…³ï¼Œå¯¹äºå°ºå¯¸ä¸å¯é¢„çŸ¥çš„Hashï¼Œåº”ä¸¥æ ¼é¿å…ä½¿ç”¨ä¸Šé¢ä¸‰ä¸ªå‘½ä»¤ï¼Œè€Œæ”¹ä¸ºä½¿ç”¨HSCANå‘½ä»¤è¿›è¡Œæ¸¸æ ‡å¼çš„éå†ï¼› SetRedis Setæ˜¯æ— åºçš„ï¼Œä¸å¯é‡å¤çš„Stringé›†åˆã€‚ ä¸Setç›¸å…³çš„å¸¸ç”¨å‘½ä»¤ï¼š SADDï¼šå‘æŒ‡å®šSetä¸­æ·»åŠ 1ä¸ªæˆ–å¤šä¸ªmemberï¼Œå¦‚æœæŒ‡å®šSetä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªã€‚æ—¶é—´å¤æ‚åº¦O(N)ï¼ŒNä¸ºæ·»åŠ çš„memberä¸ªæ•° SREMï¼šä»æŒ‡å®šSetä¸­ç§»é™¤1ä¸ªæˆ–å¤šä¸ªmemberï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼ŒNä¸ºç§»é™¤çš„memberä¸ªæ•° SRANDMEMBERï¼šä»æŒ‡å®šSetä¸­éšæœºè¿”å›1ä¸ªæˆ–å¤šä¸ªmemberï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼ŒNä¸ºè¿”å›çš„memberä¸ªæ•° SPOPï¼šä»æŒ‡å®šSetä¸­éšæœºç§»é™¤å¹¶è¿”å›countä¸ªmemberï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼ŒNä¸ºç§»é™¤çš„memberä¸ªæ•° SCARDï¼šè¿”å›æŒ‡å®šSetä¸­çš„memberä¸ªæ•°ï¼Œæ—¶é—´å¤æ‚åº¦O(1) SISMEMBERï¼šåˆ¤æ–­æŒ‡å®šçš„valueæ˜¯å¦å­˜åœ¨äºæŒ‡å®šSetä¸­ï¼Œæ—¶é—´å¤æ‚åº¦O(1) SMOVEï¼šå°†æŒ‡å®šmemberä»ä¸€ä¸ªSetç§»è‡³å¦ä¸€ä¸ªSet æ…ç”¨çš„Setç›¸å…³å‘½ä»¤ï¼š SMEMBERSï¼šè¿”å›æŒ‡å®šHashä¸­æ‰€æœ‰çš„memberï¼Œæ—¶é—´å¤æ‚åº¦O(N) SUNION/SUNIONSTOREï¼šè®¡ç®—å¤šä¸ªSetçš„å¹¶é›†å¹¶è¿”å›/å­˜å‚¨è‡³å¦ä¸€ä¸ªSetä¸­ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼ŒNä¸ºå‚ä¸è®¡ç®—çš„æ‰€æœ‰é›†åˆçš„æ€»memberæ•° SINTER/SINTERSTOREï¼šè®¡ç®—å¤šä¸ªSetçš„äº¤é›†å¹¶è¿”å›/å­˜å‚¨è‡³å¦ä¸€ä¸ªSetä¸­ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼ŒNä¸ºå‚ä¸è®¡ç®—çš„æ‰€æœ‰é›†åˆçš„æ€»memberæ•° SDIFF/SDIFFSTOREï¼šè®¡ç®—1ä¸ªSetä¸1æˆ–å¤šä¸ªSetçš„å·®é›†å¹¶è¿”å›/å­˜å‚¨è‡³å¦ä¸€ä¸ªSetä¸­ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼ŒNä¸ºå‚ä¸è®¡ç®—çš„æ‰€æœ‰é›†åˆçš„æ€»memberæ•° ä¸Šè¿°å‡ ä¸ªå‘½ä»¤æ¶‰åŠçš„è®¡ç®—é‡å¤§ï¼Œåº”è°¨æ…ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å‚ä¸è®¡ç®—çš„Setå°ºå¯¸ä¸å¯çŸ¥çš„æƒ…å†µä¸‹ï¼Œåº”ä¸¥æ ¼é¿å…ä½¿ç”¨ã€‚å¯ä»¥è€ƒè™‘é€šè¿‡SSCANå‘½ä»¤éå†è·å–ç›¸å…³Setçš„å…¨éƒ¨memberï¼Œå¦‚æœéœ€è¦åšå¹¶é›†/äº¤é›†/å·®é›†è®¡ç®—ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯è¿›è¡Œï¼Œæˆ–åœ¨ä¸æœåŠ¡å®æ—¶æŸ¥è¯¢è¯·æ±‚çš„Slaveä¸Šè¿›è¡Œã€‚ Sorted SetRedis Sorted Setæ˜¯æœ‰åºçš„ã€ä¸å¯é‡å¤çš„Stringé›†åˆã€‚Sorted Setä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½éœ€è¦æŒ‡æ´¾ä¸€ä¸ªåˆ†æ•°(score)ï¼ŒSorted Setä¼šæ ¹æ®scoreå¯¹å…ƒç´ è¿›è¡Œå‡åºæ’åºã€‚å¦‚æœå¤šä¸ªmemberæ‹¥æœ‰ç›¸åŒçš„scoreï¼Œåˆ™ä»¥å­—å…¸åºè¿›è¡Œå‡åºæ’åºã€‚ Sorted Setéå¸¸é€‚åˆç”¨äºå®ç°æ’åã€‚ Sorted Setçš„ä¸»è¦å‘½ä»¤ï¼š ZADDï¼šå‘æŒ‡å®šSorted Setä¸­æ·»åŠ 1ä¸ªæˆ–å¤šä¸ªmemberï¼Œæ—¶é—´å¤æ‚åº¦O(Mlog(N))ï¼ŒMä¸ºæ·»åŠ çš„memberæ•°é‡ï¼ŒNä¸ºSorted Setä¸­çš„memberæ•°é‡ ZREMï¼šä»æŒ‡å®šSorted Setä¸­åˆ é™¤1ä¸ªæˆ–å¤šä¸ªmemberï¼Œæ—¶é—´å¤æ‚åº¦O(Mlog(N))ï¼ŒMä¸ºåˆ é™¤çš„memberæ•°é‡ï¼ŒNä¸ºSorted Setä¸­çš„memberæ•°é‡ ZCOUNTï¼šè¿”å›æŒ‡å®šSorted Setä¸­æŒ‡å®šscoreèŒƒå›´å†…çš„memberæ•°é‡ï¼Œæ—¶é—´å¤æ‚åº¦ï¼šO(log(N)) ZCARDï¼šè¿”å›æŒ‡å®šSorted Setä¸­çš„memberæ•°é‡ï¼Œæ—¶é—´å¤æ‚åº¦O(1) ZSCOREï¼šè¿”å›æŒ‡å®šSorted Setä¸­æŒ‡å®šmemberçš„scoreï¼Œæ—¶é—´å¤æ‚åº¦O(1) ZRANK/ZREVRANKï¼šè¿”å›æŒ‡å®šmemberåœ¨Sorted Setä¸­çš„æ’åï¼ŒZRANKè¿”å›æŒ‰å‡åºæ’åºçš„æ’åï¼ŒZREVRANKåˆ™è¿”å›æŒ‰é™åºæ’åºçš„æ’åã€‚æ—¶é—´å¤æ‚åº¦O(log(N)) ZINCRBYï¼šåŒINCRBYï¼Œå¯¹æŒ‡å®šSorted Setä¸­çš„æŒ‡å®šmemberçš„scoreè¿›è¡Œè‡ªå¢ï¼Œæ—¶é—´å¤æ‚åº¦O(log(N)) æ…ç”¨çš„Sorted Setç›¸å…³å‘½ä»¤ï¼š ZRANGE/ZREVRANGEï¼šè¿”å›æŒ‡å®šSorted Setä¸­æŒ‡å®šæ’åèŒƒå›´å†…çš„æ‰€æœ‰memberï¼ŒZRANGEä¸ºæŒ‰scoreå‡åºæ’åºï¼ŒZREVRANGEä¸ºæŒ‰scoreé™åºæ’åºï¼Œæ—¶é—´å¤æ‚åº¦O(log(N)+M)ï¼ŒMä¸ºæœ¬æ¬¡è¿”å›çš„memberæ•° ZRANGEBYSCORE/ZREVRANGEBYSCOREï¼šè¿”å›æŒ‡å®šSorted Setä¸­æŒ‡å®šscoreèŒƒå›´å†…çš„æ‰€æœ‰memberï¼Œè¿”å›ç»“æœä»¥å‡åº/é™åºæ’åºï¼Œminå’Œmaxå¯ä»¥æŒ‡å®šä¸º-infå’Œ+infï¼Œä»£è¡¨è¿”å›æ‰€æœ‰çš„memberã€‚æ—¶é—´å¤æ‚åº¦O(log(N)+M) ZREMRANGEBYRANK/ZREMRANGEBYSCOREï¼šç§»é™¤Sorted Setä¸­æŒ‡å®šæ’åèŒƒå›´/æŒ‡å®šscoreèŒƒå›´å†…çš„æ‰€æœ‰memberã€‚æ—¶é—´å¤æ‚åº¦O(log(N)+M) ä¸Šè¿°å‡ ä¸ªå‘½ä»¤ï¼Œåº”å°½é‡é¿å…ä¼ é€’[0 -1]æˆ–[-inf +inf]è¿™æ ·çš„å‚æ•°ï¼Œæ¥å¯¹Sorted Setåšä¸€æ¬¡æ€§çš„å®Œæ•´éå†ï¼Œç‰¹åˆ«æ˜¯åœ¨Sorted Setçš„å°ºå¯¸ä¸å¯é¢„çŸ¥çš„æƒ…å†µä¸‹ã€‚å¯ä»¥é€šè¿‡ZSCANå‘½ä»¤æ¥è¿›è¡Œæ¸¸æ ‡å¼çš„éå†ï¼Œæˆ–é€šè¿‡LIMITå‚æ•°æ¥é™åˆ¶è¿”å›memberçš„æ•°é‡ï¼ˆé€‚ç”¨äºZRANGEBYSCOREå’ŒZREVRANGEBYSCOREå‘½ä»¤ï¼‰ï¼Œä»¥å®ç°æ¸¸æ ‡å¼çš„éå†ã€‚ Bitmapå’ŒHyperLogLogRedisçš„è¿™ä¸¤ç§æ•°æ®ç»“æ„ç›¸è¾ƒä¹‹å‰çš„å¹¶ä¸å¸¸ç”¨ï¼Œåœ¨æœ¬æ–‡ä¸­åªåšç®€è¦ä»‹ç»ï¼Œå¦‚æƒ³è¦è¯¦ç»†äº†è§£è¿™ä¸¤ç§æ•°æ®ç»“æ„ä¸å…¶ç›¸å…³çš„å‘½ä»¤ï¼› Bitmapåœ¨Redisä¸­ä¸æ˜¯ä¸€ç§å®é™…çš„æ•°æ®ç±»å‹ï¼Œè€Œæ˜¯ä¸€ç§å°†Stringä½œä¸ºBitmapä½¿ç”¨çš„æ–¹æ³•ã€‚å¯ä»¥ç†è§£ä¸ºå°†Stringè½¬æ¢ä¸ºbitæ•°ç»„ã€‚ä½¿ç”¨Bitmapæ¥å­˜å‚¨true/falseç±»å‹çš„ç®€å•æ•°æ®æä¸ºèŠ‚çœç©ºé—´ã€‚ HyperLogLogsæ˜¯ä¸€ç§ä¸»è¦ç”¨äºæ•°é‡ç»Ÿè®¡çš„æ•°æ®ç»“æ„ï¼Œå®ƒå’ŒSetç±»ä¼¼ï¼Œç»´æŠ¤ä¸€ä¸ªä¸å¯é‡å¤çš„Stringé›†åˆï¼Œä½†æ˜¯HyperLogLogså¹¶ä¸ç»´æŠ¤å…·ä½“çš„memberå†…å®¹ï¼Œåªç»´æŠ¤memberçš„ä¸ªæ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒHyperLogLogsåªèƒ½ç”¨äºè®¡ç®—ä¸€ä¸ªé›†åˆä¸­ä¸é‡å¤çš„å…ƒç´ æ•°é‡ï¼Œæ‰€ä»¥å®ƒæ¯”Setè¦èŠ‚çœå¾ˆå¤šå†…å­˜ç©ºé—´ã€‚ å…¶ä»–å¸¸ç”¨å‘½ä»¤ EXISTSï¼šåˆ¤æ–­æŒ‡å®šçš„keyæ˜¯å¦å­˜åœ¨ï¼Œè¿”å›1ä»£è¡¨å­˜åœ¨ï¼Œ0ä»£è¡¨ä¸å­˜åœ¨ï¼Œæ—¶é—´å¤æ‚åº¦O(1) DELï¼šåˆ é™¤æŒ‡å®šçš„keyåŠå…¶å¯¹åº”çš„valueï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼ŒNä¸ºåˆ é™¤çš„keyæ•°é‡ EXPIRE/PEXPIREï¼šä¸ºä¸€ä¸ªkeyè®¾ç½®æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’æˆ–æ¯«ç§’ï¼Œæ—¶é—´å¤æ‚åº¦O(1) TTL/PTTLï¼šè¿”å›ä¸€ä¸ªkeyå‰©ä½™çš„æœ‰æ•ˆæ—¶é—´ï¼Œå•ä½ä¸ºç§’æˆ–æ¯«ç§’ï¼Œæ—¶é—´å¤æ‚åº¦O(1) RENAME/RENAMENXï¼šå°†keyé‡å‘½åä¸ºnewkeyã€‚ä½¿ç”¨RENAMEæ—¶ï¼Œå¦‚æœnewkeyå·²ç»å­˜åœ¨ï¼Œå…¶å€¼ä¼šè¢«è¦†ç›–ï¼›ä½¿ç”¨RENAMENXæ—¶ï¼Œå¦‚æœnewkeyå·²ç»å­˜åœ¨ï¼Œåˆ™ä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦O(1) TYPEï¼šè¿”å›æŒ‡å®škeyçš„ç±»å‹ï¼Œstring, list, set, zset, hashã€‚æ—¶é—´å¤æ‚åº¦O(1) CONFIG GETï¼šè·å¾—RedisæŸé…ç½®é¡¹çš„å½“å‰å€¼ï¼Œå¯ä»¥ä½¿ç”¨*é€šé…ç¬¦ï¼Œæ—¶é—´å¤æ‚åº¦O(1) CONFIG SETï¼šä¸ºRedisæŸä¸ªé…ç½®é¡¹è®¾ç½®æ–°å€¼ï¼Œæ—¶é—´å¤æ‚åº¦O(1) CONFIG REWRITEï¼šè®©Redisé‡æ–°åŠ è½½redis.confä¸­çš„é…ç½® æ•°æ®æŒä¹…åŒ–Redisæä¾›äº†å°†æ•°æ®å®šæœŸè‡ªåŠ¨æŒä¹…åŒ–è‡³ç¡¬ç›˜çš„èƒ½åŠ›ï¼ŒåŒ…æ‹¬RDBå’ŒAOFä¸¤ç§æ–¹æ¡ˆï¼Œä¸¤ç§æ–¹æ¡ˆåˆ†åˆ«æœ‰å…¶é•¿å¤„å’ŒçŸ­æ¿ï¼Œå¯ä»¥é…åˆèµ·æ¥åŒæ—¶è¿è¡Œï¼Œç¡®ä¿æ•°æ®çš„ç¨³å®šæ€§ã€‚ å¿…é¡»ä½¿ç”¨æ•°æ®æŒä¹…åŒ–å—ï¼ŸRedisçš„æ•°æ®æŒä¹…åŒ–æœºåˆ¶æ˜¯å¯ä»¥å…³é—­çš„ã€‚å¦‚æœä½ åªæŠŠRedisä½œä¸ºç¼“å­˜æœåŠ¡ä½¿ç”¨ï¼ŒRedisä¸­å­˜å‚¨çš„æ‰€æœ‰æ•°æ®éƒ½ä¸æ˜¯è¯¥æ•°æ®çš„ä¸»ä½“è€Œä»…ä»…æ˜¯åŒæ­¥è¿‡æ¥çš„å¤‡ä»½ï¼Œé‚£ä¹ˆå¯ä»¥å…³é—­Redisçš„æ•°æ®æŒä¹…åŒ–æœºåˆ¶ã€‚ä½†é€šå¸¸æ¥è¯´ï¼Œä»ç„¶å»ºè®®è‡³å°‘å¼€å¯RDBæ–¹å¼çš„æ•°æ®æŒä¹…åŒ–ï¼Œå› ä¸ºï¼š RDBæ–¹å¼çš„æŒä¹…åŒ–å‡ ä¹ä¸æŸè€—Redisæœ¬èº«çš„æ€§èƒ½ï¼Œåœ¨è¿›è¡ŒRDBæŒä¹…åŒ–æ—¶ï¼ŒRedisä¸»è¿›ç¨‹å”¯ä¸€éœ€è¦åšçš„äº‹æƒ…å°±æ˜¯forkå‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ‰€æœ‰æŒä¹…åŒ–å·¥ä½œéƒ½ç”±å­è¿›ç¨‹å®Œæˆ Redisæ— è®ºå› ä¸ºä»€ä¹ˆåŸå› crashæ‰ä¹‹åï¼Œé‡å¯æ—¶èƒ½å¤Ÿè‡ªåŠ¨æ¢å¤åˆ°ä¸Šä¸€æ¬¡RDBå¿«ç…§ä¸­è®°å½•çš„æ•°æ®ã€‚è¿™çœå»äº†æ‰‹å·¥ä»å…¶ä»–æ•°æ®æºï¼ˆå¦‚DBï¼‰åŒæ­¥æ•°æ®çš„è¿‡ç¨‹ï¼Œè€Œä¸”è¦æ¯”å…¶ä»–ä»»ä½•çš„æ•°æ®æ¢å¤æ–¹å¼éƒ½è¦å¿« ç°åœ¨ç¡¬ç›˜é‚£ä¹ˆå¤§ï¼ŒçœŸçš„ä¸ç¼ºé‚£ä¸€ç‚¹åœ°æ–¹ RDBé‡‡ç”¨RDBæŒä¹…æ–¹å¼ï¼ŒRedisä¼šå®šæœŸä¿å­˜æ•°æ®å¿«ç…§è‡³ä¸€ä¸ªrbdæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½rdbæ–‡ä»¶ï¼Œæ¢å¤ä¹‹å‰ä¿å­˜çš„æ•°æ®ã€‚å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®Redisè¿›è¡Œå¿«ç…§ä¿å­˜çš„æ—¶æœºï¼š 1save [secends] [changes] æ„ä¸ºåœ¨[seconds]ç§’å†…å¦‚æœå‘ç”Ÿäº†[changes]æ¬¡æ•°æ®ä¿®æ”¹ï¼Œåˆ™è¿›è¡Œä¸€æ¬¡RDBå¿«ç…§ä¿å­˜ï¼Œä¾‹å¦‚ï¼š 1save 60 100 ä¼šè®©Redisæ¯60ç§’æ£€æŸ¥ä¸€æ¬¡æ•°æ®å˜æ›´æƒ…å†µï¼Œå¦‚æœå‘ç”Ÿäº†100æ¬¡æˆ–ä»¥ä¸Šçš„æ•°æ®å˜æ›´ï¼Œåˆ™è¿›è¡ŒRDBå¿«ç…§ä¿å­˜ã€‚å¯ä»¥é…ç½®å¤šæ¡saveæŒ‡ä»¤ï¼Œè®©Redisæ‰§è¡Œå¤šçº§çš„å¿«ç…§ä¿å­˜ç­–ç•¥ã€‚Redisé»˜è®¤å¼€å¯RDBå¿«ç…§ï¼Œé»˜è®¤çš„RDBç­–ç•¥å¦‚ä¸‹ï¼š 123save 900 1save 300 10save 60 10000 ä¹Ÿå¯ä»¥é€šè¿‡BGSAVEå‘½ä»¤æ‰‹å·¥è§¦å‘RDBå¿«ç…§ä¿å­˜ã€‚ RDBçš„ä¼˜ç‚¹ï¼š å¯¹æ€§èƒ½å½±å“æœ€å°ã€‚å¦‚å‰æ–‡æ‰€è¿°ï¼ŒRedisåœ¨ä¿å­˜RDBå¿«ç…§æ—¶ä¼šforkå‡ºå­è¿›ç¨‹è¿›è¡Œï¼Œå‡ ä¹ä¸å½±å“Rediså¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„æ•ˆç‡ã€‚ æ¯æ¬¡å¿«ç…§ä¼šç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„æ•°æ®å¿«ç…§æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥è¾…ä»¥å…¶ä»–æ‰‹æ®µä¿å­˜å¤šä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§ï¼ˆä¾‹å¦‚æŠŠæ¯å¤©0ç‚¹çš„å¿«ç…§å¤‡ä»½è‡³å…¶ä»–å­˜å‚¨åª’ä»‹ä¸­ï¼‰ï¼Œä½œä¸ºéå¸¸å¯é çš„ç¾éš¾æ¢å¤æ‰‹æ®µã€‚ ä½¿ç”¨RDBæ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤æ¯”ä½¿ç”¨AOFè¦å¿«å¾ˆå¤šã€‚ RDBçš„ç¼ºç‚¹ï¼š å¿«ç…§æ˜¯å®šæœŸç”Ÿæˆçš„ï¼Œæ‰€ä»¥åœ¨Redis crashæ—¶æˆ–å¤šæˆ–å°‘ä¼šä¸¢å¤±ä¸€éƒ¨åˆ†æ•°æ®ã€‚ å¦‚æœæ•°æ®é›†éå¸¸å¤§ä¸”CPUä¸å¤Ÿå¼ºï¼ˆæ¯”å¦‚å•æ ¸CPUï¼‰ï¼ŒRedisåœ¨forkå­è¿›ç¨‹æ—¶å¯èƒ½ä¼šæ¶ˆè€—ç›¸å¯¹è¾ƒé•¿çš„æ—¶é—´ï¼ˆé•¿è‡³1ç§’ï¼‰ï¼Œå½±å“è¿™æœŸé—´çš„å®¢æˆ·ç«¯è¯·æ±‚ã€‚ AOFé‡‡ç”¨AOFæŒä¹…æ–¹å¼æ—¶ï¼ŒRedisä¼šæŠŠæ¯ä¸€ä¸ªå†™è¯·æ±‚éƒ½è®°å½•åœ¨ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶é‡Œã€‚åœ¨Redisé‡å¯æ—¶ï¼Œä¼šæŠŠAOFæ–‡ä»¶ä¸­è®°å½•çš„æ‰€æœ‰å†™æ“ä½œé¡ºåºæ‰§è¡Œä¸€éï¼Œç¡®ä¿æ•°æ®æ¢å¤åˆ°æœ€æ–°ã€‚ AOFé»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¦‚è¦å¼€å¯ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š 1appendonly yes AOFæä¾›äº†ä¸‰ç§fsyncé…ç½®ï¼Œalways/everysec/noï¼Œé€šè¿‡é…ç½®é¡¹[appendfsync]æŒ‡å®šï¼š appendfsync noï¼šä¸è¿›è¡Œfsyncï¼Œå°†flushæ–‡ä»¶çš„æ—¶æœºäº¤ç»™OSå†³å®šï¼Œé€Ÿåº¦æœ€å¿« appendfsync alwaysï¼šæ¯å†™å…¥ä¸€æ¡æ—¥å¿—å°±è¿›è¡Œä¸€æ¬¡fsyncæ“ä½œï¼Œæ•°æ®å®‰å…¨æ€§æœ€é«˜ï¼Œä½†é€Ÿåº¦æœ€æ…¢ appendfsync everysecï¼šæŠ˜ä¸­çš„åšæ³•ï¼Œäº¤ç”±åå°çº¿ç¨‹æ¯ç§’fsyncä¸€æ¬¡ éšç€AOFä¸æ–­åœ°è®°å½•å†™æ“ä½œæ—¥å¿—ï¼Œå¿…å®šä¼šå‡ºç°ä¸€äº›æ— ç”¨çš„æ—¥å¿—ï¼Œä¾‹å¦‚æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œäº†å‘½ä»¤SET key1 â€œabcâ€ï¼Œåœ¨ä¹‹åæŸä¸ªæ—¶é—´ç‚¹åˆæ‰§è¡Œäº†SET key1 â€œbcdâ€ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¡å‘½ä»¤å¾ˆæ˜¾ç„¶æ˜¯æ²¡æœ‰ç”¨çš„ã€‚å¤§é‡çš„æ— ç”¨æ—¥å¿—ä¼šè®©AOFæ–‡ä»¶è¿‡å¤§ï¼Œä¹Ÿä¼šè®©æ•°æ®æ¢å¤çš„æ—¶é—´è¿‡é•¿ã€‚æ‰€ä»¥Redisæä¾›äº†AOF rewriteåŠŸèƒ½ï¼Œå¯ä»¥é‡å†™AOFæ–‡ä»¶ï¼Œåªä¿ç•™èƒ½å¤ŸæŠŠæ•°æ®æ¢å¤åˆ°æœ€æ–°çŠ¶æ€çš„æœ€å°å†™æ“ä½œé›†ã€‚AOF rewriteå¯ä»¥é€šè¿‡BGREWRITEAOFå‘½ä»¤è§¦å‘ï¼Œä¹Ÿå¯ä»¥é…ç½®Rediså®šæœŸè‡ªåŠ¨è¿›è¡Œï¼š 12auto-aof-rewrite-percentage 100auto-aof-rewrite-min-size 64mb ä¸Šé¢ä¸¤è¡Œé…ç½®çš„å«ä¹‰æ˜¯ï¼ŒRedisåœ¨æ¯æ¬¡AOF rewriteæ—¶ï¼Œä¼šè®°å½•å®Œæˆrewriteåçš„AOFæ—¥å¿—å¤§å°ï¼Œå½“AOFæ—¥å¿—å¤§å°åœ¨è¯¥åŸºç¡€ä¸Šå¢é•¿äº†100%åï¼Œè‡ªåŠ¨è¿›è¡ŒAOF rewriteã€‚åŒæ—¶å¦‚æœå¢é•¿çš„å¤§å°æ²¡æœ‰è¾¾åˆ°64mbï¼Œåˆ™ä¸ä¼šè¿›è¡Œrewriteã€‚ AOFçš„ä¼˜ç‚¹ï¼š æœ€å®‰å…¨ï¼Œåœ¨å¯ç”¨appendfsync alwaysæ—¶ï¼Œä»»ä½•å·²å†™å…¥çš„æ•°æ®éƒ½ä¸ä¼šä¸¢å¤±ï¼Œä½¿ç”¨åœ¨å¯ç”¨appendfsync everysecä¹Ÿè‡³å¤šåªä¼šä¸¢å¤±1ç§’çš„æ•°æ®ã€‚ AOFæ–‡ä»¶åœ¨å‘ç”Ÿæ–­ç”µç­‰é—®é¢˜æ—¶ä¹Ÿä¸ä¼šæŸåï¼Œå³ä½¿å‡ºç°äº†æŸæ¡æ—¥å¿—åªå†™å…¥äº†ä¸€åŠçš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨redis-check-aofå·¥å…·è½»æ¾ä¿®å¤ã€‚ AOFæ–‡ä»¶æ˜“è¯»ï¼Œå¯ä¿®æ”¹ï¼Œåœ¨è¿›è¡Œäº†æŸäº›é”™è¯¯çš„æ•°æ®æ¸…é™¤æ“ä½œåï¼Œåªè¦AOFæ–‡ä»¶æ²¡æœ‰rewriteï¼Œå°±å¯ä»¥æŠŠAOFæ–‡ä»¶å¤‡ä»½å‡ºæ¥ï¼ŒæŠŠé”™è¯¯çš„å‘½ä»¤åˆ é™¤ï¼Œç„¶åæ¢å¤æ•°æ®ã€‚ AOFçš„ç¼ºç‚¹ï¼š AOFæ–‡ä»¶é€šå¸¸æ¯”RDBæ–‡ä»¶æ›´å¤§ æ€§èƒ½æ¶ˆè€—æ¯”RDBé«˜ æ•°æ®æ¢å¤é€Ÿåº¦æ¯”RDBæ…¢ å†…å­˜ç®¡ç†ä¸æ•°æ®æ·˜æ±°æœºåˆ¶æœ€å¤§å†…å­˜è®¾ç½®é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨32ä½OSä¸­ï¼ŒRedisæœ€å¤§ä½¿ç”¨3GBçš„å†…å­˜ï¼Œåœ¨64ä½OSä¸­åˆ™æ²¡æœ‰é™åˆ¶ã€‚ åœ¨ä½¿ç”¨Redisæ—¶ï¼Œåº”è¯¥å¯¹æ•°æ®å ç”¨çš„æœ€å¤§ç©ºé—´æœ‰ä¸€ä¸ªåŸºæœ¬å‡†ç¡®çš„é¢„ä¼°ï¼Œå¹¶ä¸ºRedisè®¾å®šæœ€å¤§ä½¿ç”¨çš„å†…å­˜ã€‚å¦åˆ™åœ¨64ä½OSä¸­Redisä¼šæ— é™åˆ¶åœ°å ç”¨å†…å­˜ï¼ˆå½“ç‰©ç†å†…å­˜è¢«å æ»¡åä¼šä½¿ç”¨swapç©ºé—´ï¼‰ï¼Œå®¹æ˜“å¼•å‘å„ç§å„æ ·çš„é—®é¢˜ã€‚ é€šè¿‡å¦‚ä¸‹é…ç½®æ§åˆ¶Redisä½¿ç”¨çš„æœ€å¤§å†…å­˜ï¼š 1maxmemory 100mb åœ¨å†…å­˜å ç”¨è¾¾åˆ°maxmemoryåï¼Œå†å‘Rediså†™å…¥æ•°æ®æ—¶ï¼ŒRedisä¼šï¼š æ ¹æ®é…ç½®çš„æ•°æ®æ·˜æ±°ç­–ç•¥å°è¯•æ·˜æ±°æ•°æ®ï¼Œé‡Šæ”¾ç©ºé—´ å¦‚æœæ²¡æœ‰æ•°æ®å¯ä»¥æ·˜æ±°ï¼Œæˆ–è€…æ²¡æœ‰é…ç½®æ•°æ®æ·˜æ±°ç­–ç•¥ï¼Œé‚£ä¹ˆRedisä¼šå¯¹æ‰€æœ‰å†™è¯·æ±‚è¿”å›é”™è¯¯ï¼Œä½†è¯»è¯·æ±‚ä»ç„¶å¯ä»¥æ­£å¸¸æ‰§è¡Œ åœ¨ä¸ºRedisè®¾ç½®maxmemoryæ—¶ï¼Œéœ€è¦æ³¨æ„ï¼š å¦‚æœé‡‡ç”¨äº†Redisçš„ä¸»ä»åŒæ­¥ï¼Œä¸»èŠ‚ç‚¹å‘ä»èŠ‚ç‚¹åŒæ­¥æ•°æ®æ—¶ï¼Œä¼šå ç”¨æ‰ä¸€éƒ¨åˆ†å†…å­˜ç©ºé—´ï¼Œå¦‚æœmaxmemoryè¿‡äºæ¥è¿‘ä¸»æœºçš„å¯ç”¨å†…å­˜ï¼Œå¯¼è‡´æ•°æ®åŒæ­¥æ—¶å†…å­˜ä¸è¶³ã€‚æ‰€ä»¥è®¾ç½®çš„maxmemoryä¸è¦è¿‡äºæ¥è¿‘ä¸»æœºå¯ç”¨çš„å†…å­˜ï¼Œç•™å‡ºä¸€éƒ¨åˆ†é¢„ç•™ç”¨ä½œä¸»ä»åŒæ­¥ã€‚ æ•°æ®æ·˜æ±°æœºåˆ¶Redisæä¾›äº†5ç§æ•°æ®æ·˜æ±°ç­–ç•¥ï¼š volatile-lruï¼šä½¿ç”¨LRUç®—æ³•è¿›è¡Œæ•°æ®æ·˜æ±°ï¼ˆæ·˜æ±°ä¸Šæ¬¡ä½¿ç”¨æ—¶é—´æœ€æ—©çš„ï¼Œä¸”ä½¿ç”¨æ¬¡æ•°æœ€å°‘çš„keyï¼‰ï¼Œåªæ·˜æ±°è®¾å®šäº†æœ‰æ•ˆæœŸçš„key allkeys-lruï¼šä½¿ç”¨LRUç®—æ³•è¿›è¡Œæ•°æ®æ·˜æ±°ï¼Œæ‰€æœ‰çš„keyéƒ½å¯ä»¥è¢«æ·˜æ±° volatile-randomï¼šéšæœºæ·˜æ±°æ•°æ®ï¼Œåªæ·˜æ±°è®¾å®šäº†æœ‰æ•ˆæœŸçš„key allkeys-randomï¼šéšæœºæ·˜æ±°æ•°æ®ï¼Œæ‰€æœ‰çš„keyéƒ½å¯ä»¥è¢«æ·˜æ±° volatile-ttlï¼šæ·˜æ±°å‰©ä½™æœ‰æ•ˆæœŸæœ€çŸ­çš„key æœ€å¥½ä¸ºRedisæŒ‡å®šä¸€ç§æœ‰æ•ˆçš„æ•°æ®æ·˜æ±°ç­–ç•¥ä»¥é…åˆmaxmemoryè®¾ç½®ï¼Œé¿å…åœ¨å†…å­˜ä½¿ç”¨æ»¡åå‘ç”Ÿå†™å…¥å¤±è´¥çš„æƒ…å†µã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæ¨èä½¿ç”¨çš„ç­–ç•¥æ˜¯volatile-lruï¼Œå¹¶è¾¨è¯†Redisä¸­ä¿å­˜çš„æ•°æ®çš„é‡è¦æ€§ã€‚å¯¹äºé‚£äº›é‡è¦çš„ï¼Œç»å¯¹ä¸èƒ½ä¸¢å¼ƒçš„æ•°æ®ï¼ˆå¦‚é…ç½®ç±»æ•°æ®ç­‰ï¼‰ï¼Œåº”ä¸è®¾ç½®æœ‰æ•ˆæœŸï¼Œè¿™æ ·Rediså°±æ°¸è¿œä¸ä¼šæ·˜æ±°è¿™äº›æ•°æ®ã€‚å¯¹äºé‚£äº›ç›¸å¯¹ä¸æ˜¯é‚£ä¹ˆé‡è¦çš„ï¼Œå¹¶ä¸”èƒ½å¤Ÿçƒ­åŠ è½½çš„æ•°æ®ï¼ˆæ¯”å¦‚ç¼“å­˜æœ€è¿‘ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå½“åœ¨Redisä¸­æ‰¾ä¸åˆ°æ—¶ï¼Œç¨‹åºä¼šå»DBä¸­è¯»å–ï¼‰ï¼Œå¯ä»¥è®¾ç½®ä¸Šæœ‰æ•ˆæœŸï¼Œè¿™æ ·åœ¨å†…å­˜ä¸å¤Ÿæ—¶Rediså°±ä¼šæ·˜æ±°è¿™éƒ¨åˆ†æ•°æ®ã€‚ é…ç½®æ–¹æ³•ï¼š 1maxmemory-policy volatile-lru #é»˜è®¤æ˜¯noevictionï¼Œå³ä¸è¿›è¡Œæ•°æ®æ·˜æ±° PipelinlingPipelinlingRedisæä¾›è®¸å¤šæ‰¹é‡æ“ä½œçš„å‘½ä»¤ï¼Œå¦‚MSET/MGET/HMSET/HMGETç­‰ç­‰ï¼Œè¿™äº›å‘½ä»¤å­˜åœ¨çš„æ„ä¹‰æ˜¯å‡å°‘ç»´æŠ¤ç½‘ç»œè¿æ¥å’Œä¼ è¾“æ•°æ®æ‰€æ¶ˆè€—çš„èµ„æºå’Œæ—¶é—´ã€‚ä¾‹å¦‚è¿ç»­ä½¿ç”¨5æ¬¡SETå‘½ä»¤è®¾ç½®5ä¸ªä¸åŒçš„keyï¼Œæ¯”èµ·ä½¿ç”¨ä¸€æ¬¡MSETå‘½ä»¤è®¾ç½®5ä¸ªä¸åŒçš„keyï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä½†å‰è€…ä¼šæ¶ˆè€—æ›´å¤šçš„RTT(Round Trip Time)æ—¶é•¿ï¼Œæ°¸è¿œåº”ä¼˜å…ˆä½¿ç”¨åè€…ã€‚ ç„¶è€Œï¼Œå¦‚æœå®¢æˆ·ç«¯è¦è¿ç»­æ‰§è¡Œçš„å¤šæ¬¡æ“ä½œæ— æ³•é€šè¿‡Rediså‘½ä»¤ç»„åˆåœ¨ä¸€èµ·ï¼Œä¾‹å¦‚ï¼š 123SET a &quot;abc&quot;INCR bHSET c name &quot;hi&quot; æ­¤æ—¶ä¾¿å¯ä»¥ä½¿ç”¨Redisæä¾›çš„pipeliningåŠŸèƒ½æ¥å®ç°åœ¨ä¸€æ¬¡äº¤äº’ä¸­æ‰§è¡Œå¤šæ¡å‘½ä»¤ã€‚ä½¿ç”¨pipeliningæ—¶ï¼Œåªéœ€è¦ä»å®¢æˆ·ç«¯ä¸€æ¬¡å‘Rediså‘é€å¤šæ¡å‘½ä»¤ï¼ˆä»¥\\r\\nï¼‰åˆ†éš”ï¼ŒRediså°±ä¼šä¾æ¬¡æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œå¹¶ä¸”æŠŠæ¯ä¸ªå‘½ä»¤çš„è¿”å›æŒ‰é¡ºåºç»„è£…åœ¨ä¸€èµ·ä¸€æ¬¡è¿”å›ï¼Œæ¯”å¦‚ï¼š 1234$ (printf &quot;PING\\r\\nPING\\r\\nPING\\r\\n&quot;; sleep 1) | nc localhost 6379+PONG+PONG+PONG å¤§éƒ¨åˆ†çš„Rediså®¢æˆ·ç«¯éƒ½å¯¹Pipeliningæä¾›æ”¯æŒï¼Œæ‰€ä»¥å¼€å‘è€…é€šå¸¸å¹¶ä¸éœ€è¦è‡ªå·±æ‰‹å·¥æ‹¼è£…å‘½ä»¤åˆ—è¡¨ã€‚ Pipeliningçš„å±€é™æ€§Pipeliningåªèƒ½ç”¨äºæ‰§è¡Œè¿ç»­ä¸”æ— ç›¸å…³æ€§çš„å‘½ä»¤ï¼Œå½“æŸä¸ªå‘½ä»¤çš„ç”Ÿæˆéœ€è¦ä¾èµ–äºå‰ä¸€ä¸ªå‘½ä»¤çš„è¿”å›æ—¶ï¼Œå°±æ— æ³•ä½¿ç”¨Pipeliningäº†ã€‚ é€šè¿‡ScriptingåŠŸèƒ½ï¼Œå¯ä»¥è§„é¿è¿™ä¸€å±€é™æ€§ äº‹åŠ¡ä¸ScriptingPipeliningèƒ½å¤Ÿè®©Redisåœ¨ä¸€æ¬¡äº¤äº’ä¸­å¤„ç†å¤šæ¡å‘½ä»¤ï¼Œç„¶è€Œåœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨æ­¤åŸºç¡€ä¸Šç¡®ä¿è¿™ä¸€ç»„å‘½ä»¤æ˜¯è¿ç»­æ‰§è¡Œçš„ã€‚ æ¯”å¦‚è·å–å½“å‰ç´¯è®¡çš„PVæ•°å¹¶å°†å…¶æ¸…0 1234&gt; GET vCount12384&gt; SET vCount 0OK å¦‚æœåœ¨GETå’ŒSETå‘½ä»¤ä¹‹é—´æ’è¿›æ¥ä¸€ä¸ªINCR vCountï¼Œå°±ä¼šä½¿å®¢æˆ·ç«¯æ‹¿åˆ°çš„vCountä¸å‡†ç¡®ã€‚ Redisçš„äº‹åŠ¡å¯ä»¥ç¡®ä¿å¤æ•°å‘½ä»¤æ‰§è¡Œæ—¶çš„åŸå­æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´Redisèƒ½å¤Ÿä¿è¯ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­çš„ä¸€ç»„å‘½ä»¤æ˜¯ç»å¯¹è¿ç»­æ‰§è¡Œçš„ï¼Œåœ¨è¿™äº›å‘½ä»¤æ‰§è¡Œå®Œæˆä¹‹å‰ï¼Œç»å¯¹ä¸ä¼šæœ‰æ¥è‡ªäºå…¶ä»–è¿æ¥çš„å…¶ä»–å‘½ä»¤æ’è¿›å»æ‰§è¡Œã€‚ é€šè¿‡MULTIå’ŒEXECå‘½ä»¤æ¥æŠŠè¿™ä¸¤ä¸ªå‘½ä»¤åŠ å…¥ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼š 123456789&gt; MULTIOK&gt; GET vCountQUEUED&gt; SET vCount 0QUEUED&gt; EXEC1) 123842) OK Redisåœ¨æ¥æ”¶åˆ°MULTIå‘½ä»¤åä¾¿ä¼šå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œè¿™ä¹‹åçš„æ‰€æœ‰è¯»å†™å‘½ä»¤éƒ½ä¼šä¿å­˜åœ¨é˜Ÿåˆ—ä¸­ä½†å¹¶ä¸æ‰§è¡Œï¼Œç›´åˆ°æ¥æ”¶åˆ°EXECå‘½ä»¤åï¼ŒRedisä¼šæŠŠé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤è¿ç»­é¡ºåºæ‰§è¡Œï¼Œå¹¶ä»¥æ•°ç»„å½¢å¼è¿”å›æ¯ä¸ªå‘½ä»¤çš„è¿”å›ç»“æœã€‚ å¯ä»¥ä½¿ç”¨DISCARDå‘½ä»¤æ”¾å¼ƒå½“å‰çš„äº‹åŠ¡ï¼Œå°†ä¿å­˜çš„å‘½ä»¤é˜Ÿåˆ—æ¸…ç©ºã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRedisäº‹åŠ¡ä¸æ”¯æŒå›æ»šï¼šå¦‚æœä¸€ä¸ªäº‹åŠ¡ä¸­çš„å‘½ä»¤å‡ºç°äº†è¯­æ³•é”™è¯¯ï¼Œå¤§éƒ¨åˆ†å®¢æˆ·ç«¯é©±åŠ¨ä¼šè¿”å›é”™è¯¯ï¼Œ2.6.5ç‰ˆæœ¬ä»¥ä¸Šçš„Redisä¹Ÿä¼šåœ¨æ‰§è¡ŒEXECæ—¶æ£€æŸ¥é˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ˜¯å¦å­˜åœ¨è¯­æ³•é”™è¯¯ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨æ”¾å¼ƒäº‹åŠ¡å¹¶è¿”å›é”™è¯¯ã€‚ä½†å¦‚æœä¸€ä¸ªäº‹åŠ¡ä¸­çš„å‘½ä»¤æœ‰éè¯­æ³•ç±»çš„é”™è¯¯ï¼ˆæ¯”å¦‚å¯¹Stringæ‰§è¡ŒHSETæ“ä½œï¼‰ï¼Œæ— è®ºå®¢æˆ·ç«¯é©±åŠ¨è¿˜æ˜¯Rediséƒ½æ— æ³•åœ¨çœŸæ­£æ‰§è¡Œè¿™æ¡å‘½ä»¤ä¹‹å‰å‘ç°ï¼Œæ‰€ä»¥äº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ä»ç„¶ä¼šè¢«ä¾æ¬¡æ‰§è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°ä¸€ä¸ªäº‹åŠ¡ä¸­éƒ¨åˆ†å‘½ä»¤æˆåŠŸéƒ¨åˆ†å‘½ä»¤å¤±è´¥çš„æƒ…å†µï¼Œç„¶è€Œä¸RDBMSä¸åŒï¼ŒRedisä¸æä¾›äº‹åŠ¡å›æ»šçš„åŠŸèƒ½ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡å…¶ä»–æ–¹æ³•è¿›è¡Œæ•°æ®çš„å›æ»šã€‚ é€šè¿‡äº‹åŠ¡å®ç°CASRedisæä¾›äº†WATCHå‘½ä»¤ä¸äº‹åŠ¡æ­é…ä½¿ç”¨ï¼Œå®ç°CASä¹è§‚é”çš„æœºåˆ¶ã€‚ å‡è®¾è¦å®ç°å°†æŸä¸ªå•†å“çš„çŠ¶æ€æ”¹ä¸ºå·²å”®ï¼š 12if(exec(HGET stock:1001 state) == &quot;in stock&quot;) exec(HSET stock:1001 state &quot;sold&quot;); è¿™ä¸€ä¼ªä»£ç æ‰§è¡Œæ—¶ï¼Œæ— æ³•ç¡®ä¿å¹¶å‘å®‰å…¨æ€§ï¼Œæœ‰å¯èƒ½å¤šä¸ªå®¢æˆ·ç«¯éƒ½è·å–åˆ°äº†â€in stockâ€çš„çŠ¶æ€ï¼Œå¯¼è‡´ä¸€ä¸ªåº“å­˜è¢«å”®å–å¤šæ¬¡ã€‚ ä½¿ç”¨WATCHå‘½ä»¤å’Œäº‹åŠ¡å¯ä»¥è§£å†³è¿™ä¸€é—®é¢˜ï¼š 123456exec(WATCH stock:1001);if(exec(HGET stock:1001 state) == &quot;in stock&quot;) &#123; exec(MULTI); exec(HSET stock:1001 state &quot;sold&quot;); exec(EXEC);&#125; WATCHçš„æœºåˆ¶æ˜¯ï¼šåœ¨äº‹åŠ¡EXECå‘½ä»¤æ‰§è¡Œæ—¶ï¼ŒRedisä¼šæ£€æŸ¥è¢«WATCHçš„keyï¼Œåªæœ‰è¢«WATCHçš„keyä»WATCHèµ·å§‹æ—¶è‡³ä»Šæ²¡æœ‰å‘ç”Ÿè¿‡å˜æ›´ï¼ŒEXECæ‰ä¼šè¢«æ‰§è¡Œã€‚å¦‚æœWATCHçš„keyåœ¨WATCHå‘½ä»¤åˆ°EXECå‘½ä»¤ä¹‹é—´å‘ç”Ÿè¿‡å˜åŒ–ï¼Œåˆ™EXECå‘½ä»¤ä¼šè¿”å›å¤±è´¥ã€‚ Scriptingé€šè¿‡EVALä¸EVALSHAå‘½ä»¤ï¼Œå¯ä»¥è®©Redisæ‰§è¡ŒLUAè„šæœ¬ã€‚è¿™å°±ç±»ä¼¼äºRDBMSçš„å­˜å‚¨è¿‡ç¨‹ä¸€æ ·ï¼Œå¯ä»¥æŠŠå®¢æˆ·ç«¯ä¸Redisä¹‹é—´å¯†é›†çš„è¯»/å†™äº¤äº’æ”¾åœ¨æœåŠ¡ç«¯è¿›è¡Œï¼Œé¿å…è¿‡å¤šçš„æ•°æ®äº¤äº’ï¼Œæå‡æ€§èƒ½ã€‚ ScriptingåŠŸèƒ½æ˜¯ä½œä¸ºäº‹åŠ¡åŠŸèƒ½çš„æ›¿ä»£è€…è¯ç”Ÿçš„ï¼Œäº‹åŠ¡æä¾›çš„æ‰€æœ‰èƒ½åŠ›Scriptingéƒ½å¯ä»¥åšåˆ°ã€‚Rediså®˜æ–¹æ¨èä½¿ç”¨LUA Scriptæ¥ä»£æ›¿äº‹åŠ¡ï¼Œå‰è€…çš„æ•ˆç‡å’Œä¾¿åˆ©æ€§éƒ½è¶…è¿‡äº†äº‹åŠ¡ã€‚ Redisæ€§èƒ½è°ƒä¼˜å°½ç®¡Redisæ˜¯ä¸€ä¸ªéå¸¸å¿«é€Ÿçš„å†…å­˜æ•°æ®å­˜å‚¨åª’ä»‹ï¼Œä¹Ÿå¹¶ä¸ä»£è¡¨Redisä¸ä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜ã€‚å‰æ–‡ä¸­æåˆ°è¿‡ï¼ŒRedisé‡‡ç”¨å•çº¿ç¨‹æ¨¡å‹ï¼Œæ‰€æœ‰çš„å‘½ä»¤éƒ½æ˜¯ç”±ä¸€ä¸ªçº¿ç¨‹ä¸²è¡Œæ‰§è¡Œçš„ï¼Œæ‰€ä»¥å½“æŸä¸ªå‘½ä»¤æ‰§è¡Œè€—æ—¶è¾ƒé•¿æ—¶ï¼Œä¼šæ‹–æ…¢å…¶åçš„æ‰€æœ‰å‘½ä»¤ï¼Œè¿™ä½¿å¾—Rediså¯¹æ¯ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ•ˆç‡æ›´åŠ æ•æ„Ÿã€‚ é’ˆå¯¹Redisçš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¸»è¦ä»ä¸‹é¢å‡ ä¸ªå±‚é¢å…¥æ‰‹ï¼š æœ€åˆçš„ä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼Œç¡®ä¿æ²¡æœ‰è®©Redisæ‰§è¡Œè€—æ—¶é•¿çš„å‘½ä»¤ ä½¿ç”¨pipeliningå°†è¿ç»­æ‰§è¡Œçš„å‘½ä»¤ç»„åˆæ‰§è¡Œ æ“ä½œç³»ç»Ÿçš„Transparent huge pagesåŠŸèƒ½å¿…é¡»å…³é—­ï¼š 1echo never &gt; /sys/kernel/mm/transparent_hugepage/enable å¦‚æœåœ¨è™šæ‹Ÿæœºä¸­è¿è¡ŒRedisï¼Œå¯èƒ½å¤©ç„¶å°±æœ‰è™šæ‹Ÿæœºç¯å¢ƒå¸¦æ¥çš„å›ºæœ‰å»¶è¿Ÿã€‚å¯ä»¥é€šè¿‡./redis-cli â€“intrinsic-latency 100å‘½ä»¤æŸ¥çœ‹å›ºæœ‰å»¶è¿Ÿã€‚åŒæ—¶å¦‚æœå¯¹Redisçš„æ€§èƒ½æœ‰è¾ƒé«˜è¦æ±‚çš„è¯ï¼Œåº”å°½å¯èƒ½åœ¨ç‰©ç†æœºä¸Šç›´æ¥éƒ¨ç½²Redisã€‚ æ£€æŸ¥æ•°æ®æŒä¹…åŒ–ç­–ç•¥ è€ƒè™‘å¼•å…¥è¯»å†™åˆ†ç¦»æœºåˆ¶ é•¿è€—æ—¶å‘½ä»¤Redisç»å¤§å¤šæ•°è¯»å†™å‘½ä»¤çš„æ—¶é—´å¤æ‚åº¦éƒ½åœ¨O(1)åˆ°O(N)ä¹‹é—´ï¼Œåœ¨æ–‡æœ¬å’Œå®˜æ–¹æ–‡æ¡£ä¸­å‡å¯¹æ¯ä¸ªå‘½ä»¤çš„æ—¶é—´å¤æ‚åº¦æœ‰è¯´æ˜ã€‚ é€šå¸¸æ¥è¯´ï¼ŒO(1)çš„å‘½ä»¤æ˜¯å®‰å…¨çš„ï¼ŒO(N)å‘½ä»¤åœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ï¼Œå¦‚æœNçš„æ•°é‡çº§ä¸å¯é¢„çŸ¥ï¼Œåˆ™åº”é¿å…ä½¿ç”¨ã€‚ä¾‹å¦‚å¯¹ä¸€ä¸ªfieldæ•°æœªçŸ¥çš„Hashæ•°æ®æ‰§è¡ŒHGETALL/HKEYS/HVALSå‘½ä»¤ï¼Œé€šå¸¸æ¥è¯´è¿™äº›å‘½ä»¤æ‰§è¡Œçš„å¾ˆå¿«ï¼Œä½†å¦‚æœè¿™ä¸ªHashä¸­çš„fieldæ•°é‡æå¤šï¼Œè€—æ—¶å°±ä¼šæˆå€å¢é•¿ã€‚åˆå¦‚ä½¿ç”¨SUNIONå¯¹ä¸¤ä¸ªSetæ‰§è¡ŒUnionæ“ä½œï¼Œæˆ–ä½¿ç”¨SORTå¯¹List/Setæ‰§è¡Œæ’åºæ“ä½œç­‰æ—¶ï¼Œéƒ½åº”è¯¥ä¸¥åŠ æ³¨æ„ã€‚ é¿å…åœ¨ä½¿ç”¨è¿™äº›O(N)å‘½ä»¤æ—¶å‘ç”Ÿé—®é¢˜ä¸»è¦æœ‰å‡ ä¸ªåŠæ³•ï¼š ä¸è¦æŠŠListå½“åšåˆ—è¡¨ä½¿ç”¨ï¼Œä»…å½“åšé˜Ÿåˆ—æ¥ä½¿ç”¨ é€šè¿‡æœºåˆ¶ä¸¥æ ¼æ§åˆ¶Hashã€Setã€Sorted Setçš„å¤§å° å¯èƒ½çš„è¯ï¼Œå°†æ’åºã€å¹¶é›†ã€äº¤é›†ç­‰æ“ä½œæ”¾åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ ç»å¯¹ç¦æ­¢ä½¿ç”¨KEYSå‘½ä»¤ é¿å…ä¸€æ¬¡æ€§éå†é›†åˆç±»å‹çš„æ‰€æœ‰æˆå‘˜ï¼Œè€Œåº”ä½¿ç”¨SCANç±»çš„å‘½ä»¤è¿›è¡Œåˆ†æ‰¹çš„ï¼Œæ¸¸æ ‡å¼çš„éå† Redisæä¾›äº†SCANå‘½ä»¤ï¼Œå¯ä»¥å¯¹Redisä¸­å­˜å‚¨çš„æ‰€æœ‰keyè¿›è¡Œæ¸¸æ ‡å¼çš„éå†ï¼Œé¿å…ä½¿ç”¨KEYSå‘½ä»¤å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚åŒæ—¶è¿˜æœ‰SSCAN/HSCAN/ZSCANç­‰å‘½ä»¤ï¼Œåˆ†åˆ«ç”¨äºå¯¹Set/Hash/Sorted Setä¸­çš„å…ƒç´ è¿›è¡Œæ¸¸æ ‡å¼éå†ã€‚ Redisæä¾›äº†Slow LogåŠŸèƒ½ï¼Œå¯ä»¥è‡ªåŠ¨è®°å½•è€—æ—¶è¾ƒé•¿çš„å‘½ä»¤ã€‚ç›¸å…³çš„é…ç½®å‚æ•°æœ‰ä¸¤ä¸ªï¼š 12slowlog-log-slower-than xxxms #æ‰§è¡Œæ—¶é—´æ…¢äºxxxæ¯«ç§’çš„å‘½ä»¤è®¡å…¥Slow Logslowlog-max-len xxx #Slow Logçš„é•¿åº¦ï¼Œå³æœ€å¤§çºªå½•å¤šå°‘æ¡Slow Log ä½¿ç”¨SLOWLOG GET [number]å‘½ä»¤ï¼Œå¯ä»¥è¾“å‡ºæœ€è¿‘è¿›å…¥Slow Logçš„numberæ¡å‘½ä»¤ã€‚ä½¿ç”¨SLOWLOG RESETå‘½ä»¤ï¼Œå¯ä»¥é‡ç½®Slow Log ç½‘ç»œå¼•å‘çš„å»¶è¿Ÿ å°½å¯èƒ½ä½¿ç”¨é•¿è¿æ¥æˆ–è¿æ¥æ± ï¼Œé¿å…é¢‘ç¹åˆ›å»ºé”€æ¯è¿æ¥ å®¢æˆ·ç«¯è¿›è¡Œçš„æ‰¹é‡æ•°æ®æ“ä½œï¼Œåº”ä½¿ç”¨Pipelineç‰¹æ€§åœ¨ä¸€æ¬¡äº¤äº’ä¸­å®Œæˆã€‚å…·ä½“è¯·å‚ç…§æœ¬æ–‡çš„Pipeliningç« èŠ‚ æ•°æ®æŒä¹…åŒ–å¼•å‘çš„å»¶è¿ŸRedisçš„æ•°æ®æŒä¹…åŒ–å·¥ä½œæœ¬èº«å°±ä¼šå¸¦æ¥å»¶è¿Ÿï¼Œéœ€è¦æ ¹æ®æ•°æ®çš„å®‰å…¨çº§åˆ«å’Œæ€§èƒ½è¦æ±‚åˆ¶å®šåˆç†çš„æŒä¹…åŒ–ç­–ç•¥ï¼š AOF + fsync alwaysçš„è®¾ç½®è™½ç„¶èƒ½å¤Ÿç»å¯¹ç¡®ä¿æ•°æ®å®‰å…¨ï¼Œä½†æ¯ä¸ªæ“ä½œéƒ½ä¼šè§¦å‘ä¸€æ¬¡fsyncï¼Œä¼šå¯¹Redisçš„æ€§èƒ½æœ‰æ¯”è¾ƒæ˜æ˜¾çš„å½±å“ AOF + fsync every secondæ˜¯æ¯”è¾ƒå¥½çš„æŠ˜ä¸­æ–¹æ¡ˆï¼Œæ¯ç§’fsyncä¸€æ¬¡ AOF + fsync neverä¼šæä¾›AOFæŒä¹…åŒ–æ–¹æ¡ˆä¸‹çš„æœ€ä¼˜æ€§èƒ½ ä½¿ç”¨RDBæŒä¹…åŒ–é€šå¸¸ä¼šæä¾›æ¯”ä½¿ç”¨AOFæ›´é«˜çš„æ€§èƒ½ï¼Œä½†éœ€è¦æ³¨æ„RDBçš„ç­–ç•¥é…ç½® æ¯ä¸€æ¬¡RDBå¿«ç…§å’ŒAOF Rewriteéƒ½éœ€è¦Redisä¸»è¿›ç¨‹è¿›è¡Œforkæ“ä½œã€‚forkæ“ä½œæœ¬èº«å¯èƒ½ä¼šäº§ç”Ÿè¾ƒé«˜çš„è€—æ—¶ï¼Œä¸CPUå’ŒRediså ç”¨çš„å†…å­˜å¤§å°æœ‰å…³ã€‚æ ¹æ®å…·ä½“çš„æƒ…å†µåˆç†é…ç½®RDBå¿«ç…§å’ŒAOF Rewriteæ—¶æœºï¼Œé¿å…è¿‡äºé¢‘ç¹çš„forkå¸¦æ¥çš„å»¶è¿Ÿ 1Redisåœ¨forkå­è¿›ç¨‹æ—¶éœ€è¦å°†å†…å­˜åˆ†é¡µè¡¨æ‹·è´è‡³å­è¿›ç¨‹ï¼Œä»¥å ç”¨äº†24GBå†…å­˜çš„Rediså®ä¾‹ä¸ºä¾‹ï¼Œå…±éœ€è¦æ‹·è´24GB / 4kB * 8 = 48MBçš„æ•°æ®ã€‚åœ¨ä½¿ç”¨å•Xeon 2.27Ghzçš„ç‰©ç†æœºä¸Šï¼Œè¿™ä¸€forkæ“ä½œè€—æ—¶216msã€‚ 1å¯ä»¥é€šè¿‡INFOå‘½ä»¤è¿”å›çš„latest_fork_usecå­—æ®µæŸ¥çœ‹ä¸Šä¸€æ¬¡forkæ“ä½œçš„è€—æ—¶ï¼ˆå¾®ç§’ï¼‰ Swapå¼•å‘çš„å»¶è¿Ÿå½“Linuxå°†Redisæ‰€ç”¨çš„å†…å­˜åˆ†é¡µç§»è‡³swapç©ºé—´æ—¶ï¼Œå°†ä¼šé˜»å¡Redisè¿›ç¨‹ï¼Œå¯¼è‡´Rediså‡ºç°ä¸æ­£å¸¸çš„å»¶è¿Ÿã€‚Swapé€šå¸¸åœ¨ç‰©ç†å†…å­˜ä¸è¶³æˆ–ä¸€äº›è¿›ç¨‹åœ¨è¿›è¡Œå¤§é‡I/Oæ“ä½œæ—¶å‘ç”Ÿï¼Œåº”å°½å¯èƒ½é¿å…ä¸Šè¿°ä¸¤ç§æƒ…å†µçš„å‡ºç°ã€‚ /proc//smapsæ–‡ä»¶ä¸­ä¼šä¿å­˜è¿›ç¨‹çš„swapè®°å½•ï¼Œé€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œèƒ½å¤Ÿåˆ¤æ–­Redisçš„å»¶è¿Ÿæ˜¯å¦ç”±Swapäº§ç”Ÿã€‚å¦‚æœè¿™ä¸ªæ–‡ä»¶ä¸­è®°å½•äº†è¾ƒå¤§çš„Swap sizeï¼Œåˆ™è¯´æ˜å»¶è¿Ÿå¾ˆæœ‰å¯èƒ½æ˜¯Swapé€ æˆçš„ã€‚ æ•°æ®æ·˜æ±°å¼•å‘çš„å»¶è¿Ÿå½“åŒä¸€ç§’å†…æœ‰å¤§é‡keyè¿‡æœŸæ—¶ï¼Œä¹Ÿä¼šå¼•å‘Redisçš„å»¶è¿Ÿã€‚åœ¨ä½¿ç”¨æ—¶åº”å°½é‡å°†keyçš„å¤±æ•ˆæ—¶é—´é”™å¼€ã€‚ å¼•å…¥è¯»å†™åˆ†ç¦»æœºåˆ¶Redisçš„ä¸»ä»å¤åˆ¶èƒ½åŠ›å¯ä»¥å®ç°ä¸€ä¸»å¤šä»çš„å¤šèŠ‚ç‚¹æ¶æ„ï¼Œåœ¨è¿™ä¸€æ¶æ„ä¸‹ï¼Œä¸»èŠ‚ç‚¹æ¥æ”¶æ‰€æœ‰å†™è¯·æ±‚ï¼Œå¹¶å°†æ•°æ®åŒæ­¥ç»™å¤šä¸ªä»èŠ‚ç‚¹ã€‚åœ¨è¿™ä¸€åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è®©ä»èŠ‚ç‚¹æä¾›å¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„è¯»è¯·æ±‚æœåŠ¡ï¼Œä»¥å‡å°ä¸»èŠ‚ç‚¹çš„å‹åŠ›ã€‚å°¤å…¶æ˜¯é’ˆå¯¹ä¸€äº›ä½¿ç”¨äº†é•¿è€—æ—¶å‘½ä»¤çš„ç»Ÿè®¡ç±»ä»»åŠ¡ï¼Œå®Œå…¨å¯ä»¥æŒ‡å®šåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼Œé¿å…è¿™äº›é•¿è€—æ—¶å‘½ä»¤å½±å“å…¶ä»–è¯·æ±‚çš„å“åº”ã€‚ ä¸»ä»å¤åˆ¶ä¸é›†ç¾¤åˆ†ç‰‡ä¸»ä»å¤åˆ¶Redisæ”¯æŒä¸€ä¸»å¤šä»çš„ä¸»ä»å¤åˆ¶æ¶æ„ã€‚ä¸€ä¸ªMasterå®ä¾‹è´Ÿè´£å¤„ç†æ‰€æœ‰çš„å†™è¯·æ±‚ï¼ŒMasterå°†å†™æ“ä½œåŒæ­¥è‡³æ‰€æœ‰Slaveã€‚å€ŸåŠ©Redisçš„ä¸»ä»å¤åˆ¶ï¼Œå¯ä»¥å®ç°è¯»å†™åˆ†ç¦»å’Œé«˜å¯ç”¨ï¼š å®æ—¶æ€§è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜çš„è¯»è¯·æ±‚ï¼Œå¯ä»¥åœ¨Slaveä¸Šå®Œæˆï¼Œæå‡æ•ˆç‡ã€‚ç‰¹åˆ«æ˜¯ä¸€äº›å‘¨æœŸæ€§æ‰§è¡Œçš„ç»Ÿè®¡ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡å¯èƒ½éœ€è¦æ‰§è¡Œä¸€äº›é•¿è€—æ—¶çš„Rediså‘½ä»¤ï¼Œå¯ä»¥ä¸“é—¨è§„åˆ’å‡º1ä¸ªæˆ–å‡ ä¸ªSlaveç”¨äºæœåŠ¡è¿™äº›ç»Ÿè®¡ä»»åŠ¡ å€ŸåŠ©Redis Sentinelå¯ä»¥å®ç°é«˜å¯ç”¨ï¼Œå½“Master crashåï¼ŒRedis Sentinelèƒ½å¤Ÿè‡ªåŠ¨å°†ä¸€ä¸ªSlaveæ™‹å‡ä¸ºMasterï¼Œç»§ç»­æä¾›æœåŠ¡ å¯ç”¨ä¸»ä»å¤åˆ¶éå¸¸ç®€å•ï¼Œåªéœ€è¦é…ç½®å¤šä¸ªRediså®ä¾‹ï¼Œåœ¨ä½œä¸ºSlaveçš„Rediså®ä¾‹ä¸­é…ç½®ï¼š 1slaveof 192.168.1.1 6379 #æŒ‡å®šMasterçš„IPå’Œç«¯å£ å½“Slaveå¯åŠ¨åï¼Œä¼šä»Masterè¿›è¡Œä¸€æ¬¡å†·å¯åŠ¨æ•°æ®åŒæ­¥ï¼Œç”±Masterè§¦å‘BGSAVEç”ŸæˆRDBæ–‡ä»¶æ¨é€ç»™Slaveè¿›è¡Œå¯¼å…¥ï¼Œå¯¼å…¥å®ŒæˆåMasterå†å°†å¢é‡æ•°æ®é€šè¿‡Redis ProtocolåŒæ­¥ç»™Slaveã€‚ä¹‹åä¸»ä»ä¹‹é—´çš„æ•°æ®ä¾¿ä¸€ç›´ä»¥Redis Protocolè¿›è¡ŒåŒæ­¥ ä½¿ç”¨Sentinelåšè‡ªåŠ¨failoverRedisçš„ä¸»ä»å¤åˆ¶åŠŸèƒ½æœ¬èº«åªæ˜¯åšæ•°æ®åŒæ­¥ï¼Œå¹¶ä¸æä¾›ç›‘æ§å’Œè‡ªåŠ¨failoverèƒ½åŠ›ï¼Œè¦é€šè¿‡ä¸»ä»å¤åˆ¶åŠŸèƒ½æ¥å®ç°Redisçš„é«˜å¯ç”¨ï¼Œè¿˜éœ€è¦å¼•å…¥ä¸€ä¸ªç»„ä»¶ï¼šRedis Sentinel Redis Sentinelæ˜¯Rediså®˜æ–¹å¼€å‘çš„ç›‘æ§ç»„ä»¶ï¼Œå¯ä»¥ç›‘æ§Rediså®ä¾‹çš„çŠ¶æ€ï¼Œé€šè¿‡MasterèŠ‚ç‚¹è‡ªåŠ¨å‘ç°SlaveèŠ‚ç‚¹ï¼Œå¹¶åœ¨ç›‘æµ‹åˆ°MasterèŠ‚ç‚¹å¤±æ•ˆæ—¶é€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„Masterï¼Œå¹¶å‘æ‰€æœ‰Rediså®ä¾‹æ¨é€æ–°çš„ä¸»ä»é…ç½®ã€‚ Redis Sentineléœ€è¦è‡³å°‘éƒ¨ç½²3ä¸ªå®ä¾‹æ‰èƒ½å½¢æˆé€‰ä¸¾å…³ç³»ã€‚ å…³é”®é…ç½®ï¼š 1234sentinel monitor mymaster 127.0.0.1 6379 2 #Masterå®ä¾‹çš„IPã€ç«¯å£ï¼Œä»¥åŠé€‰ä¸¾éœ€è¦çš„èµæˆç¥¨æ•°sentinel down-after-milliseconds mymaster 60000 #å¤šé•¿æ—¶é—´æ²¡æœ‰å“åº”è§†ä¸ºMasterå¤±æ•ˆsentinel failover-timeout mymaster 180000 #ä¸¤æ¬¡failoverå°è¯•é—´çš„é—´éš”æ—¶é•¿sentinel parallel-syncs mymaster 1 #å¦‚æœæœ‰å¤šä¸ªSlaveï¼Œå¯ä»¥é€šè¿‡æ­¤é…ç½®æŒ‡å®šåŒæ—¶ä»æ–°Masterè¿›è¡Œæ•°æ®åŒæ­¥çš„Slaveæ•°ï¼Œé¿å…æ‰€æœ‰SlaveåŒæ—¶è¿›è¡Œæ•°æ®åŒæ­¥å¯¼è‡´æŸ¥è¯¢æœåŠ¡ä¹Ÿä¸å¯ç”¨ å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRedis Sentinelå®ç°çš„è‡ªåŠ¨failoverä¸æ˜¯åœ¨åŒä¸€ä¸ªIPå’Œç«¯å£ä¸Šå®Œæˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´è‡ªåŠ¨failoveräº§ç”Ÿçš„æ–°Masteræä¾›æœåŠ¡çš„IPå’Œç«¯å£ä¸ä¹‹å‰çš„Masteræ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¦å®ç°HAï¼Œè¿˜è¦æ±‚å®¢æˆ·ç«¯å¿…é¡»æ”¯æŒSentinelï¼Œèƒ½å¤Ÿä¸Sentineläº¤äº’è·å¾—æ–°Masterçš„ä¿¡æ¯æ‰è¡Œã€‚ é›†ç¾¤åˆ†ç‰‡ä¸ºä½•è¦åšé›†ç¾¤åˆ†ç‰‡ï¼š Redisä¸­å­˜å‚¨çš„æ•°æ®é‡å¤§ï¼Œä¸€å°ä¸»æœºçš„ç‰©ç†å†…å­˜å·²ç»æ— æ³•å®¹çº³ Redisçš„å†™è¯·æ±‚å¹¶å‘é‡å¤§ï¼Œä¸€ä¸ªRediså®ä¾‹ä»¥æ— æ³•æ‰¿è½½ å½“ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜å‡ºç°æ—¶ï¼Œå°±å¿…é¡»è¦å¯¹Redisè¿›è¡Œåˆ†ç‰‡äº†ã€‚Redisçš„åˆ†ç‰‡æ–¹æ¡ˆæœ‰å¾ˆå¤šç§ï¼Œä¾‹å¦‚å¾ˆå¤šRedisçš„å®¢æˆ·ç«¯éƒ½è‡ªè¡Œå®ç°äº†åˆ†ç‰‡åŠŸèƒ½ï¼Œä¹Ÿæœ‰å‘Twemproxyè¿™æ ·çš„ä»¥ä»£ç†æ–¹å¼å®ç°çš„Redisåˆ†ç‰‡æ–¹æ¡ˆã€‚ç„¶è€Œé¦–é€‰çš„æ–¹æ¡ˆè¿˜åº”è¯¥æ˜¯Rediså®˜æ–¹åœ¨3.0ç‰ˆæœ¬ä¸­æ¨å‡ºçš„Redis Clusteråˆ†ç‰‡æ–¹æ¡ˆã€‚ æœ¬æ–‡ä¸ä¼šå¯¹Redis Clusterçš„å…·ä½“å®‰è£…å’Œéƒ¨ç½²ç»†èŠ‚è¿›è¡Œä»‹ç»ï¼Œé‡ç‚¹ä»‹ç»Redis Clusterå¸¦æ¥çš„å¥½å¤„ä¸å¼Šç«¯ã€‚ Redis Clusterçš„èƒ½åŠ› èƒ½å¤Ÿè‡ªåŠ¨å°†æ•°æ®åˆ†æ•£åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Š å½“è®¿é—®çš„keyä¸åœ¨å½“å‰åˆ†ç‰‡ä¸Šæ—¶ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å°†è¯·æ±‚è½¬å‘è‡³æ­£ç¡®çš„åˆ†ç‰‡ å½“é›†ç¾¤ä¸­éƒ¨åˆ†èŠ‚ç‚¹å¤±æ•ˆæ—¶ä»èƒ½æä¾›æœåŠ¡ å…¶ä¸­ç¬¬ä¸‰ç‚¹æ˜¯åŸºäºä¸»ä»å¤åˆ¶æ¥å®ç°çš„ï¼ŒRedis Clusterçš„æ¯ä¸ªæ•°æ®åˆ†ç‰‡éƒ½é‡‡ç”¨äº†ä¸»ä»å¤åˆ¶çš„ç»“æ„ï¼ŒåŸç†å’Œå‰æ–‡æ‰€è¿°çš„ä¸»ä»å¤åˆ¶å®Œå…¨ä¸€è‡´ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯çœå»äº†Redis Sentinelè¿™ä¸€é¢å¤–çš„ç»„ä»¶ï¼Œç”±Redis Clusterè´Ÿè´£è¿›è¡Œä¸€ä¸ªåˆ†ç‰‡å†…éƒ¨çš„èŠ‚ç‚¹ç›‘æ§å’Œè‡ªåŠ¨failoverã€‚ Redis Clusteråˆ†ç‰‡åŸç†Redis Clusterä¸­å…±æœ‰16384ä¸ªhash slotï¼ŒRedisä¼šè®¡ç®—æ¯ä¸ªkeyçš„CRC16ï¼Œå°†ç»“æœä¸16384å–æ¨¡ï¼Œæ¥å†³å®šè¯¥keyå­˜å‚¨åœ¨å“ªä¸€ä¸ªhash slotä¸­ï¼ŒåŒæ—¶éœ€è¦æŒ‡å®šRedis Clusterä¸­æ¯ä¸ªæ•°æ®åˆ†ç‰‡è´Ÿè´£çš„Slotæ•°ã€‚Slotçš„åˆ†é…åœ¨ä»»ä½•æ—¶é—´ç‚¹éƒ½å¯ä»¥è¿›è¡Œé‡æ–°åˆ†é…ã€‚ å®¢æˆ·ç«¯åœ¨å¯¹keyè¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œå¯ä»¥è¿æ¥Clusterä¸­çš„ä»»æ„ä¸€ä¸ªåˆ†ç‰‡ï¼Œå¦‚æœæ“ä½œçš„keyä¸åœ¨æ­¤åˆ†ç‰‡è´Ÿè´£çš„SlotèŒƒå›´å†…ï¼ŒRedis Clusterä¼šè‡ªåŠ¨å°†è¯·æ±‚é‡å®šå‘åˆ°æ­£ç¡®çš„åˆ†ç‰‡ä¸Šã€‚ hash tagsåœ¨åŸºç¡€çš„åˆ†ç‰‡åŸåˆ™ä¸Šï¼ŒRedisè¿˜æ”¯æŒhash tagsåŠŸèƒ½ï¼Œä»¥hash tagsè¦æ±‚çš„æ ¼å¼æ˜æ˜çš„keyï¼Œå°†ä¼šç¡®ä¿è¿›å…¥åŒä¸€ä¸ªSlotä¸­ã€‚ä¾‹å¦‚ï¼š{uiv}user:1000å’Œ{uiv}user:1001æ‹¥æœ‰åŒæ ·çš„hash tag {uiv}ï¼Œä¼šä¿å­˜åœ¨åŒä¸€ä¸ªSlotä¸­ã€‚ ä½¿ç”¨Redis Clusteræ—¶ï¼Œpipeliningã€äº‹åŠ¡å’ŒLUA ScriptåŠŸèƒ½æ¶‰åŠçš„keyå¿…é¡»åœ¨åŒä¸€ä¸ªæ•°æ®åˆ†ç‰‡ä¸Šï¼Œå¦åˆ™å°†ä¼šè¿”å›é”™è¯¯ã€‚å¦‚è¦åœ¨Redis Clusterä¸­ä½¿ç”¨ä¸Šè¿°åŠŸèƒ½ï¼Œå°±å¿…é¡»é€šè¿‡hash tagsæ¥ç¡®ä¿ä¸€ä¸ªpipelineæˆ–ä¸€ä¸ªäº‹åŠ¡ä¸­æ“ä½œçš„æ‰€æœ‰keyéƒ½ä½äºåŒä¸€ä¸ªSlotä¸­ã€‚ 1æœ‰ä¸€äº›å®¢æˆ·ç«¯ï¼ˆå¦‚Redissonï¼‰å®ç°äº†é›†ç¾¤åŒ–çš„pipeliningæ“ä½œï¼Œå¯ä»¥è‡ªåŠ¨å°†ä¸€ä¸ªpipelineé‡Œçš„å‘½ä»¤æŒ‰keyæ‰€åœ¨çš„åˆ†ç‰‡è¿›è¡Œåˆ†ç»„ï¼Œåˆ†åˆ«å‘åˆ°ä¸åŒçš„åˆ†ç‰‡ä¸Šæ‰§è¡Œã€‚ä½†æ˜¯Redisä¸æ”¯æŒè·¨åˆ†ç‰‡çš„äº‹åŠ¡ï¼Œäº‹åŠ¡å’ŒLUA Scriptè¿˜æ˜¯å¿…é¡»éµå¾ªæ‰€æœ‰keyåœ¨ä¸€ä¸ªåˆ†ç‰‡ä¸Šçš„è§„åˆ™è¦æ±‚ã€‚ ä¸»ä»å¤åˆ¶ vs é›†ç¾¤åˆ†ç‰‡åœ¨è®¾è®¡è½¯ä»¶æ¶æ„æ—¶ï¼Œè¦å¦‚ä½•åœ¨ä¸»ä»å¤åˆ¶å’Œé›†ç¾¤åˆ†ç‰‡ä¸¤ç§éƒ¨ç½²æ–¹æ¡ˆä¸­å–èˆå‘¢ï¼Ÿ ä»å„ä¸ªæ–¹é¢çœ‹ï¼ŒRedis Clusteréƒ½æ˜¯ä¼˜äºä¸»ä»å¤åˆ¶çš„æ–¹æ¡ˆ Redis Clusterèƒ½å¤Ÿè§£å†³å•èŠ‚ç‚¹ä¸Šæ•°æ®é‡è¿‡å¤§çš„é—®é¢˜ Redis Clusterèƒ½å¤Ÿè§£å†³å•èŠ‚ç‚¹è®¿é—®å‹åŠ›è¿‡å¤§çš„é—®é¢˜ Redis ClusteråŒ…å«äº†ä¸»ä»å¤åˆ¶çš„èƒ½åŠ› é‚£æ˜¯ä¸æ˜¯ä»£è¡¨Redis Clusteræ°¸è¿œæ˜¯ä¼˜äºä¸»ä»å¤åˆ¶çš„é€‰æ‹©å‘¢ï¼Ÿ å¹¶ä¸æ˜¯ã€‚ è½¯ä»¶æ¶æ„æ°¸è¿œä¸æ˜¯è¶Šå¤æ‚è¶Šå¥½ï¼Œå¤æ‚çš„æ¶æ„åœ¨å¸¦æ¥æ˜¾è‘—å¥½å¤„çš„åŒæ—¶ï¼Œä¸€å®šä¹Ÿä¼šå¸¦æ¥ç›¸åº”çš„å¼Šç«¯ã€‚é‡‡ç”¨Redis Clusterçš„å¼Šç«¯åŒ…æ‹¬ï¼š ç»´æŠ¤éš¾åº¦å¢åŠ ã€‚åœ¨ä½¿ç”¨Redis Clusteræ—¶ï¼Œéœ€è¦ç»´æŠ¤çš„Rediså®ä¾‹æ•°å€å¢ï¼Œéœ€è¦ç›‘æ§çš„ä¸»æœºæ•°é‡ä¹Ÿç›¸åº”å¢åŠ ï¼Œæ•°æ®å¤‡ä»½/æŒä¹…åŒ–çš„å¤æ‚åº¦ä¹Ÿä¼šå¢åŠ ã€‚åŒæ—¶åœ¨è¿›è¡Œåˆ†ç‰‡çš„å¢å‡æ“ä½œæ—¶ï¼Œè¿˜éœ€è¦è¿›è¡Œreshardæ“ä½œï¼Œè¿œæ¯”ä¸»ä»æ¨¡å¼ä¸‹å¢åŠ ä¸€ä¸ªSlaveçš„å¤æ‚åº¦è¦é«˜ã€‚ å®¢æˆ·ç«¯èµ„æºæ¶ˆè€—å¢åŠ ã€‚å½“å®¢æˆ·ç«¯ä½¿ç”¨è¿æ¥æ± æ—¶ï¼Œéœ€è¦ä¸ºæ¯ä¸€ä¸ªæ•°æ®åˆ†ç‰‡ç»´æŠ¤ä¸€ä¸ªè¿æ¥æ± ï¼Œå®¢æˆ·ç«¯åŒæ—¶éœ€è¦ä¿æŒçš„è¿æ¥æ•°æˆå€å¢å¤šï¼ŒåŠ å¤§äº†å®¢æˆ·ç«¯æœ¬èº«å’Œæ“ä½œç³»ç»Ÿèµ„æºçš„æ¶ˆè€—ã€‚ æ€§èƒ½ä¼˜åŒ–éš¾åº¦å¢åŠ ã€‚ä½ å¯èƒ½éœ€è¦åœ¨å¤šä¸ªåˆ†ç‰‡ä¸ŠæŸ¥çœ‹Slow Logå’ŒSwapæ—¥å¿—æ‰èƒ½å®šä½æ€§èƒ½é—®é¢˜ã€‚ äº‹åŠ¡å’ŒLUA Scriptçš„ä½¿ç”¨æˆæœ¬å¢åŠ ã€‚åœ¨Redis Clusterä¸­ä½¿ç”¨äº‹åŠ¡å’ŒLUA Scriptç‰¹æ€§æœ‰ä¸¥æ ¼çš„é™åˆ¶æ¡ä»¶ï¼Œäº‹åŠ¡å’ŒScriptä¸­æ“ä½œçš„keyå¿…é¡»ä½äºåŒä¸€ä¸ªåˆ†ç‰‡ä¸Šï¼Œè¿™å°±ä½¿å¾—åœ¨å¼€å‘æ—¶å¿…é¡»å¯¹ç›¸åº”åœºæ™¯ä¸‹æ¶‰åŠçš„keyè¿›è¡Œé¢å¤–çš„è§„åˆ’å’Œè§„èŒƒè¦æ±‚ã€‚å¦‚æœåº”ç”¨çš„åœºæ™¯ä¸­å¤§é‡æ¶‰åŠäº‹åŠ¡å’ŒScriptçš„ä½¿ç”¨ï¼Œå¦‚ä½•åœ¨ä¿è¯è¿™ä¸¤ä¸ªåŠŸèƒ½çš„æ­£å¸¸è¿ä½œå‰æä¸‹æŠŠæ•°æ®å¹³å‡åˆ†åˆ°å¤šä¸ªæ•°æ®åˆ†ç‰‡ä¸­å°±ä¼šæˆä¸ºéš¾ç‚¹ã€‚ æ‰€ä»¥è¯´ï¼Œåœ¨ä¸»ä»å¤åˆ¶å’Œé›†ç¾¤åˆ†ç‰‡ä¸¤ä¸ªæ–¹æ¡ˆä¸­åšå‡ºé€‰æ‹©æ—¶ï¼Œåº”è¯¥ä»åº”ç”¨è½¯ä»¶çš„åŠŸèƒ½ç‰¹æ€§ã€æ•°æ®å’Œè®¿é—®é‡çº§ã€æœªæ¥å‘å±•è§„åˆ’ç­‰æ–¹é¢ç»¼åˆè€ƒè™‘ï¼Œåªåœ¨ç¡®å®æœ‰å¿…è¦å¼•å…¥æ•°æ®åˆ†ç‰‡æ—¶å†ä½¿ç”¨Redis Clusterã€‚ä¸‹é¢æ˜¯ä¸€äº›å»ºè®®ï¼š éœ€è¦åœ¨Redisä¸­å­˜å‚¨çš„æ•°æ®æœ‰å¤šå¤§ï¼Ÿæœªæ¥2å¹´å†…å¯èƒ½å‘å±•ä¸ºå¤šå¤§ï¼Ÿè¿™äº›æ•°æ®æ˜¯å¦éƒ½éœ€è¦é•¿æœŸä¿å­˜ï¼Ÿæ˜¯å¦å¯ä»¥ä½¿ç”¨LRUç®—æ³•è¿›è¡Œéçƒ­ç‚¹æ•°æ®çš„æ·˜æ±°ï¼Ÿç»¼åˆè€ƒè™‘å‰é¢å‡ ä¸ªå› ç´ ï¼Œè¯„ä¼°å‡ºRediséœ€è¦ä½¿ç”¨çš„ç‰©ç†å†…å­˜ã€‚ ç”¨äºéƒ¨ç½²Redisçš„ä¸»æœºç‰©ç†å†…å­˜æœ‰å¤šå¤§ï¼Ÿæœ‰å¤šå°‘å¯ä»¥åˆ†é…ç»™Redisä½¿ç”¨ï¼Ÿå¯¹æ¯”(1)ä¸­çš„å†…å­˜éœ€æ±‚è¯„ä¼°ï¼Œæ˜¯å¦è¶³å¤Ÿç”¨ï¼Ÿ Redisé¢ä¸´çš„å¹¶å‘å†™å‹åŠ›ä¼šæœ‰å¤šå¤§ï¼Ÿåœ¨ä¸ä½¿ç”¨pipeliningæ—¶ï¼ŒRedisçš„å†™æ€§èƒ½å¯ä»¥è¶…è¿‡10ä¸‡æ¬¡/ç§’åœ¨ä½¿ç”¨Redisæ—¶ï¼Œæ˜¯å¦ä¼šä½¿ç”¨åˆ°pipeliningå’Œäº‹åŠ¡åŠŸèƒ½ï¼Ÿä½¿ç”¨çš„åœºæ™¯å¤šä¸å¤šï¼Ÿ ç»¼åˆä¸Šé¢å‡ ç‚¹è€ƒè™‘ï¼Œå¦‚æœå•å°ä¸»æœºçš„å¯ç”¨ç‰©ç†å†…å­˜å®Œå…¨è¶³ä»¥æ”¯æ’‘å¯¹Redisçš„å®¹é‡éœ€æ±‚ï¼Œä¸”Redisé¢ä¸´çš„å¹¶å‘å†™å‹åŠ›è·ç¦»Benchmarkå€¼è¿˜å°šæœ‰è·ç¦»ï¼Œå»ºè®®é‡‡ç”¨ä¸»ä»å¤åˆ¶çš„æ¶æ„ï¼Œå¯ä»¥çœå»å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚åŒæ—¶ï¼Œå¦‚æœåº”ç”¨ä¸­å¤§é‡ä½¿ç”¨pipeliningå’Œäº‹åŠ¡ï¼Œä¹Ÿå»ºè®®å°½å¯èƒ½é€‰æ‹©ä¸»ä»å¤åˆ¶æ¶æ„ï¼Œå¯ä»¥å‡å°‘è®¾è®¡å’Œå¼€å‘æ—¶çš„å¤æ‚åº¦ã€‚ Redis Javaå®¢æˆ·ç«¯çš„é€‰æ‹©Redisçš„Javaå®¢æˆ·ç«¯å¾ˆå¤šï¼Œå®˜æ–¹æ¨èçš„æœ‰ä¸‰ç§ï¼šJedisã€Redissonå’Œlettuceã€‚ åœ¨è¿™é‡Œå¯¹Jediså’ŒRedissonè¿›è¡Œå¯¹æ¯”ä»‹ç» Jedisï¼š è½»é‡ï¼Œç®€æ´ï¼Œä¾¿äºé›†æˆå’Œæ”¹é€  æ”¯æŒè¿æ¥æ±  æ”¯æŒpipeliningã€äº‹åŠ¡ã€LUA Scriptingã€Redis Sentinelã€Redis Cluster ä¸æ”¯æŒè¯»å†™åˆ†ç¦»ï¼Œéœ€è¦è‡ªå·±å®ç° æ–‡æ¡£å·®ï¼ˆçœŸçš„å¾ˆå·®ï¼Œå‡ ä¹æ²¡æœ‰â€¦â€¦ï¼‰ Redissonï¼š åŸºäºNettyå®ç°ï¼Œé‡‡ç”¨éé˜»å¡IOï¼Œæ€§èƒ½é«˜ æ”¯æŒå¼‚æ­¥è¯·æ±‚ æ”¯æŒè¿æ¥æ±  æ”¯æŒpipeliningã€LUA Scriptingã€Redis Sentinelã€Redis Cluster ä¸æ”¯æŒäº‹åŠ¡ï¼Œå®˜æ–¹å»ºè®®ä»¥LUA Scriptingä»£æ›¿äº‹åŠ¡ æ”¯æŒåœ¨Redis Clusteræ¶æ„ä¸‹ä½¿ç”¨pipelining æ”¯æŒè¯»å†™åˆ†ç¦»ï¼Œæ”¯æŒè¯»è´Ÿè½½å‡è¡¡ï¼Œåœ¨ä¸»ä»å¤åˆ¶å’ŒRedis Clusteræ¶æ„ä¸‹éƒ½å¯ä»¥ä½¿ç”¨ å†…å»ºTomcat Session Managerï¼Œä¸ºTomcat 6/7/8æä¾›äº†ä¼šè¯å…±äº«åŠŸèƒ½ å¯ä»¥ä¸Spring Sessioné›†æˆï¼Œå®ç°åŸºäºRedisçš„ä¼šè¯å…±äº« æ–‡æ¡£è¾ƒä¸°å¯Œï¼Œæœ‰ä¸­æ–‡æ–‡æ¡£ å¯¹äºJediså’ŒRedissonçš„é€‰æ‹©ï¼ŒåŒæ ·åº”éµå¾ªå‰è¿°çš„åŸç†ï¼Œå°½ç®¡Jedisæ¯”èµ·Redissonæœ‰å„ç§å„æ ·çš„ä¸è¶³ï¼Œä½†ä¹Ÿåº”è¯¥åœ¨éœ€è¦ä½¿ç”¨Redissonçš„é«˜çº§ç‰¹æ€§æ—¶å†é€‰ç”¨Redissonï¼Œé¿å…é€ æˆä¸å¿…è¦çš„ç¨‹åºå¤æ‚åº¦æå‡ã€‚ Jedisï¼šgithubï¼šhttps://github.com/xetorthio/jedisæ–‡æ¡£ï¼šhttps://github.com/xetorthio/jedis/wiki Redissonï¼šgithubï¼šhttps://github.com/redisson/redissonæ–‡æ¡£ï¼šhttps://github.com/redisson/redisson/wiki","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Redis","slug":"Code/Redis","permalink":"http://xiaoqinghua.site/categories/Code/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"http://xiaoqinghua.site/tags/Redis/"}]},{"title":"Redisç¬”è®°","slug":"Redisç¬”è®°","date":"2017-07-01T15:04:49.000Z","updated":"2018-08-24T07:45:12.677Z","comments":true,"path":"Redisç¬”è®°.html","link":"","permalink":"http://xiaoqinghua.site/Redisç¬”è®°.html","excerpt":"","text":"Redis é‡ç‚¹ç¬”è®°1ã€ä¸ºä»€ä¹ˆä½¿ç”¨ redis2ã€ä½¿ç”¨ redis å®¹æ˜“é€ æˆä»€ä¹ˆé—®é¢˜3ã€å•çº¿ç¨‹çš„ redis ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«4ã€redis çš„æ•°æ®ç±»å‹ï¼Œä»¥åŠæ¯ç§æ•°æ®ç±»å‹çš„ä½¿ç”¨åœºæ™¯5ã€redis çš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶6ã€redis å’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜7ã€å¦‚ä½•åº”å¯¹ç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©é—®é¢˜8ã€å¦‚ä½•è§£å†³ redis çš„å¹¶å‘ç«äº‰é—®é¢˜ ç¬”è®°è§£æ1ã€ä¸ºä»€ä¹ˆä½¿ç”¨ redisåˆ†æï¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ redis ä¸»è¦è€ƒè™‘ä¸¤ç‚¹æ€§èƒ½å’Œå¹¶å‘ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œredis è¿˜å…·å¤‡åšåˆ†å¸ƒå¼é”ç­‰å…¶ä»–åŠŸèƒ½ï¼ˆ// TODO ä»€ä¹ˆå…¶ä»–åŠŸèƒ½ï¼‰ï¼Œä½†æ˜¯å¦‚æœåªæ˜¯ä¸ºäº†åˆ†å¸ƒå¼é”è¿™äº›å…¶ä»–åŠŸèƒ½ï¼Œå®Œå…¨è¿˜æœ‰å…¶ä»–ä¸­é—´ä»¶ï¼ˆå¦‚ zookeeper ç­‰ï¼‰ä»£æ›¿ï¼Œå¹¶ä¸æ˜¯éè¦ç”¨ redisã€‚ æ€§èƒ½ å’Œ å¹¶å‘ æ€§èƒ½ï¼š \bå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨ç¢°åˆ°éœ€è¦æ‰§è¡Œè€—æ—¶ç‰¹åˆ«ä¹…ï¼Œä¸”æ‰§è¡Œç»“æœä¸é¢‘ç¹å˜åŠ¨çš„ SQLï¼Œå°±ç‰¹åˆ«é€‚åˆå°†è¿è¡Œç»“æœæ”¾å…¥ç¼“å­˜ã€‚è¿™æ ·ï¼Œåé¢çš„è¯·æ±‚å°±å»ç¼“å­˜ä¸­è¯»å–ï¼Œä½¿å¾—è¯·æ±‚èƒ½å¤Ÿè¿…é€Ÿå“åº”ï¼Œå› æ­¤æé«˜äº†æ€§èƒ½ã€‚ å¹¶å‘ï¼š å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è¯·æ±‚ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œæ•°æ®åº“ä¼šå‡ºç°è¿æ¥å¼‚å¸¸ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦ä½¿ç”¨ redis åšä¸€ä¸ªç¼“å†²æ“ä½œï¼Œè®©è¯·æ±‚å…ˆè®¿é—®åˆ° redisï¼Œè€Œä¸æ˜¯ç›´æ¥è®¿é—®æ•°æ®åº“ã€‚ 2ã€ä½¿ç”¨ redis å®¹æ˜“é€ æˆä»€ä¹ˆé—®é¢˜åˆ†æï¼šè¯šç„¶ redis è§£å†³äº†å¾ˆå¤šé—®é¢˜ï¼Œæé«˜äº†ç³»ç»Ÿæ€§èƒ½ï¼Œä¼˜åŒ–äº†ç³»ç»Ÿå¤„ç†å¹¶å‘çš„èƒ½åŠ›ï¼Œä½†æ˜¯ä½¿ç”¨ redis ä¹Ÿä¼šé‡åˆ°è§£å†³ä¸Šè¿°é—®é¢˜è¿›è€Œæ‰€äº§ç”Ÿçš„è¡ç”Ÿé—®é¢˜ã€‚ ä¸»è¦æ˜¯å››ä¸ªé—®é¢˜ ç¼“å­˜å’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜ ç¼“å­˜é›ªå´©ï¼ˆå¤§é¢ç§¯çš„æ•°æ®å´©æºƒï¼‰ ç¼“å­˜å‡»ç©¿ ç¼“å­˜å¹¶å‘ç«äº‰é—®é¢˜ ä¸‹æ–‡ä¸­ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚ 3ã€å•çº¿ç¨‹çš„ redis ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«åˆ†æï¼šè¿™ä¸ªé—®é¢˜å…¶å®æ˜¯å¯¹ redis å†…éƒ¨æœºåˆ¶çš„ä¸€ä¸ªè€ƒå¯Ÿã€‚redis æ˜¯å•çº¿ç¨‹çš„ï¼ï¼ï¼ï¼ ä¸ºä»€ä¹ˆå¿«ï¼Œä¸»è¦æ˜¯ä»¥ä¸‹ä¸‰ç‚¹ çº¯å†…å­˜æ“ä½œ å•çº¿ç¨‹æ“ä½œï¼Œé¿å…é¢‘ç¹åˆ‡æ¢ä¸Šä¸‹æ–‡ é‡‡ç”¨éé˜»å¡ I/O å¤šè·¯å¤ç”¨æœºåˆ¶ï¼ˆæƒ³åˆ°äº† netty ï¼‰ I/O å¤šè·¯å¤ç”¨ï¼šå•ä¸ªçº¿ç¨‹ï¼Œé€šè¿‡è·Ÿè¸ªæ¯ä¸ªI/Oæµçš„çŠ¶æ€ï¼Œæ¥ç®¡ç†å¤šä¸ªI/Oæµã€‚ä¸‹å›¾æ˜¯ç±»æ¯”åˆ°çœŸå®çš„ redis çº¿ç¨‹æ¨¡å‹ï¼šæˆ‘ä»¬ä½¿ç”¨redis-clientåœ¨æ“ä½œçš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿå…·æœ‰ä¸åŒäº‹ä»¶ç±»å‹çš„socketã€‚åœ¨æœåŠ¡ç«¯ï¼Œæœ‰ä¸€æ®µI/O å¤šè·¯å¤ç”¨çš„ç¨‹åºï¼Œå°†å…¶ç½®å…¥é˜Ÿåˆ—ä¹‹ä¸­ï¼ˆ//TODO å¯ç†è§£ä¸ºä¸€ä¸ªçº¿ç¨‹æ¨¡å‹ï¼Œå•çº¿ç¨‹å¤„ç†ï¼‰ï¼Œç„¶åå‘é€åˆ°æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ï¼Œä¾æ¬¡å»é˜Ÿåˆ—ä¸­å–ï¼Œè½¬å‘åˆ°ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ä¸­ã€‚redisçš„è¿™ä¸ªI/O å¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œè¿˜ä½“ç°åœ¨redisæä¾›äº†selectï¼Œepollï¼Œevportï¼Œkqueue`ç­‰å¤šè·¯å¤ç”¨å‡½æ•°åº“ã€‚ 4ã€redisçš„æ•°æ®ç±»å‹ï¼Œä»¥åŠæ¯ç§æ•°æ®ç±»å‹çš„ä½¿ç”¨åœºæ™¯åˆ†æï¼šè¿™æ˜¯ä¸€ä¸ªåŸºç¡€é—®é¢˜ï¼Œé…åˆç†Ÿè®°é£Ÿç”¨æ›´ä½³ã€‚ æœ‰äº”ç§æ•°æ®ç±»å‹ String å¸¸è§„set/getæ“ä½œï¼Œvalueå¯ä»¥æ˜¯Stringä¹Ÿå¯ä»¥æ˜¯æ•°å­—ã€‚ä¸€èˆ¬åšä¸€äº›å¤æ‚è®¡ç®—åŠŸèƒ½çš„ç¼“å­˜ã€‚ hash hashæ•°æ®ç±»å‹çš„valueå­˜æ”¾çš„æ˜¯ç»“æ„åŒ–çš„å¯¹è±¡ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„å°±æ˜¯æ“ä½œå…¶ä¸­çš„æŸä¸ªå­—æ®µã€‚åœ¨åšå•ç‚¹ç™»å½•çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨è¿™ç§ç»“æ„å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œä»¥cookieIdä½œä¸ºkeyï¼Œè®¾ç½®30åˆ†é’Ÿä¸ºç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œèƒ½å¾ˆå¥½çš„æ¨¡æ‹Ÿå‡ºç±»ä¼¼sessionçš„æ•ˆæœã€‚ list listæ•°æ®ç»“æ„ï¼Œå¯ä»¥åšç®€å•çš„æ¶ˆæ¯é˜Ÿåˆ—çš„åŠŸèƒ½ã€‚å¦å¤–ä¸€ä¸ªæ˜¯ï¼Œå¯ä»¥åˆ©ç”¨lrangeå‘½ä»¤ï¼ŒåšåŸºäºredisçš„åˆ†é¡µåŠŸèƒ½ï¼ˆlrange mylist 0 10ï¼‰ï¼Œæ€§èƒ½æä½³ï¼Œç”¨æˆ·ä½“éªŒå¾ˆå¥½ã€‚ set setæ•°æ®ç»“æ„å­˜æ”¾çš„æ˜¯ä¸€å †ä¸é‡å¤çš„é›†åˆã€‚æ‰€ä»¥å¯ä»¥åšå…¨å±€å»é‡çš„åŠŸèƒ½ã€‚å¯ä»¥ä½¿ç”¨äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰æ“ä½œï¼Œå¯ä»¥è®¡ç®—å…±åŒå–œå¥½ï¼Œå…¨éƒ¨å–œå¥½ï¼Œè‡ªå·±ç‹¬æœ‰å–œå¥½ç­‰åŠŸèƒ½ã€‚ sorted set sorted setå¤šäº†ä¸€ä¸ªæƒé‡å‚æ•°scoreï¼Œé›†åˆä¸­çš„å…ƒç´ èƒ½å¤ŸæŒ‰ç…§scoreè¿›è¡Œæ’åˆ—ã€‚å¯ä»¥åšæ’è¡Œæ¦œåº”ç”¨ï¼Œå–TOP Næ“ä½œï¼Œå»¶æ—¶ä»»åŠ¡ï¼ŒèŒƒå›´æŸ¥æ‰¾ã€‚ 5ã€ redisçš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶åˆ†æï¼šå‡å¦‚redisåªèƒ½å­˜ 5G æ•°æ®é‡ï¼Œå†™å…¥äº† 10G çš„æ•°æ®ï¼Œå°±ä¼šåˆ é™¤ 5G æ•°æ®ï¼Œæ€ä¹ˆåˆ é™¤ï¼ŒæŒ‰ç…§ä»€ä¹ˆç­–ç•¥åˆ é™¤ã€‚ redis é‡‡ç”¨ å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤ç­–ç•¥ ä¸ºä»€ä¹ˆä¸ç”¨å®šæ—¶åˆ é™¤ç­–ç•¥ å®šæ—¶åˆ é™¤ï¼Œç”¨ä¸€ä¸ªå®šæ—¶å™¨æ¥è´Ÿè´£ç›‘è§† keyï¼Œè¿‡æœŸåˆ™è‡ªåŠ¨åˆ é™¤ã€‚è™½ç„¶å†…å­˜åŠæ—¶é‡Šæ”¾ï¼Œä½†æ˜¯ååˆ†æ¶ˆè€— CPU èµ„æºã€‚åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒCPU åº”è¯¥å°†æ—¶é—´åº”ç”¨åœ¨å¤„ç†è¯·æ±‚ä¸Šï¼Œè€Œä¸æ˜¯åˆ é™¤ keyï¼Œå› æ­¤ä¸é‡‡ç”¨è¿™ä¸€ç§ç­–ç•¥ã€‚ å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ å®šæœŸåˆ é™¤ï¼Œredis é»˜è®¤æ¯éš”100msæ£€æŸ¥æ˜¯å¦æœ‰è¿‡æœŸçš„keyï¼Œæœ‰è¿‡æœŸçš„keyç›´æ¥åˆ é™¤ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œredisä¸æ˜¯æ¯éš”100mså°†æ‰€æœ‰çš„keyæ£€æŸ¥ä¸€æ¬¡ï¼Œè€Œæ˜¯éšæœºæŠ½å–è¿›è¡Œæ£€æŸ¥ï¼ˆå¦‚æœæ¯éš”100mså°†æ‰€æœ‰çš„keyæ£€æŸ¥ä¸€æ¬¡ï¼Œredisåº”è¯¥å·²ç»çˆ†ç‚¸ğŸ’¥äº†ï¼‰ï¼Œå› æ­¤å¦‚æœåªé‡‡å–å®šæœŸåˆ é™¤ç­–ç•¥ï¼Œä¼šå¯¼è‡´å¾ˆå¤šè¿‡æœŸçš„keyæ²¡æœ‰è¢«åˆ é™¤ã€‚äºæ˜¯ï¼Œæƒ°æ€§åˆ é™¤æ´¾ä¸Šç”¨åœºäº†ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä½ è·å–æŸä¸ªkeyçš„æ—¶å€™ï¼Œredisä¼šæ£€æŸ¥ä¸€ä¸‹ï¼Œè¿™ä¸ªkeyå¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œé‚£ä¹ˆæ˜¯å¦è¿‡æœŸäº†ï¼Ÿå¦‚æœè¿‡æœŸæ­¤æ—¶å°±ä¼šè¢«åˆ é™¤ã€‚ï¼ˆæ„Ÿè§‰å°±æ˜¯ä¸€æ³¢äº¡ç¾Šè¡¥ç‰¢çš„æ“ä½œï¼Œä¸è¿‡èƒ½è¿™æ ·è¿˜æ˜¯æŒº NB çš„ï¼‰ é‡‡ç”¨å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤å°±æ²¡å…¶ä»–é—®é¢˜äº†ï¼Ÿï¼Ÿï¼Ÿ ä¸æ˜¯çš„ï¼ï¼Œå¦‚æœå®šæœŸåˆ é™¤æ²¡æœ‰åˆ é™¤keyã€‚ç„¶åä½ ä¹Ÿæ²¡æœ‰å»getè¿™ä¸ªkeyï¼Œä¹Ÿå°±æ˜¯è¯´æƒ°æ€§åˆ é™¤æ²¡æœ‰ç”Ÿæ•ˆã€‚è¿™æ ·ï¼Œredisçš„å†…å­˜å ç”¨ä¼šè¶Šæ¥è¶Šå¤§ã€‚æ­¤æ—¶å°±åº”è¯¥é‡‡ç”¨å†…å­˜æ·˜æ±°æœºåˆ¶ã€‚ åœ¨reids.confä¸­æœ‰ä¸€è¡Œé…ç½®ï¼š 1# maxmemory-policy volatile-lru è¿™ä¸ªé…ç½®å°±æ˜¯å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Œä¸€ä¸‹æ˜¯å‡ ç§æ·˜æ±°ç­–ç•¥ï¼Œè§£æä¸€ä¸‹ï¼š noevictionï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥çš„æ•°æ®æ—¶ï¼Œæ–°å†™å…¥æ“ä½œä¼šæŠ¥é”™ã€‚è¿™ä¸ªåº”è¯¥æ²¡äººç”¨å§ğŸ˜‚ allkeys-lruï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥çš„æ•°æ®æ—¶ï¼Œåœ¨é”®ç©ºé—´ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyï¼ˆleast recently usedï¼‰ã€‚æ¨èä½¿ç”¨è¿™ä¸€ç§ç­–ç•¥ã€‚ volatile-lruï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯æŠŠ redis æ—¢å½“ç¼“å­˜ï¼ŒåˆåšæŒä¹…åŒ–å­˜å‚¨çš„æ—¶å€™é‡‡ç”¨ã€‚ä¸æ¨è volatile-randomï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ªkeyã€‚ä¾ç„¶ä¸æ¨è //TODO why volatile-ttlï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œæœ‰æ›´æ—©è¿‡æœŸæ—¶é—´çš„keyä¼˜å…ˆç§»é™¤ã€‚ä¸æ¨èã€‚ å¦‚æœæ²¡æœ‰è®¾ç½®expireçš„keyï¼Œä¸æ»¡è¶³å…ˆå†³æ¡ä»¶prerequisitesï¼›é‚£ä¹ˆvolatile-lruï¼Œvolatile-randomå’Œvolatile-ttlç­–ç•¥çš„è¡Œä¸ºå’Œnoevictionï¼ˆä¸åˆ é™¤ï¼‰åŸºæœ¬ä¸€è‡´ã€‚ 6ã€redis å’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜åˆ†æï¼šä¸€è‡´æ€§é—®é¢˜æ˜¯åˆ†å¸ƒå¼å¸¸è§çš„é—®é¢˜ï¼Œè¿˜å¯ä»¥åˆ†ä¸ºæœ€ç»ˆä¸€è‡´æ€§å’Œå¼ºä¸€è‡´æ€§ã€‚æ•°æ®åº“å’Œç¼“å­˜åŒå†™ï¼Œå°±å¿…ç„¶ä¼šå­˜åœ¨ä¸ä¸€è‡´é—®é¢˜ã€‚æ³¨æ„ï¼šæœ‰ä¸€ä¸ªå‰æï¼Œå¦‚æœå¯¹æ•°æ®æœ‰å¼ºä¸€è‡´æ€§è¦æ±‚ï¼Œæ•°æ®å°±ä¸èƒ½å­˜æ”¾åœ¨ç¼“å­˜ã€‚æˆ‘ä»¬æ‰€åšçš„ä¸€åˆ‡åªèƒ½ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚å¦å¤–ï¼Œæˆ‘ä»¬æ‰€åšçš„æ–¹æ¡ˆä»æ ¹æœ¬ä¸Šæ¥è¯´ï¼Œåªèƒ½é™ä½ä¸ä¸€è‡´å‘ç”Ÿçš„æ¦‚ç‡ï¼Œæ— æ³•å®Œå…¨é¿å…ã€‚å› æ­¤ï¼Œæœ‰å¼ºä¸€è‡´æ€§è¦æ±‚çš„æ•°æ®ï¼Œä¸èƒ½æ”¾ç¼“å­˜ã€‚ 1é¦–å…ˆï¼Œé‡‡å–æ­£ç¡®çš„æ›´æ–°ç­–ç•¥ï¼Œå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜ã€‚å…¶æ¬¡ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨ç¼“å­˜åˆ é™¤å¤±è´¥çš„é—®é¢˜ï¼Œæä¾›ä¸€ä¸ªè¡¥å¿æªæ–½å³å¯ï¼Œä¾‹å¦‚åˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—ã€‚ 7ã€å¦‚ä½•åº”å¯¹ç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©é—®é¢˜åˆ†æï¼šè¿™ä¸ªé—®é¢˜ï¼Œä¸€ç‰ˆé«˜å¹¶å‘çš„é¡¹ç›®å¯èƒ½ä¼šé‡åˆ°ï¼Œæµé‡å‡ ç™¾ä¸‡å·¦å³ã€‚ ç¼“å­˜ç©¿é€ æœ‰äººæ•…æ„å»è¯·æ±‚ç¼“å­˜ä¸­ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå¯¼è‡´æ‰€æœ‰çš„è¯·æ±‚æ€¼åˆ°æ•°æ®åº“ä¸Šï¼Œä»è€Œæ•°æ®åº“è¿æ¥å¼‚å¸¸ã€‚ è§£å†³æ–¹æ¡ˆï¼š 1ã€åˆ©ç”¨äº’æ–¥é”ï¼Œç¼“å­˜å¤±æ•ˆçš„æ—¶å€™ï¼Œå…ˆå»è·å¾—é”ï¼Œå¾—åˆ°é”ä¹‹åï¼Œå†å»è¯·æ±‚æ•°æ®åº“ã€‚æ²¡å¾—åˆ°é”ï¼Œåˆ™ä¼‘çœ ä¸€ç«¯æ—¶é—´é‡è¯•ã€‚ 2ã€é‡‡ç”¨å¼‚æ­¥æ›´æ–°ç­–ç•¥ï¼Œæ— è®ºæ˜¯keyæ˜¯å¦å–åˆ°å€¼ï¼Œéƒ½ç›´æ¥è¿”å›ã€‚valueå€¼ä¸­ç»´æŠ¤ä¸€ä¸ªç¼“å­˜å¤±æ•ˆæ—¶é—´ï¼Œç¼“å­˜å¦‚æœè¿‡æœŸï¼Œå°±å¼‚æ­¥èµ·ä¸€ä¸ªçº¿ç¨‹å»è¯»æ•°æ®åº“ï¼Œæ›´æ–°ç¼“å­˜ã€‚è¿™ä¸ªæ–¹æ¡ˆï¼Œéœ€è¦åšç¼“å­˜é¢„çƒ­ï¼ˆç¾¡æ…•å¯åŠ¨å‰ï¼Œå…ˆé¢„åŠ è½½ç¼“å­˜ï¼‰æ“ä½œã€‚ 3ã€æä¾›ä¸€ä¸ªèƒ½è¿…é€Ÿåˆ¤æ–­è¯·æ±‚æ˜¯å¦æœ‰æ•ˆçš„æ‹¦æˆªæœºåˆ¶ã€‚æ¯”å¦‚ï¼Œåˆ©ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆbloom filterï¼‰ï¼Œå†…éƒ¨ç»´æŠ¤ä¸€ç³»åˆ—åˆæ³•æœ‰æ•ˆçš„keyã€‚è¿…é€Ÿåˆ¤æ–­å‡ºï¼Œè¯·æ±‚æ‰€æºå¸¦çš„keyæ˜¯å¦åˆæ³•æœ‰æ•ˆã€‚å¦‚æœä¸åˆæ³•ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚ ç¼“å­˜é›ªå´© ç¼“å­˜åŒä¸€æ—¶é—´å¤§é¢ç§¯çš„å¤±æ•ˆï¼Œè¿™ä¸ªæ—¶å€™åˆæ¥äº†ä¸€æ³¢è¯·æ±‚ï¼Œç»“æœè¯·æ±‚éƒ½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œä»è€Œå¯¼è‡´æ•°æ®åº“è¿æ¥å¼‚å¸¸ã€‚ è§£å†³æ–¹æ¡ˆï¼š 1ã€ç»™ç¼“å­˜çš„å¤±æ•ˆæ—¶é—´ï¼ŒåŠ ä¸Šä¸€ä¸ªéšæœºå€¼ï¼Œé¿å…é›†ä½“å¤±æ•ˆã€‚ 2ã€ä½¿ç”¨äº’æ–¥é”ï¼Œä½†æ˜¯ååé‡æ˜æ˜¾ä¸‹é™äº†ã€‚ 3ã€ä½¿ç”¨åŒç¼“å­˜ï¼Œä¸¤ä¸ªç¼“å­˜ï¼ŒAï¼ŒBã€‚ç¼“å­˜ A çš„å¤±æ•ˆæ—¶é—´æ˜¯20åˆ†é’Ÿï¼Œç¼“å­˜ B ä¸è®¾å¤±æ•ˆæ—¶é—´ã€‚è‡ªå·±åšç¼“å­˜é¢„çƒ­æ“ä½œã€‚ç„¶åç»†åˆ†ä¸€ä¸‹å‡ ä¸ªå°ç‚¹ï¼š ä»ç¼“å­˜ A è¯»æ•°æ®åº“ï¼Œæœ‰åˆ™ç›´æ¥è¿”å›ã€‚ A æ²¡æœ‰è¯»åˆ°æ•°æ®ï¼Œç›´æ¥ä» B è¯»æ•°æ®ï¼Œæœ‰åˆ™ç›´æ¥è¿”å›ï¼Œå¹¶å¼‚æ­¥å¯åŠ¨ä¸€ä¸ªæ›´æ–°çº¿ç¨‹ã€‚ æ›´æ–°çº¿ç¨‹åŒæ—¶æ›´æ–°ç¼“å­˜ A å’Œç¼“å­˜ Bã€‚ 8ã€å¦‚ä½•è§£å†³ Redis çš„å¹¶å‘ç«äº‰é—®é¢˜åˆ†æï¼šè¿™ä¸ªé—®é¢˜å¤§è‡´å°±æ˜¯ï¼ŒåŒæ—¶åˆå¤šä¸ªå­ç³»ç»Ÿå»setä¸€ä¸ªkeyã€‚ä¸€èˆ¬å¾ˆå¤šå›ç­”æ˜¯ä½¿ç”¨redisçš„äº‹åŠ¡æœºåˆ¶ã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒï¼Œä¸€èˆ¬éƒ½æ˜¯redisé›†ç¾¤ç¯å¢ƒï¼Œåšäº†æ•°æ®åˆ†ç‰‡æ“ä½œã€‚ä½ ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰€æœ‰æ¶‰åŠåˆ°å¤šä¸ªkeyæ“ä½œçš„æ—¶å€™ï¼Œè¿™ä¸ªkeyä¸ä¸€å®šéƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ªredis-serverä¸Šã€‚å› æ­¤ï¼Œredis çš„äº‹åŠ¡æœºåˆ¶ï¼Œæœ‰ç‚¹é¸¡è‚‹ã€‚ï¼ˆ// TODOï¼‰ å¦‚ä¸‹æ‰€ç¤ºï¼š 1ã€å¦‚æœè¿™ä¸ªkeyæ“ä½œï¼Œä¸è¦æ±‚é¡ºåºï¼Œå¯ä»¥å‡†å¤‡ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œå¤§å®¶å»æŠ¢é”ï¼ŒæŠ¢åˆ°äº†é”å°±åšsetæ“ä½œå³å¯ã€‚ 2ã€å¦‚æœè¿™ä¸ªkeyæ“ä½œï¼Œè¦æ±‚é¡ºåºï¼Œå‡è®¾æœ‰ä¸€ä¸ªkey1ï¼Œç³»ç»Ÿ A éœ€è¦å°†key1è®¾ç½®ä¸ºvalueAï¼Œç³»ç»Ÿ B éœ€è¦å°† key1è®¾ç½®ä¸ºvalueBï¼Œç³»ç»Ÿ C éœ€è¦å°†key1è®¾ç½®ä¸ºvalueCã€‚ æˆ‘ä»¬æœŸæœ›æŒ‰ç…§key1çš„valueå€¼æŒ‰ç…§valueAâ€“&gt;valueBâ€“&gt;valueCçš„é¡ºåºå˜åŒ–ã€‚è¿™æ—¶å€™æˆ‘ä»¬åœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™ï¼Œå°±éœ€è¦ä¿å­˜ä¸€ä¸ªæ—¶é—´æˆ³ã€‚å‡è®¾æ—¶é—´æˆ³å¦‚ä¸‹ï¼š 123ç³»ç»ŸA key1 &#123;valueA 3:00&#125;ç³»ç»ŸB key1 &#123;valueB 3:05&#125;ç³»ç»ŸC key1 &#123;valueC 3:10&#125; é‚£ä¹ˆæ ¹æ®ä¸Šè¿°ï¼Œå‡è®¾æ˜¯ç³»ç»Ÿ B å…ˆæŠ¢åˆ°é”ï¼Œå°†key1è®¾ç½®ä¸º{valueB 3:05}ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œå¦‚æœ A æŠ¢åˆ°é”ï¼Œå‘ç°è‡ªå·±çš„valueAçš„æ—¶é—´æˆ³æ—©äºç¼“å­˜ä¸­çš„æ—¶é—´æˆ³ï¼Œé‚£ä¹ˆä¹…ä¸åšsetæ“ä½œäº†ã€‚ å…¶ä»–æ–¹æ³•ï¼Œå¦‚åˆ©ç”¨é˜Ÿåˆ—ï¼Œå°†setæ–¹æ³•å˜æˆä¸²è¡Œè®¿é—®ä¹Ÿå¯ä»¥ã€‚ æœ¬æ–‡å‡ºå¤„å­¤ç‹¬çƒŸï¼Œä¸ªäººåªæ˜¯ä¸€å­—ä¸€å­—çš„è§£è¯»ï¼Œç†è§£å‰è¾ˆæ€»ç»“çš„ç»éªŒã€‚æˆ‘è®¤ä¸ºåªæ˜¯å¤§è‡´æµè§ˆä¸€ç¯‡åšæ–‡ï¼Œçœ‹ä¸€ç¯‡å…¬ä¼—å·æ•´ç†çš„å¹²è´§æ–‡ç« ï¼Œæ˜¯æ²¡æœ‰ç”¨çš„ï¼Œè¿˜æ˜¯è¦å¤šç†è§£ï¼Œå¤šå®è·µï¼ŒåŠ æ·±è®°å¿†ï¼Œæ‰èƒ½æ·±åˆ»ï¼Œæ¶“æ¶“ç»†æµï¼Œæ²äººå¿ƒè„¾ï¼Œå¼ºåŠ²å£®éª¨ã€‚è¿™ç§æ–¹å¼åªæ˜¯æˆ‘ä¸ªäººçš„å­¦ä¹ æ–¹å¼ï¼Œå¯èƒ½æ¯”è¾ƒç¬¨é‡ï¼Œæ¯”è¾ƒæ…¢ï¼Œä½†å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå†™åšå®¢çš„åŸå› ã€‚æœ‰å¹¸","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Redis","slug":"Code/Redis","permalink":"http://xiaoqinghua.site/categories/Code/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"http://xiaoqinghua.site/tags/Redis/"}]},{"title":"iterm2 å°æŠ€å·§","slug":"iterm2å°æŠ€å·§","date":"2017-03-12T06:47:35.000Z","updated":"2018-08-25T06:49:14.401Z","comments":true,"path":"iterm2å°æŠ€å·§.html","link":"","permalink":"http://xiaoqinghua.site/iterm2å°æŠ€å·§.html","excerpt":"","text":"iterm2 å°æŠ€å·§æ ‡ç­¾1234- æ–°å»ºæ ‡ç­¾ï¼šcommand + t- å…³é—­æ ‡ç­¾ï¼šcommand + w- åˆ‡æ¢æ ‡ç­¾ï¼šcommand + æ•°å­— æˆ–è€…command + æ–¹å‘é”®- åˆ‡æ¢å…¨å±ï¼šcommand + enter åˆ†å±1234- å‚ç›´åˆ†å± command + d- æ°´å¹³åˆ†å± command + shift + d- æŸ¥çœ‹å†å²å‘½ä»¤ command + ;- æŸ¥çœ‹å‰ªç²˜æ¿å†å² command + shift + h å…¶ä»–1234567891011- æ¸…é™¤å½“å‰è¡Œ ctrl + u- åˆ°è¡Œé¦– ctrl + a- åˆ°è¡Œå°¾ ctrl + e- æœç´¢å†å²å‘½ä»¤ ctrl + r- åˆ é™¤å½“å‰å…‰æ ‡çš„å­—ç¬¦ ctrl + d- åˆ é™¤å…‰æ ‡ä¹‹å‰çš„å­—ç¬¦ ctrl + h- åˆ é™¤å…‰æ ‡ä¹‹å‰çš„å•è¯ ctrl + w- åˆ é™¤åˆ°æ–‡æœ¬æœ«å°¾ ctrl + k- äº¤æ¢å…‰æ ‡å¤„å­—ç¬¦ ctrl + t- æ¸…å± command + r- command + f æ‰€é€‰ä¸­çš„å†…å®¹ä¼šè¢«è‡ªåŠ¨å¤åˆ¶ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/iterm2å°æŠ€å·§.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"Iterm2","slug":"Code/Iterm2","permalink":"http://xiaoqinghua.site/categories/Code/Iterm2/"}],"tags":[{"name":"Iterm2","slug":"Iterm2","permalink":"http://xiaoqinghua.site/tags/Iterm2/"}]},{"title":"ç™½å¤œè¡Œ","slug":"ç™½å¤œè¡Œ","date":"2016-11-14T12:06:59.000Z","updated":"2018-08-25T06:54:21.977Z","comments":true,"path":"ç™½å¤œè¡Œ.html","link":"","permalink":"http://xiaoqinghua.site/ç™½å¤œè¡Œ.html","excerpt":"","text":"ç™½å¤œè¡Œä¸–ç•Œä¸Šæœ‰ä¸¤æ ·ä¸œè¥¿ä¸èƒ½ç›´è§†ï¼Œä¸€æ˜¯å¤ªé˜³ï¼ŒäºŒæ˜¯äººå¿ƒã€‚ æˆ‘çš„å¤©ç©ºé‡Œæ²¡æœ‰å¤ªé˜³ï¼Œæ€»æ˜¯é»‘å¤œï¼Œä½†å¹¶ä¸æš—ï¼Œå› ä¸ºæœ‰ä¸œè¥¿ä»£æ›¿äº†å¤ªé˜³ã€‚è™½ç„¶æ²¡æœ‰å¤ªé˜³é‚£ä¹ˆæ˜äº®ï¼Œä½†å¯¹æˆ‘æ¥è¯´å·²ç»è¶³å¤Ÿã€‚å‡­å€Ÿè¿™ä»½å…‰ï¼Œæˆ‘ä¾¿èƒ½æŠŠé»‘å¤œå½“æˆç™½å¤©ã€‚æˆ‘ä»æ¥å°±æ²¡æœ‰å¤ªé˜³ï¼Œæ‰€ä»¥ä¸æ€•å¤±å»ã€‚ æ›¾ç»æ‹¥æœ‰çš„ä¸œè¥¿è¢«å¤ºèµ°ï¼Œå¹¶ä¸ä»£è¡¨å°±ä¼šå›åˆ°åŸæ¥æ²¡æœ‰é‚£ç§ä¸œè¥¿çš„æ—¶å€™ã€‚ ä¸€å¤©ä¸­ï¼Œå¤ªé˜³ä¼šå‡èµ·ï¼ŒåŒæ—¶è¿˜ä¼šè½ä¸‹ã€‚äººç”Ÿä¹Ÿä¸€æ ·ï¼Œæœ‰ç™½å¤©å’Œé»‘å¤œï¼Œåªæ˜¯ä¸ä¼šåƒå¤ªé˜³é‚£æ ·ï¼Œæœ‰å®šæ—¶çš„æ—¥å‡ºå’Œæ—¥è½ã€‚æœ‰äº›äººä¸€è¾ˆå­éƒ½æ´»åœ¨å¤ªé˜³çš„ç…§è€€ä¸‹ï¼Œæœ‰äº›äººä¸å¾—ä¸ä¸€ç›´æ´»åœ¨æ¼†é»‘çš„æ·±å¤œé‡Œã€‚äººå®³æ€•çš„ï¼Œå°±æ˜¯æœ¬æ¥ä¸€ç›´å­˜åœ¨çš„å¤ªé˜³è½ä¸‹ä¸å†å‡èµ·ï¼Œä¹Ÿå°±æ˜¯éå¸¸å®³æ€•åŸæœ¬ç…§åœ¨è‡ªå·±èº«ä¸Šçš„å…‰èŠ’æ¶ˆå¤±ã€‚ ä¸€ä¸ªæŠŠå¹³ç­‰ç½®äºè‡ªç”±æ™ºå•†çš„ç¤¾ä¼šä¸¤è€…éƒ½å¾—ä¸åˆ°ã€‚ä¸€ä¸ªæŠŠè‡ªç”±ç½®äºå¹³ç­‰ä¹‹ä¸Šçš„ç¤¾ä¼šï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥ä¸¤è€…å…¼å¾—ã€‚ åªæœ‰åœ¨ä¸€ä¸ªæ–¹é¢ï¼Œè”é‚¦å‚¨å¤‡ä½“ç³»å§‹ç»ˆå¦‚ä¸€ã€‚è¿™è¾¹æ˜¯ï¼Œä»–æŠŠæ‰€æœ‰é—®é¢˜éƒ½å½’å’äºè¶…å‡ºè‡ªå·±æ§åˆ¶èƒ½åŠ›çš„å¤–éƒ¨å½±å“ï¼Œè€ŒæŠŠæ‰€æœ‰åˆæ„çš„ç»“æœéƒ½å½’åŠŸäºè‡ªå·±ã€‚ç”±æ­¤ä»–ç»§ç»­ç»´æŒç€é‚£ä¸ªè°¬ä¼ ï¼Œè¯´ç§äººç»æµæ˜¯ä¸ç¨³å®šçš„ï¼›è€Œä»–çš„æ‰€ä½œæ‰€ä¸ºå´ä¸æ–­è¯æ˜äº†è¿™ä¸€äº‹å®å³æ”¿åºœæ‰æ˜¯å¯¼è‡´ä»Šå¤©ç»æµä¸ç¨³å®šçš„ä¸»è¦æ ¹æºã€‚ å…¬ä¼—å’Œç»æµå­¦å®¶è§‚å¿µçš„æ”¹å˜ï¼Œå‡æºè‡ªå¯¹å®é™…æƒ…å†µçš„è¯¯è§£ã€‚å½“æ—¶åªæœ‰å°‘æ•°äººçŸ¥é“ï¼Œè€Œæˆ‘ä»¬ç°åœ¨éƒ½çŸ¥é“ï¼Œå¤§è§æ¡å¹¶éæ˜¯ç§æœ‰åˆ¶ä¼ä¸šå¤±è´¥æ‰€å¯¼è‡´è€Œæ˜¯å› ä¸ºæ”¿åºœå¹¶æœªæˆåŠŸå±¥è¡Œå®ƒè¢«èµ‹äºˆçš„è´£ä»»ã€‚è¿™äº›è´£ä»»ç”¨ã€Šåˆä¼—å›½å®ªæ³•ã€‹ç¬¬ä¸€å¤©ç¬¬å…«æ¬¾çš„è¯æ¥è¯´ï¼Œä¾¿æ˜¯â€œé“¸é€ è´§å¸ï¼Œè°ƒèŠ‚å…¶ä»·å€¼ï¼Œå¹¶å˜å®šå¤–å¸ä»·å€¼â€ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ç¬¬ä¹ç« æˆ‘ä»¬å°†çœ‹åˆ°ï¼Œæ”¿åºœåœ¨ç®¡ç†è´§å¸æ–¹é¢çš„å¤±è´¥ä¸ä»…æ˜¯å†å²ä¸Šçš„ä¸€æ¡©æ€ªäº‹ï¼Œè€Œä¸”ä»»æ˜¯ä»Šæ—¥ä¹‹äº‹å®ã€‚ æ²¡æœ‰ä»€ä¹ˆæ¯”æ—¶é—´æ›´æœ‰è¯´æœåŠ›äº†ï¼Œå› ä¸ºæ—¶é—´æ— éœ€é€šçŸ¥æˆ‘ä»¬å°±å¯ä»¥æ”¹å˜ä¸€åˆ‡ã€‚ æœ€åˆæˆ‘ä»¬æ¥åˆ°è¿™ä¸ªä¸–ç•Œä¸Šæ˜¯å› ä¸ºä¸å¾—ä¸æ¥çš„ã€‚æœ€ç»ˆæˆ‘ä»¬ç¦»å¼€è¿™ä¸ªä¸–ç•Œï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬ä¸å¾—ä¸èµ°ã€‚ ä»¥ç¬‘çš„æ–¹å¼å“­ï¼Œåœ¨æ­»äº¡çš„ä¼´éšä¸‹æ´»ç€ã€‚ ä½œä¸ºä¸€ä¸ªè¯è¯­ï¼Œâ€œæ´»ç€â€åœ¨æˆ‘ä»¬ä¸­å›½çš„è¯­è¨€é‡Œå……æ»¡äº†åŠ›é‡ï¼Œå®ƒçš„åŠ›é‡ä¸æ˜¯æ¥è‡ªäºå–Šå«ï¼Œä¹Ÿä¸æ˜¯æ¥è‡ªäºè¿›æ”»ï¼Œè€Œæ˜¯å¿å—ï¼Œå»å¿å—ç”Ÿå‘½èµ‹äºˆæˆ‘ä»¬çš„è´£ä»»ï¼Œå»å¿å—ç°å®ç»™æˆ‘ä»¬çš„å¹¸ç¦å’Œè‹¦éš¾ï¼Œæ— èŠå’Œå¹³åº¸ã€‚ åšäººä¸èƒ½å¿˜è®°å››æ¡ï¼Œè¯ä¸è¦è¯´é”™ï¼ŒåºŠä¸è¦ç¡é”™ï¼Œé—¨æ§›ä¸è¦è¸é”™ï¼Œå£è¢‹ä¸è¦æ‘¸é”™ã€‚ äººæ˜¯ä¸ºæ´»ç€æœ¬èº«è€Œæ´»ç€ï¼Œä¸æ˜¯ä¸ºäº†æ´»ç€ä¹‹å¤–çš„ä»»ä½•äº‹ç‰©æ‰€æ´»ç€ã€‚ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸ç»å…¸å·¨è‘—æ‘˜æŠ„ç³»åˆ—è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/ç™½å¤œè¡Œ.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"http://xiaoqinghua.site/tags/Life/"}]},{"title":"å½±å“åŠ›","slug":"å½±å“åŠ›","date":"2016-10-27T13:35:02.000Z","updated":"2018-08-25T06:54:29.387Z","comments":true,"path":"å½±å“åŠ›.html","link":"","permalink":"http://xiaoqinghua.site/å½±å“åŠ›.html","excerpt":"","text":"å½±å“åŠ›è¶Šå–œæ¬¢ä¸€ä¸ªäººï¼Œå—è¿™ä¸ªäººçš„å½±å“è¶Šå¤§ã€‚ ä¸€æ ·åŸæœ¬æ²¡æœ‰ä»€ä¹ˆå¸å¼•åŠ›çš„ä¸œè¥¿ï¼Œçªç„¶é—´å˜å¾—å¾ˆæœ‰è¯±æƒ‘åŠ›ï¼Œå°±å› ä¸ºå¾ˆå¿«ä½ å°±å¾—ä¸åˆ°å®ƒäº†ã€‚ åœ¨æ¥å—äº†åˆ«äººçš„å¥½å¤„ä¹‹åï¼Œäººä»¬å¾ˆäº²ä¾å°±ä¼šç­”åº”ä¸€ä¸ªåœ¨æ²¡æœ‰è´Ÿå€ºå¿ƒé‡Œæ—¶ä¸€å®šä¼šæ‹’ç»çš„è¯·æ±‚ã€‚å³ä¾¿æ˜¯ä¸€ä¸ªä¸è¯·è‡ªæ¥çš„å¥½å¤„ï¼Œä¸€æ—¦è¢«æ¥æ”¶ï¼Œä¹Ÿä¼šåˆ¶é€ å‡ºä¸€ç§è´Ÿå€ºæ„Ÿã€‚ å½“æˆ‘ä»¬å¯¹è‡ªå·±ç¼ºä¹ä¿¡å¿ƒæ—¶ï¼Œå½“å½¢å¼å˜å¾—ä¸å¾ˆæ˜æœ—æ—¶ï¼Œå½“ä¸ç¡®å®šå äº†ä¸Šé£æ—¶ï¼Œæˆ‘ä»¬æœ€æœ‰å¯èƒ½ä»¥åˆ«äººçš„è¡Œä¸ºä½œä¸ºè‡ªå·±è¡ŒåŠ¨çš„å‚ç…§ã€‚ä¸æˆ‘ä»¬ç±»ä¼¼çš„äººçš„è¡Œä¸ºå¯¹æˆ‘ä»¬æœ€æœ‰å½±å“åŠ›ã€‚ ä¸€æ—¦æˆ‘ä»¬åšäº†ä¸€ä¸ªå†³å®šï¼Œæˆ–é€‰æ‹©äº†ä¸€ç§ç«‹åœºï¼Œå°±ä¼šæœ‰å‘è‡ªå†…å¿ƒä»¥åŠæ¥è‡ªå¤–éƒ¨çš„å‹åŠ›æ¥è¿«ä½¿æˆ‘ä»¬ä¸æ­¤ä¿æŒä¸€è‡´ã€‚åœ¨è¿™ç§å‹åŠ›ä¸‹ï¼Œæˆ‘ä»¬æ€»æ˜¯å¸Œæœ›ä»¥å®é™…è¡ŒåŠ¨æ¥è¯æ˜æˆ‘ä»¬ä»¥å‰çš„å†³å®šæ˜¯æ­£ç¡®çš„ã€‚ cazhulafu brotherä¸Šå¸ä¸é­”é¬¼åœ¨é‚£é‡Œææ–—ï¼Œæˆ˜æ–—ä¾¿åœ¨äººä»¬å¿ƒä¸­ã€‚ åœ¨ç°å®ä¸»ä¹‰è€…èº«ä¸Šï¼Œå¹¶ä¸æ˜¯å¥‡è¿¹äº§ç”Ÿä¿¡ä»°ï¼Œè€Œæ˜¯ä¿¡ä»°äº§ç”Ÿå¥‡è¿¹ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œäººä»¬ï¼Œç”šè‡³æ¶äººï¼Œè¦æ¯”æˆ‘ä»¬æƒ³è±¡ä¸­çš„ä»–ä»¬å¹¼ç¨šçš„å¤šï¼Œå¤©çœŸçš„å¤šã€‚å…¶å®æˆ‘ä»¬ä¹Ÿä¸€æ ·ã€‚ å¯¹è‡ªå·±è¯´è°å’Œå¬è‡ªå·±è¯´è°çš„äººä¼šè½åˆ°è¿™æ ·çš„åœ°æ­¥ï¼šæ— è®ºåœ¨è‡ªå·±èº«ä¸Šè¿˜æ˜¯å‘¨å›´ï¼Œå³ä½¿æœ‰çœŸç†ï¼Œä»–ä¹Ÿæ— æ³•è¾¨åˆ«ï¼Œç»“æœå°†æ˜¯æ—¢ä¸è‡ªé‡ï¼Œä¹Ÿä¸å°Šé‡åˆ«äººã€‚ä¸€ä¸ªäººå¦‚æœå¯¹è°éƒ½ä¸å°Šé‡ï¼Œä¹Ÿå°±æ²¡æœ‰äº†çˆ±ï¼›åœ¨æ²¡æœ‰çˆ±çš„æƒ…å†µä¸‹æƒ³è¦æ¶ˆé£å–ä¹ï¼Œæ— éæ”¾çºµæƒ…æ¬²ï¼Œè€½äºåŸå§‹çš„æ„Ÿå®˜äº«å—ï¼Œåœ¨ç½ªæ¶çš„æ³¥æ½­ä¸­å®Œå…¨å •è½æˆç•œç±»ï¼Œè€Œä¸€åˆ‡éƒ½å§‹äºä¸æ–­çš„å¯¹äººå’Œå¯¹å·±è¯´è°ã€‚å¯¹è‡ªå·±è¯´è°çš„äººæœ€å®¹æ˜“æ€„æ°”ã€‚ ç”µå­æ¸¸æˆè®©äººä¸Šç˜¾çš„å…¨éƒ¨åŸå› åªæœ‰ä¸€ä¸ªã€‚åˆ›é€ ä¸€ä¸ªå±äºæˆ‘ä»¬è‡ªå·±çš„ä¸–ç•Œã€‚æˆ‘æƒ³ä¸å‡ºæœ‰ä»€ä¹ˆä¸œè¥¿æ¯”åšä¸€ä¸ªç¥æ›´èƒ½è®©äººä¸Šç˜¾çš„äº†ã€‚ äººä»¬éƒ½è¯´æ²¡æœ‰ä»€ä¹ˆèƒ½é€ƒè„±å†·åº“çš„çƒ­åŠ›å­¦ç¬¬äºŒå®šå¾‹ï¼Œå®‡å®™çš„æœ€åå½’å®¿æ˜¯ä¸€ç‰‡çƒ­æ­»å¯‚ã€‚ä½†è¿™ä¸æ˜¯æ•…äº‹çš„å…¨éƒ¨ï¼Œå®‡å®™åœ¨æ²‰å¯‚çš„åŒäº‹ï¼Œä¹Ÿåœ¨çƒ­é—¹èµ·æ¥ï¼Œä»æ—§ç‰©ä¸­å¸¦æ¥æ–°ç”Ÿã€å¢åŠ å¤æ‚æ€§çš„æ–°å±‚æ¬¡ã€‚å®‡å®™å……æ»¡äº†æ— å°½çš„åˆ›é€ åŠ›ã€‚ç†µå’Œè¿›åŒ–ï¼Œä¸¤è€…å°±åƒä¸¤æ”¯æ—¶é—´ä¹‹çŸ¢ï¼Œä¸€å¤´æ‹–ç€æˆ‘ä»¬é€€å…¥æ— ç©·çš„é»‘æš—ï¼Œä¸€å¤´åœ¨æ‹‰æ‰¯æˆ‘ä»¬èµ°å‘æ°¸æ’çš„å…‰æ˜ã€‚ ç½‘ç»œæŠŠéšç§ä»é“å¾·é¢†åŸŸè½¬ç§»åˆ°äº†å¸‚åœºé¢†åŸŸâ€”â€”éšç§æˆäº†ä¸€ç§å•†å“ã€‚ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸ç»å…¸å·¨è‘—æ‘˜æŠ„ç³»åˆ—è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/å½±å“åŠ›.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"http://xiaoqinghua.site/tags/Life/"}]},{"title":"å°‘æœ‰äººèµ°çš„è·¯","slug":"å°‘æœ‰äººèµ°çš„è·¯","date":"2016-09-27T13:39:24.000Z","updated":"2018-08-25T06:54:34.305Z","comments":true,"path":"å°‘æœ‰äººèµ°çš„è·¯.html","link":"","permalink":"http://xiaoqinghua.site/å°‘æœ‰äººèµ°çš„è·¯.html","excerpt":"","text":"å°‘æœ‰äººèµ°çš„è·¯ä¸€è¾ˆå­çœŸçš„å¾ˆçŸ­ï¼Œè¿œæ²¡æœ‰æˆ‘ä»¬æƒ³è±¡çš„é‚£ä¹ˆé•¿ï¼Œæ°¸è¿œçœŸçš„æ²¡æœ‰å¤šè¿œï¼Œæ‰€æœ‰ä¸å¦¨å¯¹çˆ±ä½ çš„å¥½ä¸€ç‚¹ï¼Œä¹Ÿå¯¹è‡ªå·±å¥½ä¸€ç‚¹ï¼Œä»Šå¤©æ˜¯ä½ çš„æ•ç•”äººï¼Œæ˜å¤©å°±å¯èƒ½æ˜¯ä½ çš„é™Œç”Ÿäººï¼Œå¦‚æœè¿™ä¸€è¾ˆå­æ¥ä¸åŠå¥½å¥½çˆ±ï¼Œå°±æ›´ä¸è¦æŒ‡æœ›ä¸‹è¾ˆå­è¿˜èƒ½é‡è§ã€‚ æƒ³è®©åˆ«äººçœŸæ­£çˆ±ä½ ï¼Œåªæœ‰è®©è‡ªå·±æˆä¸ºå€¼å¾—çˆ±çš„äººã€‚ æ‰¿å—ç—›è‹¦æ˜¯èµ°å‘æˆç†Ÿçš„å¿…ç»ä¹‹è·¯ï¼Œä»»ä½•äººéƒ½ä¸èƒ½å›é¿ã€‚ å¤§éƒ¨åˆ†çš„ææƒ§ä¸æ‡’æƒ°æœ‰å…³ï¼Œè¿™å¥è¯æˆ‘æ·±ä»¥ä¸ºç„¶ã€‚æˆ‘ä¹ˆå¸¸å¸¸ä¼šå®³æ€•æ”¹å˜ï¼Œå…¶å®éƒ½æ˜¯å› ä¸ºè‡ªå·±å¤ªæ‡’äº†ï¼Œæ‡’å¾—å»é€‚åº”æ–°ç¯å¢ƒï¼Œæ‡’å¾—å»å­¦ä¹ æ–°çŸ¥è¯†ï¼Œæ¶‰è¶³æ–°çš„é¢†åŸŸï¼Œä½†å¦‚æœæ€»æ˜¯è¿™æ ·çš„è¯ï¼Œå¦‚ä½•èƒ½è®©è‡ªå·±æˆç†Ÿèµ·æ¥å‘¢ï¼Ÿ å¤šæ•°äººè®¤ä¸ºå‹‡æ°”å°±æ˜¯ä¸å®³æ€•ã€‚ç°åœ¨è®©æˆ‘æ¥å‘Šè¯‰ä½ ï¼Œä¸å®³æ€•ä¸æ˜¯å‹‡æ°”ï¼Œå®ƒåªæ˜¯è„‘æŸä¼¤ã€‚å‹‡æ°”æ˜¯å°½ç®¡ä½ æ„Ÿè§‰å®³æ€•ï¼Œä½†ä»èƒ½è¿éš¾è€Œä¸Šï¼›å°½ç®¡ä½ æ„Ÿè§‰ç—›è‹¦ï¼Œä½†ä»èƒ½ç›´æ¥é¢å¯¹ã€‚ æ‰€è°“è‡ªå¾‹ï¼Œæ˜¯ä»¥ç§¯æè€Œä¸»åŠ¨åœ°æ€åº¦ï¼Œå»è§£å†³äººç”Ÿç—›è‹¦çš„é‡è¦åŸåˆ™ï¼Œä¸»è¦åŒ…æ‹¬å››ä¸ªæ–¹é¢ï¼šæ¨è¿Ÿæ»¡è¶³æ„Ÿã€æ‰¿æ‹…è´£ä»»ã€å°Šé‡äº‹å®ã€ä¿æŒå¹³è¡¡ã€‚ æœªæ¥ç®€å²æ›´é‡è¦çš„\bï¼Œå½“ä»¥å¤§æ•°æ®ã€äººå·¥æ™ºèƒ½ä¸ºä»£è¡¨çš„ç§‘å­¦æŠ€æœ¯å‘å±•çš„æ—¥ç›Šæˆç†Ÿï¼Œäººç±»å°†é¢ä¸´ç€ä»è¿›åŒ–åˆ°æ™ºäººä»¥æ¥æœ€å¤§çš„ä¸€æ¬¡æ”¹å˜ï¼Œç»å¤§éƒ¨åˆ†äººå°†æ²¦ä¸ºâ€œæ— ä»·å€¼çš„ç¾¤ä½“â€ï¼Œåªæœ‰å°‘éƒ¨åˆ†äººèƒ½è¿›åŒ–æˆç‰¹è´¨å‘ç”Ÿæ”¹å˜çš„â€ç¥äººâ€ã€‚ æœªæ¥ï¼Œäººç±»å°†é¢ä¸´\bç€ä¸‰å¤§é—®é¢˜ï¼šç”Ÿç‰©æœ¬èº«å°±æ˜¯ç®—æ³•ï¼Œç”Ÿå‘½æ˜¯ä¸æ–­å¤„ç†æ•°æ®çš„è¿‡ç¨‹ï¼›æ„è¯†ä¸æ™ºèƒ½çš„åˆ†ç¦»ï¼›æ‹¥æœ‰å¤§æ•°æ®ç§¯ç´¯çš„å¤–éƒ¨ç¯å¢ƒå°†æ¯”æˆ‘ä»¬è‡ªå·±æ›´äº†è§£è‡ªå·±ã€‚å¦‚ä½•çœ‹å¾…è¿™ä¸‰å¤§é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•é‡‡å–åº”å¯¹æªæ–½ï¼Œå°†ç›´æ¥å½±å“ç€äººç±»æœªæ¥çš„å‘å±•ã€‚ å¤©æ‰åœ¨å·¦ï¼Œç–¯å­åœ¨å³æ—¶é—´æ˜¯ä¸æµé€çš„ï¼Œæµé€çš„æ˜¯æˆ‘ä»¬ã€‚ å“²å­¦å®¶ä¸ç–¯å­çš„åŒºåˆ«ï¼Œä¸€ä¸ªçŸ¥è¯†åœ¨æƒ³ï¼Œå¦ä¸€ä¸ªçœŸçš„å»åšäº†ã€‚ å­¤ç‹¬æ„Ÿæ—¶å¸¸ä½“ç°åœ¨ä¸€ç§çŸ›ç›¾ä¸Šï¼Œå°±æ˜¯ä½ ç»å¸¸å¤„äºä¸€ç§æŒ£æ‰çŠ¶æ€ï¼šæ—¢å¸Œæœ›åˆ«äººå…³å¿ƒã€ç®¡ä½è‡ªå·±ï¼Œåˆä¸çŸ¥é“è¯¥æ€ä¹ˆå»æ¥è§¦å’Œå›åº”åˆ«äººã€‚äºæ˜¯å¹²è„†ç›´æ¥æŠ—æ‹’ï¼Œç§‘å®¤éª¨å­é‡Œåˆæ˜¯é‚£ä¹ˆçš„æ¸´æœ›è¢«äº†è§£å’Œå…³æ³¨ï¼Œè€Œä¸”çŸ›ç›¾åˆ°å˜´é‡Œè¯´å‡ºæ¥çš„å’Œå¿ƒé‡Œæƒ³çš„å®Œå…¨ç›¸åã€‚ åªæœ‰å½“ä½ è®¤çœŸçš„å»åšä¸€ä»¶äº‹æƒ…çš„æ—¶å€™ï¼Œæ‰ä¼šå‘ç°è‡ªå·±çš„çµé­‚å’Œçµé­‚æ·±å¤„ã€‚ å¦‚æœæœ‰ä¸€å¤©ä½ çœ‹åˆ°æˆ‘ç–¯äº†ï¼Œå…¶å®æ˜¯ä½ ç–¯äº†ã€‚ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸ç»å…¸å·¨è‘—æ‘˜æŠ„ç³»åˆ—è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/å°‘æœ‰äººèµ°çš„è·¯.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"http://xiaoqinghua.site/tags/Life/"}]},{"title":"Mysqlå­˜å‚¨IPåœ°å€ç»†èŠ‚","slug":"Mysqlå­˜å‚¨IPåœ°å€ç»†èŠ‚","date":"2016-08-20T03:58:41.000Z","updated":"2018-08-25T06:51:07.266Z","comments":true,"path":"Mysqlå­˜å‚¨IPåœ°å€ç»†èŠ‚.html","link":"","permalink":"http://xiaoqinghua.site/Mysqlå­˜å‚¨IPåœ°å€ç»†èŠ‚.html","excerpt":"","text":"Mysqlå­˜å‚¨IPåœ°å€ç»†èŠ‚ipv4:æ•°æ®åº“å¯ä»¥è®¾è®¡æˆ: 1`ipv4` INT UNSIGNED; æ’å…¥ ipv4 åœ°å€1INSERT INTO `table` (`ipv4`) VALUES (INET_ATON(&quot;127.0.0.1&quot;)); æŸ¥è¯¢ ipv41SELECT INET_NTOA(`ipv4`) FROM `table`; æ³¨æ„å®æµ‹ä¸€å®šè¦è®¾è®¡æˆ UNSIGNED ï¼ŒMySQL çš„ INT å­˜å‚¨èŒƒå›´æ˜¯ -2147493648åˆ°2147493647(SIGNED) ï¼Œ0åˆ°4294967295(UNSIGNED)â€è€Œ ipv4 ä¸­ 255.255.255.255è¢«INET_ATON æˆ int ä¹‹åæ˜¯ 4294967295 åˆšå¥½æ˜¯æœ€å¤§å€¼ã€‚ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/Mysqlå­˜å‚¨IPåœ°å€ç»†èŠ‚.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[{"name":"Code","slug":"Code","permalink":"http://xiaoqinghua.site/categories/Code/"},{"name":"MySql","slug":"Code/MySql","permalink":"http://xiaoqinghua.site/categories/Code/MySql/"}],"tags":[{"name":"MySql","slug":"MySql","permalink":"http://xiaoqinghua.site/tags/MySql/"}]},{"title":"ä¹Œåˆä¹‹ä¼—","slug":"ä¹Œåˆä¹‹ä¼—","date":"2016-08-08T12:23:54.000Z","updated":"2018-08-25T06:54:47.822Z","comments":true,"path":"ä¹Œåˆä¹‹ä¼—.html","link":"","permalink":"http://xiaoqinghua.site/ä¹Œåˆä¹‹ä¼—.html","excerpt":"","text":"ä¹Œåˆä¹‹ä¼—äººä¸€åˆ°ç¾¤ä½“ä¸­ï¼Œæ™ºå•†å°±ä¸¥é‡é™ä½ï¼Œä¸ºäº†è·å¾—è®¤åŒæ„Ÿï¼Œä¸ªä½“åŸæ„æŠ›å¼ƒæ˜¯éï¼Œç”¨æ™ºå•†å»æ¢å–é‚£ä»½è®©äººå€æ„Ÿå®‰å…¨çš„å½’å±æ„Ÿã€‚ ç¾¤ä½“ä¸å–„æ¨ç†ï¼Œå´åˆæ€¥äºè¡ŒåŠ¨ã€‚ æˆ‘ä»¬å§‹ç»ˆæœ‰ä¸€ç§é”™è§‰ï¼Œä»¥ä¸ºæˆ‘ä»¬çš„æ„Ÿæƒ…æºè‡ªæˆ‘ä»¬çš„å†…å¿ƒã€‚ æˆ‘ä»¬ä»¥ä¸ºè‡ªå·±æ˜¯ç†æ€§çš„æˆ‘ä»¬ä»¥ä¸ºè‡ªå·±çš„ä¸€ä¸¾ä¸€åŠ¨éƒ½æ˜¯æœ‰å…¶é“ç†çš„ã€‚ä½†äº‹å®ä¸Šï¼Œæˆ‘ä»¬ç»å¤§å¤šæ•°çš„æ—¥å¸¸è¡Œä¸ºï¼Œéƒ½æ˜¯ä¸€äº›æˆ‘ä»¬è‡ªå·±æ ¹æœ¬æ— æ³•äº†è§£çš„éšè”½åŠ¨æœºç»“æœã€‚ ä¸ªäººä¸€æ—¦æˆä¸ºç¾¤ä½“ä¸­çš„ä¸€å‘˜ï¼Œä»–æ‰€ä½œæ‰€ä¸ºå°±ä¸ä¼šå†æ‰¿æ‹…è´£ä»»ï¼Œè¿™æ˜¯æ¯ä¸ªäººéƒ½ä¼šæš´éœ²å‡ºè‡ªå·±ä¸å—çº¦æŸçš„ä¸€é¢ã€‚ç¾¤ä½“è¿½æ±‚å’Œç›¸ä¿¡çš„ä»æ¥ä¸æ˜¯ä»€ä¹ˆçœŸç›¸å’Œç†æ€§ï¼Œè€Œæ˜¯ç›²ä»ã€æ®‹å¿ã€åæ‰§å’Œç‹‚çƒ­ï¼ŒåªçŸ¥é“ç®€å•è€Œæç«¯çš„æ„Ÿæƒ…ã€‚ æ‰€è°“ä¿¡ä»°ï¼Œå®ƒè®©ä¸€ä¸ªäººå˜å¾—å®Œå…¨å—è‡ªå·±çš„æ¢¦æƒ³å¥´å½¹ã€‚ æœˆäº®ä¸å…­ä¾¿å£«ä¸Šå¸çš„ç£¨ç›˜è½¬çš„å¾ˆæ…¢ï¼Œå´ç£¨å¾—å¾ˆç»†ã€‚ åœ¨çˆ±æƒ…çš„äº‹ä¸Šï¼Œå¦‚æœä½ è€ƒè™‘èµ·è‡ªå°Šå¿ƒæ¥ï¼Œé‚£åªèƒ½æœ‰ä¸€ä¸ªåŸå› ï¼šå®é™…ä¸Šä½ è¿˜æ˜¯æœ€çˆ±ä½ è‡ªå·±ã€‚ æˆ‘ä»¬æ¯ä¸ªäººç”Ÿåœ¨ä¸–ç•Œä¸Šéƒ½æ˜¯å­¤ç‹¬çš„ã€‚æ¯ä¸ªäººéƒ½å›°åœ¨ä¸€åº§é“å¡”é‡Œï¼Œåªèƒ½é ä¸€äº›ç¬¦å·åŒåˆ«äººä¼ è¾¾è‡ªå·±çš„æ€æƒ³ã€‚è€Œè¿™äº›ç¬¦å·å¹¶æ²¡æœ‰å…±åŒçš„ä»·å€¼ï¼Œå› æ­¤ä»–ä»¬çš„æ„ä¹‰æ˜¯æ¨¡ç³Šçš„ã€ä¸ç¡®å®šçš„ã€‚æˆ‘å—¯éå¸¸å¯æ€œåœ°æƒ³æŠŠè‡ªå·±å¿ƒä¸­çš„è´¢å¯Œä¼ é€ç»™åˆ«äººï¼Œä½†ä»–ä»¬å´æ²¡æœ‰æ¥å—è¿™è´¢å¯Œçš„èƒ½åŠ›ã€‚å› æ­¤æˆ‘ä»¬åªèƒ½å­¤ç‹¬åœ°è¡Œèµ°ï¼Œå°½ç®¡èº«ä½“ç›¸äº’ä¾å‚å´å¹¶ä¸åœ¨ä¸€èµ·ï¼Œæ—¢ä¸äº†è§£åˆ«äººä¹Ÿä¸èƒ½è¢«åˆ«äººæ‰€äº†è§£ã€‚ æµ·ä¼¯åˆ©å®‰çœ‹äº†è¿™æœ¬ä¹¦ï¼Œä½ å°±ä¸ä¼šå†çœ‹ã€Šä¸‰ä½“ã€‹äº†ã€‚ æˆ‘å»æ—…è¡Œæ˜¯å› ä¸ºæˆ‘å†³å®šè¦å»ï¼Œå¹¶ä¸æ˜¯å› ä¸ºé£æ™¯ã€‚ è¶å¹´è½»ï¼Œå¥½å¥½åˆ©ç”¨è¿™ä¸ªæœºä¼šï¼Œå°½åŠ›å»å°éæ‰€æœ‰çš„ç—›è‹¦ï¼Œè¿™ç§äº‹å¯ä¸æ˜¯ä¸€è¾ˆå­ä»€ä¹ˆæ—¶å€™éƒ½å¯ä»¥é‡åˆ°çš„ã€‚ äººä¸æ˜¯ä»å¨˜èƒé‡Œå‡ºæ¥å°±ä¸€æˆä¸å˜çš„ï¼Œç›¸åï¼Œç”Ÿæ´»ä¼šé€¼ä»–ä¸€æ¬¡åˆä¸€æ¬¡çš„è„±èƒæ¢éª¨ã€‚ çœŸæ­£çš„çˆ±æƒ…éœ€è¦ä»€ä¹ˆï¼Ÿéœ€è¦ä¸¤ä¸ªäººåœ¨ä¸€èµ·æ˜¯è½»æ¾å¿«ä¹çš„ï¼Œæ²¡æœ‰å‹åŠ›çš„ã€‚ è¯šå®çš„ç”Ÿæ´»æ–¹å¼å…¶å®æ˜¯æŒ‰ç…§è‡ªå·±èº«ä½“çš„æ„æ„¿è¡Œäº‹ï¼Œé¥¿çš„æ—¶å€™åƒé¥­ï¼Œçˆ±çš„æ—¶å€™ä¸å¿…æ’’è°ã€‚ è‹è²çš„ä¸–ç•Œç”Ÿå‘½æœ¬æ¥å°±æ˜¯æ‚²ä¼¤è€Œä¸¥è‚ƒçš„ã€‚æˆ‘ä»¬æ¥åˆ°è¿™ä¸ªç¾ä¸½çš„ä¸–ç•Œé‡Œï¼Œå½¼æ­¤ç›¸é€¢ï¼Œå½¼æ­¤é—®å€™ï¼Œå¹¶ç»“ä¼´åŒæ¸¸ä¸€æ®µçŸ­æš‚çš„æ—¶é—´ã€‚ç„¶åæˆ‘ä»¬å°±æ˜¯å»äº†å¯¹æ–¹ï¼Œç„¶åå°±è«åå…¶å¦™çš„æ¶ˆå¤±äº†ï¼Œå°±åƒæˆ‘ä»¬è«åå…¶å¦™åœ°æ¥åˆ°ä¸–ç•Œä¸€èˆ¬ã€‚ ä½ å¤ªä¹ æƒ¯è¿™ä¸ªä¸–ç•Œäº†ï¼Œæ‰€ä»¥ä½ å¯¹ä»»ä½•äº‹æƒ…éƒ½ä¸æ„Ÿåˆ°æƒŠå¥‡ã€‚ çœŸæ­£çš„çŸ¥è¯†æ¥è‡ªå†…å¿ƒï¼Œè€Œä¸æ˜¯å¾—è‡ªåˆ«äººçš„ä¼ æˆã€‚åŒæ—¶å”¯æœ‰å‡ºè‡ªå†…å¿ƒçš„çŸ¥è¯†ï¼Œæ‰èƒ½ä½¿äººæ‹¥æœ‰çœŸæ­£çš„æ™ºæ…§ã€‚ ç†æ™ºå’Œç»éªŒéƒ½ç¼ºå¤±æ—¶ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªçœŸç©ºï¼Œè¿™ä¸ªçœŸç©ºå¯ä»¥æœ‰ä¿¡ä»°å¡«è¡¥ã€‚ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸ç»å…¸å·¨è‘—æ‘˜æŠ„ç³»åˆ—è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/ä¹Œåˆä¹‹ä¼—.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"http://xiaoqinghua.site/tags/Life/"}]},{"title":"å¨±ä¹è‡³æ­»","slug":"å¨±ä¹è‡³æ­»","date":"2016-07-03T05:26:41.000Z","updated":"2018-08-25T06:54:37.906Z","comments":true,"path":"å¨±ä¹è‡³æ­».html","link":"","permalink":"http://xiaoqinghua.site/å¨±ä¹è‡³æ­».html","excerpt":"","text":"å¨±ä¹è‡³æ­»æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è®©æ–‡åŒ–ç²¾ç¥æ¯èï¼Œä¸€ç§æ˜¯å¥¥å¨å°”å¼â€”â€”æ–‡åŒ–æˆä¸ºä¸€ç§ç›‘ç‹±ï¼Œå¦ä¸€ç§æ˜¯èµ«èƒ¥é»å¼â€”â€”æ–‡åŒ–æˆä¸ºä¸€åœºæ»‘ç¨½æˆã€‚ æˆ‘ä»¬å°†æ­»äºæˆ‘ä»¬æ‰€çƒ­çˆ±çš„ä¸œè¥¿ã€‚ \bçœŸç†ä¸èƒ½ï¼Œä¹Ÿä»æ¥æ²¡æœ‰ï¼Œæ¯«æ— ä¿®é¥°åœ°å­˜åœ¨ã€‚å®ƒå¿…é¡»ç©¿ç€\bæŸç§åˆé€‚çš„å¤–è¡£å‡ºç°ï¼Œå¦åˆ™å°±å¯èƒ½å¾—ä¸åˆ°æ‰¿è®¤ï¼Œè¿™ä¹Ÿæ­£è¯´æ˜äº†â€œçœŸç†â€æ˜¯ä¸€ç§æ–‡åŒ–åè§ã€‚ è¿‡å»ï¼Œäººä»¬ä¸ºäº†è§£å†³ç”Ÿæ´»ä¸­çš„é—®é¢˜å„¿æœç´¢ä¿¡æ¯ï¼Œç°åœ¨æ˜¯ä¸ºäº†è®©æ— ç”¨çš„\bä¿¡æ¯æ´¾ä¸Šç”¨åœºè€Œåˆ¶é€ é—®é¢˜ã€‚ ä¸€ä¸ªäººå­¦åˆ°çš„\bæœ€é‡è¦çš„ä¸œè¥¿æ˜¯å­¦ä¹ çš„æ–¹æ³•ã€‚ 1984ä»–ä»¬ä¸åˆ°è§‰æ‚Ÿçš„æ—¶å€™ï¼Œå°±ä¸ä¼šé€ åã€‚ä»–ä»¬ä¸é€ åï¼Œå°±ä¸ä¼šæœ‰è§‰æ‚Ÿã€‚ å¦‚æœä½ æ„Ÿåˆ°ä¿æŒäººæ€§æ˜¯å€¼å¾—çš„ï¼Œå³ä½¿è¿™ä¸èƒ½æœ‰ä»»ä½•ç»“æœï¼Œä½ ä¹Ÿå·²ç»æ‰“è´¥äº†ä»–ä»¬ã€‚ ä¸Šç­‰äººçš„ç›®æ ‡æ˜¯ä¿æŒä»–ä»¬çš„åœ°ä½ã€‚ä¸­ç­‰äººçš„ç›®æ ‡æ˜¯è¦é€šä¸Šç­‰äººäº¤æ¢åœ°ä½ã€‚ä¸‹ç­‰äººçš„ç‰¹ç‚¹å§‹ç»ˆæ˜¯ï¼Œä»–ä»¬åŠ³è‹¦ä¹‹ä½™æ— æš‡æ—é¡¾ï¼Œå¶å°”æ‰é¡¾åˆ°æ—¥å¸¸ç”Ÿæ´»ä»¥å¤–çš„äº‹ï¼Œå› æ­¤å¦‚æœä»–ä»¬æœ‰ç›®æ ‡çš„è¯ï¼Œæ— éå°±æ˜¯å–æ¶ˆä¸€åˆ‡å·®åˆ«ï¼Œå»ºç«‹ä¸€ä¸ªäººäººå¹³ç­‰çš„ç¤¾ä¼šã€‚ æˆ‘ä»¬å¾ˆæ˜ç™½æ²¡æœ‰äººä¼šä¸ºäº†åºŸé™¤æƒåˆ©è€Œå¤ºå–æƒåˆ©ã€‚æƒåŠ›ä¸æ˜¯æ‰‹æ®µï¼ŒæƒåŠ›æ˜¯ç›®çš„ã€‚å»ºç«‹ä¸“æ”¿ä¸æ˜¯ä¸ºäº†ä¿å«é©å‘½ï¼Œåè¿‡æ¥è¿›è¡Œé©å‘½æ˜¯ä¸ºäº†å»ºç«‹ä¸“æ”¿ã€‚ zooè¶Šå–œæ¬¢ä¸Šä»€ä¹ˆï¼Œä¸€æ—¦çªç„¶å¤±å»å®ƒï¼Œæˆ‘çš„å¿ƒå°±è¶Šä¸ºæ‚²æ³£ã€‚è¿™æ ·ååå¤å¤åœ°ï¼Œæˆ‘è¿˜ä»»è¦å¿è€è¿™ç§è‹¦æ¥šä¸å¾—ä¸ç»§ç»­åº¦è¿‡å‰©ä½™çš„ç”Ÿå‘½ã€‚è¿™æ˜¯å¤šä¹ˆæ®‹é…·çš„äº‹æƒ…å•Šã€‚ä¸å…¶å¦‚æ­¤ï¼Œä¸å¦‚å¹²è„†æŠŠæˆ‘å½“åšä»€ä¹ˆéƒ½ä¸çˆ±ï¼Œæ²¡æœ‰äººå¿ƒå¾’æœ‰äººå½¢çš„æ ·å­ã€‚ çˆ±çš„è¶Šæ·±åˆ»ï¼Œæ­»çš„æ„ä¹‰å°±è¶Šæ²‰é‡ï¼Œå¤±è½æ„Ÿä¹Ÿä¼šè¶Šæ·±åˆ»ã€‚ æˆ‘è„¸ä¸Šè¶Šæ˜¯æŒ¤å‡ºæ˜äº®çš„ç¬‘å®¹ï¼Œæˆ‘çš„å†…å¿ƒå°±è¶Šæ˜¯å˜çš„è’èŠœã€‚ æˆ‘å¯¹åˆ«äººçš„å­˜åœ¨æ„Ÿåˆ°ææƒ§ï¼Œæˆ‘è§‰å¾—è‡ªå·±å¯¹åˆ«äººè°„åªšçš„è¡Œå¾„ä¹Ÿä¼šå› ä¸ºè¿™ä¸ªã€‚è¢«åˆ«äººè®¨åŒï¼Œè¢«åˆ«äººçœ‹ä¸èµ·ï¼Œè¢«åˆ«äººå˜²ç¬‘ï¼Œå¯¹æˆ‘æ¥è¯´éƒ½æ˜¯éš¾ä»¥å¿å—çš„ç—›è‹¦ï¼Œäºæ˜¯ä¸ºäº†é€ƒé¿è¿™äº›è¡Œä¸ºï¼Œæˆ‘å†è‡ªå·±çš„å†…å¿ƒå…»äº†é‚£æ ·ä¸€åªä¸‘é™‹çš„åŠ¨ç‰©ã€‚å¦‚æœæ²¡æœ‰åˆ«äººåœ¨è¿™ä¸ªä¸–ç•Œä¸Šï¼Œåªæœ‰æˆ‘è‡ªå·±ä¸€ä¸ªäººï¼Œé‚£å°†æ˜¯å¤šä¹ˆè½»æ¾å•Šã€‚ ps:è¿™æœ¬ä¹¦å¤ªæ²‰é‡äº†å§ğŸ˜¨ï¼Œé…ä¸ªé˜³å…‰æ˜åªšçš„ landspace å§ã€‚ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸ç»å…¸å·¨è‘—æ‘˜æŠ„ç³»åˆ—è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/å¨±ä¹è‡³æ­».htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"http://xiaoqinghua.site/tags/Life/"}]},{"title":"ç™¾å¹´å­¤ç‹¬","slug":"ç™¾å¹´å­¤ç‹¬","date":"2016-06-27T09:26:41.000Z","updated":"2018-08-25T06:54:17.656Z","comments":true,"path":"ç™¾å¹´å­¤ç‹¬.html","link":"","permalink":"http://xiaoqinghua.site/ç™¾å¹´å­¤ç‹¬.html","excerpt":"","text":"ç™¾å¹´å­¤ç‹¬æ— è®ºèµ°åˆ°å“ªé‡Œï¼Œéƒ½åº”è¯¥è®°ä½ï¼Œè¿‡å¾€çš„ä¸€åˆ‡éƒ½æ˜¯å‡çš„ï¼Œå›å¿†æ˜¯ä¸€æ¡æ²¡æœ‰å°½å¤´çš„è·¯ï¼Œä¸€åˆ‡ä»¥å¾€çš„æ˜¥å¤©éƒ½ä¸å¤å­˜åœ¨ï¼Œå°±è¿é‚£æœ€åšéŸ§\bè€Œåˆç‹‚ä¹±çš„çˆ±æƒ…å½’æ ¹ç»“åº•ä¹Ÿä¸è¿‡æ˜¯ä¸€ç§è½¬ç¬å³é€çš„ç°å®ï¼Œå”¯æœ‰å­¤ç‹¬æ°¸æ’ã€‚ ç”Ÿå‘½ä¸­çœŸæ­£é‡è¦çš„ä¸æ˜¯ä½ é­é‡äº†ä»€ä¹ˆï¼Œè€Œæ˜¯ä½ è®°ä½äº†å“ªäº›äº‹ï¼Œåˆæ˜¯å¦‚ä½•é“­è®°çš„ã€‚ æˆ‘ä»¬è¶‹è¡Œåœ¨äººç”Ÿè¿™ä¸ªäº˜å¤çš„æ—…é€”ï¼Œåœ¨åå·ä¸­å¥”è·‘ï¼Œåœ¨æŒ«æŠ˜ä¸­æ¶…æ§ƒï¼Œå¿§æ„ç¼ æ»¡å…¨èº«ï¼Œç—›è‹¦é£˜æ´’ä¸€åœ°ã€‚æˆ‘ä»¬ç´¯ï¼Œå´æ— ä»æ­¢æ­‡ï¼›æˆ‘ä»¬è‹¦ï¼Œå´æ— æ³•å›é¿ã€‚ ä¹°ä¸‹ä¸€å¼ æ°¸ä¹…è½¦ç¥¨ï¼Œç™»ä¸Šä¸€è¾†æ°¸æ— ç»ˆç‚¹çš„åˆ—è½¦ã€‚ æ‰€æœ‰äººéƒ½æ˜¾å¾—å¾ˆæ¿€è¿›ï¼Œç”¨è‡ªå·±çš„æ–¹å¼æƒ³å°½åŠæ³•æ´¾é£å¯‚å¯ï¼Œäº‹å®ä¸Šä»æ˜¯å»¶ç»­è‡ªå·±çš„å­¤ç‹¬ã€‚å¯‚å¯æ˜¯é€ åŒ–å¯¹ç¾¤å±…è€…çš„è¯…å’’ï¼Œå­¤ç‹¬æ‰æ˜¯å¯‚å¯çš„å”¯ä¸€å‡ºå£ã€‚ ä½œè€…ï¼šxiaoqinghua æœ‰å¹¸ç»å…¸å·¨è‘—æ‘˜æŠ„ç³»åˆ—è”ç³»åœ°å€ï¼šhttps://github.com/smartzer http://xiaoqinghua.site/css/images/zz_qrcode.jpegæœ¬æ–‡åœ°å€ï¼šhttp://xiaoqinghua.site/ç™¾å¹´å­¤ç‹¬.htmlç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 3.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"http://xiaoqinghua.site/tags/Life/"}]},{"title":"å°æ¸…åæœ‰å¹¸çš„æ—¶é—´æ—…è¡Œå›å¿†å½•","slug":"å…³äºæˆ‘","date":"1992-08-28T16:00:00.000Z","updated":"2018-09-08T08:42:37.037Z","comments":true,"path":"å…³äºæˆ‘.html","link":"","permalink":"http://xiaoqinghua.site/å…³äºæˆ‘.html","excerpt":"","text":"å¼€å§‹å§æ‰“ç®—æ˜¯å†™ä¸€ä¸ªå›å¿†å½•â€“since 1992","categories":[],"tags":[]}]}